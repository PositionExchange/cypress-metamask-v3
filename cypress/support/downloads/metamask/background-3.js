LavaPack.loadBundle([[4175,{"./bitcoin":4172,"./constants":4176,"./ethereum":4177,"./genericSigning":4178,"./index":4179,"./util":4180,bitwise:1860,buffer:1936,"hash.js/lib/hash/sha":4236,superagent:5750},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Client=void 0;var s=i(e("bitwise")),a=i(e("superagent")),o=i(e("./bitcoin")),c=e("hash.js/lib/hash/sha"),u=e("./index"),l=e("./constants"),f=i(e("./ethereum")),h=e("./genericSigning"),d=e("./util"),p=t.alloc(32),g=function(){function e(e){var t=e.baseUrl,n=e.name,r=e.privKey,i=e.stateData,s=e.timeout,a=e.retryCount,o=e.skipRetryOnWrongWallet;if(this.ephemeralPub=null,this.deviceId=null,this.isPaired=!1,this.activeWallets={internal:{uid:p,name:null,capabilities:null,external:!1},external:{uid:p,name:null,capabilities:null,external:!0}},this.skipRetryOnWrongWallet=o||!1,i)this._unpackAndApplyStateData(i);else{if(this.baseUrl=t||l.BASE_URL,n&&(n.length<5||n.length>24))throw new Error("`name` must be 5-24 characters");this.name=n||"Unknown",this.privKey=r||(0,d.randomBytes)(32),this.key=(0,d.getP256KeyPair)(this.privKey),this.retryCount=a||3,this.timeout=s||6e4}}return e.prototype.getStateData=function(){return this._packStateData()},e.prototype.getFwVersion=function(){return this.fwVersion&&this.fwVersion.length>=3?{fix:this.fwVersion[0],minor:this.fwVersion[1],major:this.fwVersion[2]}:null},e.prototype.getAppName=function(){return this.name},e.prototype.connect=function(e,t){var n=this;return new Promise((function(r,i){var s=(0,d.promisifyCb)(r,i,t);if("function"==typeof e){if(!n.deviceId)return s("No device ID has been stored. Please connect with your device ID first.");s=e}else n.deviceId=e;var a=n._buildRequest(l.deviceCodes.CONNECT,n.pubKeyBytes());n._request(a,null,(function(e,t){return e?s(e):(n.isPaired=n._handleConnect(t)||!1,!n.isPaired||n._fwVersionGTE(0,14,1)?s(e,n.isPaired):void n.fetchActiveWallet((function(e){return s(e,n.isPaired)})))}))}))},e.prototype.pair=function(e,n){var r=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,n),o=r.pubKeyBytes(),c=t.alloc(25);if(r.name.length<5||r.name.length>24)return a("Invalid length for name provided. Must be 5-24 characters.");e.length>0&&c.write(r.name);var u=(0,d.generateAppSecret)(o,c,t.from(e)),l=r.key.sign(u),f=(0,d.toPaddedDER)(l),h=t.concat([c,f]);r._request(h,"FINALIZE_PAIRING",(function(e,t){if(e)return a(e);var n=r._handlePair(t);if(n)return a(n);r.fetchActiveWallet((function(e){return e?a(e):a(null,r.hasActiveWallet())}))}))}))},e.prototype.test=function(e,n){var r=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,n);if(!e.payload)return a("First argument must contain `testID` and `payload` fields.");var o=t.alloc(506);o.writeUInt32BE(e.testID,0),o.writeUInt16BE(e.payload.length,4),e.payload.copy(o,6),r._request(o,"TEST",(function(e,t){if(e)return a(e);var n=r._handleEncResponse(t,l.decResLengths.test);return null!==n.err?a(n.err):a(null,n.data.slice(65))}))}))},e.prototype.getAddresses=function(e,n){var r=this;return new Promise((function(i,a){var o=(0,d.promisifyCb)(i,a,n),c=e.startPath,u=e.n,f=e.flag,h=void 0===f?0:f;if(c===undefined||u===undefined)return o("Please provide `startPath` and `n` options");if(c.length<2||c.length>5)return o("Path must include between 2 and 5 indices");if(!(0,d.isUInt4)(u)||!(0,d.isUInt4)(h))return o("Parameters `n` and `flag` must be integers between 0 and 15 inclusive");if(u>10)return o("You may only request ".concat(10," addresses at once."));var p=(0,l.getFwVersionConst)(r.fwVersion);if(!((p.getAddressFlags||[]).indexOf(h)>-1&&(h===l.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB||h===l.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB))&&!(0,d.isValidAssetPath)(c,p))return o("Parent derivation path is not supported");var g=53;if(p.varAddrPathSzAllowed)g+=1;else if(5!==c.length)return o("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");var b=t.alloc(g),m=0,w=r.getActiveWallet();if(null===w)return o("No active wallet.");w.uid.copy(b,m),m+=32,p.varAddrPathSzAllowed&&(b.writeUInt8(c.length,m),m+=1);for(var y=0;y<5;y++)y<=c.length&&b.writeUInt32BE(c[y],m),m+=4;var _,v=0;if(p.addrFlagsAllowed){v=p.getAddressFlags&&p.getAddressFlags.indexOf(h)>-1?h:0;var k=s.default.nibble.read(v),E=s.default.nibble.read(u);_=s.default.byte.write(k.concat(E))}else _=u;return b.writeUInt8(_,m),m++,r._request(b,"GET_ADDRESSES",(function(e,t){if(e)return o(e);var n=r._handleGetAddresses(t,v);return n.err?o(n.err):o(null,n.data)}))}))},e.prototype.sign=function(e,n,i,s){var a=this;return void 0===i&&(i=null),void 0===s&&(s=null),new Promise((function(c,u){var p=(0,d.promisifyCb)(c,u,n),g=e.data;if(!g)return p("You must provide `data`");var b,m,w,y=(0,l.getFwVersionConst)(a.fwVersion);g=r({fwConstants:y},g);var _=null;if(null!==i&&null!==s)_=i.currency,b=i,m=t.concat([s,b.extraDataPayloads.shift()]),w=l.signingSchema.EXTRA_DATA;else{_=e.currency;try{var v=y.genericSigning&&y.genericSigning.encodingTypes&&y.genericSigning.encodingTypes.EVM;if("ETH"===_&&v){var k;console.warn("Using the legacy ETH signing path. This will soon be deprecated. "+"Please switch to general signing request.");try{k=f.default.ethConvertLegacyToGenericReq(g)}catch(e){return p("Could not convert legacy request. Please switch to a general signing "+"request. See gridplus-sdk docs for more information.")}g={fwConstants:y,encodingType:l.EXTERNAL.SIGNING.ENCODINGS.EVM,curveType:l.EXTERNAL.SIGNING.CURVES.SECP256K1,hashType:l.EXTERNAL.SIGNING.HASHES.KECCAK256,signerPath:g.signerPath,payload:k},_=null}b="ETH"===_?f.default.buildEthereumTxRequest(g):"ETH_MSG"===_?f.default.buildEthereumMsgRequest(g):"BTC"===_?o.default.buildBitcoinTxRequest(g):(0,h.buildGenericSigningMsgRequest)(g)}catch(e){return p("Error building signing request: ".concat(e.message))}if(b.err!==undefined)return p(b.err);if(b.payload.length>y.reqMaxDataSz)return p("Transaction is too large");m=b.payload,w=b.schema}var E=t.alloc(2+y.reqMaxDataSz),x=0,S=b.extraDataPayloads&&Number(b.extraDataPayloads.length>0);E.writeUInt8(S,x),x+=1,E.writeUInt8(w,x),x+=1;var A=a.getActiveWallet();return null===A?p("No active wallet."):(A.uid.copy(E,x),x+=A.uid.length,m.copy(E,x),a._request(E,"SIGN_TRANSACTION",(function(t,n){if(t){if(t)return p(t)}else{if(S){var r=a._handleEncResponse(n,l.decResLengths.sign);return s=r.data.slice(65,73),i||((i=b).currency=_),a.sign(e,p,i,s)}try{var o=a._handleSign(n,_,b);return p(null,o)}catch(t){return p(t.message)}}})))}))},e.prototype.addDecoders=function(e,t){return new Promise((function(e,n){return(0,d.promisifyCb)(e,n,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.getDecoders=function(e,t){return new Promise((function(e,n){return(0,d.promisifyCb)(e,n,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.removeDecoders=function(e,t){return new Promise((function(e,n){return(0,d.promisifyCb)(e,n,t)("Feature currently disabled in Lattice firmware. Please include "+"calldata decoder data in the signing request itself.")}))},e.prototype.addPermissionV0=function(e,t){return new Promise((function(e,n){return(0,d.promisifyCb)(e,n,t)("This feature has been deprecated and may be replaced at a later time.")}))},e.prototype.getKvRecords=function(e,n){var r=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,n),o=e.type,c=void 0===o?0:o,u=e.n,f=void 0===u?1:u,h=e.start,p=void 0===h?0:h,g=(0,l.getFwVersionConst)(r.fwVersion);if(!g.kvActionsAllowed)return a("Unsupported. Please update firmware.");if(f<1)return a("You must request at least one record.");if(f>g.kvActionMaxNum)return a("You may only request up to ".concat(g.kvActionMaxNum," records at once."));var b=t.alloc(9);return b.writeUInt32LE(c,0),b.writeUInt8(f,4),b.writeUInt32LE(p,5),r._request(b,"GET_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.getKvRecords);if(n.err)return a(n.err);var i=65,s=parseInt(n.data.slice(i,i+4).toString("hex"),16);i+=4;var o=parseInt(n.data.slice(i,i+1).toString("hex"),16);if(i+=1,o>g.kvActionMaxNum)return a("Too many records fetched. Firmware error.");for(var c=[],u=0;u<o;u++){var f={};f.id=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,f.type=parseInt(n.data.slice(i,i+4).toString("hex"),16),i+=4,f.caseSensitive=1===parseInt(n.data.slice(i,i+1).toString("hex"),16),i+=1;var h=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,f.key=n.data.slice(i,i+h-1).toString(),i+=g.kvKeyMaxStrSz+1;var d=parseInt(n.data.slice(i,i+1).toString("hex"),16);i+=1,f.val=n.data.slice(i,i+d-1).toString(),i+=g.kvValMaxStrSz+1,c.push(f)}return a(null,{records:c,total:s,fetched:o})}if(e)return a(e)}))}))},e.prototype.addKvRecords=function(e,n){var r=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,n),o=e.type,c=void 0===o?0:o,u=e.records,f=void 0===u?{}:u,h=e.caseSensitive,p=void 0!==h&&h,g=(0,l.getFwVersionConst)(r.fwVersion);if(!g.kvActionsAllowed)return a("Unsupported. Please update firmware.");if("object"!=typeof f||0===Object.keys(f).length)return a("One or more key-value mapping must be provided in `records` param.");if(Object.keys(f).length>g.kvActionMaxNum)return a("Too many keys provided. Please only provide up to ".concat(g.kvActionMaxNum,"."));if(Object.keys(f).length<1)return a("You must provide at least one key to add.");var b=t.alloc(1+139*g.kvActionMaxNum);b.writeUInt8(Object.keys(f).length,0);var m=1;try{Object.keys(f).forEach((function(e){if("string"!=typeof e||String(e).length>g.kvKeyMaxStrSz)throw new Error("Key ".concat(e," too large. Must be <=").concat(g.kvKeyMaxStrSz," characters."));if("string"!=typeof f[e]||String(f[e]).length>g.kvValMaxStrSz)throw new Error("Value ".concat(f[e]," too large. Must be <=").concat(g.kvValMaxStrSz," characters."));if(0===String(e).length||0===String(f[e]).length)throw new Error("Keys and values must be >0 characters.");if(!l.ASCII_REGEX.test(e)||!l.ASCII_REGEX.test(f[e]))throw new Error("Unicode characters are not supported.");b.writeUInt32LE(0,m),m+=4,b.writeUInt32LE(c,m),m+=4,b.writeUInt8(p?1:0,m),m+=1,b.writeUInt8(String(e).length+1,m),m+=1,t.from(String(e)).copy(b,m),m+=g.kvKeyMaxStrSz+1,b.writeUInt8(String(f[e]).length+1,m),m+=1,t.from(String(f[e])).copy(b,m),m+=g.kvValMaxStrSz+1}))}catch(e){return a("Error building request: ".concat(e.message))}return r._request(b,"ADD_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.empty);return n.err?a(n.err):a(null)}if(e)return a(e)}))}))},e.prototype.removeKvRecords=function(e,n){var r=this;return new Promise((function(i,s){var a=(0,d.promisifyCb)(i,s,n),o=e.type,c=void 0===o?0:o,u=e.ids,f=void 0===u?[]:u,h=(0,l.getFwVersionConst)(r.fwVersion);if(!h.kvActionsAllowed)return a("Unsupported. Please update firmware.");if(!Array.isArray(f)||f.length<1)return a("You must include one or more `ids` to removed.");if(f.length>h.kvRemoveMaxNum)return a("Only up to ".concat(h.kvRemoveMaxNum," records may be removed at once."));var p=t.alloc(5+4*h.kvRemoveMaxNum);p.writeUInt32LE(c,0),p.writeUInt8(f.length,4);for(var g=0;g<f.length;g++)p.writeUInt32LE(f[g],5+4*g);return r._request(p,"REMOVE_KV_RECORDS",(function(e,t){if(!e){var n=r._handleEncResponse(t,l.decResLengths.empty);return n.err?a(n.err):a(null)}if(e)return a(e)}))}))},e.prototype.fetchActiveWallet=function(e){var n=this;return new Promise((function(r,i){var s=(0,d.promisifyCb)(r,i,e),a=t.alloc(0);return n._request(a,"GET_WALLETS",(function(e,t){return e?(n._resetActiveWallets(),s(e)):s(n._handleGetWallets(t))}))}))},e.prototype._getSharedSecret=function(){return t.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))},e.prototype._getEphemId=function(){if(null===this.ephemeralPub)return null;var e=this._getSharedSecret();return t.from((0,c.sha256)().update(e).digest("hex"),"hex").slice(0,4)},e.prototype._buildEncRequest=function(e,n){var r=parseInt(this._getEphemId().toString("hex"),16),i=t.concat([t.from([e]),n]),s=(0,d.checksum)(i),a=t.alloc(i.length+4);i.copy(a,0),a.writeUInt32LE(s,i.length);var o=this._getSharedSecret(),c=(0,d.aes256_encrypt)(a,o),u=t.alloc(l.ENC_MSG_LEN+4);return u.writeUInt32LE(r,0),c.copy(u,4),this._buildRequest(l.deviceCodes.ENCRYPTED_REQUEST,u)},e.prototype._buildRequest=function(e,n){var r=n&&t.isBuffer(n)?n.length+1:1;e===l.deviceCodes.ENCRYPTED_REQUEST&&(r=1+n.length);var i=0,s=t.alloc(r+8);i=s.writeUInt8(l.VERSION_BYTE,i),i=s.writeUInt8(l.REQUEST_TYPE_BYTE,i);var a=(0,d.randomBytes)(4);i=s.writeUInt32BE(parseInt("0x".concat(a.toString("hex"))),i),i=s.writeUInt16BE(r,i),i=s.writeUInt8(e,i),r>1&&(i=n.copy(s,i));var o=(0,d.checksum)(s),c=t.alloc(s.length+4);return i=s.copy(c),c.writeUInt32BE(o,i),c},e.prototype._request=function(e,t,n,r){var i=this;if(void 0===r&&(r=this.retryCount),!this.deviceId)return n("Device ID is not set. Please set it and try again.");if(t&&l.encReqCodes[t]===undefined)return n("Unknown encrypted request code.");var s=t?this._buildEncRequest(l.encReqCodes[t],e):e,o="".concat(this.baseUrl,"/").concat(this.deviceId);a.default.post(o).timeout(this.timeout).send({data:s}).then((function(s){if(!s||!s.body)return n("Invalid response: ".concat(s));if(200!==s.body.status)return n("Error code ".concat(s.body.status,": ").concat(s.body.message));var a=(0,d.parseLattice1Response)(s.body.message),o=a.responseCode===l.responseCodes.RESP_ERR_DEV_BUSY||a.responseCode===l.responseCodes.RESP_ERR_GCE_TIMEOUT,c=a.responseCode===l.responseCodes.RESP_ERR_WRONG_WALLET,u=a.responseCode===l.responseCodes.RESP_ERR_INVALID_EPHEM_ID,f=r>0;if(f&&o)setTimeout((function(){i._request(e,t,n,r-1)}),3e3);else if(f&&u)i.connect(i.deviceId,(function(s,a){return s?n(s):a?void i._request(e,t,n,r-1):n("Not paired to device.")}));else if(f&&c&&!i.skipRetryOnWrongWallet)i._resetActiveWallets(),i.fetchActiveWallet().then((function(){if(!(e=i._replaceWalletUID(t,e)))return n("Wrong wallet. Failed to switch. Please reconnect.");i._request(e,t,n,0)})).catch((function(e){return n(e)}));else if(a.responseCode||a.err){if(a.err)return n(a.err);n(l.responseMsgs[a.responseCode]||"Unknown request failure")}else n(null,a.data,a.responseCode)})).catch((function(e){var t="ECONNABORTED"===e.code&&"ETIME"===e.errno;return n(t?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device: ".concat(e.message))}))},e.prototype._handleConnect=function(e){var t=0,n=e.readUInt8(t)===l.messageConstants.PAIRED;t++;var r=e.slice(t,t+65).toString("hex");if(t+=65,this.fwVersion=e.slice(t,t+4),t+=4,this.ephemeralPub=(0,d.getP256KeyPairFromPub)(r),n&&this._fwVersionGTE(0,14,1)){var i=e.slice(t,t+160);t+=160;var s=this._getSharedSecret(),a=(0,d.aes256_decrypt)(i,s);if(0!==a[a.length-2]||0!==a[a.length-1])throw new Error("Failed to connect to Lattice.");this._parseAndAddWallets(a)}return n},e.prototype._handleEncResponse=function(e,t){var n=this._getSharedSecret(),r=e.slice(0,l.ENC_MSG_LEN),i=(0,d.aes256_decrypt)(r,n);t+=65;var s=i.slice(0,t),a=parseInt("0x".concat(i.slice(t,t+4).toString("hex"))),o=(0,d.checksum)(s);if(a!==o)return{err:"Checksum mismatch in response from Lattice (calculated ".concat(o,", wanted ").concat(a,")")};var c=i.slice(0,65).toString("hex");try{return this.ephemeralPub=(0,d.getP256KeyPairFromPub)(c),{err:null,data:i}}catch(e){return{err:"Error handling getAddresses response: ".concat(e.toString())}}},e.prototype._handlePair=function(e){var t=this._handleEncResponse(e,l.decResLengths.empty);return t.err?t.err:(this.isPaired=!0,null)},e.prototype._handleGetAddresses=function(e,t){var n=this._handleEncResponse(e,l.decResLengths.getAddresses);if(null!==n.err)return n;var r=n.data,i=65,s=[],a=u.Constants.GET_ADDR_FLAGS,o=a.ED25519_PUB,c=a.SECP256K1_PUB,f=t===o||t===c;for(f&&(i+=1);i+4<l.decResLengths.getAddresses;)if(f){var h=r.slice(i,i+65),d=h.every((function(e){return 0===e}));d||t!==o?d||s.push(h):s.push(h.slice(0,32)),i+=65}else{var p=r.slice(i,i+l.ADDR_STR_LEN);i+=l.ADDR_STR_LEN;var g=p.indexOf(0);g>0&&s.push(p.slice(0,g).toString())}return{data:s,err:null}},e.prototype._handleGetWallets=function(e){var t=this._handleEncResponse(e,l.decResLengths.getWallets);if(null!==t.err)return t;var n=t.data;return this._parseAndAddWallets(n.slice(65)),this.activeWallets.internal.uid.equals(p)&&this.activeWallets.external.uid.equals(p)?"No active wallet.":null},e.prototype._parseAndAddWallets=function(e){var t=0;this.activeWallets.internal.uid=e.slice(t,t+32),this.activeWallets.internal.capabilities=e.readUInt32BE(t+32),this.activeWallets.internal.name=e.slice(t+36,t+71),t+=71,this.activeWallets.external.uid=e.slice(t,t+32),this.activeWallets.external.capabilities=e.readUInt32BE(t+32),this.activeWallets.external.name=e.slice(t+36,t+71)},e.prototype._handleSign=function(e,n,r){void 0===r&&(r=null);var i=this._handleEncResponse(e,l.decResLengths.sign);if(null!==i.err)return{err:i.err};var s,a=65,u=i.data;if("BTC"===n){var p=o.default.getAddressFormat(r.origData.changePath),g=u.slice(a,a+20);a+=20,s=o.default.getBitcoinAddress(g,p)}if("BTC"===n){for(var b=[],m=[],w=0;a<u.length&&48===u[a];){var y=a,_=a+2+u[a+1];m.push(u.slice(y,_));var v=33*w+825,k=33*(w+1)+825;b.push(u.slice(v,k)),a+=74,w+=1}var E={inputs:[],outputs:[]};E.outputs.push({value:r.origData.value,recipient:r.origData.recipient}),r.changeData.value>0&&E.outputs.push({value:r.changeData.value,recipient:s});for(var x=0;x<m.length;x++)E.inputs.push({hash:r.origData.prevOuts[x].txHash,index:r.origData.prevOuts[x].index,sig:m[x],pubkey:b[x],signerPath:r.origData.prevOuts[x].signerPath});var S=o.default.serializeTx(E),A=S,R=t.from((0,c.sha256)().update(t.from(A,"hex")).digest("hex"),"hex");return{tx:S,txHash:(0,c.sha256)().update(R).digest("hex"),changeRecipient:s,sigs:m}}if("ETH"===n){var T=(0,d.parseDER)(u.slice(a,a+2+u[a+1]));a+=74;var N=u.slice(a,a+20),I=f.default.buildEthRawTx(r,T,N),O=I.rawTx,P=I.sigWithV;return{tx:"0x".concat(O),txHash:"0x".concat(f.default.hashTransaction(O)),sig:{v:P.v,r:P.r.toString("hex"),s:P.s.toString("hex")},signer:N}}if("ETH_MSG"===n){T=(0,d.parseDER)(u.slice(a,a+2+u[a+1]));a+=74;var L=u.slice(a,a+20),D=f.default.validateEthereumMsgResponse({signer:L,sig:T},r);return{sig:{v:D.v,r:D.r.toString("hex"),s:D.s.toString("hex")},signer:L}}return(0,h.parseGenericSigningResponse)(u,a,r.curveType,r.omitPubkey)},e.prototype._resetActiveWallets=function(){this.activeWallets.internal.uid=p,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=p,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null},e.prototype._replaceWalletUID=function(e,t){var n=this.getActiveWallet();return n?"GET_ADDRESSES"===e?(n.uid.copy(t,0),t):"SIGN_TRANSACTION"===e?(n.uid.copy(t,2),t):null:null},e.prototype._packStateData=function(){try{var e={activeWallets:{internal:{uid:this.activeWallets.internal.uid.toString("hex"),name:this.activeWallets.internal.name.toString(),capabilities:this.activeWallets.internal.capabilities},external:{uid:this.activeWallets.external.uid.toString("hex"),name:this.activeWallets.external.name.toString(),capabilities:this.activeWallets.external.capabilities}},ephemeralPub:this.ephemeralPub.getPublic().encode("hex"),fwVersion:this.fwVersion.toString("hex"),deviceId:this.deviceId,name:this.name,baseUrl:this.baseUrl,privKey:this.privKey.toString("hex"),retryCount:this.retryCount,timeout:this.timeout};return JSON.stringify(e)}catch(e){return console.warn("Could not pack state data."),null}},e.prototype._unpackAndApplyStateData=function(e){try{var n=JSON.parse(e),r={uid:t.from(n.activeWallets.internal.uid,"hex"),name:t.from(n.activeWallets.internal.name),capabilities:n.activeWallets.internal.capabilities,external:!1},i={uid:t.from(n.activeWallets.external.uid,"hex"),name:t.from(n.activeWallets.external.name),capabilities:n.activeWallets.external.capabilities,external:!0},s=t.from(n.ephemeralPub,"hex"),a=t.from(n.fwVersion,"hex"),o=t.from(n.privKey,"hex");this.activeWallets.internal=r,this.activeWallets.external=i,this.ephemeralPub=(0,d.getP256KeyPairFromPub)(s),this.fwVersion=a,this.deviceId=n.deviceId,this.name=n.name,this.baseUrl=n.baseUrl,this.privKey=o,this.key=(0,d.getP256KeyPair)(this.privKey),this.retryCount=n.retryCount,this.timeout=n.timeout}catch(e){console.warn("Could not apply state data.")}},e.prototype._fwVersionGTE=function(e,t,n){var r=this.getFwVersion(),i=r.major,s=r.minor,a=r.fix;return i>e||i>=e&&s>t||i>=e&&s>=t&&a>=n},e.prototype.getActiveWallet=function(){return p.equals(this.activeWallets.external.uid)?p.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external},e.prototype.hasActiveWallet=function(){return null!==this.getActiveWallet()},e.prototype.pubKeyBytes=function(e){void 0===e&&(e=!1);var n=this.key.getPublic().encode("hex"),r=t.from(n,"hex");if(!0===e){var i=r.slice(1,33).reverse(),s=r.slice(33,65).reverse();return t.concat([r[0],i,s])}return r},e}();n.Client=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4176,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r,i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.ETH_ABI_LATTICE_FW_TYPE_MAP=n.MAX_CHAIN_ID_BYTES=n.HANDLE_LARGER_CHAIN_ID=n.HARDENED_OFFSET=n.VERSION_BYTE=n.REQUEST_TYPE_BYTE=n.signingSchema=n.responseMsgs=n.responseCodes=n.messageConstants=n.ethMsgProtocol=n.encReqCodes=n.deviceCodes=n.decResLengths=n.addressSizes=n.ENC_MSG_LEN=n.BASE_URL=n.BIP_CONSTANTS=n.AES_IV=n.ADDR_STR_LEN=n.getFwVersionConst=n.ASCII_REGEX=n.EXTERNAL=void 0;n.AES_IV=[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100];n.ADDR_STR_LEN=129;var s={empty:0,getAddresses:1290,sign:1090,getWallets:142,getKvRecords:1395,getDecoders:1608,removeDecoders:4,test:1646};n.decResLengths=s;var a=0;n.ENC_MSG_LEN=a,Object.keys(s).forEach((function(e){s[e]+82>a&&(n.ENC_MSG_LEN=a=s[e]+82)}));n.deviceCodes={CONNECT:1,ENCRYPTED_REQUEST:2};n.encReqCodes={FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_DECODERS:6,GET_KV_RECORDS:7,ADD_KV_RECORDS:8,REMOVE_KV_RECORDS:9,GET_DECODERS:10,REMOVE_DECODERS:11,TEST:12};n.messageConstants={NOT_PAIRED:0,PAIRED:1};n.addressSizes={BTC:20,ETH:20};var o={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WRONG_WALLET:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141,RESP_ERR_INVALID_EPHEM_ID:142};n.responseCodes=o;var c=((r={})[o.RESP_SUCCESS]=0,r[o.RESP_ERR_INVALID_MSG]="Invalid request",r[o.RESP_ERR_UNSUPPORTED_VER]="Unsupported version",r[o.RESP_ERR_DEV_BUSY]="Device busy",r[o.RESP_ERR_USER_TIMEOUT]="Timeout waiting for user",r[o.RESP_ERR_USER_DECLINED]="Request declined by user",r[o.RESP_ERR_PAIR_FAIL]="Pairing failed",r[o.RESP_ERR_PAIR_DISABLED]="Pairing is currently disabled",r[o.RESP_ERR_PERMISSION_DISABLED]="Automated signing is currently disabled",r[o.RESP_ERR_INTERNAL]="Device error",r[o.RESP_ERR_GCE_TIMEOUT]="Timeout",r[o.RESP_ERR_WRONG_WALLET]="Active wallet does not match request",r[o.RESP_ERR_DEV_LOCKED]="Device locked",r[o.RESP_ERR_DISABLED]="Disabled",r[o.RESP_ERR_ALREADY]="Record already exists. You must first remove it on your device.",r[o.RESP_ERR_INVALID_EPHEM_ID]="Could not find requester. Please reconnect.",r);n.responseMsgs=c;n.signingSchema={BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4,GENERAL_SIGNING:5};var u=2147483648;n.HARDENED_OFFSET=u;var l={PURPOSES:{ETH:2147483692,BTC_LEGACY:2147483692,BTC_WRAPPED_SEGWIT:2147483697,BTC_SEGWIT:2147483732},COINS:{ETH:2147483708,BTC:u,BTC_TESTNET:2147483649}};n.BIP_CONSTANTS=l;n.REQUEST_TYPE_BYTE=2;n.VERSION_BYTE=1;n.HANDLE_LARGER_CHAIN_ID=255;n.MAX_CHAIN_ID_BYTES=8;n.BASE_URL="https://signing.gridpl.us";var f={address:1,bool:2,uint8:3,uint16:4,uint24:5,uint32:6,uint40:7,uint48:8,uint56:9,uint64:10,uint72:11,uint80:12,uint88:13,uint96:14,uint104:15,uint112:16,uint120:17,uint128:18,uint136:19,uint144:20,uint152:21,uint160:22,uint168:23,uint176:24,uint184:25,uint192:26,uint200:27,uint208:28,uint216:29,uint224:30,uint232:31,uint240:32,uint248:33,uint256:34,int8:35,int16:36,int24:37,int32:38,int40:39,int48:40,int56:41,int64:42,int72:43,int80:44,int88:45,int96:46,int104:47,int112:48,int120:49,int128:50,int136:51,int144:52,int152:53,int160:54,int168:55,int176:56,int184:57,int192:58,int200:59,int208:60,int216:61,int224:62,int232:63,int240:64,int248:65,int256:66,uint:67,bytes1:69,bytes2:70,bytes3:71,bytes4:72,bytes5:73,bytes6:74,bytes7:75,bytes8:76,bytes9:77,bytes10:78,bytes11:79,bytes12:80,bytes13:81,bytes14:82,bytes15:83,bytes16:84,bytes17:85,bytes18:86,bytes19:87,bytes20:88,bytes21:89,bytes22:90,bytes23:91,bytes24:92,bytes25:93,bytes26:94,bytes27:95,bytes28:96,bytes29:97,bytes30:98,bytes31:99,bytes32:100,bytes:101,string:102},h=i(i({},f),{tuple1:103,tuple2:104,tuple3:105,tuple4:106,tuple5:107,tuple6:108,tuple7:109,tuple8:110,tuple9:111,tuple10:112,tuple11:113,tuple12:114,tuple13:115,tuple14:116,tuple15:117,tuple16:118,tuple17:119});n.ETH_ABI_LATTICE_FW_TYPE_MAP=h;var d={SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:f}};n.ethMsgProtocol=d,n.EXTERNAL={GET_ADDR_FLAGS:{SECP256K1_PUB:3,ED25519_PUB:4},SIGNING:{HASHES:{NONE:0,KECCAK256:1,SHA256:2},CURVES:{SECP256K1:0,ED25519:1},ENCODINGS:{NONE:1,SOLANA:2,TERRA:3,EVM:4}}},n.getFwVersionConst=function(e){var t={extraDataFrameSz:0,extraDataMaxFrames:0,genericSigning:{}};function r(e,t){return e[2]>t[0]||e[2]===t[0]&&e[1]>t[1]||e[2]===t[0]&&e[1]===t[1]&&e[0]>t[2]||e[2]===t[0]&&e[1]===t[1]&&e[0]===t[2]}var i=0===e.length;return!i&&r(e,[0,10,4])||!i&&r(e,[0,10,0])?(t.reqMaxDataSz=1678,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0):(t.reqMaxDataSz=1152,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1),t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.eip712MaxTypeParams=18,!i&&r(e,[0,10,4])&&(t.extraDataFrameSz=1500,t.extraDataMaxFrames=1),!i&&r(e,[0,10,5])&&(t.varAddrPathSzAllowed=!0,t.eip712Supported=!0),!i&&r(e,[0,10,8])&&(t.prehashAllowed=!0),!i&&r(e,[0,10,10])&&(t.ethMsgPreHashAllowed=!0),!i&&r(e,[0,11,0])&&(t.allowedEthTxTypes=[1,2],t.ethMaxDataSz-=10,t.ethMaxMsgSz=t.ethMaxDataSz),!i&&r(e,[0,11,2])&&(t.personalSignHeaderSz=72),!i&&r(e,[0,12,0])&&(t.kvActionsAllowed=!0,t.kvKeyMaxStrSz=63,t.kvValMaxStrSz=63,t.kvActionMaxNum=10,t.kvRemoveMaxNum=100),!i&&r(e,[0,13,0])&&(t.allowBtcLegacyAndSegwitAddrs=!0,t.contractDeployKey="0x08002e0fec8e6acf00835f43c9764f7364fa3f42"),!i&&r(e,[0,14,0])&&(t.abiCategorySz=32,t.abiMaxRmv=200,t.genericSigning.baseReqSz=1552,t.genericSigning.baseDataSz=1519,t.genericSigning.hashTypes=n.EXTERNAL.SIGNING.HASHES,t.genericSigning.curveTypes=n.EXTERNAL.SIGNING.CURVES,t.genericSigning.encodingTypes={NONE:n.EXTERNAL.SIGNING.ENCODINGS.NONE,SOLANA:n.EXTERNAL.SIGNING.ENCODINGS.SOLANA},t.getAddressFlags=[n.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB,n.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB],t.eip712MaxTypeParams=36),!i&&r(e,[0,14,1])&&(t.genericSigning.encodingTypes.TERRA=n.EXTERNAL.SIGNING.ENCODINGS.TERRA),!i&&r(e,[0,15,0])&&(t.genericSigning.encodingTypes.EVM=n.EXTERNAL.SIGNING.ENCODINGS.EVM,t.ethMaxDataSz=1519,t.maxDecoderBufSz=1600,t.genericSigning.calldataDecoding={reserved:2895728,maxSz:1024}),t};n.ASCII_REGEX=/^[\x00-\x7F]+$/}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4177,{"./constants":4176,"./util":4180,"@ethereumjs/common":406,"@ethereumjs/tx":410,"bignumber.js":4182,borc:1899,buffer:1936,"eth-eip712-util-browser":2219,"js-sha3":4590,rlp:4183,secp256k1:4184},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=s(e("@ethereumjs/common")),c=e("@ethereumjs/tx"),u=a(e("bignumber.js")),l=a(e("borc")),f=e("eth-eip712-util-browser"),h=e("js-sha3"),d=e("rlp"),p=a(e("secp256k1")),g=e("./constants"),b=e("./util");function m(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function w(e,n,r,i){void 0===i&&(i={});try{var s=new Uint8Array(e),a=0,o=(0,b.fixLen)(n.r,32);n.r=o;var c=(0,b.fixLen)(n.s,32);n.s=c;var u=new Uint8Array(t.concat([o,c])),l=p.default.ecdsaRecover(u,a,s,!1).slice(1);if(y(l)===r.toString("hex"))return n.v=_(a,i),n;if(a=1,y(l=p.default.ecdsaRecover(u,a,s,!1).slice(1))===r.toString("hex"))return n.v=_(a,i),n;throw new Error("Invalid Ethereum signature returned.")}catch(e){throw new Error(e)}}function y(e){return(0,h.keccak256)(e).slice(-40)}function _(e,n){void 0===n&&(n={});var r=n.chainId,i=n.useEIP155,s=n.type;if(1===s||2===s)return(0,b.ensureHexBuffer)(e,!0);if(!1===i||null===r)return t.from(new u.default(e).plus(27).toString(16),"hex");var a=k(r),o=new u.default(a.toString("hex"),16);return(0,b.ensureHexBuffer)("0x".concat(o.times(2).plus(35).plus(e).toString(16)))}var v={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function k(e){var n,r;if((n=!0===E(e)?(0,b.ensureHexBuffer)(e):(0,b.ensureHexBuffer)("0x".concat(new u.default(e).toString(16)))).length>8)throw new Error("ChainID provided is too large.");return n.length<=2||4===n.length||8===n.length?n:(3===n.length?(r=t.alloc(4)).writeUInt32BE(e):n.length<=8&&(r=t.alloc(8),n.copy(r,8-n.length)),r)}function E(e){if("string"!=typeof e)return!1;if("0x"!==e.slice(0,2))return!1;try{return!1===new u.default(e,16).isNaN()}catch(e){return!1}}function x(e,n){var r=n.fwConstants,i=r.ethMaxMsgSz,s=r.extraDataFrameSz,a=r.extraDataMaxFrames,o=i,c=s>0&&a>0,u=[];if(e.length>o){var l=o+a*s;if(!c)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(o));if(c&&e.length>l)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(l));(0,b.splitFrames)(e.slice(o),s).forEach((function(e){var n=t.alloc(4);n.writeUInt32LE(e.length,0),u.push(t.concat([n,e]))}))}return u}function S(e,t,n,r){void 0===r&&(r=!1);try{n[t].forEach((function(t){var i=t.type.indexOf("[")>-1,s=i?t.type.slice(0,t.type.indexOf("[")):t.type,a=Object.keys(n).indexOf(s)>-1;if(a&&Array.isArray(e))for(var o=0;o<e.length;o++)e[o][t.name]=S(e[o][t.name],s,n,r);else if(a)e[t.name]=S(e[t.name],s,n,r);else if(Array.isArray(e))for(o=0;o<e.length;o++)if(i)for(var c=0;c<e[o][t.name].length;c++)e[o][t.name][c]=A(e[o][t.name][c],s,r);else e[o][t.name]=A(e[o][t.name],s,r);else if(i)for(o=0;o<e[t.name].length;o++)e[t.name][o]=A(e[t.name][o],s,r);else e[t.name]=A(e[t.name],s,r)}))}catch(e){throw new Error(e.message)}return e}function A(e,n,r){if(void 0===r&&(r=!1),"bytes"===n)e=(0,b.ensureHexBuffer)(e),r&&(e="0x".concat(e.toString("hex")));else if("bytes"===n.slice(0,5)){var i=parseInt(n.slice(5));if((e=(0,b.ensureHexBuffer)(e)).length!==i)throw new Error("Expected ".concat(n," type, but got ").concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if("address"===n){if(0===(e=(0,b.ensureHexBuffer)(e)).length&&(e=t.alloc(20)),20!==e.length)throw new Error("Address type must be 20 bytes, but got ".concat(e.length," bytes"));r&&(e="0x".concat(e.toString("hex")))}else if(g.ethMsgProtocol.TYPED_DATA.typeCodes[n]&&(n.indexOf("uint")>-1||n.indexOf("int")>-1)){var s=(0,b.ensureHexBuffer)(e);0===s.length&&(s=t.from("00","hex")),e=r?"0x".concat(s.toString("hex")):(new l.default.Encoder).semanticTypes[1][0](s.toString("hex"),16)}else"bool"===n&&(e=!0===e?1:0);return e}function R(e){return t.from("Ethereum Signed Message:\n".concat(e.toString()),"utf-8")}function T(e,n){return n?t.concat([t.from([n]),(0,d.encode)(e)]):(0,d.encode)(e)}n.default={buildEthereumMsgRequest:function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(e.signerPath.length>5||e.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");var n={schema:g.signingSchema.ETH_MSG,payload:null,input:e,msg:null};try{switch(e.protocol){case"signPersonal":return function(e,n){var r=n.fwConstants.ethMaxMsgSz,i=n.fwConstants.varAddrPathSzAllowed,s=24+r+4,a=0;e.payload=t.alloc(s),e.payload.writeUInt8(g.ethMsgProtocol.SIGN_PERSONAL,0),a+=1;var o=(0,b.buildSignerPathBuf)(n.signerPath,i);o.copy(e.payload,a),a+=o.length;var c=n.payload,u=!1;if("string"==typeof n.payload)if("0x"===n.payload.slice(0,2))c=(0,b.ensureHexBuffer)(n.payload),u=!1===g.ASCII_REGEX.test(t.from(n.payload.slice(2),"hex").toString());else{if(!1===(0,b.isAsciiStr)(n.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");c=t.from(n.payload)}else if("boolean"==typeof n.displayHex)u=n.displayHex;else{if(!n.payload.toString)throw new Error("Unsupported input data type");u=!1===g.ASCII_REGEX.test(n.payload.toString())}var l=n.fwConstants,f=r+l.extraDataMaxFrames*l.extraDataFrameSz;l.personalSignHeaderSz&&(f-=l.personalSignHeaderSz);if(l.ethMsgPreHashAllowed&&c.length>f){e.payload.writeUInt8(u,a),a+=1,e.payload.writeUInt16LE(c.length,a),a+=2;var d=t.from((0,h.keccak256)(t.concat([R(c.length),c])),"hex");d.copy(e.payload,a),e.prehash=d}else{var p=x(c,n);e.extraDataPayloads=p,e.msg=c,e.payload.writeUInt8(u,a),a+=1,e.payload.writeUInt16LE(c.length,a),a+=2,c.copy(e.payload,a)}return e}(n,e);case"eip712":if(!e.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(e,n){try{var r=n.fwConstants,i=r.ethMaxMsgSz,s=r.varAddrPathSzAllowed,a=r.eip712MaxTypeParams,o=g.ethMsgProtocol.TYPED_DATA,c=24+i+4,u=0;e.payload=t.alloc(c),e.payload.writeUInt8(o.enumIdx,0),u+=1;var h=(0,b.buildSignerPathBuf)(n.signerPath,s);h.copy(e.payload,u),u+=h.length;var d=JSON.parse(JSON.stringify(n.payload));if(!d.primaryType||!d.types[d.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!d.message||!d.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(d.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");n.payload.message=S(JSON.parse(JSON.stringify(d.message)),JSON.parse(JSON.stringify(d.primaryType)),JSON.parse(JSON.stringify(d.types)),!0),n.payload.domain=S(JSON.parse(JSON.stringify(d.domain)),"EIP712Domain",JSON.parse(JSON.stringify(d.types)),!0),d.domain=S(d.domain,"EIP712Domain",d.types,!1),d.message=S(d.message,d.primaryType,d.types,!1);var p=t.from(l.default.encode(d)),m=n.fwConstants,w=i+m.extraDataMaxFrames*m.extraDataFrameSz,y=p.length>w;if(Object.keys(d.types).forEach((function(e){d.types[e].length>a&&(y=!0)})),m.ethMsgPreHashAllowed&&y){e.payload.writeUInt16LE(p.length,u),u+=2;var _=f.TypedDataUtils.hash(e.input.payload);_.copy(e.payload,u),e.prehash=_}else{var v=x(p,n);e.extraDataPayloads=v,e.payload.writeUInt16LE(p.length,u),u+=2,p.copy(e.payload,u),u+=p.length,e.payload=e.payload.slice(0,u)}return e}catch(e){return{err:"Failed to build EIP712 request: ".concat(e.message)}}}(n,e);default:throw new Error("Unsupported protocol")}}catch(e){return{err:e.toString()}}},validateEthereumMsgResponse:function(e,n){var r=e.signer,i=e.sig,s=n.input,a=n.msg,o=n.prehash,c=void 0===o?null:o;if("signPersonal"===s.protocol)return w(c||t.from((0,h.keccak256)(t.concat([R(a.length),a])),"hex"),i,r,{chainId:1,useEIP155:!1});if("eip712"===s.protocol){var u=f.TypedDataUtils.hash(n.input.payload);return w(c||u,i,r,{useEIP155:!1})}throw new Error("Unsupported protocol")},buildEthereumTxRequest:function(e){try{var n=e.chainId,r=void 0===n?1:n,i=e.signerPath,s=e.eip155,a=void 0===s?null:s,o=e.fwConstants,c=e.type,u=void 0===c?null:c,l=o.contractDeployKey,f=o.extraDataFrameSz,d=o.extraDataMaxFrames,p=o.prehashAllowed,m=f>0&&d>0,w=o.ethMaxDataSz,y=o.varAddrPathSzAllowed;if("number"!=typeof r&&!1===E(r)&&(r=v[r]),!r)throw new Error("Unsupported chain ID or name");if(!i)throw new Error("`signerPath` not provided");if(null===e.to&&!l)throw new Error("Contract deployment not supported. Please update your Lattice firmware.");var _=null===e.to&&l,x=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(2)>-1,S=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(1)>-1,A=x&&(2===u||"eip1559"===u),R=S&&(1===u||"eip2930"===u);if(null!==u&&!A&&!R)throw new Error("Unsupported Ethereum transaction type");var N=function(e){switch(e){case 3:case 4:return!1;default:return!0}}(r);null!==a&&"boolean"==typeof a?N=a:(A||R)&&(N=!1),e.value||(e.value=0);var I=[],O=(0,b.ensureHexBuffer)(r),P=(0,b.ensureHexBuffer)(e.nonce),L=void 0,D=(0,b.ensureHexBuffer)(e.gasLimit),C=void 0,B=void 0;_?(C=t.alloc(0),B=(0,b.ensureHexBuffer)(l)):(C=(0,b.ensureHexBuffer)(e.to),B=(0,b.ensureHexBuffer)(e.to));var M=(0,b.ensureHexBuffer)(e.value),j=(0,b.ensureHexBuffer)(e.data);(A||R)&&I.push(O),I.push(P);var U=void 0,z=void 0;if(A){if(!e.maxPriorityFeePerGas)throw new Error("EIP1559 transactions must include `maxPriorityFeePerGas`");U=(0,b.ensureHexBuffer)(e.maxPriorityFeePerGas),I.push(U),z=(0,b.ensureHexBuffer)(e.maxFeePerGas),I.push(z),L=z}else L=(0,b.ensureHexBuffer)(e.gasPrice),I.push(L);I.push(D),I.push(C),I.push(M),I.push(j);var F=!1;if(A||R){var $=[];Array.isArray(e.accessList)&&e.accessList.forEach((function(e){var t=[];e.storageKeys.forEach((function(e){t.push((0,b.ensureHexBuffer)(e))})),$.push([(0,b.ensureHexBuffer)(e.address),t]),F=!0})),I.push($)}else!0===N&&(I.push(O),I.push((0,b.ensureHexBuffer)(null)),I.push((0,b.ensureHexBuffer)(null)));var H=t.alloc(w+122),q=0;H.writeUInt8(Number(N),q),q++;var W=void 0,G=0;if(!0==(1!==(ne=k(r)).length||255===ne.readUInt8(0))){if((G=(W=k(r)).length)>g.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");H.writeUInt8(g.HANDLE_LARGER_CHAIN_ID,q),q++}else{if(1!==(W=(0,b.ensureHexBuffer)(r)).length)throw new Error("Error parsing chainID");W.copy(H,q),q+=W.length}var V=(0,b.buildSignerPathBuf)(i,y);if(V.copy(H,q),q+=V.length,P.length>4)throw new Error("Nonce too large");if(P.copy(H,q+(4-P.length)),q+=4,L.length>8)throw new Error("Gas price too large");if(L.copy(H,q+(8-L.length)),q+=8,D.length>4)throw new Error("Gas limit too large");if(D.copy(H,q+(4-D.length)),q+=4,20!==B.length)throw new Error("Invalid `to` address");if(B.copy(H,q),q+=20,M.length>32)throw new Error("Value too large");M.copy(H,q+(32-M.length)),q+=32;var K=!1;if(o.allowedEthTxTypes)if(F&&(K=!0),H.writeUInt8(K?1:0,q),q+=1,A){if(H.writeUInt8(2,q),q+=1,U.length>8)throw new Error("maxPriorityFeePerGasBytes too large");U.copy(H,q+(8-U.length)),q+=8}else R?(H.writeUInt8(1,q),q+=1,q+=8):q+=9;var Z=[],Y=null,X=j.length||0,J=G>0?G+1:0,Q=t.alloc(X+J);if(J>0&&(Q.writeUInt8(G,0),W.copy(Q,1)),j.copy(Q,J),X>w){var ee=X+J,te=w+d*f;if(p&&ee>te)Y=t.from((0,h.keccak256)(T(I,u)),"hex");else{if(!m||m&&ee>te)throw new Error("Data field too large (got ".concat(j.length,"; must be <=").concat(te-J," bytes)"));(0,b.splitFrames)(Q.slice(w),f).forEach((function(e){var n=t.alloc(4);n.writeUInt32LE(e.length,0),Z.push(t.concat([n,e]))}))}}else K&&(Y=t.from((0,h.keccak256)(T(I,u)),"hex"));return H.writeUInt16BE(j.length,q),q+=2,G>0&&(H.writeUInt8(G,q),q++,W.copy(H,q),q+=G),Y?(Y.copy(H,q),q+=w):(j.slice(0,w).copy(H,q),q+=w),{rawTx:I,type:u,payload:H.slice(0,q),extraDataPayloads:Z,schema:g.signingSchema.ETH_TRANSFER,chainId:r,useEIP155:N,signerPath:i}}catch(e){return{err:e.message}}var ne},buildEthRawTx:function(e,n,r){var i=w(t.from((0,h.keccak256)(T(e.rawTx,e.type)),"hex"),n,r,e),s=e.useEIP155?e.rawTx.slice(0,-3):e.rawTx;s.push(i.v),s.push(m(i.r)),s.push(m(i.s));var a=(0,d.encode)(s);return e.type&&(a=t.concat([t.from([e.type]),a])),{rawTx:t.from(a).toString("hex"),sigWithV:i}},hashTransaction:function(e){return(0,h.keccak256)(t.from(e,"hex"))},chainIds:v,ensureHexBuffer:b.ensureHexBuffer,ethConvertLegacyToGenericReq:function(e){var n;n=e.chainId&&"01"!==(0,b.ensureHexBuffer)(e.chainId).toString("hex")?o.default.custom({chainId:e.chainId},{hardfork:o.Hardfork.London,eips:[1559,2930]}):new o.default({chain:o.Chain.Mainnet,hardfork:o.Hardfork.London});var r=c.TransactionFactory.fromTxData(e,{common:n});return e.type?r.getMessageToSign(!1):t.from((0,d.encode)(r.getMessageToSign(!1)))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4178,{"./constants":4176,"./index":4179,"./util":4180,buffer:1936,"hash.js/lib/hash/sha":4236,"js-sha3":4590},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.getEncodedPayload=n.parseGenericSigningResponse=n.buildGenericSigningMsgRequest=void 0;var r=e("hash.js/lib/hash/sha"),i=e("js-sha3"),s=e("./constants"),a=e("./index"),o=e("./util");n.buildGenericSigningMsgRequest=function(e){var a=e.signerPath,c=e.curveType,u=e.hashType,l=e.encodingType,f=void 0===l?null:l,h=e.decoder,d=void 0===h?null:h,p=e.omitPubkey,g=void 0!==p&&p,b=e.fwConstants,m=b.extraDataFrameSz,w=b.extraDataMaxFrames,y=b.prehashAllowed,_=b.genericSigning,v=b.varAddrPathSzAllowed,k=_.curveTypes,E=_.encodingTypes,x=_.hashTypes,S=_.baseDataSz,A=_.baseReqSz,R=_.calldataDecoding,T=(0,n.getEncodedPayload)(e.payload,f,E),N=T.encoding,I=T.payloadBuf,O=I.length,P=S+w*m;if(!O)throw new Error("Payload could not be handled.");if(!(_&&m&&w&&y))throw new Error("Unsupported. Please update your Lattice firmware.");if(!(0,o.existsIn)(c,k))throw new Error("Unsupported curve type.");if(!(0,o.existsIn)(u,x))throw new Error("Unsupported hash type.");var L=d&&R&&d.length<=R.maxSz,D=L&&I.length+d.length<=P;if(L&&D){var C=t.alloc(8+d.length);C.writeUInt32LE(R.reserved,0),C.writeUInt32LE(d.length,4),t.from(d).copy(C,8),I=t.concat([I,C])}if(c===k.ED25519){if(u!==x.NONE)throw new Error("Signing on ed25519 requires unhashed message");a.forEach((function(e){if(e<s.HARDENED_OFFSET)throw new Error("Signing on ed25519 requires all signer path indices be hardened.")}))}var B=t.alloc(A),M=0;B.writeUInt32LE(N,M),M+=4,B.writeUInt8(u,M),M+=1,B.writeUInt8(c,M),M+=1;var j=(0,o.buildSignerPathBuf)(a,v);j.copy(B,M),M+=j.length,B.writeUInt8(g?1:0,M),M+=1;var U=[],z=null,F=!1;if(I.length>S)if(y&&I.length>P){B.writeUInt16LE(I.length,M),M+=2,F=!0;var $=I.slice(0,O);if(u===x.NONE)throw new Error("Message too large to send and could not be prehashed (hashType=NONE).");if(u===x.KECCAK256)z=t.from((0,i.keccak256)($),"hex");else{if(u!==x.SHA256)throw new Error("Unsupported hash type.");z=t.from((0,r.sha256)().update($).digest("hex"),"hex")}}else{(0,o.splitFrames)(I.slice(S),m).forEach((function(e){var n=t.alloc(4);n.writeUInt32LE(e.length,0),U.push(t.concat([n,e]))}))}return F||(B.writeUInt16LE(O,M),M+=2),(z||I).copy(B,M),{payload:B,extraDataPayloads:U,schema:s.signingSchema.GENERAL_SIGNING,curveType:c,omitPubkey:g}};n.parseGenericSigningResponse=function(e,n,r,i){var s={pubkey:null,sig:null};if(r===a.Constants.SIGNING.CURVES.SECP256K1){if(i)n+=65;else{var c=e.readUInt8(n);if(n+=1,2===c||3===c)s.pubkey=t.alloc(33),s.pubkey.writeUInt8(c,0),e.slice(n,n+32).copy(s.pubkey,1);else{if(4!==c)throw new Error("Bad compression byte in signing response.");s.pubkey=t.alloc(65),s.pubkey.writeUInt8(c,0),e.slice(n).copy(s.pubkey,1)}n+=64}s.sig=(0,o.parseDER)(e.slice(n,n+2+e[n+1])),s.sig.r=(0,o.fixLen)(s.sig.r,32),s.sig.s=(0,o.fixLen)(s.sig.s,32)}else{if(r!==a.Constants.SIGNING.CURVES.ED25519)throw new Error("Unsupported curve.");i||(s.pubkey=t.alloc(32),e.slice(n,n+32).copy(s.pubkey)),n+=32,s.sig={r:e.slice(n,n+32),s:e.slice(n+32,n+64)}}return s};n.getEncodedPayload=function(e,n,r){if(n||(n=a.Constants.SIGNING.ENCODINGS.NONE),!(0,o.existsIn)(n,r))throw new Error("Encoding not supported by Lattice firmware. You may want to update.");return{payloadBuf:"string"==typeof e&&"0x"===e.slice(0,2)?t.from(e.slice(2),"hex"):t.from(e),encoding:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4179,{"./calldata/index":4174,"./client":4175,"./constants":4176,"./util":4180},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Utils=n.Constants=n.Client=n.Calldata=void 0;var r=e("./calldata/index");Object.defineProperty(n,"Calldata",{enumerable:!0,get:function(){return r.CALLDATA}});var i=e("./client");Object.defineProperty(n,"Client",{enumerable:!0,get:function(){return i.Client}});var s=e("./constants");Object.defineProperty(n,"Constants",{enumerable:!0,get:function(){return s.EXTERNAL}});var a=e("./util");Object.defineProperty(n,"Utils",{enumerable:!0,get:function(){return a.EXTERNAL}})}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4180,{"./constants":4176,"@ethereumjs/tx":410,"aes-js":1539,"bignumber.js":4182,"bn.js":1892,buffer:1936,"crc-32":2010,elliptic:2170,"hash.js/lib/hash/sha":4236,"lodash/inRange":4996,"lodash/isInteger":5005,secp256k1:4184},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.EXTERNAL=n.getV=n.generateAppSecret=n.isUInt4=n.randomBytes=n.promisifyCb=n.existsIn=n.isAsciiStr=n.buildSignerPathBuf=n.getP256KeyPairFromPub=n.getP256KeyPair=n.parseDER=n.aes256_decrypt=n.aes256_encrypt=n.fixLen=n.ensureHexBuffer=n.splitFrames=n.isValidAssetPath=n.toPaddedDER=n.checksum=n.parseLattice1Response=void 0;var s,a=e("@ethereumjs/tx"),o=i(e("aes-js")),c=e("bn.js"),u=i(e("bignumber.js")),l=i(e("crc-32")),f=i(e("elliptic")),h=e("hash.js/lib/hash/sha"),d=e("secp256k1"),p=e("./constants"),g=p.BIP_CONSTANTS.COINS,b=p.BIP_CONSTANTS.PURPOSES,m=f.default.ec,w=i(e("lodash/isInteger")),y=i(e("lodash/inRange"));n.parseLattice1Response=function(e){var r={err:null,data:null},i=t.from(e,"hex"),s=0,a=i.readUInt8(s);if(s++,a!==p.VERSION_BYTE)return r.err="Incorrect protocol version. Please update your SDK",r;var o=i.readUInt8(s);if(s++,0!==o)return r.err="Incorrect response from Lattice1",r;i.readUInt32BE(s),s+=4;var c=i.readUInt16BE(s);s+=2;var u=i.slice(s,s+c);s+=c;var l=u.readUInt8(0);return l!==p.responseCodes.RESP_SUCCESS?(r.err="".concat(p.responseMsgs[l]?p.responseMsgs[l]:"Unknown Error"," (Lattice)"),r.responseCode=l,r):(r.data=u.slice(1,u.length),i.readUInt32BE(s)!==(0,n.checksum)(i.slice(0,i.length-4))?(r.err="Invalid checksum from device response",r.data=null,r):r)};n.checksum=function(e){return l.default.buf(e)>>>0};n.toPaddedDER=function(e){var n=t.alloc(74);return t.from(e.toDER()).copy(n),n};n.isValidAssetPath=function(e,t){var n=[b.ETH,b.BTC_LEGACY,b.BTC_WRAPPED_SEGWIT,b.BTC_SEGWIT],r=[g.ETH,g.BTC,g.BTC_TESTNET];return!((e[1]===g.BTC||e[1]===g.BTC_TESTNET)&&e[0]!==b.BTC_WRAPPED_SEGWIT&&!t.allowBtcLegacyAndSegwitAddrs)&&(n.indexOf(e[0])>=0&&(r.indexOf(e[1])>=0||[60,61,966,700,9006,9e3,1007,553,178,137,37310,108,40,889,1987,820,6060,1620,1313114,76,246529,246785,1001,227,916,464,2221,344,73799,246].indexOf(e[1]-p.HARDENED_OFFSET)>0))};n.splitFrames=function(e,t){for(var n=[],r=Math.ceil(e.length/t),i=0,s=0;s<r;s++)n.push(e.slice(i,i+t)),i+=t;return n};n.ensureHexBuffer=function(e,n){void 0===n&&(n=!0);try{if(null===e||0===e&&!0===n)return t.alloc(0);var r="number"==typeof e||function(e){var t=new u.default(e).toString().split(".").join(""),n=new String(e);return t.slice(0,8)===n.slice(0,8)}(e);return(e=r?"".concat(new u.default(e).toString(16)):"string"==typeof e&&"0x"===e.slice(0,2)?e.slice(2):e.toString("hex")).length%2>0&&(e="0".concat(e)),"00"!==e||r?t.from(e,"hex"):t.alloc(0)}catch(t){throw new Error("Cannot convert ".concat(e.toString()," to hex buffer (").concat(t.toString(),")"))}};n.fixLen=function(e,n){var r=t.alloc(n);return e.length<n?(e.copy(r,n-e.length),r):e.slice(-n)};n.aes256_encrypt=function(e,n){var r=t.from(p.AES_IV),i=new o.default.ModeOfOperation.cbc(n,r),s=e.length%16==0?e:o.default.padding.pkcs7.pad(e);return t.from(i.encrypt(s))};n.aes256_decrypt=function(e,n){var r=t.from(p.AES_IV),i=new o.default.ModeOfOperation.cbc(n,r);return t.from(i.decrypt(e))};n.parseDER=function(e){if(48!==e[0]||2!==e[2])return null;var t=3,n={r:null,s:null},r=e[t];if(t++,n.r=e.slice(t,t+r),2!==e[t+=r])return null;var i=e[++t];return t++,n.s=e.slice(t,t+i),n};n.getP256KeyPair=function(e){return s===undefined&&(s=new m("p256")),s.keyFromPrivate(e,"hex")};n.getP256KeyPairFromPub=function(e){return s===undefined&&(s=new m("p256")),s.keyFromPublic(e,"hex")};n.buildSignerPathBuf=function(e,n){var r=t.alloc(24),i=0;if(n&&e.length>5)throw new Error("Signer path must be <=5 indices.");if(!n&&5!==e.length)throw new Error("Your Lattice firmware only supports 5-index derivation paths. Please upgrade.");r.writeUInt32LE(e.length,i),i+=4;for(var s=0;s<5;s++)s<e.length?r.writeUInt32LE(e[s],i):r.writeUInt32LE(0,i),i+=4;return r};n.isAsciiStr=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)return!1;for(var n=t?[32,10]:[],r=0;r<e.length;r++){var i=e.charCodeAt(r);if(n.indexOf(i)<0&&(i<32||i>127))return!1}return!0};n.existsIn=function(e,t){return Object.keys(t).some((function(n){return t[n]===e}))};n.promisifyCb=function(e,t,n){return function(i){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return n&&"function"==typeof n?n.apply(void 0,r([i],s,!1)):i&&"string"==typeof i?t(i):e.apply(void 0,s)}};n.randomBytes=function(e){for(var n=t.alloc(e),r=0;r<e;r++)n[r]=Math.round(255*Math.random());return n};n.isUInt4=function(e){return(0,w.default)(e)&&(0,y.default)(0,16)};n.generateAppSecret=function(e,n,r){var i=t.concat([e,n,r]);return t.from((0,h.sha256)().update(i).digest("hex"),"hex")};n.getV=function(e,n){var r,i=e.getMessageToSign(!0),s=new Uint8Array(t.concat([n.sig.r,n.sig.s])),o=new Uint8Array(n.pubkey),u=(0,d.ecdsaRecover)(s,0,i,!1),l=(0,d.ecdsaRecover)(s,1,i,!1),f=t.from(o).toString("hex"),h=t.from(u).toString("hex"),p=t.from(l).toString("hex");if(f===h)r=0;else{if(f!==p)return null;r=1}if(e._type)return new c.BN(r);var g=null;return e.common&&"function"==typeof e.common.chainIdBN?g=e.common.chainIdBN():e.chainId&&(g=new c.BN(e.chainId)),g&&e.supports(a.Capability.EIP155ReplayProtection)?g.muln(2).addn(35).addn(r):new c.BN(r).addn(27)},n.EXTERNAL={getV:n.getV,generateAppSecret:n.generateAppSecret}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4181,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.bech32m=n.bech32=void 0;const r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={};for(let e=0;e<r.length;e++){const t=r.charAt(e);i[t]=e}function s(e){const t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function a(e){let t=1;for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=s(t)^r>>5}t=s(t);for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);t=s(t)^31&r}return t}function o(e,t,n,r){let i=0,s=0;const a=(1<<n)-1,o=[];for(let r=0;r<e.length;++r)for(i=i<<t|e[r],s+=t;s>=n;)s-=n,o.push(i>>s&a);if(r)s>0&&o.push(i<<n-s&a);else{if(s>=t)return"Excess padding";if(i<<n-s&a)return"Non-zero padding"}return o}function c(e){return o(e,8,5,!0)}function u(e){const t=o(e,5,8,!1);if(Array.isArray(t))return t}function l(e){const t=o(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function f(e){let t;function n(e,n){if(n=n||90,e.length<8)return e+" too short";if(e.length>n)return"Exceeds length limit";const r=e.toLowerCase(),o=e.toUpperCase();if(e!==r&&e!==o)return"Mixed-case string "+e;const c=(e=r).lastIndexOf("1");if(-1===c)return"No separator character for "+e;if(0===c)return"Missing prefix for "+e;const u=e.slice(0,c),l=e.slice(c+1);if(l.length<6)return"Data too short";let f=a(u);if("string"==typeof f)return f;const h=[];for(let e=0;e<l.length;++e){const t=l.charAt(e),n=i[t];if(n===undefined)return"Unknown character "+t;f=s(f)^n,e+6>=l.length||h.push(n)}return f!==t?"Invalid checksum for "+e:{prefix:u,words:h}}return t="bech32"===e?1:734539939,{decodeUnsafe:function(e,t){const r=n(e,t);if("object"==typeof r)return r},decode:function(e,t){const r=n(e,t);if("object"==typeof r)return r;throw new Error(r)},encode:function(e,n,i){if(i=i||90,e.length+7+n.length>i)throw new TypeError("Exceeds length limit");let o=a(e=e.toLowerCase());if("string"==typeof o)throw new Error(o);let c=e+"1";for(let e=0;e<n.length;++e){const t=n[e];if(t>>5!=0)throw new Error("Non 5-bit word");o=s(o)^t,c+=r.charAt(t)}for(let e=0;e<6;++e)o=s(o);o^=t;for(let e=0;e<6;++e){c+=r.charAt(o>>5*(5-e)&31)}return c},toWords:c,fromWordsUnsafe:u,fromWords:l}}n.bech32=f("bech32"),n.bech32m=f("bech32m")}}},{package:"eth-lattice-keyring>gridplus-sdk>bech32"}],[4182,{},function(){with(this)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=u-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function b(e,t){var n,r,i=e.c,s=t.c,a=e.s,o=t.s,c=e.e,u=t.e;if(!a||!o)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-o:a;if(a!=o)return a;if(n=a<0,r=c==u,!i||!s)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(o=(c=i.length)<(u=s.length)?c:u,a=0;a<o;a++)if(i[a]!=s[a])return i[a]>s[a]^n?1:-1;return c==u?0:c>u^n?1:-1}function m(e,t,n,r){if(e<t||e>n||e!==s(e))throw Error(a+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function w(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function _(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,v,k,E,x,S,A,R,T,N,I=H.prototype={constructor:H,toString:null,valueOf:null},O=new H(1),P=20,L=4,D=-7,C=21,B=-1e7,M=1e7,j=!1,U=1,z=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},$="0123456789abcdefghijklmnopqrstuvwxyz";function H(e,t){var n,i,a,c,f,h,d,p,g=this;if(!(g instanceof H))return new H(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>M?g.c=g.e=null:e.e<B?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,f=e;f>=10;f/=10,c++);return void(c>M?g.c=g.e=null:(g.e=c,g.c=[e]))}p=String(e)}else{if(!r.test(p=String(e)))return k(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(c<0&&(c=f),c+=+p.slice(f+1),p=p.substring(0,f)):c<0&&(c=p.length)}else{if(m(t,2,$.length,"Base"),10==t)return V(g=new H(e),P+g.e+1,L);if(p=String(e),h="number"==typeof e){if(0*e!=0)return k(g,p,h,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,H.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=$.slice(0,t),c=f=0,d=p.length;f<d;f++)if(n.indexOf(i=p.charAt(f))<0){if("."==i){if(f>c){c=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,c=0;continue}return k(g,String(e),h,t)}h=!1,(c=(p=v(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&H.DEBUG&&d>15&&(e>l||e!==s(e)))throw Error(o+g.s*e);if((c=c-f-1)>M)g.c=g.e=null;else if(c<B)g.c=[g.e=0];else{if(g.e=c,g.c=[],f=(c+1)%u,c<0&&(f+=u),f<d){for(f&&g.c.push(+p.slice(0,f)),d-=u;f<d;)g.c.push(+p.slice(f,f+=u));f=u-(p=p.slice(f)).length}else f-=d;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function q(e,t,n,r){var i,s,a,o,c;if(null==n?n=L:m(n,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)c=g(e.c),c=1==r||2==r&&(a<=D||a>=C)?y(c,a):_(c,a,"0");else if(s=(e=V(new H(e),t,n)).e,o=(c=g(e.c)).length,1==r||2==r&&(t<=s||s<=D)){for(;o<t;c+="0",o++);c=y(c,s)}else if(t-=a,c=_(c,s,"0"),s+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-o)>0)for(s+1==o&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function W(e,t){for(var n,r=1,i=new H(e[0]);r<e.length;r++){if(!(n=new H(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function G(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*u-1)>M?e.c=e.e=null:n<B?e.c=[e.e=0]:(e.e=n,e.c=t),e}function V(e,t,n,r){var a,o,l,h,d,p,g,b=e.c,m=f;if(b){e:{for(a=1,h=b[0];h>=10;h/=10,a++);if((o=t-a)<0)o+=u,l=t,g=(d=b[p=0])/m[a-l-1]%10|0;else if((p=i((o+1)/u))>=b.length){if(!r)break e;for(;b.length<=p;b.push(0));d=g=0,a=1,l=(o%=u)-u+1}else{for(d=h=b[p],a=1;h>=10;h/=10,a++);g=(l=(o%=u)-u+a)<0?0:d/m[a-l-1]%10|0}if(r=r||t<0||null!=b[p+1]||(l<0?d:d%m[a-l-1]),r=n<4?(g||r)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||r||6==n&&(o>0?l>0?d/m[a-l]:0:b[p-1])%10&1||n==(e.s<0?8:7)),t<1||!b[0])return b.length=0,r?(t-=e.e+1,b[0]=m[(u-t%u)%u],e.e=-t||0):b[0]=e.e=0,e;if(0==o?(b.length=p,h=1,p--):(b.length=p+1,h=m[u-o],b[p]=l>0?s(d/m[a-l]%m[l])*h:0),r)for(;;){if(0==p){for(o=1,l=b[0];l>=10;l/=10,o++);for(l=b[0]+=h,h=1;l>=10;l/=10,h++);o!=h&&(e.e++,b[0]==c&&(b[0]=1));break}if(b[p]+=h,b[p]!=c)break;b[p--]=0,h=1}for(o=b.length;0===b[--o];b.pop());}e.e>M?e.c=e.e=null:e.e<B&&(e.c=[e.e=0])}return e}function K(e){var t,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=D||n>=C?y(t,n):_(t,n,"0"),e.s<0?"-"+t:t)}return H.clone=e,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(n=e[t],0,d,t),P=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(n=e[t],0,8,t),L=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(m(n[0],-d,0,t),m(n[1],0,d,t),D=n[0],C=n[1]):(m(n,-d,d,t),D=-(C=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)m(n[0],-d,-1,t),m(n[1],1,d,t),B=n[0],M=n[1];else{if(m(n,-d,d,t),!n)throw Error(a+t+" cannot be zero: "+n);B=-(M=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(a+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!n,Error(a+"crypto unavailable");j=n}else j=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(n=e[t],0,9,t),U=n),e.hasOwnProperty(t="POW_PRECISION")&&(m(n=e[t],0,d,t),z=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(a+t+" not an object: "+n);F=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(a+t+" invalid: "+n);$=n}}return{DECIMAL_PLACES:P,ROUNDING_MODE:L,EXPONENTIAL_AT:[D,C],RANGE:[B,M],CRYPTO:j,MODULO_MODE:U,POW_PRECISION:z,FORMAT:F,ALPHABET:$}},H.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!H.DEBUG)return!0;var t,n,r=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&i>=-d&&i<=d&&i===s(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=c||n!==s(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===o||1===o||-1===o))return!0;throw Error(a+"Invalid BigNumber: "+e)},H.maximum=H.max=function(){return W(arguments,I.lt)},H.minimum=H.min=function(){return W(arguments,I.gt)},H.random=(E=9007199254740992,x=Math.random()*E&2097151?function(){return s(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,o,c,l=0,h=[],p=new H(O);if(null==e?e=P:m(e,0,d),o=i(e/u),j)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));l<o;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[l]=n[0],t[l+1]=n[1]):(h.push(c%1e14),l+=2);l=o/2}else{if(!crypto.randomBytes)throw j=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(o*=7);l<o;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(h.push(c%1e14),l+=7);l=o/7}if(!j)for(;l<o;)(c=x())<9e15&&(h[l++]=c%1e14);for(o=h[--l],e%=u,o&&e&&(c=f[u-e],h[l]=s(o/c)*c);0===h[l];h.pop(),l--);if(l<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=u);for(l=1,c=h[0];c>=10;c/=10,l++);l<u&&(r-=u-l)}return p.e=r,p.c=h,p}),H.sum=function(){for(var e=1,t=arguments,n=new H(t[0]);e<t.length;)n=n.plus(t[e++]);return n},v=function(){var e="0123456789";function t(e,t,n,r){for(var i,s,a=[0],o=0,c=e.length;o<c;){for(s=a.length;s--;a[s]*=t);for(a[0]+=r.indexOf(e.charAt(o++)),i=0;i<a.length;i++)a[i]>n-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/n|0,a[i]%=n)}return a.reverse()}return function(r,i,s,a,o){var c,u,l,f,h,d,p,b,m=r.indexOf("."),w=P,y=L;for(m>=0&&(f=z,z=0,r=r.replace(".",""),d=(b=new H(i)).pow(r.length-m),z=f,b.c=t(_(g(d.c),d.e,"0"),10,s,e),b.e=b.c.length),l=f=(p=t(r,i,s,o?(c=$,e):(c=e,$))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(m<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=n(d,b,w,y,s)).c,h=d.r,l=d.e),m=p[u=l+w+1],f=s/2,h=h||u<0||null!=p[u+1],h=y<4?(null!=m||h)&&(0==y||y==(d.s<0?3:2)):m>f||m==f&&(4==y||h||6==y&&1&p[u-1]||y==(d.s<0?8:7)),u<1||!p[0])r=h?_(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,h)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(m=0,r="";m<=f;r+=c.charAt(p[m++]));r=_(r,l,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,s,a,o=0,c=e.length,u=t%h,l=t/h|0;for(e=e.slice();c--;)o=((i=u*(s=e[c]%h)+(r=l*s+(a=e[c]/h|0)*u)%h*h+o)/n|0)+(r/h|0)+l*a,e[c]=i%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,a,o,l){var f,h,d,g,b,m,w,y,_,v,k,E,x,S,A,R,T,N=r.s==i.s?1:-1,I=r.c,O=i.c;if(!(I&&I[0]&&O&&O[0]))return new H(r.s&&i.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*N:N/0:NaN);for(_=(y=new H(N)).c=[],N=a+(h=r.e-i.e)+1,l||(l=c,h=p(r.e/u)-p(i.e/u),N=N/u|0),d=0;O[d]==(I[d]||0);d++);if(O[d]>(I[d]||0)&&h--,N<0)_.push(1),g=!0;else{for(S=I.length,R=O.length,d=0,N+=2,(b=s(l/(O[0]+1)))>1&&(O=e(O,b,l),I=e(I,b,l),R=O.length,S=I.length),x=R,k=(v=I.slice(0,R)).length;k<R;v[k++]=0);T=O.slice(),T=[0].concat(T),A=O[0],O[1]>=l/2&&A++;do{if(b=0,(f=t(O,v,R,k))<0){if(E=v[0],R!=k&&(E=E*l+(v[1]||0)),(b=s(E/A))>1)for(b>=l&&(b=l-1),w=(m=e(O,b,l)).length,k=v.length;1==t(m,v,w,k);)b--,n(m,R<w?T:O,w,l),w=m.length,f=1;else 0==b&&(f=b=1),w=(m=O.slice()).length;if(w<k&&(m=[0].concat(m)),n(v,m,k,l),k=v.length,-1==f)for(;t(O,v,R,k)<1;)b++,n(v,R<k?T:O,k,l),k=v.length}else 0===f&&(b++,v=[0]);_[d++]=b,v[0]?v[k++]=I[x]||0:(v=[I[x]],k=1)}while((x++<S||null!=v[0])&&N--);g=null!=v[0],_[0]||_.splice(0,1)}if(l==c){for(d=1,N=_[0];N>=10;N/=10,d++);V(y,a+(y.e=d+h*u-1)+1,o,g)}else y.e=h,y.r=+g;return y}}(),S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,R=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,k=function(e,t,n,r){var i,s=n?t:t.replace(N,"");if(T.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(S,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(A,"$1").replace(R,"0.$1")),t!=s))return new H(s,i);if(H.DEBUG)throw Error(a+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},I.absoluteValue=I.abs=function(){var e=new H(this);return e.s<0&&(e.s=1),e},I.comparedTo=function(e,t){return b(this,new H(e,t))},I.decimalPlaces=I.dp=function(e,t){var n,r,i,s=this;if(null!=e)return m(e,0,d),null==t?t=L:m(t,0,8),V(new H(s),e+s.e+1,t);if(!(n=s.c))return null;if(r=((i=n.length-1)-p(this.e/u))*u,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},I.dividedBy=I.div=function(e,t){return n(this,new H(e,t),P,L)},I.dividedToIntegerBy=I.idiv=function(e,t){return n(this,new H(e,t),0,1)},I.exponentiatedBy=I.pow=function(e,t){var n,r,o,c,l,f,h,d,p=this;if((e=new H(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+K(e));if(null!=t&&(t=new H(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new H(Math.pow(+K(p),l?2-w(e):+K(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new H(NaN);(r=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&w(e)?-0:0,p.e>-1&&(c=1/c),new H(f?1/c:c);z&&(c=i(z/u+2))}for(l?(n=new H(.5),f&&(e.s=1),h=w(e)):h=(o=Math.abs(+K(e)))%2,d=new H(O);;){if(h){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):r&&(d=d.mod(t))}if(o){if(0===(o=s(o/2)))break;h=o%2}else if(V(e=e.times(n),e.e+1,1),e.e>14)h=w(e);else{if(0===(o=+K(e)))break;h=o%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):r&&(p=p.mod(t))}return r?d:(f&&(d=O.div(d)),t?d.mod(t):c?V(d,z,L,undefined):d)},I.integerValue=function(e){var t=new H(this);return null==e?e=L:m(e,0,8),V(t,t.e+1,e)},I.isEqualTo=I.eq=function(e,t){return 0===b(this,new H(e,t))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(e,t){return b(this,new H(e,t))>0},I.isGreaterThanOrEqualTo=I.gte=function(e,t){return 1===(t=b(this,new H(e,t)))||0===t},I.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},I.isLessThan=I.lt=function(e,t){return b(this,new H(e,t))<0},I.isLessThanOrEqualTo=I.lte=function(e,t){return-1===(t=b(this,new H(e,t)))||0===t},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(e,t){var n,r,i,s,a=this,o=a.s;if(t=(e=new H(e,t)).s,!o||!t)return new H(NaN);if(o!=t)return e.s=-t,a.plus(e);var l=a.e/u,f=e.e/u,h=a.c,d=e.c;if(!l||!f){if(!h||!d)return h?(e.s=-t,e):new H(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new H(h[0]?a:3==L?-0:0)}if(l=p(l),f=p(f),h=h.slice(),o=l-f){for((s=o<0)?(o=-o,i=h):(f=l,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(r=(s=(o=h.length)<(t=d.length))?o:t,o=t=0;t<r;t++)if(h[t]!=d[t]){s=h[t]<d[t];break}if(s&&(i=h,h=d,d=i,e.s=-e.s),(t=(r=d.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=c-1;r>o;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=c}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?G(e,h,f):(e.s=3==L?-1:1,e.c=[e.e=0],e)},I.modulo=I.mod=function(e,t){var r,i,s=this;return e=new H(e,t),!s.c||!e.s||e.c&&!e.c[0]?new H(NaN):!e.c||s.c&&!s.c[0]?new H(s):(9==U?(i=e.s,e.s=1,r=n(s,e,0,3),e.s=i,r.s*=i):r=n(s,e,0,U),(e=s.minus(r.times(e))).c[0]||1!=U||(e.s=s.s),e)},I.multipliedBy=I.times=function(e,t){var n,r,i,s,a,o,l,f,d,g,b,m,w,y,_,v=this,k=v.c,E=(e=new H(e,t)).c;if(!(k&&E&&k[0]&&E[0]))return!v.s||!e.s||k&&!k[0]&&!E||E&&!E[0]&&!k?e.c=e.e=e.s=null:(e.s*=v.s,k&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(v.e/u)+p(e.e/u),e.s*=v.s,(l=k.length)<(g=E.length)&&(w=k,k=E,E=w,i=l,l=g,g=i),i=l+g,w=[];i--;w.push(0));for(y=c,_=h,i=g;--i>=0;){for(n=0,b=E[i]%_,m=E[i]/_|0,s=i+(a=l);s>i;)n=((f=b*(f=k[--a]%_)+(o=m*f+(d=k[a]/_|0)*b)%_*_+w[s]+n)/y|0)+(o/_|0)+m*d,w[s--]=f%y;w[s]=n}return n?++r:w.splice(0,1),G(e,w,r)},I.negated=function(){var e=new H(this);return e.s=-e.s||null,e},I.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new H(e,t)).s,!i||!t)return new H(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/u,a=e.e/u,o=r.c,l=e.c;if(!s||!a){if(!o||!l)return new H(i/0);if(!o[0]||!l[0])return l[0]?e:new H(o[0]?r:0*i)}if(s=p(s),a=p(a),o=o.slice(),i=s-a){for(i>0?(a=s,n=l):(i=-i,n=o),n.reverse();i--;n.push(0));n.reverse()}for((i=o.length)-(t=l.length)<0&&(n=l,l=o,o=n,t=i),i=0;t;)i=(o[--t]=o[t]+l[t]+i)/c|0,o[t]=c===o[t]?0:o[t]%c;return i&&(o=[i].concat(o),++a),G(e,o,a)},I.precision=I.sd=function(e,t){var n,r,i,s=this;if(null!=e&&e!==!!e)return m(e,1,d),null==t?t=L:m(t,0,8),V(new H(s),e,t);if(!(n=s.c))return null;if(r=(i=n.length-1)*u+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},I.shiftedBy=function(e){return m(e,-9007199254740991,l),this.times("1e"+e)},I.squareRoot=I.sqrt=function(){var e,t,r,i,s,a=this,o=a.c,c=a.s,u=a.e,l=P+4,f=new H("0.5");if(1!==c||!o||!o[0])return new H(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+K(a)))||c==1/0?(((t=g(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),r=new H(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new H(c+""),r.c[0])for((c=(u=r.e)+l)<3&&(c=0);;)if(s=r,r=f.times(s.plus(n(a,s,l,1))),g(s.c).slice(0,c)===(t=g(r.c)).slice(0,c)){if(r.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(V(r,r.e+P+2,1),e=!r.times(r).eq(a));break}if(!i&&(V(s,s.e+P+2,0),s.times(s).eq(a))){r=s;break}l+=4,c+=4,i=1}return V(r,r.e+P+1,L,e)},I.toExponential=function(e,t){return null!=e&&(m(e,0,d),e++),q(this,e,t,1)},I.toFixed=function(e,t){return null!=e&&(m(e,0,d),e=e+this.e+1),q(this,e,t)},I.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=F;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,o=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",f=o[0],h=o[1],d=i.s<0,p=d?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),d&&(f="-"+f)}r=h?f+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):f}return(n.prefix||"")+r+(n.suffix||"")},I.toFraction=function(e){var t,r,i,s,o,c,l,h,d,p,b,m,w=this,y=w.c;if(null!=e&&(!(l=new H(e)).isInteger()&&(l.c||1!==l.s)||l.lt(O)))throw Error(a+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+K(l));if(!y)return new H(w);for(t=new H(O),d=r=new H(O),i=h=new H(O),m=g(y),o=t.e=m.length-w.e-1,t.c[0]=f[(c=o%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?o>0?t:d:l,c=M,M=1/0,l=new H(m),h.c[0]=0;p=n(l,t,0,1),1!=(s=r.plus(p.times(i))).comparedTo(e);)r=i,i=s,d=h.plus(p.times(s=d)),h=s,t=l.minus(p.times(s=t)),l=s;return s=n(e.minus(r),i,0,1),h=h.plus(s.times(d)),r=r.plus(s.times(i)),h.s=d.s=w.s,b=n(d,i,o*=2,L).minus(w).abs().comparedTo(n(h,r,o,L).minus(w).abs())<1?[d,i]:[h,r],M=c,b},I.toNumber=function(){return+K(this)},I.toPrecision=function(e,t){return null!=e&&m(e,1,d),q(this,e,t,2)},I.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=D||i>=C?y(g(n.c),i):_(g(n.c),i,"0"):10===e?t=_(g((n=V(new H(n),P+i+1,L)).c),n.e,"0"):(m(e,2,$.length,"Base"),t=v(_(g(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},I.valueOf=I.toJSON=function(){return K(this)},I._isBigNumber=!0,null!=t&&H.set(t),H}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"eth-lattice-keyring>gridplus-sdk>bignumber.js"}],[4183,{},function(){with(this)return function(){"use strict";return function(e,t,n){function r(e){if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t.push(r(e[n]));const n=d(...t);return d(a(n.length,192),n)}const t=m(e);return 1===t.length&&t[0]<128?t:d(a(t.length,128),t)}function i(e,t,n){if(n>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,n)}function s(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return f(l(e))}function a(e,t){if(e<56)return Uint8Array.from([e+t]);const n=g(e),r=g(t+55+n.length/2);return Uint8Array.from(h(r+n))}function o(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const n=c(m(e));if(t)return n;if(0!==n.remainder.length)throw new Error("invalid RLP: remainder must be zero");return n.data}function c(e){let t,n,r,a,o;const u=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,r=128===l?Uint8Array.from([]):i(e,1,t),2===t&&r[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:r,remainder:e.slice(t)}}if(l<=191){if(n=l-182,e.length-1<n)throw new Error("invalid RLP: not enough bytes for string length");if(t=s(i(e,1,n)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return r=i(e,n,t+n),{data:r,remainder:e.slice(t+n)}}if(l<=247){for(t=l-191,a=i(e,1,t);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(t)}}{if(n=l-246,t=s(i(e,1,n)),t<56)throw new Error("invalid RLP: encoded list too short");const r=n+t;if(r>e.length)throw new Error("invalid RLP: total length is larger than the data");for(a=i(e,n,r);a.length;)o=c(a),u.push(o.data),a=o.remainder;return{data:u,remainder:e.slice(r)}}}Object.defineProperty(n,"__esModule",{value:!0}),n.utils=n.decode=n.encode=void 0,n.encode=r,n.decode=o;const u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){let t="";for(let n=0;n<e.length;n++)t+=u[e[n]];return t}function f(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n;t[n]=f(e.slice(r,r+2))}return t}function d(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}function p(e){return(new TextEncoder).encode(e)}function g(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function b(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function m(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return b(e)?h((t="string"!=typeof(n=e)?n:b(n)?n.slice(2):n).length%2?`0${t}`:t):p(e);var t,n;if("number"==typeof e||"bigint"==typeof e)return e?h(g(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}n.utils={bytesToHex:l,concatBytes:d,hexToBytes:h,utf8ToBytes:p};const w={encode:r,decode:o};n.default=w}}},{package:"eth-lattice-keyring>gridplus-sdk>rlp"}],[4184,{"./lib":4186,"./lib/elliptic":4185},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"eth-lattice-keyring>gridplus-sdk>secp256k1"}],[4185,{elliptic:2170},function(){with(this)return function(){"use strict";return function(e,t,n){const r=new(0,e("elliptic").ec)("secp256k1"),i=r.curve,s=i.n.constructor;function a(e){const t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){let n=new s(t);if(n.cmp(i.p)>=0)return null;n=n.toRed(i.red);let a=n.redSqr().redIMul(n).redIAdd(i.b).redSqrt();return 3===e!==a.isOdd()&&(a=a.redNeg()),r.keyPair({pub:{x:n,y:a}})}(t,e.subarray(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,n){let a=new s(t),o=new s(n);if(a.cmp(i.p)>=0||o.cmp(i.p)>=0)return null;if(a=a.toRed(i.red),o=o.toRed(i.red),(6===e||7===e)&&o.isOdd()!==(7===e))return null;const c=a.redSqr().redIMul(a);return o.redSqr().redISub(c.redIAdd(i.b)).isZero()?r.keyPair({pub:{x:a,y:o}}):null}(t,e.subarray(1,33),e.subarray(33,65));default:return null}}function o(e,t){const n=t.encode(null,33===e.length);for(let t=0;t<e.length;++t)e[t]=n[t]}t.exports={contextRandomize:()=>0,privateKeyVerify(e){const t=new s(e);return t.cmp(i.n)<0&&!t.isZero()?0:1},privateKeyNegate(e){const t=new s(e),n=i.n.sub(t).umod(i.n).toArrayLike(Uint8Array,"be",32);return e.set(n),0},privateKeyTweakAdd(e,t){const n=new s(t);if(n.cmp(i.n)>=0)return 1;if(n.iadd(new s(e)),n.cmp(i.n)>=0&&n.isub(i.n),n.isZero())return 1;const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},privateKeyTweakMul(e,t){let n=new s(t);if(n.cmp(i.n)>=0||n.isZero())return 1;n.imul(new s(e)),n.cmp(i.n)>=0&&(n=n.umod(i.n));const r=n.toArrayLike(Uint8Array,"be",32);return e.set(r),0},publicKeyVerify:e=>null===a(e)?1:0,publicKeyCreate(e,t){const n=new s(t);if(n.cmp(i.n)>=0||n.isZero())return 1;return o(e,r.keyFromPrivate(t).getPublic()),0},publicKeyConvert(e,t){const n=a(t);if(null===n)return 1;return o(e,n.getPublic()),0},publicKeyNegate(e,t){const n=a(t);if(null===n)return 1;const r=n.getPublic();return r.y=r.y.redNeg(),o(e,r),0},publicKeyCombine(e,t){const n=new Array(t.length);for(let e=0;e<t.length;++e)if(n[e]=a(t[e]),null===n[e])return 1;let r=n[0].getPublic();for(let e=1;e<n.length;++e)r=r.add(n[e].pub);return r.isInfinity()?2:(o(e,r),0)},publicKeyTweakAdd(e,t,n){const r=a(t);if(null===r)return 1;if((n=new s(n)).cmp(i.n)>=0)return 2;const c=r.getPublic().add(i.g.mul(n));return c.isInfinity()?2:(o(e,c),0)},publicKeyTweakMul(e,t,n){const r=a(t);if(null===r)return 1;if((n=new s(n)).cmp(i.n)>=0||n.isZero())return 2;return o(e,r.getPublic().mul(n)),0},signatureNormalize(e){const t=new s(e.subarray(0,32)),n=new s(e.subarray(32,64));return t.cmp(i.n)>=0||n.cmp(i.n)>=0?1:(1===n.cmp(r.nh)&&e.set(i.n.sub(n).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){const n=t.subarray(0,32),r=t.subarray(32,64);if(new s(n).cmp(i.n)>=0)return 1;if(new s(r).cmp(i.n)>=0)return 1;const{output:a}=e;let o=a.subarray(4,37);o[0]=0,o.set(n,1);let c=33,u=0;for(;c>1&&0===o[u]&&!(128&o[u+1]);--c,++u);if(o=o.subarray(u),128&o[0])return 1;if(c>1&&0===o[0]&&!(128&o[1]))return 1;let l=a.subarray(39,72);l[0]=0,l.set(r,1);let f=33,h=0;for(;f>1&&0===l[h]&&!(128&l[h+1]);--f,++h);return l=l.subarray(h),128&l[0]||f>1&&0===l[0]&&!(128&l[1])?1:(e.outputlen=6+c+f,a[0]=48,a[1]=e.outputlen-2,a[2]=2,a[3]=o.length,a.set(o,4),a[4+c]=2,a[5+c]=l.length,a.set(l,6+c),0)},signatureImport(e,t){if(t.length<8)return 1;if(t.length>72)return 1;if(48!==t[0])return 1;if(t[1]!==t.length-2)return 1;if(2!==t[2])return 1;const n=t[3];if(0===n)return 1;if(5+n>=t.length)return 1;if(2!==t[4+n])return 1;const r=t[5+n];if(0===r)return 1;if(6+n+r!==t.length)return 1;if(128&t[4])return 1;if(n>1&&0===t[4]&&!(128&t[5]))return 1;if(128&t[n+6])return 1;if(r>1&&0===t[n+6]&&!(128&t[n+7]))return 1;let a=t.subarray(4,4+n);if(33===a.length&&0===a[0]&&(a=a.subarray(1)),a.length>32)return 1;let o=t.subarray(6+n);if(33===o.length&&0===o[0]&&(o=o.slice(1)),o.length>32)throw new Error("S length is too long");let c=new s(a);c.cmp(i.n)>=0&&(c=new s(0));let u=new s(t.subarray(6+n));return u.cmp(i.n)>=0&&(u=new s(0)),e.set(c.toArrayLike(Uint8Array,"be",32),0),e.set(u.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t,n,a,o){if(o){const e=o;o=r=>{const i=e(t,n,null,a,r);if(!(i instanceof Uint8Array&&32===i.length))throw new Error("This is the way");return new s(i)}}const c=new s(n);if(c.cmp(i.n)>=0||c.isZero())return 1;let u;try{u=r.sign(t,n,{canonical:!0,k:o,pers:a})}catch(e){return 1}return e.signature.set(u.r.toArrayLike(Uint8Array,"be",32),0),e.signature.set(u.s.toArrayLike(Uint8Array,"be",32),32),e.recid=u.recoveryParam,0},ecdsaVerify(e,t,n){const o={r:e.subarray(0,32),s:e.subarray(32,64)},c=new s(o.r),u=new s(o.s);if(c.cmp(i.n)>=0||u.cmp(i.n)>=0)return 1;if(1===u.cmp(r.nh)||c.isZero()||u.isZero())return 3;const l=a(n);if(null===l)return 2;const f=l.getPublic();return r.verify(t,o,f)?0:3},ecdsaRecover(e,t,n,a){const c={r:t.slice(0,32),s:t.slice(32,64)},u=new s(c.r),l=new s(c.s);if(u.cmp(i.n)>=0||l.cmp(i.n)>=0)return 1;if(u.isZero()||l.isZero())return 2;let f;try{f=r.recoverPubKey(a,c,n)}catch(e){return 2}return o(e,f),0},ecdh(e,t,n,o,c,u,l){const f=a(t);if(null===f)return 1;const h=new s(n);if(h.cmp(i.n)>=0||h.isZero())return 2;const d=f.getPublic().mul(h);if(c===undefined){const t=d.encode(null,!0),n=r.hash().update(t).digest();for(let t=0;t<32;++t)e[t]=n[t]}else{u||(u=new Uint8Array(32));const t=d.getX().toArray("be",32);for(let e=0;e<32;++e)u[e]=t[e];l||(l=new Uint8Array(32));const n=d.getY().toArray("be",32);for(let e=0;e<32;++e)l[e]=n[e];const r=c(u,l,o);if(!(r instanceof Uint8Array&&r.length===e.length))return 2;e.set(r)}return 0}}}}},{package:"eth-lattice-keyring>gridplus-sdk>secp256k1"}],[4186,{},function(){with(this)return function(){"use strict";return function(e,t,n){const r="Impossible case. Please create issue.",i="The tweak was out of range or the resulted private key is invalid",s="The tweak was out of range or equal to zero",a="Unknow error on context randomization",o="Private Key is invalid",c="Public Key could not be parsed",u="Public Key serialization error",l="The sum of the public keys is not valid",f="Signature could not be parsed",h="The nonce generation function failed, or the private key was invalid",d="Public key could not be recover",p="Scalar was invalid (zero or overflow)";function g(e,t){if(!e)throw new Error(t)}function b(e,t,n){if(g(t instanceof Uint8Array,`Expected ${e} to be an Uint8Array`),n!==undefined)if(Array.isArray(n)){const r=`Expected ${e} to be an Uint8Array with length [${n.join(", ")}]`;g(n.includes(t.length),r)}else{const r=`Expected ${e} to be an Uint8Array with length ${n}`;g(t.length===n,r)}}function m(e){g("Boolean"===y(e),"Expected compressed to be a Boolean")}function w(e=(e=>new Uint8Array(e)),t){return"function"==typeof e&&(e=e(t)),b("output",e,t),e}function y(e){return Object.prototype.toString.call(e).slice(8,-1)}t.exports=e=>({contextRandomize(t){if(g(null===t||t instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),null!==t&&b("seed",t,32),1===e.contextRandomize(t))throw new Error(a)},privateKeyVerify:t=>(b("private key",t,32),0===e.privateKeyVerify(t)),privateKeyNegate(t){switch(b("private key",t,32),e.privateKeyNegate(t)){case 0:return t;case 1:throw new Error(r)}},privateKeyTweakAdd(t,n){switch(b("private key",t,32),b("tweak",n,32),e.privateKeyTweakAdd(t,n)){case 0:return t;case 1:throw new Error(i)}},privateKeyTweakMul(t,n){switch(b("private key",t,32),b("tweak",n,32),e.privateKeyTweakMul(t,n)){case 0:return t;case 1:throw new Error(s)}},publicKeyVerify:t=>(b("public key",t,[33,65]),0===e.publicKeyVerify(t)),publicKeyCreate(t,n=!0,r){switch(b("private key",t,32),m(n),r=w(r,n?33:65),e.publicKeyCreate(r,t)){case 0:return r;case 1:throw new Error(o);case 2:throw new Error(u)}},publicKeyConvert(t,n=!0,r){switch(b("public key",t,[33,65]),m(n),r=w(r,n?33:65),e.publicKeyConvert(r,t)){case 0:return r;case 1:throw new Error(c);case 2:throw new Error(u)}},publicKeyNegate(t,n=!0,i){switch(b("public key",t,[33,65]),m(n),i=w(i,n?33:65),e.publicKeyNegate(i,t)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(r);case 3:throw new Error(u)}},publicKeyCombine(t,n=!0,r){g(Array.isArray(t),"Expected public keys to be an Array"),g(t.length>0,"Expected public keys array will have more than zero items");for(const e of t)b("public key",e,[33,65]);switch(m(n),r=w(r,n?33:65),e.publicKeyCombine(r,t)){case 0:return r;case 1:throw new Error(c);case 2:throw new Error(l);case 3:throw new Error(u)}},publicKeyTweakAdd(t,n,r=!0,s){switch(b("public key",t,[33,65]),b("tweak",n,32),m(r),s=w(s,r?33:65),e.publicKeyTweakAdd(s,t,n)){case 0:return s;case 1:throw new Error(c);case 2:throw new Error(i)}},publicKeyTweakMul(t,n,r=!0,i){switch(b("public key",t,[33,65]),b("tweak",n,32),m(r),i=w(i,r?33:65),e.publicKeyTweakMul(i,t,n)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(s)}},signatureNormalize(t){switch(b("signature",t,64),e.signatureNormalize(t)){case 0:return t;case 1:throw new Error(f)}},signatureExport(t,n){b("signature",t,64);const i={output:n=w(n,72),outputlen:72};switch(e.signatureExport(i,t)){case 0:return n.slice(0,i.outputlen);case 1:throw new Error(f);case 2:throw new Error(r)}},signatureImport(t,n){switch(b("signature",t),n=w(n,64),e.signatureImport(n,t)){case 0:return n;case 1:throw new Error(f);case 2:throw new Error(r)}},ecdsaSign(t,n,i={},s){b("message",t,32),b("private key",n,32),g("Object"===y(i),"Expected options to be an Object"),i.data!==undefined&&b("options.data",i.data),i.noncefn!==undefined&&g("Function"===y(i.noncefn),"Expected options.noncefn to be a Function");const a={signature:s=w(s,64),recid:null};switch(e.ecdsaSign(a,t,n,i.data,i.noncefn)){case 0:return a;case 1:throw new Error(h);case 2:throw new Error(r)}},ecdsaVerify(t,n,r){switch(b("signature",t,64),b("message",n,32),b("public key",r,[33,65]),e.ecdsaVerify(t,n,r)){case 0:return!0;case 3:return!1;case 1:throw new Error(f);case 2:throw new Error(c)}},ecdsaRecover(t,n,i,s=!0,a){switch(b("signature",t,64),g("Number"===y(n)&&n>=0&&n<=3,"Expected recovery id to be a Number within interval [0, 3]"),b("message",i,32),m(s),a=w(a,s?33:65),e.ecdsaRecover(a,t,n,i)){case 0:return a;case 1:throw new Error(f);case 2:throw new Error(d);case 3:throw new Error(r)}},ecdh(t,n,r={},i){switch(b("public key",t,[33,65]),b("private key",n,32),g("Object"===y(r),"Expected options to be an Object"),r.data!==undefined&&b("options.data",r.data),r.hashfn!==undefined?(g("Function"===y(r.hashfn),"Expected options.hashfn to be a Function"),r.xbuf!==undefined&&b("options.xbuf",r.xbuf,32),r.ybuf!==undefined&&b("options.ybuf",r.ybuf,32),b("output",i)):i=w(i,32),e.ecdh(i,t,n,r.data,r.hashfn,r.xbuf,r.ybuf)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(p)}}})}}},{package:"eth-lattice-keyring>gridplus-sdk>secp256k1"}],[4188,{"is-deflate":4562,"is-gzip":4565,"peek-stream":5247,pumpify:4204,through2:4205,zlib:4190},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("zlib"),i=e("peek-stream"),s=e("through2"),a=e("pumpify"),o=e("is-gzip"),c=e("is-deflate"),u=function(e){return e===undefined&&(e=3),i({newline:!1,maxBuffer:10},(function(t,n){if(e<0)return n(new Error("Maximum recursion reached"));switch(function(e){return o(e)?1:c(e)?2:0}(t)){case 1:n(null,a(r.createGunzip(),u(e-1)));break;case 2:n(null,a(r.createInflate(),u(e-1)));break;default:n(null,s())}}))};t.exports=u}}},{package:"@metamask/snap-controllers>gunzip-maybe"}],[4189,{_process:5261,buffer:1936,"pako/lib/zlib/constants":4194,"pako/lib/zlib/deflate.js":4196,"pako/lib/zlib/inflate.js":4198,"pako/lib/zlib/messages":4200,"pako/lib/zlib/zstream":4202},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t,r){(function(){var i=e("pako/lib/zlib/messages"),s=e("pako/lib/zlib/zstream"),a=e("pako/lib/zlib/deflate.js"),o=e("pako/lib/zlib/inflate.js"),c=e("pako/lib/zlib/constants");for(var u in c)n[u]=c[u];function l(e){if(e<n.DEFLATE||e>n.UNZIP)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function f(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}n.NONE=0,n.DEFLATE=1,n.INFLATE=2,n.GZIP=3,n.GUNZIP=4,n.DEFLATERAW=5,n.INFLATERAW=6,n.UNZIP=7,l.prototype.init=function(e,t,r,i,c){switch(this.windowBits=e,this.level=t,this.memLevel=r,this.strategy=i,this.mode!==n.GZIP&&this.mode!==n.GUNZIP||(this.windowBits+=16),this.mode===n.UNZIP&&(this.windowBits+=32),this.mode!==n.DEFLATERAW&&this.mode!==n.INFLATERAW||(this.windowBits=-this.windowBits),this.strm=new s,this.mode){case n.DEFLATE:case n.GZIP:case n.DEFLATERAW:var u=a.deflateInit2(this.strm,this.level,n.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case n.INFLATE:case n.GUNZIP:case n.INFLATERAW:case n.UNZIP:u=o.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}u===n.Z_OK?(this.write_in_progress=!1,this.init_done=!0):this._error(u)},l.prototype.params=function(){throw new Error("deflateParams Not supported")},l.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===n.NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},l.prototype.write=function(e,n,r,i,s,a,o){this._writeCheck(),this.write_in_progress=!0;var c=this;return t.nextTick((function(){c.write_in_progress=!1;var t=c._write(e,n,r,i,s,a,o);c.callback(t[0],t[1]),c.pending_close&&c.close()})),this},l.prototype.writeSync=function(e,t,n,r,i,s,a){return this._writeCheck(),this._write(e,t,n,r,i,s,a)},l.prototype._write=function(e,t,i,s,c,u,l){if(this.write_in_progress=!0,e!==n.Z_NO_FLUSH&&e!==n.Z_PARTIAL_FLUSH&&e!==n.Z_SYNC_FLUSH&&e!==n.Z_FULL_FLUSH&&e!==n.Z_FINISH&&e!==n.Z_BLOCK)throw new Error("Invalid flush value");null==t&&(t=new r(0),s=0,i=0),c._set?c.set=c._set:c.set=f;var h=this.strm;switch(h.avail_in=s,h.input=t,h.next_in=i,h.avail_out=l,h.output=c,h.next_out=u,this.mode){case n.DEFLATE:case n.GZIP:case n.DEFLATERAW:var d=a.deflate(h,e);break;case n.UNZIP:case n.INFLATE:case n.GUNZIP:case n.INFLATERAW:d=o.inflate(h,e);break;default:throw new Error("Unknown mode "+this.mode)}return d!==n.Z_STREAM_END&&d!==n.Z_OK&&this._error(d),this.write_in_progress=!1,[h.avail_in,h.avail_out]},l.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===n.DEFLATE||this.mode===n.GZIP||this.mode===n.DEFLATERAW?a.deflateEnd(this.strm):o.inflateEnd(this.strm),this.mode=n.NONE)},l.prototype.reset=function(){switch(this.mode){case n.DEFLATE:case n.DEFLATERAW:var e=a.deflateReset(this.strm);break;case n.INFLATE:case n.INFLATERAW:e=o.inflateReset(this.strm)}e!==n.Z_OK&&this._error(e)},l.prototype._error=function(e){this.onerror(i[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()},n.Zlib=l}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib"}],[4190,{"./binding":4189,_process:5261,_stream_transform:5542,assert:1564,buffer:1936,util:1942},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t,r){(function(){var i=e("_stream_transform"),s=e("./binding"),a=e("util"),o=e("assert").ok;function c(e,t,n){var i=[],s=0;function a(){for(var t;null!==(t=e.read());)i.push(t),s+=t.length;e.once("readable",a)}function o(){var t=r.concat(i,s);i=[],n(null,t),e.close()}e.on("error",(function(t){e.removeListener("end",o),e.removeListener("readable",a),n(t)})),e.on("end",o),e.end(t),a()}function u(e,t){if("string"==typeof t&&(t=new r(t)),!r.isBuffer(t))throw new TypeError("Not a string or buffer");var n=s.Z_FINISH;return e._processChunk(t,n)}function l(e){if(!(this instanceof l))return new l(e);m.call(this,e,s.DEFLATE)}function f(e){if(!(this instanceof f))return new f(e);m.call(this,e,s.INFLATE)}function h(e){if(!(this instanceof h))return new h(e);m.call(this,e,s.GZIP)}function d(e){if(!(this instanceof d))return new d(e);m.call(this,e,s.GUNZIP)}function p(e){if(!(this instanceof p))return new p(e);m.call(this,e,s.DEFLATERAW)}function g(e){if(!(this instanceof g))return new g(e);m.call(this,e,s.INFLATERAW)}function b(e){if(!(this instanceof b))return new b(e);m.call(this,e,s.UNZIP)}function m(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||n.Z_DEFAULT_CHUNK,i.call(this,e),e.flush&&e.flush!==s.Z_NO_FLUSH&&e.flush!==s.Z_PARTIAL_FLUSH&&e.flush!==s.Z_SYNC_FLUSH&&e.flush!==s.Z_FULL_FLUSH&&e.flush!==s.Z_FINISH&&e.flush!==s.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||s.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<n.Z_MIN_CHUNK||e.chunkSize>n.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<n.Z_MIN_WINDOWBITS||e.windowBits>n.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<n.Z_MIN_LEVEL||e.level>n.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<n.Z_MIN_MEMLEVEL||e.memLevel>n.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=n.Z_FILTERED&&e.strategy!=n.Z_HUFFMAN_ONLY&&e.strategy!=n.Z_RLE&&e.strategy!=n.Z_FIXED&&e.strategy!=n.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!r.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new s.Zlib(t);var a=this;this._hadError=!1,this._binding.onerror=function(e,t){a._binding=null,a._hadError=!0;var r=new Error(e);r.errno=t,r.code=n.codes[t],a.emit("error",r)};var o=n.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var c=n.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(c=e.strategy),this._binding.init(e.windowBits||n.Z_DEFAULT_WINDOWBITS,o,e.memLevel||n.Z_DEFAULT_MEMLEVEL,c,e.dictionary),this._buffer=new r(this._chunkSize),this._offset=0,this._closed=!1,this._level=o,this._strategy=c,this.once("end",this.close)}s.Z_MIN_WINDOWBITS=8,s.Z_MAX_WINDOWBITS=15,s.Z_DEFAULT_WINDOWBITS=15,s.Z_MIN_CHUNK=64,s.Z_MAX_CHUNK=Infinity,s.Z_DEFAULT_CHUNK=16384,s.Z_MIN_MEMLEVEL=1,s.Z_MAX_MEMLEVEL=9,s.Z_DEFAULT_MEMLEVEL=8,s.Z_MIN_LEVEL=-1,s.Z_MAX_LEVEL=9,s.Z_DEFAULT_LEVEL=s.Z_DEFAULT_COMPRESSION,Object.keys(s).forEach((function(e){e.match(/^Z/)&&(n[e]=s[e])})),n.codes={Z_OK:s.Z_OK,Z_STREAM_END:s.Z_STREAM_END,Z_NEED_DICT:s.Z_NEED_DICT,Z_ERRNO:s.Z_ERRNO,Z_STREAM_ERROR:s.Z_STREAM_ERROR,Z_DATA_ERROR:s.Z_DATA_ERROR,Z_MEM_ERROR:s.Z_MEM_ERROR,Z_BUF_ERROR:s.Z_BUF_ERROR,Z_VERSION_ERROR:s.Z_VERSION_ERROR},Object.keys(n.codes).forEach((function(e){n.codes[n.codes[e]]=e})),n.Deflate=l,n.Inflate=f,n.Gzip=h,n.Gunzip=d,n.DeflateRaw=p,n.InflateRaw=g,n.Unzip=b,n.createDeflate=function(e){return new l(e)},n.createInflate=function(e){return new f(e)},n.createDeflateRaw=function(e){return new p(e)},n.createInflateRaw=function(e){return new g(e)},n.createGzip=function(e){return new h(e)},n.createGunzip=function(e){return new d(e)},n.createUnzip=function(e){return new b(e)},n.deflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new l(t),e,n)},n.deflateSync=function(e,t){return u(new l(t),e)},n.gzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new h(t),e,n)},n.gzipSync=function(e,t){return u(new h(t),e)},n.deflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new p(t),e,n)},n.deflateRawSync=function(e,t){return u(new p(t),e)},n.unzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new b(t),e,n)},n.unzipSync=function(e,t){return u(new b(t),e)},n.inflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new f(t),e,n)},n.inflateSync=function(e,t){return u(new f(t),e)},n.gunzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new d(t),e,n)},n.gunzipSync=function(e,t){return u(new d(t),e)},n.inflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),c(new g(t),e,n)},n.inflateRawSync=function(e,t){return u(new g(t),e)},a.inherits(m,i),m.prototype.params=function(e,r,i){if(e<n.Z_MIN_LEVEL||e>n.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(r!=n.Z_FILTERED&&r!=n.Z_HUFFMAN_ONLY&&r!=n.Z_RLE&&r!=n.Z_FIXED&&r!=n.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+r);if(this._level!==e||this._strategy!==r){var a=this;this.flush(s.Z_SYNC_FLUSH,(function(){a._binding.params(e,r),a._hadError||(a._level=e,a._strategy=r,i&&i())}))}else t.nextTick(i)},m.prototype.reset=function(){return this._binding.reset()},m.prototype._flush=function(e){this._transform(new r(0),"",e)},m.prototype.flush=function(e,n){var i=this._writableState;if(("function"==typeof e||void 0===e&&!n)&&(n=e,e=s.Z_FULL_FLUSH),i.ended)n&&t.nextTick(n);else if(i.ending)n&&this.once("end",n);else if(i.needDrain){var a=this;this.once("drain",(function(){a.flush(n)}))}else this._flushFlag=e,this.write(new r(0),"",n)},m.prototype.close=function(e){if(e&&t.nextTick(e),!this._closed){this._closed=!0,this._binding.close();var n=this;t.nextTick((function(){n.emit("close")}))}},m.prototype._transform=function(e,t,n){var i,a=this._writableState,o=(a.ending||a.ended)&&(!e||a.length===e.length);if(null===!e&&!r.isBuffer(e))return n(new Error("invalid input"));o?i=s.Z_FINISH:(i=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||s.Z_NO_FLUSH));this._processChunk(e,i,n)},m.prototype._processChunk=function(e,t,n){var i=e&&e.length,s=this._chunkSize-this._offset,a=0,c=this,u="function"==typeof n;if(!u){var l,f=[],h=0;this.on("error",(function(e){l=e}));do{var d=this._binding.writeSync(t,e,a,i,this._buffer,this._offset,s)}while(!this._hadError&&b(d[0],d[1]));if(this._hadError)throw l;var p=r.concat(f,h);return this.close(),p}var g=this._binding.write(t,e,a,i,this._buffer,this._offset,s);function b(l,d){if(!c._hadError){var p=s-d;if(o(p>=0,"have should not go down"),p>0){var g=c._buffer.slice(c._offset,c._offset+p);c._offset+=p,u?c.push(g):(f.push(g),h+=g.length)}if((0===d||c._offset>=c._chunkSize)&&(s=c._chunkSize,c._offset=0,c._buffer=new r(c._chunkSize)),0===d){if(a+=i-l,i=l,!u)return!0;var m=c._binding.write(t,e,a,i,c._buffer,c._offset,c._chunkSize);return m.callback=b,void(m.buffer=e)}if(!u)return!1;n()}}g.buffer=e,g.callback=b},a.inherits(l,m),a.inherits(f,m),a.inherits(h,m),a.inherits(d,m),a.inherits(p,m),a.inherits(g,m),a.inherits(b,m)}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib"}],[4191,{_process:5261,buffer:1936,"end-of-stream":2193,inherits:4276,"readable-stream":5541,"stream-shift":5745},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n,r){(function(){var i=e("readable-stream"),s=e("end-of-stream"),a=e("inherits"),o=e("stream-shift"),c=r.from&&r.from!==Uint8Array.from?r.from([0]):new r([0]),u=function(e,t){e._corked?e.once("uncork",t):t()},l=function(e,t){return function(n){n?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===n.message?null:n):t&&!e._ended&&e.end()}},f=function(e,t,n){if(!(this instanceof f))return new f(e,t,n);i.Duplex.call(this,n),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!n||!1!==n.autoDestroy,this._forwardDestroy=!n||!1!==n.destroy,this._forwardEnd=!n||!1!==n.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};a(f,i.Duplex),f.obj=function(e,t,n){return n||(n={}),n.objectMode=!0,n.highWaterMark=16,new f(e,t,n)},f.prototype.cork=function(){1==++this._corked&&this.emit("cork")},f.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},f.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)e&&e.destroy&&e.destroy();else if(null!==e&&!1!==e){var t=this,r=s(e,{writable:!0,readable:!1},l(this,this._forwardEnd)),i=function(){var e=t._ondrain;t._ondrain=null,e&&e()};this._unwrite&&n.nextTick(i),this._writable=e,this._writable.on("drain",i),this._unwrite=function(){t._writable.removeListener("drain",i),r()},this.uncork()}else this.end()},f.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,n=this,r=s(e,{writable:!1,readable:!0},l(this)),a=function(){n._forward()},o=function(){n.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new i.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",a),this._readable2.on("end",o),this._unread=function(){n._readable2.removeListener("readable",a),n._readable2.removeListener("end",o),r()},this._forward()}},f.prototype._read=function(){this._drained=!0,this._forward()},f.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=o(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},f.prototype.destroy=function(e){if(!this.destroyed){this.destroyed=!0;var t=this;n.nextTick((function(){t._destroy(e)}))}},f.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},f.prototype._write=function(e,t,n){return this.destroyed?n():this._corked?u(this,this._write.bind(this,e,t,n)):e===c?this._finish(n):this._writable?void(!1===this._writable.write(e)?this._ondrain=n:n()):n()},f.prototype._finish=function(e){var t=this;this.emit("preend"),u(this,(function(){var n,r;n=t._forwardEnd&&t._writable,r=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),u(t,e)},n?n._writableState&&n._writableState.finished?r():n._writableState?n.end(r):(n.end(),r()):r()}))},f.prototype.end=function(e,t,n){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this.write(c),i.Writable.prototype.end.call(this,n))},t.exports=f}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify>duplexify"}],[4192,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){var t,n,r,i,s,a;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)s=e[t],a.set(s,i),i+=s.length;return a}},s={arraySet:function(e,t,n,r,i){for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(r)}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4193,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(e,t,n,r){for(var i=65535&e|0,s=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{s=s+(i=i+t[r++]|0)|0}while(--a);i%=65521,s%=65521}return i|s<<16|0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4194,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4195,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var s=r,a=i+n;e^=-1;for(var o=i;o<a;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4196,{"../utils/common":4192,"./adler32":4193,"./crc32":4195,"./messages":4200,"./trees":4201},function(){with(this)return function(){"use strict";return function(e,t,n){var r,i=e("../utils/common"),s=e("./trees"),a=e("./adler32"),o=e("./crc32"),c=e("./messages"),u=-2,l=258,f=262,h=103,d=113,p=666;function g(e,t){return e.msg=c[t],t}function b(e){return(e<<1)-(e>4?9:0)}function m(e){for(var t=e.length;--t>=0;)e[t]=0}function w(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function y(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,w(e.strm)}function _(e,t){e.pending_buf[e.pending++]=t}function v(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function k(e,t){var n,r,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,c=e.strstart>e.w_size-f?e.strstart-(e.w_size-f):0,u=e.window,h=e.w_mask,d=e.prev,p=e.strstart+l,g=u[s+a-1],b=u[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(u[(n=t)+a]===b&&u[n+a-1]===g&&u[n]===u[s]&&u[++n]===u[s+1]){s+=2,n++;do{}while(u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&u[++s]===u[++n]&&s<p);if(r=l-(p-s),s=p-l,r>a){if(e.match_start=t,a=r,r>=o)break;g=u[s+a-1],b=u[s+a]}}}while((t=d[t&h])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead}function E(e){var t,n,r,s,c,u,l,h,d,p,g=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-f)){i.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=g?r-g:0}while(--n);t=n=g;do{r=e.prev[--t],e.prev[t]=r>=g?r-g:0}while(--n);s+=g}if(0===e.strm.avail_in)break;if(u=e.strm,l=e.window,h=e.strstart+e.lookahead,d=s,p=void 0,(p=u.avail_in)>d&&(p=d),n=0===p?0:(u.avail_in-=p,i.arraySet(l,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=a(u.adler,l,p,h):2===u.state.wrap&&(u.adler=o(u.adler,l,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<f&&0!==e.strm.avail_in)}function x(e,t){for(var n,r;;){if(e.lookahead<f){if(E(e),e.lookahead<f&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-f&&(e.match_length=k(e,n)),e.match_length>=3)if(r=s._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function S(e,t){for(var n,r,i;;){if(e.lookahead<f){if(E(e),e.lookahead<f&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-f&&(e.match_length=k(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=s._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function A(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function R(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function T(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,s._tr_init(t),0):g(e,u)}function N(e){var t,n=T(e);return 0===n&&((t=e.state).window_size=2*t.w_size,m(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function I(e,t,n,r,s,a){if(!e)return u;var o=1;if(-1===t&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),s<1||s>9||8!==n||r<8||r>15||t<0||t>9||a<0||a>4)return g(e,u);8===r&&(r=9);var c=new R;return e.state=c,c.strm=e,c.wrap=o,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=s+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<s+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=a,c.method=n,N(e)}r=[new A(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(E(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-f&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)})),new A(4,4,8,4,x),new A(4,5,16,8,x),new A(4,6,32,32,x),new A(4,4,16,16,S),new A(8,16,32,32,S),new A(8,16,128,128,S),new A(8,32,128,256,S),new A(32,128,258,1024,S),new A(32,258,258,4096,S)],n.deflateInit=function(e,t){return I(e,t,8,15,8,0)},n.deflateInit2=I,n.deflateReset=N,n.deflateResetKeep=T,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},n.deflate=function(e,t){var n,i,a,c;if(!e||!e.state||t>5||t<0)return e?g(e,u):u;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===p&&4!==t)return g(e,0===e.avail_out?-5:u);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,_(i,31),_(i,139),_(i,8),i.gzhead?(_(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),_(i,255&i.gzhead.time),_(i,i.gzhead.time>>8&255),_(i,i.gzhead.time>>16&255),_(i,i.gzhead.time>>24&255),_(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),_(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(_(i,255&i.gzhead.extra.length),_(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=o(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(_(i,0),_(i,0),_(i,0),_(i,0),_(i,0),_(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),_(i,3),i.status=d);else{var f=8+(i.w_bits-8<<4)<<8;f|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(f|=32),f+=31-f%31,i.status=d,v(i,f),0!==i.strstart&&(v(i,e.adler>>>16),v(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),w(e),a=i.pending,i.pending!==i.pending_buf_size));)_(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),w(e),a=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,_(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),w(e),a=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,_(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>a&&(e.adler=o(e.adler,i.pending_buf,i.pending-a,a)),0===c&&(i.status=h)}else i.status=h;if(i.status===h&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&w(e),i.pending+2<=i.pending_buf_size&&(_(i,255&e.adler),_(i,e.adler>>8&255),e.adler=0,i.status=d)):i.status=d),0!==i.pending){if(w(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&b(t)<=b(n)&&4!==t)return g(e,-5);if(i.status===p&&0!==e.avail_in)return g(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==p){var k=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(E(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,a,o=e.window;;){if(e.lookahead<=l){if(E(e),e.lookahead<=l&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=o[i=e.strstart-1])===o[++i]&&r===o[++i]&&r===o[++i]){a=e.strstart+l;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);e.match_length=l-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=s._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==k&&4!==k||(i.status=p),1===k||3===k)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===k&&(1===t?s._tr_align(i):5!==t&&(s._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),w(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(_(i,255&e.adler),_(i,e.adler>>8&255),_(i,e.adler>>16&255),_(i,e.adler>>24&255),_(i,255&e.total_in),_(i,e.total_in>>8&255),_(i,e.total_in>>16&255),_(i,e.total_in>>24&255)):(v(i,e.adler>>>16),v(i,65535&e.adler)),w(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==h&&t!==d&&t!==p?g(e,u):(e.state=null,t===d?g(e,-3):0):u},n.deflateSetDictionary=function(e,t){var n,r,s,o,c,l,f,h,d=t.length;if(!e||!e.state)return u;if(2===(o=(n=e.state).wrap)||1===o&&42!==n.status||n.lookahead)return u;for(1===o&&(e.adler=a(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===o&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,d-n.w_size,n.w_size,0),t=h,d=n.w_size),c=e.avail_in,l=e.next_in,f=e.input,e.avail_in=d,e.next_in=0,e.input=t,E(n);n.lookahead>=3;){r=n.strstart,s=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--s);n.strstart=r,n.lookahead=2,E(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=l,e.input=f,e.avail_in=c,n.wrap=o,0},n.deflateInfo="pako deflate (from Nodeca project)"}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4197,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(e,t){var n,r,i,s,a,o,c,u,l,f,h,d,p,g,b,m,w,y,_,v,k,E,x,S,A;n=e.state,r=e.next_in,S=e.input,i=r+(e.avail_in-5),s=e.next_out,A=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),c=n.dmax,u=n.wsize,l=n.whave,f=n.wnext,h=n.window,d=n.hold,p=n.bits,g=n.lencode,b=n.distcode,m=(1<<n.lenbits)-1,w=(1<<n.distbits)-1;e:do{p<15&&(d+=S[r++]<<p,p+=8,d+=S[r++]<<p,p+=8),y=g[d&m];t:for(;;){if(d>>>=_=y>>>24,p-=_,0===(_=y>>>16&255))A[s++]=65535&y;else{if(!(16&_)){if(0==(64&_)){y=g[(65535&y)+(d&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}v=65535&y,(_&=15)&&(p<_&&(d+=S[r++]<<p,p+=8),v+=d&(1<<_)-1,d>>>=_,p-=_),p<15&&(d+=S[r++]<<p,p+=8,d+=S[r++]<<p,p+=8),y=b[d&w];n:for(;;){if(d>>>=_=y>>>24,p-=_,!(16&(_=y>>>16&255))){if(0==(64&_)){y=b[(65535&y)+(d&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&y,p<(_&=15)&&(d+=S[r++]<<p,(p+=8)<_&&(d+=S[r++]<<p,p+=8)),(k+=d&(1<<_)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(d>>>=_,p-=_,k>(_=s-a)){if((_=k-_)>l&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,x=h,0===f){if(E+=u-_,_<v){v-=_;do{A[s++]=h[E++]}while(--_);E=s-k,x=A}}else if(f<_){if(E+=u+f-_,(_-=f)<v){v-=_;do{A[s++]=h[E++]}while(--_);if(E=0,f<v){v-=_=f;do{A[s++]=h[E++]}while(--_);E=s-k,x=A}}}else if(E+=f-_,_<v){v-=_;do{A[s++]=h[E++]}while(--_);E=s-k,x=A}for(;v>2;)A[s++]=x[E++],A[s++]=x[E++],A[s++]=x[E++],v-=3;v&&(A[s++]=x[E++],v>1&&(A[s++]=x[E++]))}else{E=s-k;do{A[s++]=A[E++],A[s++]=A[E++],A[s++]=A[E++],v-=3}while(v>2);v&&(A[s++]=A[E++],v>1&&(A[s++]=A[E++]))}break}}break}}while(r<i&&s<o);r-=v=p>>3,d&=(1<<(p-=v<<3))-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=s<o?o-s+257:257-(s-o),n.hold=d,n.bits=p}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4198,{"../utils/common":4192,"./adler32":4193,"./crc32":4195,"./inffast":4197,"./inftrees":4199},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../utils/common"),i=e("./adler32"),s=e("./crc32"),a=e("./inffast"),o=e("./inftrees"),c=-2,u=12,l=30;function f(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):c}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):c}function g(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?c:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,p(e))):c}function b(e,t){var n,r;return e?(r=new h,e.state=r,r.window=null,0!==(n=g(e,t))&&(e.state=null),n):c}var m,w,y=!0;function _(e){if(y){var t;for(m=new r.Buf32(512),w=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,w,0,e.work,{bits:5}),y=!1}e.lencode=m,e.lenbits=9,e.distcode=w,e.distbits=5}function v(e,t,n,i){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>i&&(s=i),r.arraySet(a.window,t,n-i,s,a.wnext),(i-=s)?(r.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}n.inflateReset=p,n.inflateReset2=g,n.inflateResetKeep=d,n.inflateInit=function(e){return b(e,15)},n.inflateInit2=b,n.inflate=function(e,t){var n,h,d,p,g,b,m,w,y,k,E,x,S,A,R,T,N,I,O,P,L,D,C,B,M=0,j=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;(n=e.state).mode===u&&(n.mode=13),g=e.next_out,d=e.output,m=e.avail_out,p=e.next_in,h=e.input,b=e.avail_in,w=n.hold,y=n.bits,k=b,E=m,D=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;y<16;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(2&n.wrap&&35615===w){n.check=0,j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0),w=0,y=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",n.mode=l;break}if(8!=(15&w)){e.msg="unknown compression method",n.mode=l;break}if(y-=4,L=8+(15&(w>>>=4)),0===n.wbits)n.wbits=L;else if(L>n.wbits){e.msg="invalid window size",n.mode=l;break}n.dmax=1<<L,e.adler=n.check=1,n.mode=512&w?10:u,w=0,y=0;break;case 2:for(;y<16;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=l;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=l;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),w=0,y=0,n.mode=3;case 3:for(;y<32;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.head&&(n.head.time=w),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,j[2]=w>>>16&255,j[3]=w>>>24&255,n.check=s(n.check,j,4,0)),w=0,y=0,n.mode=4;case 4:for(;y<16;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),w=0,y=0,n.mode=5;case 5:if(1024&n.flags){for(;y<16;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(j[0]=255&w,j[1]=w>>>8&255,n.check=s(n.check,j,2,0)),w=0,y=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((x=n.length)>b&&(x=b),x&&(n.head&&(L=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,h,p,x,L)),512&n.flags&&(n.check=s(n.check,h,x,p)),b-=x,p+=x,n.length-=x),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===b)break e;x=0;do{L=h[p+x++],n.head&&L&&n.length<65536&&(n.head.name+=String.fromCharCode(L))}while(L&&x<b);if(512&n.flags&&(n.check=s(n.check,h,x,p)),b-=x,p+=x,L)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===b)break e;x=0;do{L=h[p+x++],n.head&&L&&n.length<65536&&(n.head.comment+=String.fromCharCode(L))}while(L&&x<b);if(512&n.flags&&(n.check=s(n.check,h,x,p)),b-=x,p+=x,L)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;y<16;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=l;break}w=0,y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=u;break;case 10:for(;y<32;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}e.adler=n.check=f(w),w=0,y=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=g,e.avail_out=m,e.next_in=p,e.avail_in=b,n.hold=w,n.bits=y,2;e.adler=n.check=1,n.mode=u;case u:if(5===t||6===t)break e;case 13:if(n.last){w>>>=7&y,y-=7&y,n.mode=27;break}for(;y<3;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}switch(n.last=1&w,y-=1,3&(w>>>=1)){case 0:n.mode=14;break;case 1:if(_(n),n.mode=20,6===t){w>>>=2,y-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=l}w>>>=2,y-=2;break;case 14:for(w>>>=7&y,y-=7&y;y<32;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=l;break}if(n.length=65535&w,w=0,y=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(x=n.length){if(x>b&&(x=b),x>m&&(x=m),0===x)break e;r.arraySet(d,h,p,x,g),b-=x,p+=x,m-=x,g+=x,n.length-=x;break}n.mode=u;break;case 17:for(;y<14;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(n.nlen=257+(31&w),w>>>=5,y-=5,n.ndist=1+(31&w),w>>>=5,y-=5,n.ncode=4+(15&w),w>>>=4,y-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=l;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;y<3;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.lens[U[n.have++]]=7&w,w>>>=3,y-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},D=o(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,D){e.msg="invalid code lengths set",n.mode=l;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;T=(M=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,N=65535&M,!((R=M>>>24)<=y);){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(N<16)w>>>=R,y-=R,n.lens[n.have++]=N;else{if(16===N){for(B=R+2;y<B;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(w>>>=R,y-=R,0===n.have){e.msg="invalid bit length repeat",n.mode=l;break}L=n.lens[n.have-1],x=3+(3&w),w>>>=2,y-=2}else if(17===N){for(B=R+3;y<B;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}y-=R,L=0,x=3+(7&(w>>>=R)),w>>>=3,y-=3}else{for(B=R+7;y<B;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}y-=R,L=0,x=11+(127&(w>>>=R)),w>>>=7,y-=7}if(n.have+x>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=l;break}for(;x--;)n.lens[n.have++]=L}}if(n.mode===l)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=l;break}if(n.lenbits=9,C={bits:n.lenbits},D=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,D){e.msg="invalid literal/lengths set",n.mode=l;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},D=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,D){e.msg="invalid distances set",n.mode=l;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(b>=6&&m>=258){e.next_out=g,e.avail_out=m,e.next_in=p,e.avail_in=b,n.hold=w,n.bits=y,a(e,E),g=e.next_out,d=e.output,m=e.avail_out,p=e.next_in,h=e.input,b=e.avail_in,w=n.hold,y=n.bits,n.mode===u&&(n.back=-1);break}for(n.back=0;T=(M=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,N=65535&M,!((R=M>>>24)<=y);){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(T&&0==(240&T)){for(I=R,O=T,P=N;T=(M=n.lencode[P+((w&(1<<I+O)-1)>>I)])>>>16&255,N=65535&M,!(I+(R=M>>>24)<=y);){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}w>>>=I,y-=I,n.back+=I}if(w>>>=R,y-=R,n.back+=R,n.length=N,0===T){n.mode=26;break}if(32&T){n.back=-1,n.mode=u;break}if(64&T){e.msg="invalid literal/length code",n.mode=l;break}n.extra=15&T,n.mode=22;case 22:if(n.extra){for(B=n.extra;y<B;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;T=(M=n.distcode[w&(1<<n.distbits)-1])>>>16&255,N=65535&M,!((R=M>>>24)<=y);){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(0==(240&T)){for(I=R,O=T,P=N;T=(M=n.distcode[P+((w&(1<<I+O)-1)>>I)])>>>16&255,N=65535&M,!(I+(R=M>>>24)<=y);){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}w>>>=I,y-=I,n.back+=I}if(w>>>=R,y-=R,n.back+=R,64&T){e.msg="invalid distance code",n.mode=l;break}n.offset=N,n.extra=15&T,n.mode=24;case 24:if(n.extra){for(B=n.extra;y<B;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=l;break}n.mode=25;case 25:if(0===m)break e;if(x=E-m,n.offset>x){if((x=n.offset-x)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=l;break}x>n.wnext?(x-=n.wnext,S=n.wsize-x):S=n.wnext-x,x>n.length&&(x=n.length),A=n.window}else A=d,S=g-n.offset,x=n.length;x>m&&(x=m),m-=x,n.length-=x;do{d[g++]=A[S++]}while(--x);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;d[g++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;y<32;){if(0===b)break e;b--,w|=h[p++]<<y,y+=8}if(E-=m,e.total_out+=E,n.total+=E,E&&(e.adler=n.check=n.flags?s(n.check,d,E,g-E):i(n.check,d,E,g-E)),E=m,(n.flags?w:f(w))!==n.check){e.msg="incorrect data check",n.mode=l;break}w=0,y=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;y<32;){if(0===b)break e;b--,w+=h[p++]<<y,y+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=l;break}w=0,y=0}n.mode=29;case 29:D=1;break e;case l:D=-3;break e;case 31:return-4;default:return c}return e.next_out=g,e.avail_out=m,e.next_in=p,e.avail_in=b,n.hold=w,n.bits=y,(n.wsize||E!==e.avail_out&&n.mode<l&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,E-e.avail_out)?(n.mode=31,-4):(k-=e.avail_in,E-=e.avail_out,e.total_in+=k,e.total_out+=E,n.total+=E,n.wrap&&E&&(e.adler=n.check=n.flags?s(n.check,d,E,e.next_out-E):i(n.check,d,E,e.next_out-E)),e.data_type=n.bits+(n.last?64:0)+(n.mode===u?128:0)+(20===n.mode||15===n.mode?256:0),(0===k&&0===E||4===t)&&0===D&&(D=-5),D)},n.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?c:(n.head=t,t.done=!1,0):c},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?c:11===n.mode&&i(1,t,r,0)!==n.check?-3:v(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):c},n.inflateInfo="pako inflate (from Nodeca project)"}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4199,{"../utils/common":4192},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../utils/common"),i=15,s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,u,l,f,h,d){var p,g,b,m,w,y,_,v,k,E=d.bits,x=0,S=0,A=0,R=0,T=0,N=0,I=0,O=0,P=0,L=0,D=null,C=0,B=new r.Buf16(16),M=new r.Buf16(16),j=null,U=0;for(x=0;x<=i;x++)B[x]=0;for(S=0;S<u;S++)B[t[n+S]]++;for(T=E,R=i;R>=1&&0===B[R];R--);if(T>R&&(T=R),0===R)return l[f++]=20971520,l[f++]=20971520,d.bits=1,0;for(A=1;A<R&&0===B[A];A++);for(T<A&&(T=A),O=1,x=1;x<=i;x++)if(O<<=1,(O-=B[x])<0)return-1;if(O>0&&(0===e||1!==R))return-1;for(M[1]=0,x=1;x<i;x++)M[x+1]=M[x]+B[x];for(S=0;S<u;S++)0!==t[n+S]&&(h[M[t[n+S]]++]=S);if(0===e?(D=j=h,y=19):1===e?(D=s,C-=257,j=a,U-=257,y=256):(D=o,j=c,y=-1),L=0,S=0,x=A,w=f,N=T,I=0,b=-1,m=(P=1<<T)-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){_=x-I,h[S]<y?(v=0,k=h[S]):h[S]>y?(v=j[U+h[S]],k=D[C+h[S]]):(v=96,k=0),p=1<<x-I,A=g=1<<N;do{l[w+(L>>I)+(g-=p)]=_<<24|v<<16|k|0}while(0!==g);for(p=1<<x-1;L&p;)p>>=1;if(0!==p?(L&=p-1,L+=p):L=0,S++,0==--B[x]){if(x===R)break;x=t[n+h[S]]}if(x>T&&(L&m)!==b){for(0===I&&(I=T),w+=A,O=1<<(N=x-I);N+I<R&&!((O-=B[N+I])<=0);)N++,O<<=1;if(P+=1<<N,1===e&&P>852||2===e&&P>592)return 1;l[b=L&m]=T<<24|N<<16|w-f|0}}return 0!==L&&(l[w+L]=x-I<<24|64<<16|0),d.bits=T,0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4200,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4201,{"../utils/common":4192},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../utils/common");function i(e){for(var t=e.length;--t>=0;)e[t]=0}var s=256,a=286,o=30,c=15,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],d=new Array(576);i(d);var p=new Array(60);i(p);var g=new Array(512);i(g);var b=new Array(256);i(b);var m=new Array(29);i(m);var w,y,_,v=new Array(o);function k(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function E(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?g[e]:g[256+(e>>>7)]}function S(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function R(e,t,n){A(e,n[2*t],n[2*t+1])}function T(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function N(e,t,n){var r,i,s=new Array(16),a=0;for(r=1;r<=c;r++)s[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=T(s[o]++,o))}}function I(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function O(e){e.bi_valid>8?S(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function P(e,t,n,r){var i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]}function L(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&P(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!P(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function D(e,t,n){var r,i,a,o,c=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===r?R(e,i,t):(R(e,(a=b[i])+s+1,t),0!==(o=u[a])&&A(e,i-=m[a],o),R(e,a=x(--r),n),0!==(o=l[a])&&A(e,r-=v[a],o))}while(c<e.last_lit);R(e,256,t)}function C(e,t){var n,r,i,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<u;n++)0!==s[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=a[2*i+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)L(e,s,n);i=u;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],L(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,s[2*i]=s[2*n]+s[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,s[2*n+1]=s[2*r+1]=i,e.heap[1]=i++,L(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,s,a,o,u=t.dyn_tree,l=t.max_code,f=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,b=0;for(s=0;s<=c;s++)e.bl_count[s]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(s=u[2*u[2*(r=e.heap[n])+1]+1]+1)>g&&(s=g,b++),u[2*r+1]=s,r>l||(e.bl_count[s]++,a=0,r>=p&&(a=d[r-p]),o=u[2*r],e.opt_len+=o*(s+a),h&&(e.static_len+=o*(f[2*r+1]+a)));if(0!==b){do{for(s=g-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[g]--,b-=2}while(b>0);for(s=g;0!==s;s--)for(r=e.bl_count[s];0!==r;)(i=e.heap[--n])>l||(u[2*i+1]!==s&&(e.opt_len+=(s-u[2*i+1])*u[2*i],u[2*i+1]=s),r--)}}(e,t),N(s,l,e.bl_count)}function B(e,t,n){var r,i,s=-1,a=t[1],o=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++o<c&&i===a||(o<u?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4))}function M(e,t,n){var r,i,s=-1,a=t[1],o=0,c=7,u=4;for(0===a&&(c=138,u=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++o<c&&i===a)){if(o<u)do{R(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==s&&(R(e,i,e.bl_tree),o--),R(e,16,e.bl_tree),A(e,o-3,2)):o<=10?(R(e,17,e.bl_tree),A(e,o-3,3)):(R(e,18,e.bl_tree),A(e,o-11,7));o=0,s=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4)}}i(v);var j=!1;function U(e,t,n,i){A(e,0+(i?1:0),3),function(e,t,n,i){O(e),i&&(S(e,n),S(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){j||(!function(){var e,t,n,r,i,s=new Array(16);for(n=0,r=0;r<28;r++)for(m[r]=n,e=0;e<1<<u[r];e++)b[n++]=r;for(b[n-1]=r,i=0,r=0;r<16;r++)for(v[r]=i,e=0;e<1<<l[r];e++)g[i++]=r;for(i>>=7;r<o;r++)for(v[r]=i<<7,e=0;e<1<<l[r]-7;e++)g[256+i++]=r;for(t=0;t<=c;t++)s[t]=0;for(e=0;e<=143;)d[2*e+1]=8,e++,s[8]++;for(;e<=255;)d[2*e+1]=9,e++,s[9]++;for(;e<=279;)d[2*e+1]=7,e++,s[7]++;for(;e<=287;)d[2*e+1]=8,e++,s[8]++;for(N(d,287,s),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=T(e,5);w=new k(d,u,257,a,c),y=new k(p,l,0,o,c),_=new k(new Array(0),f,0,19,7)}(),j=!0),e.l_desc=new E(e.dyn_ltree,w),e.d_desc=new E(e.dyn_dtree,y),e.bl_desc=new E(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,I(e)},n._tr_stored_block=U,n._tr_flush_block=function(e,t,n,r){var i,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),C(e,e.l_desc),C(e,e.d_desc),o=function(e){var t;for(B(e,e.dyn_ltree,e.l_desc.max_code),B(e,e.dyn_dtree,e.d_desc.max_code),C(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?U(e,t,n,r):4===e.strategy||a===i?(A(e,2+(r?1:0),3),D(e,d,p)):(A(e,4+(r?1:0),3),function(e,t,n,r){var i;for(A(e,t-257,5),A(e,n-1,5),A(e,r-4,4),i=0;i<r;i++)A(e,e.bl_tree[2*h[i]+1],3);M(e,e.dyn_ltree,t-1),M(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),D(e,e.dyn_ltree,e.dyn_dtree)),I(e),r&&O(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(b[n]+s+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){A(e,2,3),R(e,256,d),function(e){16===e.bi_valid?(S(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4202,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}}},{package:"@metamask/snap-controllers>gunzip-maybe>browserify-zlib>pako"}],[4203,{"end-of-stream":2193,fs:1935,once:5154},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("once"),i=e("end-of-stream"),s=e("fs"),a=function(){},o=function(e){return"function"==typeof e},c=function(e,t,n,c){c=r(c);var u=!1;e.on("close",(function(){u=!0})),i(e,{readable:t,writable:n},(function(e){if(e)return c(e);u=!0,c()}));var l=!1;return function(t){if(!u&&!l)return l=!0,function(e){return!!s&&(e instanceof(s.ReadStream||a)||e instanceof(s.WriteStream||a))&&o(e.close)}(e)?e.close(a):function(e){return e.setHeader&&o(e.abort)}(e)?e.abort():o(e.destroy)?e.destroy():void c(t||new Error("stream was destroyed"))}},u=function(e){e()},l=function(e,t){return e.pipe(t)};t.exports=function(){var e,t=Array.prototype.slice.call(arguments),n=o(t[t.length-1]||a)&&t.pop()||a;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var r=t.map((function(i,s){var a=s<t.length-1;return c(i,a,s>0,(function(t){e||(e=t),t&&r.forEach(u),a||(r.forEach(u),n(e))}))}));return t.reduce(l)}}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify>pump"}],[4204,{duplexify:4191,inherits:4276,pump:4203},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("pump"),i=e("inherits"),s=e("duplexify"),a=function(e){return e.length?Array.isArray(e[0])?e[0]:Array.prototype.slice.call(e):[]},o=function(e){var t=function(){var n=a(arguments);if(!(this instanceof t))return new t(n);s.call(this,null,null,e),n.length&&this.setPipeline(n)};return i(t,s),t.prototype.setPipeline=function(){var e=a(arguments),t=this,n=!1,i=e[0],s=e[e.length-1];s=s.readable?s:null,i=i.writable?i:null;var o=function(){e[0].emit("error",new Error("stream was destroyed"))};if(this.on("close",o),this.on("prefinish",(function(){n||t.cork()})),r(e,(function(e){if(t.removeListener("close",o),e)return t.destroy(e);n=!0,t.uncork()})),this.destroyed)return o();this.setWritable(i),this.setReadable(s)},t};t.exports=o({destroy:!1}),t.exports.obj=o({destroy:!1,objectMode:!0,highWaterMark:16})}}},{package:"@metamask/snap-controllers>gunzip-maybe>pumpify"}],[4205,{_process:5261,"readable-stream":5541,util:1942,xtend:6010},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("readable-stream").Transform,i=e("util").inherits,s=e("xtend");function a(e){r.call(this,e),this._destroyed=!1}function o(e,t,n){n(null,e)}function c(e){return function(t,n,r){return"function"==typeof t&&(r=n,n=t,t={}),"function"!=typeof n&&(n=o),"function"!=typeof r&&(r=null),e(t,n,r)}}i(a,r),a.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;n.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,n){var r=new a(e);return r._transform=t,n&&(r._flush=n),r})),t.exports.ctor=c((function(e,t,n){function r(t){if(!(this instanceof r))return new r(t);this.options=s(e,t),a.call(this,this.options)}return i(r,a),r.prototype._transform=t,n&&(r.prototype._flush=n),r})),t.exports.obj=c((function(e,t,n){var r=new a(s({objectMode:!0,highWaterMark:16},e));return r._transform=t,n&&(r._flush=n),r}))}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>gunzip-maybe>through2"}],[4206,{"./consumable-hash":4208,"sparse-array":5712},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("sparse-array"),i=e("./consumable-hash"),s={bits:8};class a{constructor(e,t,n){if(this._options=Object.assign({},s,e),this._popCount=0,this._parent=t,this._posAtParent=n,!this._options.hashFn)throw new Error("please define an options.hashFn");this._options.hash||(this._options.hash=i(this._options.hashFn)),this._children=new r}static isBucket(e){return e instanceof a}async put(e,t){const n=await this._findNewBucketAndPos(e);await n.bucket._putAt(n,e,t)}async get(e){const t=await this._findChild(e);if(t)return t.value}async del(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);n&&n.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof a?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)if(t instanceof a)for(const e of t.eachLeafSeries())yield e;else yield t}serialize(e,t){return t(this._children.reduce(((n,r,i)=>(r&&(r instanceof a?n.push(r.serialize(e,t)):n.push(e(r,i))),n)),[]))}async asyncTransform(e,t){return l(this,e,t)}toJSON(){return this.serialize(c,u)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);if(n&&n.key===e)return n}async _findPlace(e){const t=this._options.hash(e),n=await t.take(this._options.bits),r=this._children.get(n);return r instanceof a?r._findPlace(t):{bucket:this,pos:n,hash:t}}async _findNewBucketAndPos(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);if(n&&n.key!==e){const e=new a(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(n.hash);return r.bucket._putAt(r,n.key,n.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,n){this._putObjectAt(e.pos,{key:t,value:n,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(o);if(!(e instanceof a)){const t=e.hash;t.untake(this._options.bits);const n={pos:this._posAtParent,hash:t};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function o(e){return Boolean(e)}function c(e,t){return e.key}function u(e){return e}async function l(e,t,n){const r=[];for(const i of e._children.compactArray()){if(i instanceof a)await l(i,t,n);else{const n=await t(i);r.push({bitField:e._children.bitField(),children:n})}return n(r)}}t.exports=a}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4207,{},function(){with(this)return function(){"use strict";return function(e,t,n){const r=[255,254,252,248,240,224,192,128],i=[1,3,7,15,31,63,127,255];function s(e,t,n){const s=function(e,t){return r[e]&i[Math.min(t+e-1,7)]}(t,n);return(e&s)>>>t}t.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,n=0;for(;t&&this._haveBits();){const e=this._value[this._currentBytePos],r=this._currentBitPos+1,i=Math.min(r,t);n=(n<<i)+s(e,r-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4208,{"../../is-buffer/index.js":4558,"./consumable-buffer":4207},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("./consumable-buffer");t.exports=function(e){return function(t){return t instanceof i?t:new i(t,e)}};class i{constructor(e,t){if("string"!=typeof e&&!n.isBuffer(e))throw new Error("can only hash strings or buffers");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let n=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.availableBits(),t);n=(n<<r)+e.take(r),t-=r,this._availableBits-=r,0===e.availableBits()&&this._currentBufferIndex++}return n}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.totalBits()-e.availableBits(),t);e.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth?this._value+this._depth:this._value,t=await this._hashFn(e),n=new r(t);this._buffers.push(n),this._availableBits+=n.availableBits()}}}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4209,{"./bucket":4206},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./bucket");t.exports=function(e){return new r(e)},t.exports.isBucket=r.isBucket}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding"}],[4210,{buffer:1936,isarray:4211},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("isarray"),i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(r(t)){for(var i=0,o=t.length;i<o;i++)if(e(t[i]))return!0;return!1}if("function"==typeof n&&n.isBuffer&&n.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)&&e(t[c]))return!0;return!1}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io>has-binary2"}],[4211,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io>has-binary2>isarray"}],[4212,{},function(){with(this)return function(){"use strict";return function(e,t,n){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>has-cors"}],[4244,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,n=Object.create(null),r=Object.create(null);function i(i,s){n[i]=s,++t>=e&&(t=0,r=n,n=Object.create(null))}return{has:function(e){return n[e]!==undefined||r[e]!==undefined},remove:function(e){n[e]!==undefined&&(n[e]=undefined),r[e]!==undefined&&(r[e]=undefined)},get:function(e){var t=n[e];return t!==undefined?t:(t=r[e])!==undefined?(i(e,t),t):void 0},set:function(e,t){n[e]!==undefined?n[e]=t:i(e,t)},clear:function(){n=Object.create(null),r=Object.create(null)}}}}}},{package:"3box>ipfs>libp2p-kad-dht>hashlru"}],[4250,{"./lib/heap":4251},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e("./lib/heap")}}},{package:"3box>ipfs>libp2p-kad-dht>heap"}],[4251,{},function(){with(this)return function(){"use strict";return function(e,t,n){(function(){var e,r,i,s,a,o,c,u,l,f,h,d,p,g,b,m,w;i=Math.floor,f=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},l=function(e,t,n,s,a){var o;if(null==n&&(n=0),null==a&&(a=r),n<0)throw new Error("lo must be non-negative");for(null==s&&(s=e.length);n<s;)a(t,e[o=i((n+s)/2)])<0?s=o:n=o+1;return[].splice.apply(e,[n,n-n].concat(t)),t},o=function(e,t,n){return null==n&&(n=r),e.push(t),g(e,0,e.length-1,n)},a=function(e,t){var n,i;return null==t&&(t=r),n=e.pop(),e.length?(i=e[0],e[0]=n,b(e,0,t)):i=n,i},u=function(e,t,n){var i;return null==n&&(n=r),i=e[0],e[0]=t,b(e,0,n),i},c=function(e,t,n){var i;return null==n&&(n=r),e.length&&n(e[0],t)<0&&(t=(i=[e[0],t])[0],e[0]=i[1],b(e,0,n)),t},s=function(e,t){var n,s,a,o,c,u;for(null==t&&(t=r),o=function(){u=[];for(var t=0,n=i(e.length/2);0<=n?t<n:t>n;0<=n?t++:t--)u.push(t);return u}.apply(this).reverse(),c=[],s=0,a=o.length;s<a;s++)n=o[s],c.push(b(e,n,t));return c},p=function(e,t,n){var i;if(null==n&&(n=r),-1!==(i=e.indexOf(t)))return g(e,0,i,n),b(e,i,n)},h=function(e,t,n){var i,a,o,u,l;if(null==n&&(n=r),!(a=e.slice(0,t)).length)return a;for(s(a,n),o=0,u=(l=e.slice(t)).length;o<u;o++)i=l[o],c(a,i,n);return a.sort(n).reverse()},d=function(e,t,n){var i,o,c,u,h,d,p,g,b;if(null==n&&(n=r),10*t<=e.length){if(!(c=e.slice(0,t).sort(n)).length)return c;for(o=c[c.length-1],u=0,d=(p=e.slice(t)).length;u<d;u++)n(i=p[u],o)<0&&(l(c,i,0,null,n),c.pop(),o=c[c.length-1]);return c}for(s(e,n),b=[],h=0,g=f(t,e.length);0<=g?h<g:h>g;0<=g?++h:--h)b.push(a(e,n));return b},g=function(e,t,n,i){var s,a,o;for(null==i&&(i=r),s=e[n];n>t&&i(s,a=e[o=n-1>>1])<0;)e[n]=a,n=o;return e[n]=s},b=function(e,t,n){var i,s,a,o,c;for(null==n&&(n=r),s=e.length,c=t,a=e[t],i=2*t+1;i<s;)(o=i+1)<s&&!(n(e[i],e[o])<0)&&(i=o),e[t]=e[i],i=2*(t=i)+1;return e[t]=a,g(e,c,t,n)},e=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=o,e.pop=a,e.replace=u,e.pushpop=c,e.heapify=s,e.updateItem=p,e.nlargest=h,e.nsmallest=d,e.prototype.push=function(e){return o(this.nodes,e,this.cmp)},e.prototype.pop=function(){return a(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return c(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return s(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return p(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),m=this,w=function(){return e},"function"==typeof define&&define.amd?define([],w):"object"==typeof n?t.exports=w():m.Heap=w()}).call(this)}}},{package:"3box>ipfs>libp2p-kad-dht>heap"}],[4252,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e){(function(){
/*
 * [hi-base32]{@link https://github.com/emn178/hi-base32}
 *
 * @version 0.5.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
!function(){var n="object"==typeof window?window:{};!n.HI_BASE32_NO_NODE_JS&&"object"==typeof e&&e.versions&&e.versions.node&&(n=global);var r=!n.HI_BASE32_NO_COMMON_JS&&"object"==typeof t&&t.exports,i="function"==typeof define&&define.amd,s="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),a={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},o=[0,0,0,0,0,0,0,0],c=function(e,t){t.length>10&&(t="..."+t.substr(-10));var n=new Error("Decoded data is not valid UTF-8."+" Maybe try base32.decode.asBytes()?"+" Partial data after reading "+e+" bytes: "+t+" <-");throw n.position=e,n},u=function(e){if(!/^[A-Z2-7=]+$/.test(e))throw new Error("Invalid base32 characters");for(var t,n,r,i,s,o,c,u,l=[],f=0,h=(e=e.replace(/=/g,"")).length,d=0,p=h>>3<<3;d<p;)t=a[e.charAt(d++)],n=a[e.charAt(d++)],r=a[e.charAt(d++)],i=a[e.charAt(d++)],s=a[e.charAt(d++)],o=a[e.charAt(d++)],c=a[e.charAt(d++)],u=a[e.charAt(d++)],l[f++]=255&(t<<3|n>>>2),l[f++]=255&(n<<6|r<<1|i>>>4),l[f++]=255&(i<<4|s>>>1),l[f++]=255&(s<<7|o<<2|c>>>3),l[f++]=255&(c<<5|u);var g=h-p;return 2===g?(t=a[e.charAt(d++)],n=a[e.charAt(d++)],l[f++]=255&(t<<3|n>>>2)):4===g?(t=a[e.charAt(d++)],n=a[e.charAt(d++)],r=a[e.charAt(d++)],i=a[e.charAt(d++)],l[f++]=255&(t<<3|n>>>2),l[f++]=255&(n<<6|r<<1|i>>>4)):5===g?(t=a[e.charAt(d++)],n=a[e.charAt(d++)],r=a[e.charAt(d++)],i=a[e.charAt(d++)],s=a[e.charAt(d++)],l[f++]=255&(t<<3|n>>>2),l[f++]=255&(n<<6|r<<1|i>>>4),l[f++]=255&(i<<4|s>>>1)):7===g&&(t=a[e.charAt(d++)],n=a[e.charAt(d++)],r=a[e.charAt(d++)],i=a[e.charAt(d++)],s=a[e.charAt(d++)],o=a[e.charAt(d++)],c=a[e.charAt(d++)],l[f++]=255&(t<<3|n>>>2),l[f++]=255&(n<<6|r<<1|i>>>4),l[f++]=255&(i<<4|s>>>1),l[f++]=255&(s<<7|o<<2|c>>>3)),l},l=function(e,t){if(!t)return function(e){for(var t,n,r="",i=e.length,s=0,a=0;s<i;)if((t=e[s++])<=127)r+=String.fromCharCode(t);else{t>191&&t<=223?(n=31&t,a=1):t<=239?(n=15&t,a=2):t<=247?(n=7&t,a=3):c(s,r);for(var o=0;o<a;++o)((t=e[s++])<128||t>191)&&c(s,r),n<<=6,n+=63&t;n>=55296&&n<=57343&&c(s,r),n>1114111&&c(s,r),n<=65535?r+=String.fromCharCode(n):(n-=65536,r+=String.fromCharCode(55296+(n>>10)),r+=String.fromCharCode(56320+(1023&n)))}return r}(u(e));if(!/^[A-Z2-7=]+$/.test(e))throw new Error("Invalid base32 characters");var n,r,i,s,o,l,f,h,d="",p=e.indexOf("=");-1===p&&(p=e.length);for(var g=0,b=p>>3<<3;g<b;)n=a[e.charAt(g++)],r=a[e.charAt(g++)],i=a[e.charAt(g++)],s=a[e.charAt(g++)],o=a[e.charAt(g++)],l=a[e.charAt(g++)],f=a[e.charAt(g++)],h=a[e.charAt(g++)],d+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|i<<1|s>>>4))+String.fromCharCode(255&(s<<4|o>>>1))+String.fromCharCode(255&(o<<7|l<<2|f>>>3))+String.fromCharCode(255&(f<<5|h));var m=p-b;return 2===m?(n=a[e.charAt(g++)],r=a[e.charAt(g++)],d+=String.fromCharCode(255&(n<<3|r>>>2))):4===m?(n=a[e.charAt(g++)],r=a[e.charAt(g++)],i=a[e.charAt(g++)],s=a[e.charAt(g++)],d+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|i<<1|s>>>4))):5===m?(n=a[e.charAt(g++)],r=a[e.charAt(g++)],i=a[e.charAt(g++)],s=a[e.charAt(g++)],o=a[e.charAt(g++)],d+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|i<<1|s>>>4))+String.fromCharCode(255&(s<<4|o>>>1))):7===m&&(n=a[e.charAt(g++)],r=a[e.charAt(g++)],i=a[e.charAt(g++)],s=a[e.charAt(g++)],o=a[e.charAt(g++)],l=a[e.charAt(g++)],f=a[e.charAt(g++)],d+=String.fromCharCode(255&(n<<3|r>>>2))+String.fromCharCode(255&(r<<6|i<<1|s>>>4))+String.fromCharCode(255&(s<<4|o>>>1))+String.fromCharCode(255&(o<<7|l<<2|f>>>3))),d},f={encode:function(e,t){var n="string"!=typeof e;return n&&e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),n?function(e){for(var t,n,r,i,a,o="",c=e.length,u=0,l=5*parseInt(c/5);u<l;)t=e[u++],n=e[u++],r=e[u++],i=e[u++],a=e[u++],o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[31&(i<<3|a>>>5)]+s[31&a];var f=c-l;return 1===f?(t=e[u],o+=s[t>>>3]+s[t<<2&31]+"======"):2===f?(t=e[u++],n=e[u],o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[n<<4&31]+"===="):3===f?(t=e[u++],n=e[u++],r=e[u],o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[r<<1&31]+"==="):4===f&&(t=e[u++],n=e[u++],r=e[u++],i=e[u],o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[i<<3&31]+"="),o}(e):t?function(e){for(var t,n,r,i,a,o="",c=e.length,u=0,l=5*parseInt(c/5);u<l;)t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),i=e.charCodeAt(u++),a=e.charCodeAt(u++),o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[31&(i<<3|a>>>5)]+s[31&a];var f=c-l;return 1===f?(t=e.charCodeAt(u),o+=s[t>>>3]+s[t<<2&31]+"======"):2===f?(t=e.charCodeAt(u++),n=e.charCodeAt(u),o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[n<<4&31]+"===="):3===f?(t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u),o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[r<<1&31]+"==="):4===f&&(t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),i=e.charCodeAt(u),o+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[i<<3&31]+"="),o}(e):function(e){var t,n,r,i,a,c,u,l=!1,f="",h=0,d=0,p=e.length;do{for(o[0]=o[5],o[1]=o[6],o[2]=o[7],u=d;h<p&&u<5;++h)(c=e.charCodeAt(h))<128?o[u++]=c:c<2048?(o[u++]=192|c>>6,o[u++]=128|63&c):c<55296||c>=57344?(o[u++]=224|c>>12,o[u++]=128|c>>6&63,o[u++]=128|63&c):(c=65536+((1023&c)<<10|1023&e.charCodeAt(++h)),o[u++]=240|c>>18,o[u++]=128|c>>12&63,o[u++]=128|c>>6&63,o[u++]=128|63&c);d=u-5,h===p&&++h,h>p&&u<6&&(l=!0),t=o[0],u>4?(n=o[1],r=o[2],i=o[3],a=o[4],f+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[31&(i<<3|a>>>5)]+s[31&a]):1===u?f+=s[t>>>3]+s[t<<2&31]+"======":2===u?(n=o[1],f+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[n<<4&31]+"===="):3===u?(n=o[1],r=o[2],f+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[r<<1&31]+"==="):(n=o[1],r=o[2],i=o[3],f+=s[t>>>3]+s[31&(t<<2|n>>>6)]+s[n>>>1&31]+s[31&(n<<4|r>>>4)]+s[31&(r<<1|i>>>7)]+s[i>>>2&31]+s[i<<3&31]+"=")}while(!l);return f}(e)},decode:l};l.asBytes=u,r?t.exports=f:(n.base32=f,i&&define((function(){return f})))}()}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>multiaddr>hi-base32"}],[4256,{"did-resolver":2129,xmlhttprequest:1935},function(){with(this)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,o)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("did-resolver");function a(t){return new Promise((function(n,r){var i=new("undefined"!=typeof window?window.XMLHttpRequest:e("xmlhttprequest").XMLHttpRequest);i.open("GET",t),i.onreadystatechange=function(){i&&4===i.readyState&&(200===i.status?n(i.responseText):r(new Error(("Invalid http response status "+i.status+" "+i.responseText).trim())))},i.setRequestHeader("accept","application/json"),i.send()}))}n.default=function(){s.registerMethod("https",(function(e,t){return r(this,void 0,void 0,(function(){var n,r,s,o;return i(this,(function(i){switch(i.label){case 0:n="https://"+t.id+"/.well-known/did.json",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a(n)];case 2:return r=i.sent(),[3,4];case 3:throw s=i.sent(),new Error("DID must resolve to a valid https URL: "+s.message);case 4:o=null;try{o=JSON.parse(r)}catch(e){throw new Error("DID must resolve to a JSON document")}if(!("https://w3id.org/did/v1"===o["@context"]))throw new Error("DID document missing context");if(!(o.id===e))throw new Error("DID document id does not match requested did");if(!(Array.isArray(o.publicKey)&&o.publicKey.length>0))throw new Error("DID document has no public keys");return[2,o]}}))}))}))}}}},{package:"3box>https-did-resolver"}],[4258,{"promisify-es6":5265},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("promisify-es6"),i=/^((\d+(\.\d+)*)(ns|ms|us|µs|m|s|h))+$/,s=/((\d+(\.\d+)*)(ns|ms|us|µs|m|s|h))/g,a=/(ns|ms|us|µs|m|s|h)/g,o={ns:1e-6,us:.001,"µs":.001,ms:1,s:1e3,m:6e4,h:36e5};t.exports=r((function(e,t){return"string"!=typeof e?t(new Error("the first argument must be a string")):i.test(e)?void t(null,e.match(s).reduce(((e,t)=>e+function(e){let t=e.match(a)[0];return e=e.substring(0,e.length-t.length),parseFloat(e)*o[t]}(t)),0)):t(new Error("invalid time"))}))}}},{package:"3box>ipfs>human-to-milliseconds"}],[4260,{stream:1939,xtend:6010},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("stream"),i=e("xtend");t.exports=function(e,t,n){if("object"!=typeof e)throw new TypeError("db must be an object");if("string"!=typeof t)throw new TypeError("storeName must be a string");if(null==n&&(n={}),"object"!=typeof n)throw new TypeError("opts must be an object");var s=new r.Transform(i(n,{objectMode:!0,transform:function(e,t,n){n(null,e)}}));n=i({snapshot:!1},n);var a=null;return s._cursorsOpened=0,function r(){var i,o,c,u,l,f=n.direction||"next",h=n.range||{};i=h.lower,o=h.upper,c=!!h.lowerOpen,u=!!h.upperOpen,a&&("next"===f?(c=!0,i=a):(u=!0,o=a)),i&&o?l=IDBKeyRange.bound(i,o,c,u):i?l=IDBKeyRange.lowerBound(i,c):o&&(l=IDBKeyRange.upperBound(o,u));var d=e.transaction(t,"readonly"),p=d.objectStore(t);s._cursorsOpened++;var g=p.openCursor(l,n.direction);function b(e){try{e.continue()}catch(e){"TransactionInactiveError"!==e.name||n.snapshot?s.emit("error",e):r()}}g.onsuccess=function(){var e=g.result;if(e){a=e.key;var t=s.write({key:e.key,value:e.value});n.snapshot||t?b(e):s.once("drain",(function(){b(e)}))}else s.end()},d.onabort=function(){s.emit("error",d.error)},d.onerror=function(){s.emit("error",d.error)}}(),s}}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>idb-readable-stream"}],[4266,{"./messageChannel":4267,"./mutation.js":4268,"./nextTick":4269,"./stateChange":4270,"./timeout":4271},function(){with(this)return function(){"use strict";return function(e,t,n){var r,i,s,a=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],o=-1,c=[],u=!1;function l(){r&&i&&(r=!1,i.length?c=i.concat(c):o=-1,c.length&&f())}function f(){if(!r){u=!1,r=!0;for(var e=c.length,t=setTimeout(l);e;){for(i=c,c=[];i&&++o<e;)i[o].run();o=-1,e=c.length}i=null,o=-1,r=!1,clearTimeout(t)}}for(var h=-1,d=a.length;++h<d;)if(a[h]&&a[h].test&&a[h].test()){s=a[h].install(f);break}function p(e,t){this.fun=e,this.array=t}p.prototype.run=function(){var e=this.fun,t=this.array;switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);default:return e.apply(null,t)}},t.exports=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),u||r||(u=!0,s())}}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4267,{},function(){with(this)return function(){"use strict";return function(e,t,n){n.test=function(){return!global.setImmediate&&void 0!==global.MessageChannel},n.install=function(e){var t=new global.MessageChannel;return t.port1.onmessage=e,function(){t.port2.postMessage(0)}}}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4268,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r=global.MutationObserver||global.WebKitMutationObserver;n.test=function(){return r},n.install=function(e){var t=0,n=new r(e),i=global.document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4269,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e){(function(){n.test=function(){return void 0!==e&&!e.browser},n.install=function(t){return function(){e.nextTick(t)}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4270,{},function(){with(this)return function(){"use strict";return function(e,t,n){n.test=function(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")},n.install=function(e){return function(){var t=global.document.createElement("script");return t.onreadystatechange=function(){e(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},global.document.documentElement.appendChild(t),e}}}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4271,{},function(){with(this)return function(){"use strict";return function(e,t,n){n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}}}},{package:"3box>orbit-db>orbit-db-cache>level-js>immediate"}],[4275,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>indexof"}],[4277,{"pull-defer/duplex":5292},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("pull-defer/duplex");t.exports=class{constructor(e,t){this.peerInfo=null,this.conn=r(),e?this.setInnerConn(e,t):t&&(this.info=t)}get source(){return this.conn.source}get sink(){return this.conn.sink}getPeerInfo(e){return this.info&&this.info.getPeerInfo?this.info.getPeerInfo(e):this.peerInfo?void e(null,this.peerInfo):e(new Error("Peer Info not set yet"))}setPeerInfo(e){if(this.info&&this.info.setPeerInfo)return this.info.setPeerInfo(e);this.peerInfo=e}getObservedAddrs(e){if(this.info&&this.info.getObservedAddrs)return this.info.getObservedAddrs(e);e(null,[])}setInnerConn(e,t){this.conn.resolve(e),this.info=t||e}}}}},{package:"3box>ipfs>pull-mplex>interface-connection"}],[4278,{"./connection":4277},function(){with(this)return function(){"use strict";return function(e,t,n){n.Connection=e("./connection")}}},{package:"3box>ipfs>pull-mplex>interface-connection"}],[4279,{},function(){with(this)return function(){"use strict";return function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}}}},{package:"3box>ipfs>interface-datastore>uuid"}],[4280,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"3box>ipfs>interface-datastore>uuid"}],[4281,{"./lib/bytesToUuid":4279,"./lib/rng":4280},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||i(a)}}}},{package:"3box>ipfs>interface-datastore>uuid"}],[4282,{"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code");t.exports.dbOpenFailedError=e=>(e=e||new Error("Cannot open database"),r(e,"ERR_DB_OPEN_FAILED")),t.exports.dbDeleteFailedError=e=>(e=e||new Error("Delete failed"),r(e,"ERR_DB_DELETE_FAILED")),t.exports.dbWriteFailedError=e=>(e=e||new Error("Write failed"),r(e,"ERR_DB_WRITE_FAILED")),t.exports.notFoundError=e=>(e=e||new Error("Not Found"),r(e,"ERR_NOT_FOUND"))}}},{package:"3box>ipfs>interface-datastore"}],[4283,{"./errors":4282,"./key":4284,"./memory":4285,"./utils":4286},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./key"),i=e("./memory"),s=e("./utils"),a=e("./errors");n.Key=r,n.MemoryDatastore=i,n.utils=s,n.Errors=a}}},{package:"3box>ipfs>interface-datastore"}],[4284,{buffer:1936,"class-is":1975,"uuid/v4":4281},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("uuid/v4"),i=e("class-is"),s="/",a=n.from(s),o=a[0];class c{constructor(e,t){if("string"==typeof e?this._buf=n.from(e):n.isBuffer(e)&&(this._buf=e),null==t&&(t=!0),t&&this.clean(),0===this._buf.length||this._buf[0]!==o)throw new Error(`Invalid key: ${this.toString()}`)}toString(e){return this._buf.toString(e||"utf8")}toBuffer(){return this._buf}get[Symbol.toStringTag](){return`[Key ${this.toString()}]`}static withNamespaces(e){return new u(e.join(s))}static random(){return new u(r().replace(/-/g,""))}clean(){for(this._buf&&0!==this._buf.length||(this._buf=n.from(s)),this._buf[0]!==o&&(this._buf=n.concat([a,this._buf]));this._buf.length>1&&this._buf[this._buf.length-1]===o;)this._buf=this._buf.slice(0,-1)}less(e){const t=this.list(),n=e.list();for(let e=0;e<t.length;e++){if(n.length<e+1)return!1;const r=t[e],i=n[e];if(r<i)return!0;if(r>i)return!1}return t.length<n.length}reverse(){return c.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(s).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new u(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(s)||(e+=s),e+=this.type(),new u(e)}parent(){const e=this.list();return 1===e.length?new u(s):new u(e.slice(0,-1).join(s))}child(e){return this.toString()===s?e:e.toString()===s?this:new u(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}}const u=i(c,{className:"Key",symbolName:"@ipfs/interface-datastore/key"});t.exports=u}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>interface-datastore"}],[4285,{"./errors":4282,"./key":4284,"./utils":4286,"async/setImmediate":1637,"pull-stream":5318},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("pull-stream"),i=e("async/setImmediate"),s=e("./utils").asyncFilter,a=e("./utils").asyncSort,o=e("./key"),c=e("./errors");t.exports=class{constructor(){this.data={}}open(e){i(e)}put(e,t,n){this.data[e.toString()]=t,i(n)}get(e,t){this.has(e,((n,r)=>n?t(n):r?void t(null,this.data[e.toString()]):t(c.notFoundError())))}has(e,t){i((()=>{t(null,this.data[e.toString()]!==undefined)}))}delete(e,t){delete this.data[e.toString()],i((()=>{t()}))}batch(){let e=[],t=[];return{put(t,n){e.push([t,n])},delete(e){t.push(e)},commit:n=>{e.forEach((e=>{this.data[e[0].toString()]=e[1]})),e=[],t.forEach((e=>{delete this.data[e.toString()]})),t=[],i(n)}}}query(e){let t=[r.keys(this.data),r.map((e=>({key:new o(e),value:this.data[e]})))],n=[];if(null!=e.prefix){const t=e.prefix;n.push(((e,n)=>n(null,e.key.toString().startsWith(t))))}if(null!=e.filters&&(n=n.concat(e.filters)),t=t.concat(n.map((e=>s(e)))),null!=e.orders&&(t=t.concat(e.orders.map((e=>a(e))))),null!=e.offset){let n=0;t.push(r.filter((()=>n++>=e.offset)))}return null!=e.limit&&t.push(r.take(e.limit)),!0===e.keysOnly&&t.push(r.map((e=>({key:e.key})))),r.apply(null,t)}close(e){i(e)}}}}},{package:"3box>ipfs>interface-datastore"}],[4286,{os:5204,path:5237,"pull-defer/source":5295,"pull-stream":5318,"uuid/v4":4281},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("pull-stream"),i=e("pull-defer/source"),s=e("path"),a=e("os"),o=e("uuid/v4");n.asyncFilter=function(e){let t,n,r=!1;return function(i){return function s(a,o){if(n)return o(n);a?(n=a,i(a,r?()=>{r?t=o:o(a)}:o)):i(null,((i,a)=>{i?o(i):n?o(n):(r=!0,e(a,((e,i)=>{r=!1,n?(o(n),t(n)):e?s(e,o):i?o(null,a):s(null,o)})))}))}}},n.asyncSort=function(e){const t=i(),n=r.collect(((n,i)=>{if(n)return t.abort(n);e(i,((e,n)=>{if(e)return t.abort(e);t.resolve(r.values(i))}))}));return function(e){return n(e),t}},n.replaceStartWith=function(e,t){const n=new RegExp("^"+t);return e.replace(n,"")},n.tmpdir=()=>s.join(a.tmpdir(),o())}}},{package:"3box>ipfs>interface-datastore"}],[4288,{},function(){with(this)return function(){"use strict";return function(e,t,n){const r="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}",i="[0-9a-fA-F]{1,4}",s=`\n(\n(?:${i}:){7}(?:${i}|:)|                                // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${i}:){6}(?:${r}|:${i}|:)|                         // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${i}:){5}(?::${r}|(:${i}){1,2}|:)|                 // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${i}:){4}(?:(:${i}){0,1}:${r}|(:${i}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${i}:){3}(?:(:${i}){0,2}:${r}|(:${i}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${i}:){2}(?:(:${i}){0,3}:${r}|(:${i}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${i}:){1}(?:(:${i}){0,4}:${r}|(:${i}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::((?::${i}){0,5}:${r}|(?::${i}){1,7}|:))           // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(%[0-9a-zA-Z]{1,})?                                           // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=t.exports=e=>e&&e.exact?new RegExp(`(?:^${r}$)|(?:^${s}$)`):new RegExp(`(?:${r})|(?:${s})`,"g");a.v4=e=>e&&e.exact?new RegExp(`^${r}$`):new RegExp(r,"g"),a.v6=e=>e&&e.exact?new RegExp(`^${s}$`):new RegExp(s,"g")}}},{package:"chromedriver>tcp-port-used>is2>ip-regex"}],[4289,{buffer:1936,os:5204},function(){with(this)return function(){"use strict";return function(e,t,n){var r=n,i=e("buffer").Buffer,s=e("os");r.toBuffer=function(e,t,n){var r;if(n=~~n,this.isV4Format(e))r=t||new i(n+4),e.split(/\./g).map((function(e){r[n++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){var s,a=e.split(":",8);for(s=0;s<a.length;s++){var o;this.isV4Format(a[s])&&(o=this.toBuffer(a[s]),a[s]=o.slice(0,2).toString("hex")),o&&++s<8&&a.splice(s,0,o.slice(2,4).toString("hex"))}if(""===a[0])for(;a.length<8;)a.unshift("0");else if(""===a[a.length-1])for(;a.length<8;)a.push("0");else if(a.length<8){for(s=0;s<a.length&&""!==a[s];s++);var c=[s,1];for(s=9-a.length;s>0;s--)c.push("0");a.splice.apply(a,c)}for(r=t||new i(n+16),s=0;s<a.length;s++){var u=parseInt(a[s],16);r[n++]=u>>8&255,r[n++]=255&u}}if(!r)throw Error("Invalid ip address: "+e);return r},r.toString=function(e,t,n){t=~~t;var r=[];if(4===(n=n||e.length-t)){for(var i=0;i<n;i++)r.push(e[t+i]);r=r.join(".")}else if(16===n){for(i=0;i<n;i+=2)r.push(e.readUInt16BE(t+i).toString(16));r=(r=(r=r.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return r};var a=/^(\d{1,3}\.){3,3}\d{1,3}$/,o=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function c(e){return e?e.toLowerCase():"ipv4"}r.isV4Format=function(e){return a.test(e)},r.isV6Format=function(e){return o.test(e)},r.fromPrefixLen=function(e,t){var n=4;"ipv6"===(t=e>32?"ipv6":c(t))&&(n=16);for(var s=new i(n),a=0,o=s.length;a<o;++a){var u=8;e<8&&(u=e),e-=u,s[a]=255&~(255>>u)}return r.toString(s)},r.mask=function(e,t){e=r.toBuffer(e),t=r.toBuffer(t);var n=new i(Math.max(e.length,t.length)),s=0;if(e.length===t.length)for(s=0;s<e.length;s++)n[s]=e[s]&t[s];else if(4===t.length)for(s=0;s<t.length;s++)n[s]=e[e.length-4+s]&t[s];else{for(s=0;s<n.length-6;s++)n[s]=0;for(n[10]=255,n[11]=255,s=0;s<e.length;s++)n[s+12]=e[s]&t[s+12];s+=12}for(;s<n.length;s++)n[s]=0;return r.toString(n)},r.cidr=function(e){var t=e.split("/"),n=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: "+n);var i=r.fromPrefixLen(parseInt(t[1],10));return r.mask(n,i)},r.subnet=function(e,t){for(var n=r.toLong(r.mask(e,t)),i=r.toBuffer(t),s=0,a=0;a<i.length;a++)if(255===i[a])s+=8;else for(var o=255&i[a];o;)o=o<<1&255,s++;var c=Math.pow(2,32-s);return{networkAddress:r.fromLong(n),firstAddress:c<=2?r.fromLong(n):r.fromLong(n+1),lastAddress:c<=2?r.fromLong(n+c-1):r.fromLong(n+c-2),broadcastAddress:r.fromLong(n+c-1),subnetMask:t,subnetMaskLength:s,numHosts:c<=2?c:c-2,length:c,contains:function(e){return n===r.toLong(r.mask(e,t))}}},r.cidrSubnet=function(e){var t=e.split("/"),n=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: "+n);var i=r.fromPrefixLen(parseInt(t[1],10));return r.subnet(n,i)},r.not=function(e){for(var t=r.toBuffer(e),n=0;n<t.length;n++)t[n]=255^t[n];return r.toString(t)},r.or=function(e,t){if(e=r.toBuffer(e),t=r.toBuffer(t),e.length===t.length){for(var n=0;n<e.length;++n)e[n]|=t[n];return r.toString(e)}var i=e,s=t;t.length>e.length&&(i=t,s=e);var a=i.length-s.length;for(n=a;n<i.length;++n)i[n]|=s[n-a];return r.toString(i)},r.isEqual=function(e,t){if(e=r.toBuffer(e),t=r.toBuffer(t),e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if(4===t.length){var i=t;t=e,e=i}for(n=0;n<10;n++)if(0!==t[n])return!1;var s=t.readUInt16BE(10);if(0!==s&&65535!==s)return!1;for(n=0;n<4;n++)if(e[n]!==t[n+12])return!1;return!0},r.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},r.isPublic=function(e){return!r.isPrivate(e)},r.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},r.loopback=function(e){if("ipv4"!==(e=c(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},r.address=function(e,t){var n,i=s.networkInterfaces();if(t=c(t),e&&"private"!==e&&"public"!==e){var a=i[e].filter((function(e){return e.family.toLowerCase()===t}));return 0===a.length?undefined:a[0].address}return(n=Object.keys(i).map((function(n){var s=i[n].filter((function(n){return n.family=n.family.toLowerCase(),n.family===t&&!r.isLoopback(n.address)&&(!e||("public"===e?r.isPrivate(n.address):r.isPublic(n.address)))}));return s.length?s[0].address:undefined})).filter(Boolean)).length?n[0]:r.loopback(t)},r.toLong=function(e){var t=0;return e.split(".").forEach((function(e){t<<=8,t+=parseInt(e)})),t>>>0},r.fromLong=function(e){return(e>>>24)+"."+(e>>16&255)+"."+(e>>8&255)+"."+(255&e)}}}},{package:"react-devtools>ip"}],[4290,{},function(){with(this)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,s=Math.ceil,a=Math.floor,o="[BigNumber Error] ",c=o+"Number primitive has more than 15 significant digits: ",u=1e14,l=14,f=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,p=1e9;function g(e){var t=0|e;return e>0||e===t?t:t-1}function b(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function m(e,t){var n,r,i=e.c,s=t.c,a=e.s,o=t.s,c=e.e,u=t.e;if(!a||!o)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-o:a;if(a!=o)return a;if(n=a<0,r=c==u,!i||!s)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(o=(c=i.length)<(u=s.length)?c:u,a=0;a<o;a++)if(i[a]!=s[a])return i[a]>s[a]^n?1:-1;return c==u?0:c>u^n?1:-1}function w(e,t,n,r){if(e<t||e>n||e!==a(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function y(e){var t=e.c.length-1;return g(e.e/l)==t&&e.c[t]%2!=0}function _(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,k,E,x,S,A,R,T,N,I,O=q.prototype={constructor:q,toString:null,valueOf:null},P=new q(1),L=20,D=4,C=-7,B=21,M=-1e7,j=1e7,U=!1,z=1,F=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz";function q(e,t){var n,i,s,o,u,h,d,p,g=this;if(!(g instanceof q))return new q(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>j?g.c=g.e=null:e.e<M?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,u=e;u>=10;u/=10,o++);return void(o>j?g.c=g.e=null:(g.e=o,g.c=[e]))}p=String(e)}else{if(!r.test(p=String(e)))return E(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(o=p.indexOf("."))>-1&&(p=p.replace(".","")),(u=p.search(/e/i))>0?(o<0&&(o=u),o+=+p.slice(u+1),p=p.substring(0,u)):o<0&&(o=p.length)}else{if(w(t,2,H.length,"Base"),10==t)return K(g=new q(e),L+g.e+1,D);if(p=String(e),h="number"==typeof e){if(0*e!=0)return E(g,p,h,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,q.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(c+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=H.slice(0,t),o=u=0,d=p.length;u<d;u++)if(n.indexOf(i=p.charAt(u))<0){if("."==i){if(u>o){o=d;continue}}else if(!s&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){s=!0,u=-1,o=0;continue}return E(g,String(e),h,t)}h=!1,(o=(p=k(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):o=p.length}for(u=0;48===p.charCodeAt(u);u++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(u,++d)){if(d-=u,h&&q.DEBUG&&d>15&&(e>f||e!==a(e)))throw Error(c+g.s*e);if((o=o-u-1)>j)g.c=g.e=null;else if(o<M)g.c=[g.e=0];else{if(g.e=o,g.c=[],u=(o+1)%l,o<0&&(u+=l),u<d){for(u&&g.c.push(+p.slice(0,u)),d-=l;u<d;)g.c.push(+p.slice(u,u+=l));u=l-(p=p.slice(u)).length}else u-=d;for(;u--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function W(e,t,n,r){var i,s,a,o,c;if(null==n?n=D:w(n,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)c=b(e.c),c=1==r||2==r&&(a<=C||a>=B)?_(c,a):v(c,a,"0");else if(s=(e=K(new q(e),t,n)).e,o=(c=b(e.c)).length,1==r||2==r&&(t<=s||s<=C)){for(;o<t;c+="0",o++);c=_(c,s)}else if(t-=a,c=v(c,s,"0"),s+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-o)>0)for(s+1==o&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function G(e,t){for(var n,r=1,i=new q(e[0]);r<e.length;r++){if(!(n=new q(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function V(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>j?e.c=e.e=null:n<M?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,r){var i,o,c,f,d,p,g,b=e.c,m=h;if(b){e:{for(i=1,f=b[0];f>=10;f/=10,i++);if((o=t-i)<0)o+=l,c=t,g=(d=b[p=0])/m[i-c-1]%10|0;else if((p=s((o+1)/l))>=b.length){if(!r)break e;for(;b.length<=p;b.push(0));d=g=0,i=1,c=(o%=l)-l+1}else{for(d=f=b[p],i=1;f>=10;f/=10,i++);g=(c=(o%=l)-l+i)<0?0:d/m[i-c-1]%10|0}if(r=r||t<0||null!=b[p+1]||(c<0?d:d%m[i-c-1]),r=n<4?(g||r)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||r||6==n&&(o>0?c>0?d/m[i-c]:0:b[p-1])%10&1||n==(e.s<0?8:7)),t<1||!b[0])return b.length=0,r?(t-=e.e+1,b[0]=m[(l-t%l)%l],e.e=-t||0):b[0]=e.e=0,e;if(0==o?(b.length=p,f=1,p--):(b.length=p+1,f=m[l-o],b[p]=c>0?a(d/m[i-c]%m[c])*f:0),r)for(;;){if(0==p){for(o=1,c=b[0];c>=10;c/=10,o++);for(c=b[0]+=f,f=1;c>=10;c/=10,f++);o!=f&&(e.e++,b[0]==u&&(b[0]=1));break}if(b[p]+=f,b[p]!=u)break;b[p--]=0,f=1}for(o=b.length;0===b[--o];b.pop());}e.e>j?e.c=e.e=null:e.e<M&&(e.c=[e.e=0])}return e}function Z(e){var t,n=e.e;return null===n?e.toString():(t=b(e.c),t=n<=C||n>=B?_(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return q.clone=e,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(w(n=e[t],0,p,t),L=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(w(n=e[t],0,8,t),D=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(w(n[0],-p,0,t),w(n[1],0,p,t),C=n[0],B=n[1]):(w(n,-p,p,t),C=-(B=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)w(n[0],-p,-1,t),w(n[1],1,p,t),M=n[0],j=n[1];else{if(w(n,-p,p,t),!n)throw Error(o+t+" cannot be zero: "+n);M=-(j=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw U=!n,Error(o+"crypto unavailable");U=n}else U=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(w(n=e[t],0,9,t),z=n),e.hasOwnProperty(t="POW_PRECISION")&&(w(n=e[t],0,p,t),F=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);$=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);H=n}}return{DECIMAL_PLACES:L,ROUNDING_MODE:D,EXPONENTIAL_AT:[C,B],RANGE:[M,j],CRYPTO:U,MODULO_MODE:z,POW_PRECISION:F,FORMAT:$,ALPHABET:H}},q.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!q.DEBUG)return!0;var t,n,r=e.c,i=e.e,s=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===s||-1===s)&&i>=-p&&i<=p&&i===a(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=u||n!==a(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(o+"Invalid BigNumber: "+e)},q.maximum=q.max=function(){return G(arguments,O.lt)},q.minimum=q.min=function(){return G(arguments,O.gt)},q.random=(x=9007199254740992,S=Math.random()*x&2097151?function(){return a(Math.random()*x)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,c,u=0,f=[],d=new q(P);if(null==e?e=L:w(e,0,p),i=s(e/l),U)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));u<i;)(c=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(f.push(c%1e14),u+=2);u=i/2}else{if(!crypto.randomBytes)throw U=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(i*=7);u<i;)(c=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(f.push(c%1e14),u+=7);u=i/7}if(!U)for(;u<i;)(c=S())<9e15&&(f[u++]=c%1e14);for(i=f[--u],e%=l,i&&e&&(c=h[l-e],f[u]=a(i/c)*c);0===f[u];f.pop(),u--);if(u<0)f=[r=0];else{for(r=-1;0===f[0];f.splice(0,1),r-=l);for(u=1,c=f[0];c>=10;c/=10,u++);u<l&&(r-=l-u)}return d.e=r,d.c=f,d}),q.sum=function(){for(var e=1,t=arguments,n=new q(t[0]);e<t.length;)n=n.plus(t[e++]);return n},k=function(){var e="0123456789";function t(e,t,n,r){for(var i,s,a=[0],o=0,c=e.length;o<c;){for(s=a.length;s--;a[s]*=t);for(a[0]+=r.indexOf(e.charAt(o++)),i=0;i<a.length;i++)a[i]>n-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/n|0,a[i]%=n)}return a.reverse()}return function(r,i,s,a,o){var c,u,l,f,h,d,p,g,m=r.indexOf("."),w=L,y=D;for(m>=0&&(f=F,F=0,r=r.replace(".",""),d=(g=new q(i)).pow(r.length-m),F=f,g.c=t(v(b(d.c),d.e,"0"),10,s,e),g.e=g.c.length),l=f=(p=t(r,i,s,o?(c=H,e):(c=e,H))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(m<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=n(d,g,w,y,s)).c,h=d.r,l=d.e),m=p[u=l+w+1],f=s/2,h=h||u<0||null!=p[u+1],h=y<4?(null!=m||h)&&(0==y||y==(d.s<0?3:2)):m>f||m==f&&(4==y||h||6==y&&1&p[u-1]||y==(d.s<0?8:7)),u<1||!p[0])r=h?v(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,h)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(m=0,r="";m<=f;r+=c.charAt(p[m++]));r=v(r,l,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,s,a,o=0,c=e.length,u=t%d,l=t/d|0;for(e=e.slice();c--;)o=((i=u*(s=e[c]%d)+(r=l*s+(a=e[c]/d|0)*u)%d*d+o)/n|0)+(r/d|0)+l*a,e[c]=i%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,s,o,c){var f,h,d,p,b,m,w,y,_,v,k,E,x,S,A,R,T,N=r.s==i.s?1:-1,I=r.c,O=i.c;if(!(I&&I[0]&&O&&O[0]))return new q(r.s&&i.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*N:N/0:NaN);for(_=(y=new q(N)).c=[],N=s+(h=r.e-i.e)+1,c||(c=u,h=g(r.e/l)-g(i.e/l),N=N/l|0),d=0;O[d]==(I[d]||0);d++);if(O[d]>(I[d]||0)&&h--,N<0)_.push(1),p=!0;else{for(S=I.length,R=O.length,d=0,N+=2,(b=a(c/(O[0]+1)))>1&&(O=e(O,b,c),I=e(I,b,c),R=O.length,S=I.length),x=R,k=(v=I.slice(0,R)).length;k<R;v[k++]=0);T=O.slice(),T=[0].concat(T),A=O[0],O[1]>=c/2&&A++;do{if(b=0,(f=t(O,v,R,k))<0){if(E=v[0],R!=k&&(E=E*c+(v[1]||0)),(b=a(E/A))>1)for(b>=c&&(b=c-1),w=(m=e(O,b,c)).length,k=v.length;1==t(m,v,w,k);)b--,n(m,R<w?T:O,w,c),w=m.length,f=1;else 0==b&&(f=b=1),w=(m=O.slice()).length;if(w<k&&(m=[0].concat(m)),n(v,m,k,c),k=v.length,-1==f)for(;t(O,v,R,k)<1;)b++,n(v,R<k?T:O,k,c),k=v.length}else 0===f&&(b++,v=[0]);_[d++]=b,v[0]?v[k++]=I[x]||0:(v=[I[x]],k=1)}while((x++<S||null!=v[0])&&N--);p=null!=v[0],_[0]||_.splice(0,1)}if(c==u){for(d=1,N=_[0];N>=10;N/=10,d++);K(y,s+(y.e=d+h*l-1)+1,o,p)}else y.e=h,y.r=+p;return y}}(),A=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,T=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(e,t,n,r){var i,s=n?t:t.replace(I,"");if(N.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(A,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(R,"$1").replace(T,"0.$1")),t!=s))return new q(s,i);if(q.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},O.absoluteValue=O.abs=function(){var e=new q(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return m(this,new q(e,t))},O.decimalPlaces=O.dp=function(e,t){var n,r,i,s=this;if(null!=e)return w(e,0,p),null==t?t=D:w(t,0,8),K(new q(s),e+s.e+1,t);if(!(n=s.c))return null;if(r=((i=n.length-1)-g(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},O.dividedBy=O.div=function(e,t){return n(this,new q(e,t),L,D)},O.dividedToIntegerBy=O.idiv=function(e,t){return n(this,new q(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var n,r,i,c,u,f,h,d,p=this;if((e=new q(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+Z(e));if(null!=t&&(t=new q(t)),u=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new q(Math.pow(+Z(p),u?2-y(e):+Z(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new q(NaN);(r=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return c=p.s<0&&y(e)?-0:0,p.e>-1&&(c=1/c),new q(f?1/c:c);F&&(c=s(F/l+2))}for(u?(n=new q(.5),f&&(e.s=1),h=y(e)):h=(i=Math.abs(+Z(e)))%2,d=new q(P);;){if(h){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):r&&(d=d.mod(t))}if(i){if(0===(i=a(i/2)))break;h=i%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)h=y(e);else{if(0===(i=+Z(e)))break;h=i%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):r&&(p=p.mod(t))}return r?d:(f&&(d=P.div(d)),t?d.mod(t):c?K(d,F,D,undefined):d)},O.integerValue=function(e){var t=new q(this);return null==e?e=D:w(e,0,8),K(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===m(this,new q(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return m(this,new q(e,t))>0},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=m(this,new q(e,t)))||0===t},O.isInteger=function(){return!!this.c&&g(this.e/l)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return m(this,new q(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=m(this,new q(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var n,r,i,s,a=this,o=a.s;if(t=(e=new q(e,t)).s,!o||!t)return new q(NaN);if(o!=t)return e.s=-t,a.plus(e);var c=a.e/l,f=e.e/l,h=a.c,d=e.c;if(!c||!f){if(!h||!d)return h?(e.s=-t,e):new q(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new q(h[0]?a:3==D?-0:0)}if(c=g(c),f=g(f),h=h.slice(),o=c-f){for((s=o<0)?(o=-o,i=h):(f=c,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(r=(s=(o=h.length)<(t=d.length))?o:t,o=t=0;t<r;t++)if(h[t]!=d[t]){s=h[t]<d[t];break}if(s&&(i=h,h=d,d=i,e.s=-e.s),(t=(r=d.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=u-1;r>o;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=u}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?V(e,h,f):(e.s=3==D?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var r,i,s=this;return e=new q(e,t),!s.c||!e.s||e.c&&!e.c[0]?new q(NaN):!e.c||s.c&&!s.c[0]?new q(s):(9==z?(i=e.s,e.s=1,r=n(s,e,0,3),e.s=i,r.s*=i):r=n(s,e,0,z),(e=s.minus(r.times(e))).c[0]||1!=z||(e.s=s.s),e)},O.multipliedBy=O.times=function(e,t){var n,r,i,s,a,o,c,f,h,p,b,m,w,y,_,v=this,k=v.c,E=(e=new q(e,t)).c;if(!(k&&E&&k[0]&&E[0]))return!v.s||!e.s||k&&!k[0]&&!E||E&&!E[0]&&!k?e.c=e.e=e.s=null:(e.s*=v.s,k&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=g(v.e/l)+g(e.e/l),e.s*=v.s,(c=k.length)<(p=E.length)&&(w=k,k=E,E=w,i=c,c=p,p=i),i=c+p,w=[];i--;w.push(0));for(y=u,_=d,i=p;--i>=0;){for(n=0,b=E[i]%_,m=E[i]/_|0,s=i+(a=c);s>i;)n=((f=b*(f=k[--a]%_)+(o=m*f+(h=k[a]/_|0)*b)%_*_+w[s]+n)/y|0)+(o/_|0)+m*h,w[s--]=f%y;w[s]=n}return n?++r:w.splice(0,1),V(e,w,r)},O.negated=function(){var e=new q(this);return e.s=-e.s||null,e},O.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new q(e,t)).s,!i||!t)return new q(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/l,a=e.e/l,o=r.c,c=e.c;if(!s||!a){if(!o||!c)return new q(i/0);if(!o[0]||!c[0])return c[0]?e:new q(o[0]?r:0*i)}if(s=g(s),a=g(a),o=o.slice(),i=s-a){for(i>0?(a=s,n=c):(i=-i,n=o),n.reverse();i--;n.push(0));n.reverse()}for((i=o.length)-(t=c.length)<0&&(n=c,c=o,o=n,t=i),i=0;t;)i=(o[--t]=o[t]+c[t]+i)/u|0,o[t]=u===o[t]?0:o[t]%u;return i&&(o=[i].concat(o),++a),V(e,o,a)},O.precision=O.sd=function(e,t){var n,r,i,s=this;if(null!=e&&e!==!!e)return w(e,1,p),null==t?t=D:w(t,0,8),K(new q(s),e,t);if(!(n=s.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},O.shiftedBy=function(e){return w(e,-9007199254740991,f),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,r,i,s,a=this,o=a.c,c=a.s,u=a.e,l=L+4,f=new q("0.5");if(1!==c||!o||!o[0])return new q(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+Z(a)))||c==1/0?(((t=b(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=g((u+1)/2)-(u<0||u%2),r=new q(t=c==1/0?"1e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new q(c+""),r.c[0])for((c=(u=r.e)+l)<3&&(c=0);;)if(s=r,r=f.times(s.plus(n(a,s,l,1))),b(s.c).slice(0,c)===(t=b(r.c)).slice(0,c)){if(r.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(r,r.e+L+2,1),e=!r.times(r).eq(a));break}if(!i&&(K(s,s.e+L+2,0),s.times(s).eq(a))){r=s;break}l+=4,c+=4,i=1}return K(r,r.e+L+1,D,e)},O.toExponential=function(e,t){return null!=e&&(w(e,0,p),e++),W(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(w(e,0,p),e=e+this.e+1),W(this,e,t)},O.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=$;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",f=a[0],h=a[1],d=i.s<0,p=d?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),d&&(f="-"+f)}r=h?f+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):f}return(n.prefix||"")+r+(n.suffix||"")},O.toFraction=function(e){var t,r,i,s,a,c,u,f,d,p,g,m,w=this,y=w.c;if(null!=e&&(!(u=new q(e)).isInteger()&&(u.c||1!==u.s)||u.lt(P)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Z(u));if(!y)return new q(w);for(t=new q(P),d=r=new q(P),i=f=new q(P),m=b(y),a=t.e=m.length-w.e-1,t.c[0]=h[(c=a%l)<0?l+c:c],e=!e||u.comparedTo(t)>0?a>0?t:d:u,c=j,j=1/0,u=new q(m),f.c[0]=0;p=n(u,t,0,1),1!=(s=r.plus(p.times(i))).comparedTo(e);)r=i,i=s,d=f.plus(p.times(s=d)),f=s,t=u.minus(p.times(s=t)),u=s;return s=n(e.minus(r),i,0,1),f=f.plus(s.times(d)),r=r.plus(s.times(i)),f.s=d.s=w.s,g=n(d,i,a*=2,D).minus(w).abs().comparedTo(n(f,r,a,D).minus(w).abs())<1?[d,i]:[f,r],j=c,g},O.toNumber=function(){return+Z(this)},O.toPrecision=function(e,t){return null!=e&&w(e,1,p),W(this,e,t,2)},O.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=C||i>=B?_(b(n.c),i):v(b(n.c),i,"0"):10===e?t=v(b((n=K(new q(n),L+i+1,D)).c),n.e,"0"):(w(e,2,H.length,"Base"),t=k(v(b(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return Z(this)},O._isBigNumber=!0,i&&(O[Symbol.toStringTag]="BigNumber",O[Symbol.for("nodejs.util.inspect.custom")]=O.valueOf),null!=t&&q.set(t),q}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"3box>ipfs>ipfs-bitswap>bignumber.js"}],[4291,{"./utils":4295,blakejs:1889,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("blakejs"),i=e("./utils").toCallback,s={init:r.blake2bInit,update:r.blake2bUpdate,digest:r.blake2bFinal},a={init:r.blake2sInit,update:r.blake2sUpdate,digest:r.blake2sFinal},o=(e,t)=>i((r=>{const i=t.init(e,null);return t.update(i,r),n.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=o(t+1,s);for(let t=0;t<32;t++)e[45633+t]=o(t+1,a)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-bitswap>multihashing-async"}],[4292,{buffer:1936,nodeify:5141},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const a=i.digest({name:e},t);if("function"!=typeof a.then)return a.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(a.oncomplete=e=>{s(null,e.target.result)});r(a.then((e=>n.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-bitswap>multihashing-async"}],[4293,{"./blake":4291,"./crypto-sha1-2":4292,"./utils":4295,buffer:1936,"js-sha3":4590,murmurhash3js:5101},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),a=e("./crypto-sha1-2"),o=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:a.sha1,sha2256:a.sha2256,sha2512:a.sha2512,sha3512:o(c(r.sha3_512)),sha3384:o(c(r.sha3_384)),sha3256:o(c(r.sha3_256)),sha3224:o(c(r.sha3_224)),shake128:o(c(r.shake_128,128)),shake256:o(c(r.shake_256,256)),keccak224:o(c(r.keccak_224)),keccak256:o(c(r.keccak_256)),keccak384:o(c(r.keccak_384)),keccak512:o(c(r.keccak_512)),murmur3128:o(c(u(i.x64.hash128))),murmur332:o(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{a.sha2256(e,((e,r)=>{e&&t(e),a.sha2256(n.from(r),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-bitswap>multihashing-async"}],[4294,{"./crypto":4293,buffer:1936,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("multihashes"),i=e("./crypto");function s(e,t,n,i){if("function"==typeof n&&(i=n,n=undefined),!i)throw new Error("Missing callback");s.digest(e,t,n,((e,s)=>{if(e)return i(e);i(null,r.encode(s,t,n))}))}t.exports=s,s.Buffer=n,s.multihash=r,s.digest=function(e,t,n,r){if("function"==typeof n&&(r=n,n=undefined),!r)throw new Error("Missing callback");let i,a=r;n&&(a=(e,t)=>{if(e)return r(e);r(null,t.slice(0,n))});try{i=s.createHash(t)}catch(e){return a(e)}i(e,a)},s.createHash=function(e){if(e=r.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-bitswap>multihashing-async"}],[4295,{_process:5261,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e,t){(function(){n.toCallback=t=>function(n,r){let i;try{i=t(n)}catch(t){return void e.nextTick(r,t)}e.nextTick(r,null,i)},n.toBuf=(e,n)=>r=>{let i=e(r,n);return t.from(i,"hex")},n.fromString=(e,n)=>r=>{const i=t.isBuffer(r)?r.toString():r;return e(i,n)},n.fromNumberTo32BitBuf=(e,n)=>r=>{let i=e(r,n);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-bitswap>multihashing-async"}],[4296,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={maxProvidersPerRequest:3,providerRequestTimeout:1e4,hasBlockTimeout:15e3,provideTimeout:15e3,kMaxPriority:Math.pow(2,31)-1,rebroadcastDelay:1e4,maxListeners:1e3}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4297,{"../types/message":4305,"../types/wantlist":4308,"../utils":4309,"./ledger":4298,"async/each":1597,"async/eachSeries":1602,"async/map":1628,"async/nextTick":1631,"async/waterfall":1643,"just-debounce-it":4622},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async/each"),i=e("async/eachSeries"),s=e("async/waterfall"),a=e("async/nextTick"),o=e("async/map"),c=e("just-debounce-it"),u=e("../types/message"),l=e("../types/wantlist"),f=e("./ledger"),{logger:h,groupBy:d,pullAllWith:p,uniqWith:g}=e("../utils"),b=524288;t.exports=class{constructor(e,t,n,r){this._log=h(e,"engine"),this.blockstore=t,this.network=n,this._stats=r,this.ledgerMap=new Map,this._running=!1,this._tasks=[],this._outbox=c(this._processTasks.bind(this),100)}_sendBlocks(e,t,n){if(t.reduce(((e,t)=>e+t.data.byteLength),0)<b)return this._sendSafeBlocks(e,t,n);let r=0,s=[],o=t.length;i(t,((t,n)=>{if(o--,s.push(t),r+=t.data.byteLength,r>=b||0===o){r=0;const t=s.slice();s=[],this._sendSafeBlocks(e,t,(e=>{e&&this._log("sendblock error: %s",e.message),n()}))}else a(n)}),n)}_sendSafeBlocks(e,t,n){const r=new u(!1);t.forEach((e=>r.addBlock(e))),this.network.sendMessage(e,r,n)}_processTasks(){if(!this._running||!this._tasks.length)return;const e=this._tasks;this._tasks=[];const t=e.map((e=>e.entry)).map((e=>e.cid)),n=g(((e,t)=>e.equals(t)),t),i=d((e=>e.target.toB58String()),e);s([e=>o(n,((e,t)=>{this.blockstore.get(e,t)}),e),(e,n)=>r(Object.values(i),((n,r)=>{const i=n[0].target,s=t.map((t=>e.find((e=>e.cid.equals(t)))));this._sendBlocks(i,s,(e=>{e?this._log.error("should never happen: ",e):s.forEach((e=>this.messageSent(i,e))),r()}))}),n)],(e=>{this._tasks=[],e&&this._log.error(e)}))}wantlistForPeer(e){const t=e.toB58String();return this.ledgerMap.has(t)?this.ledgerMap.get(t).wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toB58String(),n=this.ledgerMap.get(t);return n?{peer:n.partner.toPrint(),value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){e.length&&(this.ledgerMap.forEach((t=>{e.map((e=>t.wantlistContains(e))).filter(Boolean).forEach((e=>{this._tasks.push({entry:e,target:t.partner})}))})),this._outbox())}messageReceived(e,t,n){const r=this._findOrCreate(e);if(t.empty)return a(n);if(t.full&&(r.wantlist=new l),this._processBlocks(t.blocks,r),0===t.wantlist.size)return a(n);let i=[],s=[];t.wantlist.forEach((e=>{e.cancel?(r.cancelWant(e.cid),i.push(e)):(r.wants(e.cid,e.priority),s.push(e))})),this._cancelWants(r,e,i),this._addWants(r,e,s,n)}_cancelWants(e,t,n){const r=t.toB58String();this._tasks=p(((e,t)=>{const n=e.target.toB58String()===r,i=e.entry.cid.equals(t.cid);return n&&i}),this._tasks,n)}_addWants(e,t,n,i){r(n,((e,n)=>{this.blockstore.has(e.cid,((r,i)=>{r?this._log.error("failed existence check"):i&&this._tasks.push({entry:e.entry,target:t}),n()}))}),(()=>{this._outbox(),i()}))}_processBlocks(e,t,n){const r=[];e.forEach(((e,n)=>{this._log("got block (%s bytes)",e.data.length),t.receivedBytes(e.data.length),r.push(e.cid)})),this.receivedBlocks(r)}messageSent(e,t){const n=this._findOrCreate(e);n.sentBytes(t?t.data.length:0),t&&t.cid&&n.wantlist.remove(t.cid)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){const t=e.toB58String();if(this.ledgerMap.has(t))return this.ledgerMap.get(t);const n=new f(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(e){this._running=!0,a((()=>e()))}stop(e){this._running=!1,a((()=>e()))}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4298,{"../types/wantlist":4308},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("../types/wantlist");t.exports=class{constructor(e){this.partner=e,this.wantlist=new r,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t){this.wantlist.add(e,t)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.contains(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4299,{"./decision-engine":4297,"./network":4300,"./notifications":4301,"./stats":4302,"./utils":4309,"./want-manager":4310,"async/each":1597,"async/map":1628,"async/nextTick":1631,"async/reject":1634,"async/series":1636,"async/waterfall":1643},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async/waterfall"),i=e("async/reject"),s=e("async/each"),a=e("async/series"),o=e("async/map"),c=e("async/nextTick"),u=e("./want-manager"),l=e("./network"),f=e("./decision-engine"),h=e("./notifications"),d=e("./utils").logger,p=e("./stats"),g={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},b=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];t.exports=class{constructor(e,t,n){this._libp2p=e,this._log=d(this.peerInfo.id),this._options=Object.assign({},g,n),this._stats=new p(b,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new l(e,this,{},this._stats),this.blockstore=t,this.engine=new f(this.peerInfo.id,t,this.network,this._stats),this.wm=new u(this.peerInfo.id,this.network,this._stats),this.notifications=new h(this.peerInfo.id)}get peerInfo(){return this._libp2p.peerInfo}_receiveMessage(e,t,n){this.engine.messageReceived(e,t,(r=>{if(r&&this._log("failed to receive message",t),0===t.blocks.size)return n();const i=Array.from(t.blocks.values()),a=i.filter((e=>this.wm.wantlist.contains(e.cid))).map((e=>e.cid));this.wm.cancelWants(a),s(i,((t,n)=>{const r=a.includes(t.cid);this._handleReceivedBlock(e,t,r,n)}),n)}))}_handleReceivedBlock(e,t,n,i){this._log("received block"),r([e=>this.blockstore.has(t.cid,e),(r,i)=>{if(this._updateReceiveCounters(e.toB58String(),t,r),r||!n)return c(i);this._putBlock(t,i)}],i)}_updateReceiveCounters(e,t,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",t.data.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",t.data.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}_putBlock(e,t){this.blockstore.put(e,(n=>{if(n)return t(n);this.notifications.hasBlock(e),this.network.provide(e.cid,(e=>{e&&this._log.error("Failed to provide: %s",e.message)})),this.engine.receivedBlocks([e.cid]),t()}))}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}get(e,t){this.getMany([e],((e,n)=>{if(e)return t(e);n&&n.length>0?t(null,n[0]):t()}))}getMany(e,t){let n=e.length;const i=[];let s=!1;const a=(e,t)=>{i.push(e),this.notifications.wantBlock(e,(n=>{this.wm.cancelWants([e]),t(null,n)}),(()=>{this.wm.cancelWants([e]),t(null,undefined)})),n||this.wm.wantBlocks(i)};o(e,((t,o)=>{r([e=>this.blockstore.has(t,e),(r,o)=>{if(n--,r)return n||this.wm.wantBlocks(i),this.blockstore.get(t,o);s||(s=!0,this.network.findAndConnect(e[0],(e=>{e&&this._log.error(e)}))),a(t,o)}],o)}),t)}unwant(e){Array.isArray(e)||(e=[e]),this.wm.unwantBlocks(e),e.forEach((e=>this.notifications.unwantBlock(e)))}cancelWants(e){Array.isArray(e)||(e=[e]),this.wm.cancelWants(e)}put(e,t){this._log("putting block"),r([t=>this.blockstore.has(e.cid,t),(t,n)=>{if(t)return c(n);this._putBlock(e,n)}],t)}putMany(e,t){r([t=>i(e,((e,t)=>{this.blockstore.has(e.cid,t)}),t),(e,t)=>this.blockstore.putMany(e,(n=>{if(n)return t(n);e.forEach((e=>{this.notifications.hasBlock(e),this.engine.receivedBlocks([e.cid]),this.network.provide(e.cid,(e=>{e&&this._log.error("Failed to provide: %s",e.message)}))})),t()}))],t)}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(e){a([e=>this.wm.start(e),e=>this.network.start(e),e=>this.engine.start(e)],e)}stop(e){this._stats.stop(),a([e=>this.wm.stop(e),e=>this.network.stop(e),e=>this.engine.stop(e)],e)}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[43,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let n=e.message;n=n===undefined?"":String(n),""===t?e.stack=e.message:""===n?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"$root$"}],[4300,{"./constants":4296,"./types/message":4305,"./utils":4309,"async/each":1597,"async/nextTick":1631,"async/waterfall":1643,"pull-length-prefixed":5300,"pull-stream":5318},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("pull-length-prefixed"),i=e("pull-stream"),s=e("async/waterfall"),a=e("async/each"),o=e("async/nextTick"),c=e("./types/message"),u=e("./constants"),l=e("./utils").logger,f="/ipfs/bitswap/1.0.0",h="/ipfs/bitswap/1.1.0";t.exports=class{constructor(e,t,n,r){this._log=l(e.peerInfo.id,"network"),n=n||{},this.libp2p=e,this.bitswap=t,this.b100Only=n.b100Only||!1,this._stats=r,this._running=!1}start(e){this._running=!0,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this.libp2p.handle(f,this._onConnection),this.b100Only||this.libp2p.handle(h,this._onConnection),this.libp2p.on("peer:connect",this._onPeerConnect),this.libp2p.on("peer:disconnect",this._onPeerDisconnect),this.libp2p.peerBook.getAllArray().filter((e=>e.isConnected())).forEach((e=>this._onPeerConnect(e))),o((()=>e()))}stop(e){this._running=!1,this.libp2p.unhandle(f),this.b100Only||this.libp2p.unhandle(h),this.libp2p.removeListener("peer:connect",this._onPeerConnect),this.libp2p.removeListener("peer:disconnect",this._onPeerDisconnect),o((()=>e()))}_onConnection(e,t){this._running&&(this._log("incomming new bitswap connection: %s",e),i(t,r.decode(),i.asyncMap(((e,t)=>c.deserialize(e,t))),i.asyncMap(((e,n)=>{t.getPeerInfo(((t,r)=>{if(t)return n(t);this.bitswap._receiveMessage(r.id,e,n)}))})),i.onEnd((e=>{this._log("ending connection"),e&&this.bitswap._receiveError(e)}))))}_onPeerConnect(e){this._running&&this.bitswap._onPeerConnected(e.id)}_onPeerDisconnect(e){this._running&&this.bitswap._onPeerDisconnected(e.id)}findProviders(e,t,n){this.libp2p.contentRouting.findProviders(e,{maxTimeout:u.providerRequestTimeout,maxNumProviders:t},n)}findAndConnect(e,t){s([t=>this.findProviders(e,u.maxProvidersPerRequest,t),(e,t)=>{this._log("connecting to providers",e.map((e=>e.id.toB58String()))),a(e,((e,t)=>this.connectTo(e,t)))}],t)}provide(e,t){this.libp2p.contentRouting.provide(e,t)}sendMessage(e,t,n){if(!this._running)return n(new Error("network isn't running"));const s=e.toB58String()?e.toB58String():e.id.toB58String();this._log("sendMessage to %s",s,t),this._dialPeer(e,((s,a,o)=>{if(s)return n(s);let c;switch(o){case f:c=t.serializeToBitswap100();break;case h:c=t.serializeToBitswap110();break;default:return n(new Error("Unkown protocol: "+o))}!function(e,t,n){i(i.values([t]),r.encode(),e,i.onEnd(n))}(a,c,(e=>{e&&this._log.error(e)})),n(),this._updateSentStats(e,t.blocks)}))}connectTo(e,t){if(!this._running)return t(new Error("network isn't running"));this.libp2p.dial(e,t)}_dialPeer(e,t){this.libp2p.dialProtocol(e,h,((n,r)=>{n?this.libp2p.dialProtocol(e,f,((e,n)=>{if(e)return t(e);t(null,n,f)})):t(null,r,h)}))}_updateSentStats(e,t){const n=e.toB58String();this._stats&&(t.forEach((e=>this._stats.push(n,"dataSent",e.data.length))),this._stats.push(n,"blocksSent",t.size))}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4301,{"./constants":4296,"./utils":4309,events:1937},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("events").EventEmitter,i=e("./constants"),s=e("./utils").logger,a=e=>`unwant:${e}`,o=e=>`block:${e}`;t.exports=class extends r{constructor(e){super(),this.setMaxListeners(i.maxListeners),this._log=s(e,"notif"),this._unwantListeners={},this._blockListeners={}}hasBlock(e){const t=`block:${e.cid.buffer.toString()}`;this._log(t),this.emit(t,e)}wantBlock(e,t,n){const r=e.buffer.toString();this._log(`wantBlock:${r}`),this._unwantListeners[r]=()=>{this._log(`manual unwant: ${r}`),this._cleanup(r),n()},this._blockListeners[r]=e=>{this._cleanup(r),t(e)},this.once(a(r),this._unwantListeners[r]),this.once(o(r),this._blockListeners[r])}unwantBlock(e){const t=`unwant:${e.buffer.toString()}`;this._log(t),this.emit(t)}_cleanup(e){this._unwantListeners[e]&&(this.removeListener(a(e),this._unwantListeners[e]),delete this._unwantListeners[e]),this._blockListeners[e]&&(this.removeListener(o(e),this._blockListeners[e]),delete this._blockListeners[e])}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4302,{"./stat":4303,events:1937},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("events"),i=e("./stat"),s={movingAverageIntervals:[6e4,3e5,9e5]};t.exports=class extends r{constructor(e,t){super();const n=Object.assign({},s,t);if("number"!=typeof n.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!=typeof n.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=n,this._enabled=this._options.enabled,this._global=new i(e,n),this._global.on("update",(e=>this.emit("update",e))),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){return e.toB58String&&(e=e.toB58String()),this._peers.get(e)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e)){let r=this._peers.get(e);r||(r=new i(this._initialCounters,this._options),this._peers.set(e,r)),r.push(t,n)}}disconnected(e){const t=e.toB58String(),n=this._peers.get(t);n&&(n.stop(),this._peers.delete(t))}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4303,{"bignumber.js":4290,events:1937,"moving-average":5050},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("events"),i=e("bignumber.js"),s=e("moving-average");t.exports=class extends r{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=i(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{(this._movingAverages[e][t]=s(t)).push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){const t=e=this._queue.shift();this._applyOp(t)}this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;Object.keys(this._stats).forEach((n=>{this._updateFrequencyFor(n,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){const r=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const i=r/t*1e3;let a=this._movingAverages[e];a||(a=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=a[e];t||(t=a[e]=s(e)),t.push(n,i)}))}_applyOp(e){const t=e[0],n=e[1];if("number"!=typeof n)throw new Error("invalid increment number:",n);let r;r=this._stats.hasOwnProperty(t)?this._stats[t]:this._stats[t]=i(0),this._stats[t]=r.plus(n),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4304,{"../wantlist":4308,assert:1564,cids:1973},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("../wantlist").Entry,i=e("cids"),s=e("assert");t.exports=class{constructor(e,t,n){s(i.isCID(e),"needs valid cid"),this.entry=new r(e,t),this.cancel=Boolean(n)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toBaseEncodedString()} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.entry.equals(e.entry)}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4305,{"./entry":4304,"./message.proto":4306,assert:1564,"async/each":1597,"async/nextTick":1631,cids:1973,"ipfs-block":4313,"lodash.isequalwith":4837,"multicodec/src/name-table":5067,"multihashing-async":4294,protons:5281,"varint-decoder":5876},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("protons"),i=e("ipfs-block"),s=e("lodash.isequalwith"),a=e("assert"),o=e("async/each"),c=e("async/nextTick"),u=e("cids"),l=e("multicodec/src/name-table"),f=e("varint-decoder"),h=e("multihashing-async"),d=r(e("./message.proto")),p=e("./entry");class g{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map}get empty(){return 0===this.blocks.size&&0===this.wantlist.size}addEntry(e,t,n){a(e&&u.isCID(e),"must be a valid cid");const r=e.buffer.toString(),i=this.wantlist.get(r);i?(i.priority=t,i.cancel=Boolean(n)):this.wantlist.set(r,new p(e,t,n))}addBlock(e){a(i.isBlock(e),"must be a valid cid");const t=e.cid.buffer.toString();this.blocks.set(t,e)}cancel(e){a(u.isCID(e),"must be a valid cid");const t=e.buffer.toString();this.wantlist.delete(t),this.addEntry(e,0,!0)}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.buffer,priority:Number(e.priority),cancel:Boolean(e.cancel)})))},blocks:Array.from(this.blocks.values()).map((e=>e.data))};return this.full&&(e.wantlist.full=!0),d.Message.encode(e)}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.buffer,priority:Number(e.priority),cancel:Boolean(e.cancel)})))},payload:[]};return this.full&&(e.wantlist.full=!0),this.blocks.forEach((t=>{e.payload.push({prefix:t.cid.prefix,data:t.data})})),d.Message.encode(e)}equals(e){const t=(e,t)=>{if(e.equals&&"function"==typeof e.equals)return e.equals(t)};return!(this.full!==e.full||!s(this.wantlist,e.wantlist,t)||!s(this.blocks,e.blocks,t))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}g.deserialize=(e,t)=>{let n;try{n=d.Message.decode(e)}catch(e){return c((()=>t(e)))}const r=n.wantlist&&n.wantlist.full||!1,s=new g(r);return n.wantlist&&n.wantlist.entries.forEach((e=>{let n;try{n=new u(e.block)}catch(e){return t(e)}s.addEntry(n,e.priority,e.cancel)})),n.blocks.length>0?o(n.blocks,((e,n)=>{h(e,"sha2-256",((r,a)=>{if(r)return n(r);let o;try{o=new u(a)}catch(r){return t(r)}s.addBlock(new i(e,o)),n()}))}),(e=>{if(e)return t(e);t(null,s)})):n.payload.length>0?o(n.payload,((e,t)=>{if(!e.prefix||!e.data)return c(t);const n=f(e.prefix),r=n[0],a=n[1],o=n[2];h(e.data,o,((n,o)=>{if(n)return t(n);let c;try{c=new u(r,l[a.toString("16")],o)}catch(n){return t(n)}s.addBlock(new i(e.data,c)),t()}))}),(e=>{if(e)return t(e);t(null,s)})):void t(null,s)},g.Entry=p,t.exports=g}}},{package:"3box>ipfs>ipfs-bitswap"}],[4306,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports="\n  message Message {\n    message Wantlist {\n      message Entry {\n        // changed from string to bytes, it makes a difference in JavaScript\n        optional bytes block = 1;      // the block cid (cidV0 in bitswap 1.0.0, cidV1 in bitswap 1.1.0)\n        optional int32 priority = 2;    // the priority (normalized). default to 1\n        optional bool cancel = 3;       // whether this revokes an entry\n      }\n\n      repeated Entry entries = 1;       // a list of wantlist entries\n      optional bool full = 2;           // whether this is the full wantlist. default to false\n    }\n\n    message Block {\n      optional bytes prefix = 1;        // CID prefix (cid version, multicodec and multihash prefix (type + length)\n      optional bytes data = 2;\n    }\n\n    optional Wantlist wantlist = 1;\n    repeated bytes blocks = 2;          // used to send Blocks in bitswap 1.0.0\n    repeated Block payload = 3;         // used to send Blocks in bitswap 1.1.0\n  }\n"}}},{package:"3box>ipfs>ipfs-bitswap"}],[4307,{assert:1564,cids:1973},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("assert"),i=e("cids");class s{constructor(e,t){r(i.isCID(e),"must be valid CID"),this._refCounter=1,this.cid=e,this.priority=t||1}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toBaseEncodedString()}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority}}t.exports=s}}},{package:"3box>ipfs>ipfs-bitswap"}],[4308,{"../../utils":4309,"./entry":4307},function(){with(this)return function(){"use strict";return function(e,t,n){const{sortBy:r}=e("../../utils"),i=e("./entry");class s{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,t){const n=e.buffer.toString(),r=this.set.get(n);r?(r.inc(),r.priority=t):(this.set.set(n,new i(e,t)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.buffer.toString(),n=this.set.get(t);n&&(n.dec(),n.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(r((e=>e[1].key),Array.from(this.set.entries())))}contains(e){const t=e.buffer.toString();return this.set.get(t)}}s.Entry=i,t.exports=s}}},{package:"3box>ipfs>ipfs-bitswap"}],[4309,{debug:2108},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("debug"),i=(e,t,n)=>{let r=0;const i=n.length;for(;r<i;){if(e(t,n[r]))return!0;r+=1}return!1};t.exports={logger:(e,t)=>{const n=["bitswap"];t&&n.push(t),e&&n.push(`${e.toB58String().slice(0,8)}`);const i=r(n.join(":"));return i.error=r(n.concat(["error"]).join(":")),i},includesWith:i,uniqWith:(e,t)=>{let n=0;const r=t.length,s=[];let a;for(;n<r;)a=t[n],i(e,a,s)||(s[s.length]=a),n+=1;return s},groupBy:(e,t)=>t.reduce(((t,n)=>{const r=e(n);return t[r]?t[r].push(n):t[r]=[n],t}),{}),pullAllWith:(e,t,n)=>t.filter((t=>!i(e,t,n))),sortBy:(e,t)=>Array.prototype.slice.call(t,0).sort(((t,n)=>{const r=e(t),i=e(n);return r<i?-1:r>i?1:0}))}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4310,{"../constants":4296,"../types/message":4305,"../types/wantlist":4308,"../utils":4309,"./msg-queue":4311,"async/nextTick":1631},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async/nextTick"),i=e("../types/message"),s=e("../types/wantlist"),a=e("../constants"),o=e("./msg-queue"),c=e("../utils").logger;t.exports=class{constructor(e,t,n){this.peers=new Map,this.wantlist=new s(n),this.network=t,this._stats=n,this._peerId=e,this._log=c(e,"want")}_addEntries(e,t,n){const r=e.map(((e,n)=>new i.Entry(e,a.kMaxPriority-n,t)));r.forEach((e=>{e.cancel?n?this.wantlist.removeForce(e.cid):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))}));for(let e of this.peers.values())e.addEntries(r)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t)return void t.refcnt++;t=new o(this._peerId,e,this.network);const n=new i(!0);for(let e of this.wantlist.entries())n.addEntry(e[1].cid,e[1].priority);return t.addMessage(n),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toB58String());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toB58String()))}wantBlocks(e){this._addEntries(e,!1)}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(e){this.timer=setInterval((()=>{this._log("resend full-wantlist");const e=new i(!0);this.wantlist.forEach((t=>{e.addEntry(t.cid,t.priority)})),this.peers.forEach((t=>t.addMessage(e)))}),6e4),r((()=>e()))}stop(e){this.peers.forEach((e=>this.disconnected(e.peerId))),clearInterval(this.timer),r((()=>e()))}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4311,{"../types/message":4305,"../utils":4309,"just-debounce-it":4622},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("just-debounce-it"),i=e("../types/message"),s=e("../utils").logger;t.exports=class{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=s(e,"msgqueue",t.toB58String().slice(0,8)),this.sendEntries=r(this._sendEntries.bind(this),200)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new i(!1);this._entries.forEach((t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)})),this._entries=[],this.addMessage(e)}send(e){this.network.connectTo(this.peerId,(t=>{t?this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message):(this._log("sending message"),this.network.sendMessage(this.peerId,e,(e=>{e&&this._log.error("send error: %s",e.message)})))}))}}}}},{package:"3box>ipfs>ipfs-bitswap"}],[4312,{"async/map":1628},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async/map");t.exports=class{constructor(e){this._repo=e,this._bitswap=null}setExchange(e){this._bitswap=e}unsetExchange(){this._bitswap=null}hasExchange(){return null!=this._bitswap}put(e,t){this.hasExchange()?this._bitswap.put(e,t):this._repo.blocks.put(e,t)}putMany(e,t){this.hasExchange()?this._bitswap.putMany(e,t):this._repo.blocks.putMany(e,t)}get(e,t){this.hasExchange()?this._bitswap.get(e,t):this._repo.blocks.get(e,t)}getMany(e,t){Array.isArray(e)?this.hasExchange()?this._bitswap.getMany(e,t):r(e,((e,t)=>this._repo.blocks.get(e,t)),t):t(new Error("first arg must be an array of cids"))}delete(e,t){this._repo.blocks.delete(e,t)}}}}},{package:"3box>ipfs>ipfs-block-service"}],[4313,{"../../is-buffer/index.js":4558,cids:1973,"class-is":1975},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("cids"),i=e("class-is");t.exports=i(class{constructor(e,t){if(!e||!n.isBuffer(e))throw new Error("first argument  must be a buffer");if(!t||!r.isCID(t))throw new Error("second argument must be a CID");this._data=e,this._cid=t}get data(){return this._data}set data(e){throw new Error("Tried to change an immutable block")}get cid(){return this._cid}set cid(e){throw new Error("Tried to change an immutable block")}},{className:"Block",symbolName:"@ipfs/js-ipfs-block/block"})}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-block"}],[4314,{},function(){with(this)return function(){"use strict";return function(e,t,n){const r="GENESIS";class i{constructor(e,t){this._ipfs=e,this._content={id:`did:${t}:GENESIS`}}get DID(){if(this._content.id.includes(r))throw new Error("DID is not available before commit");return this._content.id}static async load(e,t){const n=new i(e);return n._content=await i.cidToDocument(e,t),n._content.previousDocument={"/":t.toString()},n}addPublicKey(e,t,n,r,i){this._content.publicKey||(this._content.publicKey=[]);let s={id:`${this._content.id}#${e}`,type:t};s[n]=r,i&&(s.owner=i),this._content.publicKey.push(s)}removePublicKey(e){const t=this._content.publicKey.findIndex((t=>t.id.endsWith(e)));this._content.publicKey.splice(t,1),this._content.publicKey.length||delete this._content.publicKey}addAuthentication(e,t){this._content.authentication||(this._content.authentication=[]),this._content.authentication.push({type:e,publicKey:`${this._content.id}#${t}`})}removeAuthentication(e){const t=this._content.authentication.findIndex((t=>t.publicKey.endsWith(e)));this._content.authentication.splice(t,1),this._content.authentication.length||delete this._content.authentication}addService(e,t,n,r){this._content.service||(this._content.service=[]),this._content.service.push(Object.assign({id:`${this._content.id};${e}`,type:t,serviceEndpoint:n},r))}removeService(e){const t=this._content.service.findIndex((t=>t.id.endsWith(e)));this._content.service.splice(t,1),this._content.service.length||delete this._content.service}setRevocationMethod(e){this._content.revocationMethod=e}addCustomProperty(e,t){this._content[e]=t}removeCustomProperty(e){delete this._content[e]}async commit(e={}){this._content.created?e.noTimestamp||(this._content.updated=new Date(Date.now()).toISOString()):(this._content["@context"]="https://w3id.org/did/v1",e.noTimestamp||(this._content.created=new Date(Date.now()).toISOString()));const t=await this._ipfs.dag.put(this._content,{format:"dag-cbor",hashAlg:"sha2-256"});return this._content=await i.cidToDocument(this._ipfs,t),this._content.previousDocument={"/":t.toString()},t}static async cidToDocument(e,t){let n=(await e.dag.get(t)).value;if(n.id.includes(r)){const e=new RegExp(r,"gi");n.id=n.id.replace(e,t),n.publicKey&&(n.publicKey=JSON.parse(JSON.stringify(n.publicKey).replace(e,t))),n.authentication&&(n.authentication=JSON.parse(JSON.stringify(n.authentication).replace(e,t))),n.service&&(n.service=JSON.parse(JSON.stringify(n.service).replace(e,t)))}return n.previousDocument&&(n.previousDocument={"/":n.previousDocument.toString()}),n}}t.exports=i}}},{package:"3box>ipfs-did-document"}],[4315,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=(e,t,n)=>new Promise(((r,i)=>{if(n=Object.assign({concurrency:Infinity},n),"function"!=typeof t)throw new TypeError("Mapper function is required");const s=n.concurrency;if(!("number"==typeof s&&s>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${s}\` (${typeof s})`);const a=[],o=e[Symbol.iterator]();let c=!1,u=!1,l=0,f=0;const h=()=>{if(c)return;const e=o.next(),n=f;if(f++,e.done)return u=!0,void(0===l&&r(a));l++,Promise.resolve(e.value).then((e=>t(e,n))).then((e=>{a[n]=e,l--,h()}),(e=>{c=!0,i(e)}))};for(let e=0;e<s&&(h(),!u);e++);}))}}},{package:"3box>3box-orbitdb-plugins>ipfs-log>p-map"}],[4316,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=class{async canAppend(e,t){return!0}}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4317,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=class{constructor(e={}){this._cache=e}set(e,t){this._cache[e]=t}get(e){return this._cache[e]}delete(e){return delete this._cache[e]}add(e){this._cache=Object.assign(this._cache,e)}get length(){return Object.values(this._cache).length}}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4318,{"./entry":4319,"p-map":4315,"p-whilst":5213},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("p-whilst"),i=e("p-map"),s=e("./entry");class a{static async fetchParallel(e,t,{length:n=-1,exclude:r=[],concurrency:s=null,timeout:o,onProgressCallback:c}={}){const u=e=>e.hash,l=(e,t)=>{const n=e.map(u);return t.forEach((t=>{-1===n.indexOf(t.hash)&&e.push(t)})),e},f=Array.isArray(t)?t.slice():[t];s=Math.max(s||f.length,1);const h=await i(f,(t=>a.fetchAll(e,t,{length:n,exclude:r,timeout:o,onProgressCallback:c})),{concurrency:s});return h.reduce(l,[])}static async fetchAll(e,t,{length:n=-1,exclude:i=[],timeout:a=null,onProgressCallback:o}){let c=[],u={},l=Array.isArray(t)?t.slice():[t];const f=e=>l.push(e);(i=i&&Array.isArray(i)?i:[]).forEach((e=>{s.isEntry(e)&&(c.push(e),u[e.hash]=e)}));return await r((()=>l.length>0&&(c.length<n||n<0)),(()=>{const t=l.shift();return u[t]?Promise.resolve():new Promise((async(n,r)=>{const i=a?setTimeout((()=>{console.warn(`Warning: Couldn't fetch entry '${t}', request timed out (${a}ms)`),n()}),a):null;try{(e=>{s.isEntry(e)&&(e.next.forEach(f),c.push(e),u[t]=e,o&&o(t,e,c.length))})(await s.fromMultihash(e,t)),n()}catch(e){r(e)}finally{clearTimeout(i)}}))})),c}}t.exports=a}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4319,{"./lamport-clock":4321,"./utils":4328,buffer:1936,"json-stringify-deterministic":4604},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("./lamport-clock"),{isDefined:i,io:s}=e("./utils"),a=e("json-stringify-deterministic"),o=["next"],c=()=>new Error("Ipfs instance not defined"),u={0:"dag-pb",1:"dag-cbor"};class l{static async create(e,t,n,s,a=[],o){if(!i(e))throw c();if(!i(t))throw new Error("Identity is required, cannot create entry");if(!i(n))throw new Error("Entry requires an id");if(!i(s))throw new Error("Entry requires data");if(!i(a)||!Array.isArray(a))throw new Error("'next' argument is not an array");const u={hash:null,id:n,payload:s,next:a.filter(i).map((e=>e.hash?e.hash:e)),v:1,clock:o||new r(t.publicKey)},f=await t.provider.sign(t,l.toBuffer(u));return u.key=t.publicKey,u.identity=t.toJSON(),u.sig=f,u.hash=await l.toMultihash(e,u),u}static async verify(e,t){if(!e)throw new Error("Identity-provider is required, cannot verify entry");if(!l.isEntry(t))throw new Error("Invalid Log entry");if(!t.key)throw new Error("Entry doesn't have a key");if(!t.sig)throw new Error("Entry doesn't have a signature");const n={hash:null,id:t.id,payload:t.payload,next:t.next,v:t.v,clock:t.clock};return e.verify(t.sig,t.key,l.toBuffer(n),"v"+t.v)}static toBuffer(e){const t=0===e.v?JSON.stringify(e):a(e);return n.from(t)}static async toMultihash(e,t){if(!e)throw c();if(!l.isEntry(t))throw new Error("Invalid object format, cannot generate entry hash");const n={hash:null,id:t.id,payload:t.payload,next:t.next,v:t.v,clock:t.clock};return t.key&&Object.assign(n,{key:t.key}),t.identity&&Object.assign(n,{identity:t.identity}),t.sig&&Object.assign(n,{sig:t.sig}),s.write(e,u[n.v],n,{links:o})}static async fromMultihash(e,t){if(!e)throw c();if(!t)throw new Error(`Invalid hash: ${t}`);const n=await s.read(e,t,{links:o});let i={hash:t,id:n.id,payload:n.payload,next:n.next,v:n.v,clock:new r(n.clock.id,n.clock.time)};return n.key&&Object.assign(i,{key:n.key}),n.identity&&Object.assign(i,{identity:n.identity}),n.sig&&Object.assign(i,{sig:n.sig}),i}static isEntry(e){return e&&e.id!==undefined&&e.next!==undefined&&e.payload!==undefined&&e.v!==undefined&&e.hash!==undefined&&e.clock!==undefined}static compare(e,t){var n=r.compare(e.clock,t.clock);return 0===n?e.clock.id<t.clock.id?-1:1:n}static isEqual(e,t){return e.hash===t.hash}static isParent(e,t){return t.next.indexOf(e.hash)>-1}static findChildren(e,t){for(var n=[],r=t.find((t=>l.isParent(e,t))),i=e;r;)n.push(r),i=r,r=t.find((e=>l.isParent(i,e)));return n=n.sort(((e,t)=>e.clock.time>t.clock.time))}}t.exports=l}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4320,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=class{constructor(e){}append(e){}merge(e){}get(e){}has(e){}get values(){}get length(){}}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4321,{},function(){with(this)return function(){"use strict";return function(e,t,n){class r{constructor(e,t){this.id=e,this.time=t||0}tick(){return new r(this.id,++this.time)}merge(e){return this.time=Math.max(this.time,e.time),new r(this.id,this.time)}clone(){return new r(this.id,this.time)}static compare(e,t){var n=e.time-t.time;return 0===n&&e.id!==t.id?e.id<t.id?-1:1:n}}t.exports=r}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4322,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={IPFSNotDefinedError:()=>new Error("IPFS instance not defined"),LogNotDefinedError:()=>new Error("Log instance not defined"),NotALogError:()=>new Error("Given argument is not an instance of Log"),CannotJoinWithDifferentId:()=>new Error("Can't join logs with different IDs"),LtOrLteMustBeStringOrArray:()=>new Error("lt or lte must be a string or array of Entries")}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4323,{"./entry":4319,"./entry-io":4318,"./lamport-clock":4321,"./log-errors":4322,"./utils":4328},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./entry"),i=e("./entry-io"),s=e("./lamport-clock"),a=e("./log-errors"),{isDefined:o,findUniques:c,difference:u,io:l}=e("./utils"),f=["heads"];t.exports=class{static async toMultihash(e,t,{format:n}={}){if(!o(e))throw a.IPFSNotDefinedError();if(!o(t))throw a.LogNotDefinedError();if(o(n)||(n="dag-cbor"),t.values.length<1)throw new Error("Can't serialize an empty log");return l.write(e,n,t.toJSON(),{links:f})}static async fromMultihash(e,t,{length:n=-1,exclude:c,onProgressCallback:u,timeout:h}={}){if(!o(e))throw a.IPFSNotDefinedError();if(!o(t))throw new Error(`Invalid hash: ${t}`);const d=await l.read(e,t,{links:f});if(!d.heads||!d.id)throw a.NotALogError();const p=await i.fetchAll(e,d.heads,{length:n,exclude:c,onProgressCallback:u,timeout:h}),g=p.reduce(((e,t)=>t.clock.time>e.time?new s(t.clock.id,t.clock.time):e),new s(d.id)),b=p.slice().sort(r.compare),m=b.filter((e=>d.heads.includes(e.hash)));return{id:d.id,values:b,heads:m,clock:g}}static async fromEntryHash(e,t,{length:n=-1,exclude:r,onProgressCallback:s,timeout:c}){if(!o(e))throw a.IpfsNotDefinedError();if(!o(t))throw new Error("'hash' must be defined");const u=Array.isArray(t)?t:[t];n=n>-1?Math.max(n,1):n;const l=await i.fetchParallel(e,u,{length:n,exclude:r,onProgressCallback:s,timeout:c});var f,h;return{values:n>-1?(h=n,(f=l).slice(f.length-h,f.length)):l}}static async fromJSON(e,t,{length:n=-1,timeout:s,onProgressCallback:c}){if(!o(e))throw a.IPFSNotDefinedError();const u=t.heads.map((e=>e.hash)),l=(await i.fetchParallel(e,u,{length:n,exclude:[],concurrency:16,timeout:s,onProgressCallback:c})).slice().sort(r.compare);return{id:t.id,values:l,heads:t.heads}}static async fromEntry(e,t,{length:n=-1,exclude:s,onProgressCallback:l,timeout:f}){if(!o(e))throw a.IPFSNotDefinedError();if(!o(t))throw new Error("'sourceEntries' must be defined");if(!Array.isArray(t)&&!r.isEntry(t))throw new Error("'sourceEntries' argument must be an array of Entry instances or a single Entry");Array.isArray(t)||(t=[t]),n=n>-1?Math.max(n,t.length):n;const h=t.map((e=>e.hash)),d=await i.fetchParallel(e,h,{length:n,exclude:s,onProgressCallback:l,timeout:f}),p=t.concat(d),g=c(p,"hash").sort(r.compare),b=g.slice(n>-1?-n:-g.length),m=((e,t)=>{var n=e.slice(t.length,e.length);return t.concat(n)})(b,u(b,t,"hash"));return{id:m[m.length-1].id,values:m}}}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4324,{"./lamport-clock":4321},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./lamport-clock");function i(e,t,n){const i=r.compare(e.clock,t.clock);return 0===i?n(e,t):i}function s(e,t,n){return e.clock.id===t.clock.id?n(e,t):e.clock.id<t.clock.id?-1:1}n.SortByClocks=i,n.SortByClockId=s,n.LastWriteWins=function(e,t){const n=(e,t)=>e,r=(e,t)=>s(e,t,n);return((e,t)=>i(e,t,r))(e,t)},n.SortByEntryHash=function(e,t){const n=(e,t)=>e.hash<t.hash?-1:1,r=(e,t)=>s(e,t,n);return((e,t)=>i(e,t,r))(e,t)},n.NoZeroes=function(e){const t=`Your log's tiebreaker function, ${e.name}, has returned zero and therefore cannot be`;return(n,r)=>{const i=e(n,r);if(0===i)throw Error(t);return i}}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4325,{"./default-access-controller":4316,"./entry":4319,"./entry-index":4317,"./g-set":4320,"./lamport-clock":4321,"./log-errors":4322,"./log-io":4323,"./log-sorting":4324,"./utils":4328,buffer:1936,"p-each-series":5205},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("p-each-series"),i=e("./g-set"),s=e("./entry"),a=e("./log-io"),o=e("./log-errors"),c=e("./lamport-clock"),u=e("./log-sorting"),{LastWriteWins:l,NoZeroes:f}=u,h=e("./default-access-controller"),{isDefined:d,findUniques:p}=e("./utils"),g=e("./entry-index"),b=e=>e.hash,m=(e,t)=>e.concat(t),w=e=>e.next,y=(e,t)=>Math.max(e,t.clock.time),_=(e,t)=>(e[t.hash]=t,e);class v extends i{constructor(e,t,{logId:n,access:r,entries:i,heads:s,clock:a,sortFn:u}={}){if(!d(e))throw o.IPFSNotDefinedError();if(!d(t))throw new Error("Identity is required");if(d(r)||(r=new h),d(i)&&!Array.isArray(i))throw new Error("'entries' argument must be an array of Entry instances");if(d(s)&&!Array.isArray(s))throw new Error("'heads' argument must be an array");d(u)||(u=l),super(),this._sortFn=f(u),this._storage=e,this._id=n||(new Date).getTime().toString(),this._access=r,this._identity=t,i=i||[],this._entryIndex=new g(i.reduce(_,{})),s=s||v.findHeads(i),this._headsIndex=s.reduce(_,{}),this._nextsIndex={};i.forEach((e=>e.next.forEach((t=>this._nextsIndex[t]=e.hash)))),this._length=i.length;const p=Math.max(a?a.time:0,this.heads.reduce(y,0));this._clock=new c(this._identity.publicKey,p)}get id(){return this._id}get clock(){return this._clock}get length(){return this._length}get values(){return Object.values(this.traverse(this.heads)).reverse()}get heads(){return Object.values(this._headsIndex).sort(this._sortFn).reverse()}get tails(){return v.findTails(this.values)}get tailHashes(){return v.findTailHashes(this.values)}setIdentity(e){this._identity=e;const t=Math.max(this.clock.time,this.heads.reduce(y,0));this._clock=new c(this._identity.publicKey,t)}get(e){return this._entryIndex.get(e)}has(e){return this._entryIndex.get(e.hash||e)!==undefined}traverse(e,t=-1,n){var r=e.sort(this._sortFn).reverse();let i={},s={},a=0;const o=e=>this.get(e),c=e=>{e&&!i[e.hash]&&(r=[e,...r].sort(this._sortFn).reverse(),i[e.hash]=!0)};for(;r.length>0&&(-1===t||a<t);){const e=r.shift();if(a++,s[e.hash]=e,e.next.map(o).filter(d).forEach(c),e.hash===n)break}return s}async append(e,t=1){const n=Math.max(this.clock.time,this.heads.reduce(y,0))+1;this._clock=new c(this.clock.id,n);const r=this.traverse(this.heads,Math.max(t,this.heads.length)),i=this.heads.reverse().reduce(_,{}),a=Object.keys(Object.assign({},i,r)),o=await s.create(this._storage,this._identity,this.id,e,a,this.clock);if(!await this._access.canAppend(o,this._identity.provider))throw new Error(`Could not append entry, key "${this._identity.id}" is not allowed to write to the log`);return this._entryIndex.set(o.hash,o),a.forEach((e=>this._nextsIndex[e]=o.hash)),this._headsIndex={},this._headsIndex[o.hash]=o,this._length++,o}iterator({gt:e=undefined,gte:t=undefined,lt:n=undefined,lte:r=undefined,amount:i=-1}={}){if(0===i)return function*(){}();if("string"==typeof r&&(r=[this.get(r)]),"string"==typeof n&&(n=[this.get(this.get(n).next)]),r&&!Array.isArray(r))throw o.LtOrLteMustBeStringOrArray();if(n&&!Array.isArray(n))throw o.LtOrLteMustBeStringOrArray();let s=r||n||this.heads,a=t?this.get(t).hash:e?this.get(e).hash:null,c=a?-1:i||-1,u=this.traverse(s,c,a),l=Object.values(u);return e&&l.pop(),(e||t)&&i>-1&&(l=l.slice(l.length-i,l.length)),function*(){for(let e in l)yield l[e]}()}async join(e,t=-1){if(!d(e))throw o.LogNotDefinedError();if(!v.isLog(e))throw o.NotALogError();if(this.id!==e.id)return;const n=v.difference(e,this),i=this._identity.provider,a=async e=>{if(!await this._access.canAppend(e,i))throw new Error(`Could not append entry, key "${e.identity.id}" is not allowed to write to the log`)},u=Object.values(n);await r(u,(async e=>{await a(e),await(async e=>{const t=await s.verify(i,e),n=e.identity?e.identity.publicKey:e.key;if(!t)throw new Error(`Could not validate signature "${e.sig}" for entry "${e.hash}" and key "${n}"`)})(e)}));Object.values(n).forEach((e=>{this.get(e.hash)||this._length++,e.next.forEach((t=>this._nextsIndex[t]=e.hash))})),this._entryIndex.add(n);const l=Object.values(n).map(w).reduce(m,[]),f=v.findHeads(Object.values(Object.assign({},this._headsIndex,e._headsIndex))).filter((e=>!l.find((t=>t===e.hash)))).filter((e=>!this._nextsIndex[e.hash])).reduce(_,{});if(this._headsIndex=f,t>-1){let e=this.values;e=e.slice(-t),this._entryIndex=null,this._entryIndex=new g(e.reduce(_,{})),this._headsIndex=v.findHeads(e).reduce(_,{}),this._length=this._entryIndex.length}const h=Object.values(this._headsIndex).reduce(y,0);return this._clock=new c(this.clock.id,Math.max(this.clock.time,h)),this}toJSON(){return{id:this.id,heads:this.heads.sort(this._sortFn).reverse().map(b)}}toSnapshot(){return{id:this.id,heads:this.heads,values:this.values}}toBuffer(){return n.from(JSON.stringify(this.toJSON()))}toString(e){return this.values.slice().reverse().map(((t,n)=>{const r=s.findChildren(t,this.values).length;let i=new Array(Math.max(r-1,0));return i=r>1?i.fill("  "):i,i=r>0?i.concat(["└─"]):i,i.join("")+(e?e(t.payload):t.payload)})).join("\n")}static isLog(e){return e.id!==undefined&&e.heads!==undefined&&e._entryIndex!==undefined}toMultihash({format:e}={}){return a.toMultihash(this._storage,this,{format:e})}static async fromMultihash(e,t,n,{access:r,length:i=-1,exclude:s,onProgressCallback:o,sortFn:u,timeout:l,format:f}={}){const h=await a.fromMultihash(e,n,{length:i,exclude:s,onProgressCallback:o,timeout:l,format:f});return new v(e,t,{logId:h.id,access:r,entries:h.values,heads:h.heads,clock:new c(h.clock.id,h.clock.time),sortFn:u})}static async fromEntryHash(e,t,n,{logId:r,access:i,length:s=-1,exclude:o,onProgressCallback:c,sortFn:u,timeout:l}){const f=await a.fromEntryHash(e,n,{length:s,exclude:o,onProgressCallback:c,timeout:l});return new v(e,t,{logId:r,access:i,entries:f.values,sortFn:u})}static async fromJSON(e,t,n,{access:r,length:i=-1,timeout:s,onProgressCallback:o,sortFn:c}={}){const u=await a.fromJSON(e,n,{length:i,timeout:s,onProgressCallback:o});return new v(e,t,{logId:u.id,access:r,entries:u.values,sortFn:c})}static async fromEntry(e,t,n,{access:r,length:i=-1,exclude:s,onProgressCallback:o,timeout:c,sortFn:u}={}){const l=await a.fromEntry(e,n,{length:i,exclude:s,onProgressCallback:o,timeout:c});return new v(e,t,{logId:l.id,access:r,entries:l.values,sortFn:u})}static findHeads(e){var t=e.reduce(((e,t,n,r)=>(t.next.forEach((n=>e[n]=t.hash)),e)),{});return e.filter((e=>t[e.hash]===undefined)).sort(((e,t)=>e.clock.id>t.clock.id))}static findTails(e){var t={},n=[],r={},i=[];e.forEach((e=>{0===e.next.length&&n.push(e);e.next.forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)})),i=i.concat(e.next),r[e.hash]=!0}));const a=i.filter((e=>r[e]===undefined)).map((e=>t[e])).reduce(((e,t,n,r)=>e.concat(p(t,"hash"))),[]).concat(n);return p(a,"hash").sort(s.compare)}static findTailHashes(e){var t={};return e.forEach((e=>t[e.hash]=!0)),e.reduce(((e,n,r,i)=>(n.next.reverse().forEach((n=>{t[n]===undefined&&e.splice(0,0,n)})),e)),[])}static difference(e,t){let n=Object.keys(e._headsIndex),r={},i={};const s=e=>{r[e]||t.get(e)||(n.push(e),r[e]=!0)};for(;n.length>0;){const a=n.shift(),o=e.get(a);o&&!t.get(a)&&o.id===t.id&&(i[o.hash]=o,r[o.hash]=!0,o.next.forEach(s))}return i}}t.exports=v,t.exports.Sorting=u,t.exports.AccessController=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4326,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(e,t,n){var r={},i={};return e.forEach((e=>i[n?e[n]:e]=!0)),t.reduce(((e,t)=>{var s=i[n?t[n]:t]!==undefined,a=r[n?t[n]:t]!==undefined;return s||a||(e.push(t),r[n?t[n]:t]=!0),e}),[])}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4327,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(e,t){let n={};return e.forEach((e=>n[t?e[t]:e]=e)),Object.keys(n).map((e=>n[e]))}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4328,{"./difference":4326,"./find-uniques":4327,"./is-defined":4329,"orbit-db-io":5183},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./difference"),i=e("./find-uniques"),s=e("./is-defined"),a=e("orbit-db-io");t.exports={difference:r,findUniques:i,isDefined:s,io:a}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4329,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e=>e!==undefined&&null!==e}}},{package:"3box>3box-orbitdb-plugins>ipfs-log"}],[4330,{"./src/core":4333},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e("./src/core")}}},{package:"3box>ipfs>ipfs-mfs"}],[4331,{"./mkdir":4335,"./utils/add-link":4340,"./utils/apply-default-options":4341,"./utils/to-mfs-path":4348,"./utils/to-sources-and-destination":4350,"./utils/to-trail":4352,"./utils/update-mfs-root":4353,"./utils/update-tree":4354,debug:2108,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./mkdir"),i=e("debug")("ipfs:mfs:cp"),s=e("err-code"),a=e("./utils/update-tree"),o=e("./utils/update-mfs-root"),c=e("./utils/add-link"),u=e("./utils/apply-default-options"),l=e("./utils/to-mfs-path"),f=e("./utils/to-sources-and-destination"),h=e("./utils/to-trail"),d={parents:!1,flush:!0,format:"dag-pb",hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};t.exports=e=>async function(...t){const n=u(t,d);let{sources:a,destination:o}=await f(e,t);if(!a.length)throw s(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");if(!o)throw s(new Error("Please supply a destination"),"ERR_INVALID_PARAMS");n.parents=n.p||n.parents;const c=a.find((e=>!e.exists));if(c)throw s(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");const m=p(o);if(o.exists){if(i("Destination exists"),1===a.length&&!m)throw s(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(i("Destination does not exist"),a.length>1){if(!n.parents)throw s(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await r(e)(o.path,n),o=await l(e,o.path)}const w=p(o)?o.mfsPath:o.mfsDirectory,y=await h(e,w,n);if(1===a.length){const t=a.pop(),r=m?t.name:o.name;return i(`Only one source, copying to destination ${m?"directory":"file"} ${r}`),g(e,t,r,y,n)}return i("Multiple sources, wrapping in a directory"),b(e,a,o,y,n)};const p=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),g=async(e,t,n,r,i)=>{let s=r.pop();s=await m(e,t,n,s,i),r.push(s);const c=await a(e,r,i);await o(e,c)},b=async(e,t,n,r,i)=>{for(let r=0;r<t.length;r++){const s=t[r];n=await m(e,s,s.name,n,i)}r[r.length-1]=n;const s=await a(e,r,i);await o(e,s)},m=async(e,t,n,r,i)=>{const s=await e.repo.blocks.get(t.cid),{node:a,cid:o}=await c(e,{parentCid:r.cid,size:s.data.length,cid:t.cid,name:n,format:i.format,hashAlg:i.hashAlg,cidVersion:i.cidVersion});return r.node=a,r.cid=o,r.size=a.size,r}}}},{package:"3box>ipfs>ipfs-mfs"}],[4332,{"./stat":4339,"./utils/apply-default-options":4341,"./utils/constants":4342},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./utils/apply-default-options"),i=e("./stat"),{FILE_SEPARATOR:s}=e("./utils/constants"),a={};t.exports=e=>async function(t=s,n=a){n=r(n,a),await i(e)(t,n)}}}},{package:"3box>ipfs>ipfs-mfs"}],[4333,{"./cp":4331,"./flush":4332,"./ls":4334,"./mkdir":4335,"./mv":4336,"./read":4337,"./rm":4338,"./stat":4339,"./utils/create-lock":4343,"./write":4356,assert:1564,"promisify-es6":5265},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("assert"),i=e("promisify-es6"),s=e("./utils/create-lock"),a={stat:e("./stat")},o={cp:e("./cp"),flush:e("./flush"),mkdir:e("./mkdir"),mv:e("./mv"),rm:e("./rm")},c={write:e("./write"),read:e("./read"),ls:e("./ls")},u=({options:e,mfs:t,operations:n,lock:r})=>{Object.keys(n).forEach((i=>{t[i]=r(n[i](e))}))},l={repoOwner:!0,ipld:null,repo:null};t.exports=e=>{const{repoOwner:t}=Object.assign({},l||{},e);r(e.ipld,"MFS requires an IPLD instance"),r(e.blocks,"MFS requires an BlockStore instance"),r(e.datastore,"MFS requires a DataStore instance"),e.repo={blocks:{get:i(e.blocks.get,{context:e.blocks})},datastore:{open:i(e.datastore.open,{context:e.datastore}),get:i(e.datastore.get,{context:e.datastore}),put:i(e.datastore.put,{context:e.datastore})}};const n=s(t),f={};return u({options:e,mfs:f,operations:a,lock:e=>n.readLock(e)}),u({options:e,mfs:f,operations:o,lock:e=>n.writeLock(e)}),Object.keys(c).forEach((t=>{f[t]=c[t](e)})),f}}}},{package:"3box>ipfs>ipfs-mfs"}],[4334,{"./utils/apply-default-options":4341,"./utils/constants":4342,"./utils/to-mfs-path":4348,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("ipfs-unixfs-exporter"),i=e("./utils/apply-default-options"),s=e("./utils/to-mfs-path"),{FILE_SEPARATOR:a,FILE_TYPES:o}=e("./utils/constants"),c={},u=e=>{let t=0,n=e.node.size||e.node.length;return e.unixfs&&(n=e.unixfs.fileSize(),t=o[e.unixfs.type]),{cid:e.cid,name:e.name,type:t,size:n}};t.exports=e=>async function*(t=a,n={}){"object"!=typeof t||t instanceof String||(n=t,t=a),n=i(n,c);const o=await s(e,t),l=await r(o.mfsPath,e.ipld);if(l.unixfs&&l.unixfs.type.includes("directory"))for await(const e of l.content(n))yield u(e);else yield u(l)}}}},{package:"3box>ipfs>ipfs-mfs"}],[4335,{"./utils/add-link":4340,"./utils/apply-default-options":4341,"./utils/constants":4342,"./utils/create-node":4344,"./utils/to-path-components":4349,"./utils/update-mfs-root":4353,"./utils/update-tree":4354,"./utils/with-mfs-root":4355,debug:2108,"err-code":2210,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i=e("debug")("ipfs:mfs:mkdir"),s=e("ipfs-unixfs-exporter"),a=e("./utils/create-node"),o=e("./utils/to-path-components"),c=e("./utils/update-mfs-root"),u=e("./utils/update-tree"),l=e("./utils/add-link"),f=e("./utils/with-mfs-root"),h=e("./utils/apply-default-options"),{FILE_SEPARATOR:d}=e("./utils/constants"),p={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,format:"dag-pb",flush:!0};t.exports=e=>async function(t,n){if(n=h(n,p),!t)throw new Error("no path given to Mkdir");if((t=t.trim())===d){if(n.parents)return;throw r(new Error(`cannot create directory '${d}': Already exists`),"ERR_INVALID_PATH")}if(t.substring(0,1)!==d)throw r(new Error("paths must start with a leading /"),"ERR_INVALID_PATH");i(`Creating ${t}`);const l=o(t);if("ipfs"===l[0])throw r(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let b,m=await f(e),w=[];const y=await a(e,"directory",n);for(let t=0;t<=l.length;t++){const a=l.slice(0,t),o=`/ipfs/${m}/${a.join("/")}`;try{if(b=await s(o,e.ipld),i(`${o} existed`),i(`${o} had children ${b.node.Links.map((e=>e.Name))}`),t===l.length){if(n.parents)return;throw r(new Error("file already exists"),"ERR_ALREADY_EXISTS")}w.push({name:b.name,cid:b.cid})}catch(i){if("ERR_NOT_FOUND"!==i.code)throw i;if(t<l.length&&!n.parents)throw r(new Error(`Intermediate directory path ${o} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await g(e,a[a.length-1],y,w[w.length-1],w,n)}}const _=await u(e,w,n);await c(e,_)};const g=async(e,t,n,r,s,a)=>{i(`Adding empty dir called ${t} to ${r.cid}`);const o=await l(e,{parent:r.node,parentCid:r.cid,size:n.node.size,cid:n.cid,name:t,format:a.format,hashAlg:a.hashAlg,cidVersion:a.cidVersion});s[s.length-1].cid=o.cid,s.push({name:t,cid:n.cid})}}}},{package:"3box>ipfs>ipfs-mfs"}],[4336,{"./cp":4331,"./rm":4338,"./utils/apply-default-options":4341,"./utils/to-sources":4351},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./utils/apply-default-options"),i=e("./utils/to-sources"),s=e("./cp"),a=e("./rm"),o={parents:!1,recursive:!1,flush:!0,format:"dag-pb",hashAlg:"sha2-256",shardSplitThreshold:1e3};t.exports=e=>async function(...t){Array.isArray(t[0])&&(t=t[0].concat(t.slice(1)));const{sources:n}=await i(e,t),c=r(t,o),u=n.map((e=>e.path)).concat(c),l=n.slice(0,-1).map((e=>e.path)).concat(Object.assign(c,{recursive:!0}));await s(e).apply(null,u),await a(e).apply(null,l)}}}},{package:"3box>ipfs>ipfs-mfs"}],[4337,{"./utils/apply-default-options":4341,"./utils/to-mfs-path":4348,"err-code":2210,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("ipfs-unixfs-exporter"),i=e("./utils/apply-default-options"),s=e("./utils/to-mfs-path"),a=e("err-code"),o={offset:0,length:Infinity};t.exports=e=>function(t,n={}){return n=i(n,o),{[Symbol.asyncIterator]:async function*(){const i=await s(e,t),o=await r(i.mfsPath,e.ipld);if("file"!==o.unixfs.type)throw a(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw a(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(const e of o.content({offset:n.offset,length:n.length}))yield e}}}}}},{package:"3box>ipfs>ipfs-mfs"}],[4338,{"./utils/apply-default-options":4341,"./utils/constants":4342,"./utils/remove-link":4346,"./utils/to-mfs-path":4348,"./utils/to-sources":4351,"./utils/to-trail":4352,"./utils/update-mfs-root":4353,"./utils/update-tree":4354,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i=e("./utils/update-tree"),s=e("./utils/update-mfs-root"),a=e("./utils/to-sources"),o=e("./utils/remove-link"),c=e("./utils/to-mfs-path"),u=e("./utils/to-trail"),l=e("./utils/apply-default-options"),{FILE_SEPARATOR:f}=e("./utils/constants"),h={recursive:!1,cidVersion:0,hashAlg:"sha2-256",format:"dag-pb",flush:!0};t.exports=e=>async function(){const t=Array.from(arguments),{sources:n}=await a(e,t,h),i=l(t,h);if(!n.length)throw r(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");n.forEach((e=>{if(e.path===f)throw r(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")}));for(const t of n)await d(e,t.path,i)};const d=async(e,t,n)=>{const a=await c(e,t),l=await u(e,a.mfsPath,n),f=l.pop(),h=l[l.length-1];if(!h)throw r(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if("directory"===f.type&&!n.recursive)throw r(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:d}=await o(e,{parentCid:h.cid,name:f.name,format:n.format,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush});h.cid=d;const p=await i(e,l,n);await s(e,p)}}}},{package:"3box>ipfs>ipfs-mfs"}],[4339,{"./utils/apply-default-options":4341,"./utils/to-mfs-path":4348,debug:2108,"err-code":2210,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./utils/apply-default-options"),i=e("./utils/to-mfs-path"),s=e("ipfs-unixfs-exporter"),a=e("debug")("ipfs:mfs:stat"),o=e("err-code"),c={withLocal:!1};t.exports=e=>async function(t,n){n=r(n,c),a(`Fetching stats for ${t}`);const{type:l,cid:f,mfsPath:h}=await i(e,t);let d,p="ipfs"===l&&f?f:h;try{d=await s(p,e.ipld)}catch(e){if("ERR_NOT_FOUND"===e.code)throw o(new Error(`${t} does not exist`),"ERR_NOT_FOUND");throw e}if(!u[d.cid.codec])throw new Error(`Cannot stat codec ${d.cid.codec}`);return u[d.cid.codec](d,n)};const u={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:undefined,sizeLocal:undefined,withLocality:!1}),"dag-pb":e=>{let t=e.node.Links.length,n=e.node.size,r=e.node.size,i=null;return e.unixfs&&(n=e.unixfs.fileSize(),i=e.unixfs.type,i.includes("directory")&&(n=0,r=e.node.size),"file"===i&&(t=e.unixfs.blockSizes.length)),{cid:e.cid,size:n,cumulativeSize:r,blocks:t,type:i,local:undefined,sizeLocal:undefined,withLocality:!1}},"dag-cbor":e=>({cid:e.cid,local:undefined,sizeLocal:undefined,withLocality:!1})}}}},{package:"3box>ipfs>ipfs-mfs"}],[4340,{"./hamt-utils":4345,"async-iterator-last":1571,cids:1973,debug:2108,"err-code":2210,"ipfs-unixfs":4409,"ipfs-unixfs-importer/src/dir-sharded":4402,"ipld-dag-pb":4546,multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){const{DAGNode:r,DAGLink:i}=e("ipld-dag-pb"),s=e("cids"),a=e("debug")("ipfs:mfs:core:utils:add-link"),o=e("ipfs-unixfs"),c=e("ipfs-unixfs-importer/src/dir-sharded"),{updateHamtDirectory:u,recreateHamtLevel:l,createShard:f,toPrefix:h,addLinksToHamtBucket:d}=e("./hamt-utils"),p=e("err-code"),g=e("multicodec"),b=e("multihashes"),m=e("async-iterator-last"),w=async(e,t)=>{const n=await f(e,t.parent.Links.map((e=>({name:e.Name,size:e.Tsize,cid:e.Hash}))).concat({name:t.name,size:t.size,cid:t.cid}),t);return a(`Converted directory to sharded directory ${n.cid}`),n},y=async(e,t)=>{let n=await r.rmLink(t.parent,t.name);n=await r.addLink(n,new i(t.name,t.size,t.cid));const s=g[t.format.toUpperCase().replace(/-/g,"_")],a=b.names[t.hashAlg];return{node:n,cid:await e.ipld.put(n,s,{cidVersion:t.cidVersion,hashAlg:a,hashOnly:!t.flush})}},_=async(e,t)=>{const{shard:n,path:i}=await v(e,t),s=await m(n.flush("",e.ipld)),a=t.parent.Links.find((e=>e.Name.substring(0,2)===i[0].prefix)),o=s.node.Links.find((e=>e.Name.substring(0,2)===i[0].prefix));let c=t.parent;return a&&(c=await r.rmLink(t.parent,a.Name)),c=await r.addLink(c,o),u(e,c.Links,i[0].bucket,t)},v=async(e,t)=>{const n={name:t.name,cid:t.cid,size:t.size},r=await l(t.parent.Links),i=new c({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1},t);i._bucket=r;const s=await r._findNewBucketAndPos(n.name),o=k(s);o[0].node=t.parent;let u=0;for(;u<o.length;){let t=o[u];u++;let i=t.node.Links.find((e=>e.Name.substring(0,2)===t.prefix));if(!i){a(`Link ${t.prefix}${n.name} will be added`),u=o.length;break}if(i.Name===`${t.prefix}${n.name}`){a(`Link ${t.prefix}${n.name} will be replaced`),u=o.length;break}if(i.Name.length>2){a(`Link ${i.Name} will be replaced with a subshard`),u=o.length;break}a(`Found subshard ${t.prefix}`);const s=await e.ipld.get(i.Hash);if(!o[u]){a(`Loaded new subshard ${t.prefix}`),await l(s.Links,r,t.bucket,parseInt(t.prefix,16));const e=await r._findNewBucketAndPos(n.name);o.push({bucket:e.bucket,prefix:h(e.pos),node:s});break}const c=o[u];await d(s.Links,c.bucket,r),c.node=s}return await i._bucket.put(n.name,{size:n.size,cid:n.cid}),{shard:i,path:o}},k=e=>{let t=e.bucket,n=e.pos,r=[{bucket:t,prefix:h(n)}];for(t=e.bucket._parent,n=e.bucket._posAtParent;t;)r.push({bucket:t,prefix:h(n)}),n=t._posAtParent,t=t._parent;return r.reverse(),r};t.exports=async(e,t)=>{if(!t.parentCid&&!t.parent)throw p(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(t.parentCid&&!s.isCID(t.parentCid))throw p(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(t.parent||(a(`Loading parent node ${t.parentCid}`),t.parent=await e.ipld.get(t.parentCid)),!t.cid)throw p(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw p(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(s.isCID(t.cid)||(t.cid=new s(t.cid)),!t.size&&0!==t.size)throw p(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");return"hamt-sharded-directory"===o.unmarshal(t.parent.Data).type?(a("Adding link to sharded directory"),_(e,t)):t.parent.Links.length>=t.shardSplitThreshold?(a("Converting directory to sharded directory"),w(e,t)):(a(`Adding ${t.name} (${t.cid}) to regular directory`),y(e,t))}}}},{package:"3box>ipfs>ipfs-mfs"}],[4341,{"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code");t.exports=(e={},t)=>{Array.isArray(e)&&(e=e.filter((e=>"object"==typeof e)).pop()||{});const n={};for(let r in t)null!==e[r]&&e[r]!==undefined?n[r]=e[r]:n[r]=t[r];const i=n.format||n.codec;if(i&&isNaN(i)&&(n.format=i,delete n.codec),e.count!==undefined&&(n.length=e.count),e.p!==undefined&&(n.parents=e.p),e.l!==undefined&&(n.long=e.l),n.length||0===n.length||(n.length=Infinity),n.offset<0)throw r(new Error("cannot have negative write offset"),"ERR_INVALID_PARAMS");if(n.length<0)throw r(new Error("cannot have negative byte count"),"ERR_INVALID_PARAMS");return n}}}},{package:"3box>ipfs>ipfs-mfs"}],[4342,{"interface-datastore":4283},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("interface-datastore").Key;t.exports={FILE_SEPARATOR:"/",MFS_ROOT_KEY:new r("/local/filesroot"),MAX_CHUNK_SIZE:262144,MAX_LINKS:174,FILE_TYPES:{file:0,directory:1,"hamt-sharded-directory":1}}}}},{package:"3box>ipfs>ipfs-mfs"}],[4343,{mortice:5048},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("mortice");let i;t.exports=e=>{if(i)return i;const t=r({singleProcess:e});return i={readLock:e=>(...n)=>t.readLock((()=>e.apply(null,n))),writeLock:e=>(...n)=>t.writeLock((()=>e.apply(null,n)))},i}}}},{package:"3box>ipfs>ipfs-mfs"}],[4344,{"ipfs-unixfs":4409,"ipld-dag-pb":4546,multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("ipfs-unixfs"),{DAGNode:i}=e("ipld-dag-pb"),s=e("multicodec"),a=e("multihashes");t.exports=async(e,t,n)=>{const o=s[n.format.toUpperCase().replace(/-/g,"_")],c=a.names[n.hashAlg],u=i.create(new r(t).marshal());return{cid:await e.ipld.put(u,o,{cidVersion:n.cidVersion,hashAlg:c}),node:u}}}}},{package:"3box>ipfs>ipfs-mfs"}],[4345,{"async-iterator-last":1571,buffer:1936,debug:2108,"hamt-sharding/src/bucket":4206,"ipfs-unixfs":4409,"ipfs-unixfs-importer/src/dir-sharded":4402,"ipld-dag-pb":4546,multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const{DAGNode:r}=e("ipld-dag-pb"),i=e("hamt-sharding/src/bucket"),s=e("ipfs-unixfs-importer/src/dir-sharded"),a=e("debug")("ipfs:mfs:core:utils:hamt-utils"),o=e("ipfs-unixfs"),c=e("multicodec"),u=e("multihashes"),l=e("async-iterator-last"),f=async(e,t,n,r)=>{const a=new i({hashFn:s.hashFn,hash:n?n._options.hash:undefined},n,r);return n&&n._putObjectAt(r,a),await h(e,a,t),a},h=async(e,t,n)=>{await Promise.all(e.map((e=>{if(2===e.Name.length){const n=parseInt(e.Name,16);return t._putObjectAt(n,new i({hashFn:s.hashFn},t,n)),Promise.resolve()}return(n||t).put(e.Name.substring(2),{size:e.TSize,cid:e.Hash})})))},d=e=>e.toString("16").toUpperCase().padStart(2,"0").substring(0,2);t.exports={generatePath:async(e,t,n)=>{const r=await f(n.Links,null,null,null),i=await r._findNewBucketAndPos(t);let s=[{bucket:i.bucket,prefix:d(i.pos)}],o=i.bucket;for(;o!==r;)s.push({bucket:o,prefix:d(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=n;for(let n=0;n<s.length;n++){const i=s[n],o=i.node.Links.filter((e=>e.Name.substring(0,2)===i.prefix)).pop();if(!o){a(`Link ${i.prefix}${t} will be added`);continue}if(o.Name===`${i.prefix}${t}`){a(`Link ${i.prefix}${t} will be replaced`);continue}a(`Found subshard ${i.prefix}`);const c=await e.ipld.get(o.Hash);if(!s[n+1]){a(`Loaded new subshard ${i.prefix}`),await f(c.Links,r,i.bucket,parseInt(i.prefix,16));const e=await r._findNewBucketAndPos(t);s.push({bucket:e.bucket,prefix:d(e.pos),node:c});continue}const u=s[n+1];await h(c.Links,u.bucket,r),u.node=c}return await r.put(t,!0),s.reverse(),{rootBucket:r,path:s}},updateHamtDirectory:async(e,t,i,a)=>{const l=n.from(i._children.bitField().reverse()),f=new o("hamt-sharded-directory",l);f.fanout=i.tableSize(),f.hashType=s.hashFn.code;const h=c[a.format.toUpperCase().replace(/-/g,"_")],d=u.names[a.hashAlg],p=r.create(f.marshal(),t);return{node:p,cid:await e.ipld.put(p,h,{cidVersion:a.cidVersion,hashAlg:d,hashOnly:!a.flush})}},recreateHamtLevel:f,addLinksToHamtBucket:h,toPrefix:d,createShard:async(e,t,n)=>{const r=new s({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1},n);for(let e=0;e<t.length;e++)await r._bucket.put(t[e].name,{size:t[e].size,cid:t[e].cid});return l(r.flush("",e.ipld,null))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-mfs"}],[4346,{"./hamt-utils":4345,cids:1973,debug:2108,"err-code":2210,"ipfs-unixfs":4409,"ipld-dag-pb":4546,multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){const{DAGNode:r,DAGLink:i}=e("ipld-dag-pb"),s=e("cids"),a=e("debug")("ipfs:mfs:core:utils:remove-link"),o=e("ipfs-unixfs"),{generatePath:c,updateHamtDirectory:u}=e("./hamt-utils"),l=e("err-code"),f=e("multicodec"),h=e("multihashes"),d=async(e,t)=>{const n=f[t.format.toUpperCase().replace(/-/g,"_")],i=h.names[t.hashAlg],s=await r.rmLink(t.parent,t.name),o=await e.ipld.put(s,n,{cidVersion:t.cidVersion,hashAlg:i});return a(`Updated regular directory ${o}`),{node:s,cid:o}},p=async(e,t)=>{const{rootBucket:n,path:r}=await c(e,t.name,t.parent);await n.del(t.name);const{node:i}=await g(e,r,{name:t.name,cid:t.cid,size:t.size,hashAlg:t.hashAlg,format:t.format,cidVersion:t.cidVersion,flush:t.flush},t);return u(e,i.Links,n,t)},g=async(e,t,n,i)=>{const{bucket:s,prefix:o,node:c}=t.pop(),f=c.Links.find((e=>e.Name.substring(0,2)===o));if(!f)throw l(new Error(`No link found with prefix ${o} for file ${n.name}`),"ERR_NOT_FOUND");if(f.Name===`${o}${n.name}`){a(`Removing existing link ${f.Name}`);const t=await r.rmLink(c,f.Name);return await s.del(n.name),u(e,t.Links,s,i)}a(`Descending into sub-shard ${f.Name} for ${o}${n.name}`);const h=await g(e,t,n,i);let d=o;1===h.node.Links.length&&(a(`Removing subshard for ${o}`),h.cid=h.node.Links[0].Hash,h.node=h.node.Links[0],d=`${o}${h.node.Name.substring(2)}`),a(`Updating shard ${o} with name ${d}`);const p=r.isDAGNode(h.node)?h.node.size:h.node.Tsize;return b(e,s,c,o,d,p,h.cid,i)},b=async(e,t,n,s,a,o,c,l)=>(n=await r.rmLink(n,s),n=await r.addLink(n,new i(a,o,c)),u(e,n.Links,t,l));t.exports=async(e,t)=>{if(!t.parentCid&&!t.parent)throw l(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(t.parentCid&&!s.isCID(t.parentCid))throw l(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");if(t.parent||(a(`Loading parent node ${t.parentCid}`),t.parent=await e.ipld.get(t.parentCid)),!t.name)throw l(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");return"hamt-sharded-directory"===o.unmarshal(t.parent.Data).type?(a(`Removing ${t.name} from sharded directory`),p(e,t)):(a(`Removing link ${t.name} regular directory`),d(e,t))}}}},{package:"3box>ipfs>ipfs-mfs"}],[4347,{"./constants":4342,buffer:1936,debug:2108,"err-code":2210,fs:1935},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("err-code"),i=e("fs"),s=e("debug")("ipfs:mfs:utils:to-async-iterator"),{MAX_CHUNK_SIZE:a}=e("./constants");t.exports=async e=>{if(!e)throw r(new Error("paths must start with a leading /"),"ERR_INVALID_PATH");if("string"==typeof e||e instanceof String)return s("Content was a path"),i.createReadStream(e);if(e.length)return s("Content was array-like"),{[Symbol.asyncIterator]:async function*(){yield e}};if(e[Symbol.asyncIterator])return s("Content was an async iterator"),e;if(e[Symbol.iterator])return s("Content was an iterator"),e;if(global.Blob&&e instanceof global.Blob){s("Content was an HTML5 Blob");let t=0;const r={next:async()=>t>e.size?{done:!0}:new Promise(((r,i)=>{const s=e.slice(t,a);t+=a;const o=new global.FileReader,c=e=>{if(o.removeEventListener("loadend",c,!1),e.error)return i(e.error);r({done:!1,value:n.from(o.result)})};o.addEventListener("loadend",c),o.readAsArrayBuffer(s)}))};return{[Symbol.asyncIterator]:()=>r}}throw r(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-mfs"}],[4348,{"./constants":4342,"./to-path-components":4349,"./with-mfs-root":4355,"err-code":2210,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const{FILE_SEPARATOR:r}=e("./constants"),i=e("./with-mfs-root"),s=e("./to-path-components"),a=e("ipfs-unixfs-exporter"),o=e("err-code"),c="ipfs";t.exports=async(e,t)=>{let n=Array.isArray(t),u=Array.isArray(t)?t:[t];const l=await i(e);return u=u.map((e=>{if((e=(e=(e||"").trim()).replace(/(\/\/+)/g,"/")).endsWith("/")&&e.length>1&&(e=e.substring(0,e.length-1)),!e)throw o(new Error("paths must not be empty"),"ERR_NO_PATH");if(e.substring(0,1)!==r)throw o(new Error(`paths must start with a leading ${r}`),"ERR_INVALID_PATH");e.substring(e.length-r.length)===r&&(e=e.substring(0,e.length-r.length));const t=s(e);if(t[0]===c){let e;return e=2===t.length?`${r}${t.join(r)}`:`${r}${t.slice(0,t.length-1).join(r)}`,{type:"ipfs",depth:t.length-2,mfsPath:`${r}${t.join(r)}`,mfsDirectory:e,parts:t,path:`${r}${t.join(r)}`,name:t[t.length-1]}}const n=`/ipfs/${l}${t.length?"/"+t.join(r):""}`,i=`/ipfs/${l}/${t.slice(0,t.length-1).join(r)}`;return{type:"mfs",depth:t.length,mfsDirectory:i,mfsPath:n,parts:t,path:`${r}${t.join(r)}`,name:t[t.length-1]}})),await Promise.all(u.map((async t=>{const n="mfs"===t.type?t.mfsPath:t.path;try{const r=await a(n,e.ipld);t.cid=r.cid,t.mfsPath=`/ipfs/${r.path}`,t.unixfs=r.unixfs,t.content=r.content}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}t.exists=Boolean(t.cid)}))),n?u:u[0]}}}},{package:"3box>ipfs>ipfs-mfs"}],[4349,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}}},{package:"3box>ipfs>ipfs-mfs"}],[4350,{"./to-sources":4351},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./to-sources");t.exports=async function(e,t){const{sources:n,options:i}=await r(e,t);return{destination:n.pop(),sources:n,options:i}}}}},{package:"3box>ipfs>ipfs-mfs"}],[4351,{"./to-mfs-path":4348},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./to-mfs-path");t.exports=async function(e,t){Array.isArray(t[0])&&(t=t[0]);const n=t.filter((e=>"string"==typeof e)).map((e=>e.trim()));return{sources:await r(e,n)}}}}},{package:"3box>ipfs>ipfs-mfs"}],[4352,{debug:2108,"ipfs-unixfs-exporter":4380},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("ipfs-unixfs-exporter"),i=e("debug")("ipfs:mfs:utils:to-trail");t.exports=async(e,t)=>{i(`Creating trail for path ${t}`);const n=[];for await(const i of r.path(t,e.ipld))n.push({name:i.name,cid:i.cid,size:i.node.size,type:i.unixfs?i.unixfs.type:undefined});return n}}}},{package:"3box>ipfs>ipfs-mfs"}],[4353,{"./constants":4342,debug:2108},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("debug")("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:i}=e("./constants");t.exports=async(e,t)=>(r(`New MFS root will be ${t}`),await e.repo.datastore.put(i,t.buffer),t)}}},{package:"3box>ipfs>ipfs-mfs"}],[4354,{"./add-link":4340,debug:2108},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("debug")("ipfs:mfs:utils:update-tree"),i=e("./add-link"),s={shardSplitThreshold:1e3};t.exports=async(e,t,n)=>{n=Object.assign({},s,n),r("Trail",t),t=t.slice().reverse();let a,o=0;for await(const r of e.ipld.getMany(t.map((e=>e.cid)))){const s=t[o].cid,c=t[o].name;if(o++,!a){a={cid:s,name:c,size:r.size};continue}const u=await i(e,{parent:r,name:a.name,cid:a.cid,size:a.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,format:n.format,hashAlg:n.hashAlg,cidVersion:n.cidVersion});a={cid:u.cid,name:c,size:u.node.size}}return r(`Final CID ${a.cid}`),a.cid}}}},{package:"3box>ipfs>ipfs-mfs"}],[4355,{"./constants":4342,cids:1973,debug:2108,"ipfs-unixfs":4409,"ipld-dag-pb":4546,multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("cids"),i=e("ipfs-unixfs"),{DAGNode:s}=e("ipld-dag-pb"),a=e("debug")("ipfs:mfs:utils:with-mfs-root"),o=e("multicodec"),c=e("multihashes"),{MFS_ROOT_KEY:u}=e("./constants");t.exports=async e=>{let t;await e.repo.datastore.open();try{const n=await e.repo.datastore.get(u);t=new r(n)}catch(n){if("ERR_NOT_FOUND"!==n.code)throw n;a("Creating new MFS root");const r=s.create(new i("directory").marshal());t=await e.ipld.put(r,o.DAG_PB,{cidVersion:0,hashAlg:c.names["sha2-256"]}),await e.repo.datastore.put(u,t.buffer)}return a(`Loaded MFS root /ipfs/${t}`),t}}}},{package:"3box>ipfs>ipfs-mfs"}],[4356,{"./mkdir":4335,"./stat":4339,"./utils/add-link":4340,"./utils/apply-default-options":4341,"./utils/constants":4342,"./utils/create-lock":4343,"./utils/to-async-iterator":4347,"./utils/to-mfs-path":4348,"./utils/to-path-components":4349,"./utils/to-trail":4352,"./utils/update-mfs-root":4353,"./utils/update-tree":4354,"async-iterator-last":1571,buffer:1936,debug:2108,"err-code":2210,"ipfs-unixfs-importer":4405},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("debug")("ipfs:mfs:write"),i=e("ipfs-unixfs-importer"),s=e("./stat"),a=e("./mkdir"),o=e("./utils/add-link"),c=e("./utils/apply-default-options"),u=e("./utils/create-lock"),l=e("./utils/to-async-iterator"),f=e("./utils/to-mfs-path"),h=e("./utils/to-path-components"),d=e("./utils/to-trail"),p=e("./utils/update-tree"),g=e("./utils/update-mfs-root"),b=e("err-code"),{MAX_CHUNK_SIZE:m}=e("./utils/constants"),w=e("async-iterator-last"),y={offset:0,length:undefined,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",format:"dag-pb",parents:!1,progress:()=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};t.exports=e=>async function(t,n,i){let s,a,o;if(r("Hello world, writing",t,n,i),i=c(i,y),r("Reading source, destination and parent"),await u().readLock((async()=>{s=await l(n,i),a=await f(e,t),o=await f(e,a.mfsDirectory)}))(),r("Read source, destination and parent"),!i.parents&&!o.exists)throw b(new Error("directory does not exist"),"ERR_NO_EXIST");if(!i.create&&!a.exists)throw b(new Error("file does not exist"),"ERR_NO_EXIST");return _(e,t,s,a,i)};const _=async(e,t,n,r,i)=>{const c=await v(e,n,r,i);await u().writeLock((async()=>{const n=h(t),r=n.pop();let u=!1;try{await s(e)(`/${n.join("/")}`,i),u=!0}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}u||await a(e)(`/${n.join("/")}`,i);const l=await f(e,t),m=await d(e,l.mfsDirectory,i),w=m[m.length-1];if(!w.type.includes("directory"))throw b(new Error(`cannot write to ${w.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const y=await e.ipld.get(w.cid),_=await o(e,{parent:y,name:r,cid:c.cid,size:c.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,format:i.format,hashAlg:i.hashAlg,cidVersion:i.cidVersion});w.cid=_.cid;const v=await p(e,m,i);await g(e,v)}))()},v=async(e,t,n,s)=>{n.exists?r(`Overwriting file ${n.cid} offset ${s.offset} length ${s.length}`):r(`Writing file offset ${s.offset} length ${s.length}`);const a=[];s.offset>0&&(n.unixfs&&n.unixfs.fileSize()>s.offset?(r(`Writing first ${s.offset} bytes of original file`),a.push((()=>n.content({offset:0,length:s.offset})))):(r(`Writing zeros for first ${s.offset} bytes`),a.push(E(s.offset)))),a.push(k(t,s.length));const o=S(x(a),(e=>{if(n.unixfs&&!s.truncate){const t=n.unixfs.fileSize();if(t>e)return r(`Writing last ${t-e} of ${t} bytes from original file starting at offset ${e}`),n.content({offset:e});r("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}));let c=await w(i([{content:o}],e.ipld,{progress:s.progress,hashAlg:s.hashAlg,cidVersion:s.cidVersion,strategy:s.strategy,rawLeaves:s.rawLeaves,reduceSingleLeafToSelf:s.reduceSingleLeafToSelf,leafType:s.leafType}));return r(`Wrote ${c.cid}`),{cid:c.cid,size:c.size}},k=(e,t)=>async function*(){let n=0;for await(const r of e){if(n+=r.length,n>t)return void(yield r.slice(0,t-n));yield r}},E=(e,t=m)=>{const r=n.alloc(t,0),i={[Symbol.asyncIterator]:async function*(){for(;;)yield r.slice()}};return k(i,e)},x=async function*(e){for(let t=0;t<e.length;t++)for await(const n of e[t]())yield n},S=async function*(e,t){let n=0;for await(const t of e)n+=t.length,yield t;for await(const e of t(n))n+=e.length,yield e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-mfs"}],[4357,{"./lib/XMLHttpRequest":4358},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("./lib/XMLHttpRequest");function i(e){if(!(this instanceof i))throw new Error('[ipfs-mini] IPFS instance must be instantiated with "new" flag (e.g. var ipfs = new IPFS("http://localhost:8545");).');this.setProvider(e||{})}function s(){}function a(e){return new Promise(e)}function o(e){e(s,s)}t.exports=i,i.prototype.setProvider=function(e){if("object"!=typeof e)throw new Error(`[ifpsjs] provider must be type Object, got '${typeof e}'.`);var t=this.provider=Object.assign({host:"127.0.0.1",pinning:!0,port:"5001",protocol:"http",base:"/api/v0"},e||{});this.requestBase=String(`${t.protocol}://${t.host}:${t.port}${t.base}`)},i.prototype.sendAsync=function(e,t){var n=this,i=new r,c=e||{};return(t?o:a)((function(r,a){function o(e,n){return(t||s)(e,c.takeHash&&n?n.Hash:n),e?a(e):!e&&n?r(c.takeHash?n.Hash:n):void 0}i.onreadystatechange=function(){if(4===i.readyState&&1!==i.timeout)if(200!==i.status)o(new Error(`[ipfs-mini] status ${i.status}: ${i.responseText}`),null);else try{o(null,c.jsonParse?JSON.parse(i.responseText):i.responseText)}catch(e){o(new Error(`[ipfs-mini] while parsing data: '${String(i.responseText)}', error: ${String(e)} with provider: '${n.requestBase}'`,null))}};try{var u=n.provider.pinning&&"/add"===e.uri?"?pin=true":"";c.payload?i.open("POST",`${n.requestBase}${e.uri}${u}`):i.open("GET",`${n.requestBase}${e.uri}${u}`),c.accept&&i.setRequestHeader("accept",c.accept),c.payload&&c.boundary?(i.setRequestHeader("Content-Type",`multipart/form-data; boundary=${c.boundary}`),i.send(c.payload)):i.send()}catch(e){o(e,null)}}))},i.prototype.add=function(e,t){var n="object"==typeof e&&e.isBuffer?e.toString("binary"):e,r=function(e){for(;;){var t=`----IPFSMini${1e5*Math.random()}.${1e5*Math.random()}`;if(-1===e.indexOf(t))return t}}(n),i=`--${r}\r\nContent-Disposition: form-data; name="path"\r\nContent-Type: application/octet-stream\r\n\r\n${n}\r\n--${r}--`;return this.sendAsync({jsonParse:!0,accept:"application/json",uri:"/add",takeHash:!0,payload:i,boundary:r},t)},i.prototype.addJSON=function(e,t){return this.add(JSON.stringify(e),t)},i.prototype.stat=function(e,t){return this.sendAsync({jsonParse:!0,uri:`/object/stat/${e}`},t)},i.prototype.cat=function(e,t){return this.sendAsync({uri:`/cat/${e}`},t)},i.prototype.catJSON=function(e,t){return this.sendAsync({uri:`/cat/${e}`,jsonParse:!0},t)}}}},{package:"3box>ipfs-mini"}],[4358,{},function(){with(this)return function(){"use strict";return function(e,t,n){const r=window.XMLHttpRequest;t.exports=r}}},{package:"3box>ipfs-mini"}],[4359,{buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("buffer"),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(s(r,n),n.Buffer=a),s(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return t!==undefined?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}}},{package:"3box>orbit-db>ipfs-pubsub-1on1>safe-buffer"}],[4360,{"./encoding":4361,"./get-peer-id":4362,"./protocol":4363,"./wait-for-peers":4364,events:1937,path:5237},function(){with(this)return function(){"use strict";return function(e,t,n){e("path");const r=e("events"),i=e("./protocol"),s=e("./encoding"),a=e("./wait-for-peers"),o=e("./get-peer-id");class c extends r{constructor(e,t){if(super(),this._ipfs=e,!e.pubsub)throw new Error("This IPFS node does not support pubsub.");if(this._receiverID=t,!this._receiverID)throw new Error("Receiver ID was undefined")}get id(){return this._id}get peers(){return this._peers}async connect(){await a(this._ipfs,[this._receiverID],this._id)}async send(e){let t=s(e);await this._ipfs.pubsub.publish(this._id,t)}close(){this.removeAllListeners("message"),this._ipfs.pubsub.unsubscribe(this._id,this._messageHandler)}async _setup(){this._senderID=await o(this._ipfs),this._peers=Array.from([this._senderID,this._receiverID]).sort(),this._id="/"+i+"/"+this._peers.join("/"),this._messageHandler=e=>{e&&e.from===this._receiverID&&this.emit("message",e)}}async _openChannel(){await this._setup(),await this._ipfs.pubsub.subscribe(this._id,this._messageHandler)}static async open(e,t){const n=new c(e,t);return await n._openChannel(),n}}t.exports=c}}},{package:"3box>orbit-db>ipfs-pubsub-1on1"}],[4361,{"safe-buffer":4359},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("safe-buffer").Buffer;t.exports=e=>{let t=e;return r.isBuffer(t)||(t=r.from(t)),t}}}},{package:"3box>orbit-db>ipfs-pubsub-1on1"}],[4362,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=async e=>(await e.id()).id}}},{package:"3box>orbit-db>ipfs-pubsub-1on1"}],[4363,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports="ipfs-pubsub-direct-channel/v1"}}},{package:"3box>orbit-db>ipfs-pubsub-1on1"}],[4364,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=async(e,t,n)=>{const r=async()=>{const r=await e.pubsub.peers(n);return 0===t.map((e=>r.includes(e))).filter((e=>!1===e)).length};return await r()?Promise.resolve():new Promise((async(e,t)=>{const n=setInterval((async()=>{try{await r()&&(clearInterval(n),e())}catch(e){t(e)}}),100)}))}}}},{package:"3box>orbit-db>ipfs-pubsub-1on1"}],[4365,{"./utils":4366,events:1937},function(){with(this)return function(){"use strict";return function(e,t,n){const{difference:r}=e("./utils"),i=e("events"),s={start:!0,pollInterval:1e3};class a extends i{constructor(e,t,n){super(),this._pubsub=e,this._topic=t,this._options=Object.assign({},s,n),this._peers=[],this._interval=null,this._options.start&&this.start()}get started(){return null!==this._interval}set started(e){throw new Error("'started' is read-only")}start(){this._interval&&this.stop(),this._interval=setInterval(this._pollPeers.bind(this),this._options.pollInterval)}stop(){clearInterval(this._interval),this._interval=null,this.removeAllListeners("error"),this.removeAllListeners("join"),this.removeAllListeners("leave")}async getPeers(){return this._peers=await this._pubsub.peers(this._topic),this._peers.slice()}hasPeer(e){return this._peers.includes(e)}async _pollPeers(){try{const e=await this._pubsub.peers(this._topic);a._emitJoinsAndLeaves(new Set(this._peers),new Set(e),this),this._peers=e}catch(e){clearInterval(this._interval),this.emit("error",e)}}static _emitJoinsAndLeaves(e,t,n){r(t,e).forEach((e=>n.emit("join",e))),r(e,t).forEach((e=>n.emit("leave",e)))}}t.exports=a}}},{package:"3box>orbit-db>orbit-db-pubsub>ipfs-pubsub-peer-monitor"}],[4366,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports.runWithDelay=async(e,t,n)=>{const r=await e(t);var i;return await(i=n,new Promise((e=>setTimeout(e,i)))),r},t.exports.difference=(e,t)=>new Set([...e].filter((e=>!t.has(e))))}}},{package:"3box>orbit-db>orbit-db-pubsub>ipfs-pubsub-peer-monitor"}],[4367,{},function(){with(this)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,s=Math.ceil,a=Math.floor,o="[BigNumber Error] ",c=o+"Number primitive has more than 15 significant digits: ",u=1e14,l=14,f=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,p=1e9;function g(e){var t=0|e;return e>0||e===t?t:t-1}function b(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function m(e,t){var n,r,i=e.c,s=t.c,a=e.s,o=t.s,c=e.e,u=t.e;if(!a||!o)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-o:a;if(a!=o)return a;if(n=a<0,r=c==u,!i||!s)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(o=(c=i.length)<(u=s.length)?c:u,a=0;a<o;a++)if(i[a]!=s[a])return i[a]>s[a]^n?1:-1;return c==u?0:c>u^n?1:-1}function w(e,t,n,r){if(e<t||e>n||e!==a(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function y(e){var t=e.c.length-1;return g(e.e/l)==t&&e.c[t]%2!=0}function _(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,k,E,x,S,A,R,T,N,I,O=q.prototype={constructor:q,toString:null,valueOf:null},P=new q(1),L=20,D=4,C=-7,B=21,M=-1e7,j=1e7,U=!1,z=1,F=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz";function q(e,t){var n,i,s,o,u,h,d,p,g=this;if(!(g instanceof q))return new q(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>j?g.c=g.e=null:e.e<M?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,u=e;u>=10;u/=10,o++);return void(o>j?g.c=g.e=null:(g.e=o,g.c=[e]))}p=String(e)}else{if(!r.test(p=String(e)))return E(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(o=p.indexOf("."))>-1&&(p=p.replace(".","")),(u=p.search(/e/i))>0?(o<0&&(o=u),o+=+p.slice(u+1),p=p.substring(0,u)):o<0&&(o=p.length)}else{if(w(t,2,H.length,"Base"),10==t)return K(g=new q(e),L+g.e+1,D);if(p=String(e),h="number"==typeof e){if(0*e!=0)return E(g,p,h,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,q.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(c+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=H.slice(0,t),o=u=0,d=p.length;u<d;u++)if(n.indexOf(i=p.charAt(u))<0){if("."==i){if(u>o){o=d;continue}}else if(!s&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){s=!0,u=-1,o=0;continue}return E(g,String(e),h,t)}h=!1,(o=(p=k(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):o=p.length}for(u=0;48===p.charCodeAt(u);u++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(u,++d)){if(d-=u,h&&q.DEBUG&&d>15&&(e>f||e!==a(e)))throw Error(c+g.s*e);if((o=o-u-1)>j)g.c=g.e=null;else if(o<M)g.c=[g.e=0];else{if(g.e=o,g.c=[],u=(o+1)%l,o<0&&(u+=l),u<d){for(u&&g.c.push(+p.slice(0,u)),d-=l;u<d;)g.c.push(+p.slice(u,u+=l));u=l-(p=p.slice(u)).length}else u-=d;for(;u--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function W(e,t,n,r){var i,s,a,o,c;if(null==n?n=D:w(n,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)c=b(e.c),c=1==r||2==r&&(a<=C||a>=B)?_(c,a):v(c,a,"0");else if(s=(e=K(new q(e),t,n)).e,o=(c=b(e.c)).length,1==r||2==r&&(t<=s||s<=C)){for(;o<t;c+="0",o++);c=_(c,s)}else if(t-=a,c=v(c,s,"0"),s+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-o)>0)for(s+1==o&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function G(e,t){for(var n,r=1,i=new q(e[0]);r<e.length;r++){if(!(n=new q(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function V(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>j?e.c=e.e=null:n<M?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,r){var i,o,c,f,d,p,g,b=e.c,m=h;if(b){e:{for(i=1,f=b[0];f>=10;f/=10,i++);if((o=t-i)<0)o+=l,c=t,g=(d=b[p=0])/m[i-c-1]%10|0;else if((p=s((o+1)/l))>=b.length){if(!r)break e;for(;b.length<=p;b.push(0));d=g=0,i=1,c=(o%=l)-l+1}else{for(d=f=b[p],i=1;f>=10;f/=10,i++);g=(c=(o%=l)-l+i)<0?0:d/m[i-c-1]%10|0}if(r=r||t<0||null!=b[p+1]||(c<0?d:d%m[i-c-1]),r=n<4?(g||r)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||r||6==n&&(o>0?c>0?d/m[i-c]:0:b[p-1])%10&1||n==(e.s<0?8:7)),t<1||!b[0])return b.length=0,r?(t-=e.e+1,b[0]=m[(l-t%l)%l],e.e=-t||0):b[0]=e.e=0,e;if(0==o?(b.length=p,f=1,p--):(b.length=p+1,f=m[l-o],b[p]=c>0?a(d/m[i-c]%m[c])*f:0),r)for(;;){if(0==p){for(o=1,c=b[0];c>=10;c/=10,o++);for(c=b[0]+=f,f=1;c>=10;c/=10,f++);o!=f&&(e.e++,b[0]==u&&(b[0]=1));break}if(b[p]+=f,b[p]!=u)break;b[p--]=0,f=1}for(o=b.length;0===b[--o];b.pop());}e.e>j?e.c=e.e=null:e.e<M&&(e.c=[e.e=0])}return e}function Z(e){var t,n=e.e;return null===n?e.toString():(t=b(e.c),t=n<=C||n>=B?_(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return q.clone=e,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(w(n=e[t],0,p,t),L=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(w(n=e[t],0,8,t),D=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(w(n[0],-p,0,t),w(n[1],0,p,t),C=n[0],B=n[1]):(w(n,-p,p,t),C=-(B=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)w(n[0],-p,-1,t),w(n[1],1,p,t),M=n[0],j=n[1];else{if(w(n,-p,p,t),!n)throw Error(o+t+" cannot be zero: "+n);M=-(j=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw U=!n,Error(o+"crypto unavailable");U=n}else U=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(w(n=e[t],0,9,t),z=n),e.hasOwnProperty(t="POW_PRECISION")&&(w(n=e[t],0,p,t),F=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);$=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);H=n}}return{DECIMAL_PLACES:L,ROUNDING_MODE:D,EXPONENTIAL_AT:[C,B],RANGE:[M,j],CRYPTO:U,MODULO_MODE:z,POW_PRECISION:F,FORMAT:$,ALPHABET:H}},q.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!q.DEBUG)return!0;var t,n,r=e.c,i=e.e,s=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===s||-1===s)&&i>=-p&&i<=p&&i===a(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=u||n!==a(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(o+"Invalid BigNumber: "+e)},q.maximum=q.max=function(){return G(arguments,O.lt)},q.minimum=q.min=function(){return G(arguments,O.gt)},q.random=(x=9007199254740992,S=Math.random()*x&2097151?function(){return a(Math.random()*x)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,c,u=0,f=[],d=new q(P);if(null==e?e=L:w(e,0,p),i=s(e/l),U)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));u<i;)(c=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(f.push(c%1e14),u+=2);u=i/2}else{if(!crypto.randomBytes)throw U=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(i*=7);u<i;)(c=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(f.push(c%1e14),u+=7);u=i/7}if(!U)for(;u<i;)(c=S())<9e15&&(f[u++]=c%1e14);for(i=f[--u],e%=l,i&&e&&(c=h[l-e],f[u]=a(i/c)*c);0===f[u];f.pop(),u--);if(u<0)f=[r=0];else{for(r=-1;0===f[0];f.splice(0,1),r-=l);for(u=1,c=f[0];c>=10;c/=10,u++);u<l&&(r-=l-u)}return d.e=r,d.c=f,d}),q.sum=function(){for(var e=1,t=arguments,n=new q(t[0]);e<t.length;)n=n.plus(t[e++]);return n},k=function(){var e="0123456789";function t(e,t,n,r){for(var i,s,a=[0],o=0,c=e.length;o<c;){for(s=a.length;s--;a[s]*=t);for(a[0]+=r.indexOf(e.charAt(o++)),i=0;i<a.length;i++)a[i]>n-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/n|0,a[i]%=n)}return a.reverse()}return function(r,i,s,a,o){var c,u,l,f,h,d,p,g,m=r.indexOf("."),w=L,y=D;for(m>=0&&(f=F,F=0,r=r.replace(".",""),d=(g=new q(i)).pow(r.length-m),F=f,g.c=t(v(b(d.c),d.e,"0"),10,s,e),g.e=g.c.length),l=f=(p=t(r,i,s,o?(c=H,e):(c=e,H))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(m<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=n(d,g,w,y,s)).c,h=d.r,l=d.e),m=p[u=l+w+1],f=s/2,h=h||u<0||null!=p[u+1],h=y<4?(null!=m||h)&&(0==y||y==(d.s<0?3:2)):m>f||m==f&&(4==y||h||6==y&&1&p[u-1]||y==(d.s<0?8:7)),u<1||!p[0])r=h?v(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,h)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(m=0,r="";m<=f;r+=c.charAt(p[m++]));r=v(r,l,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,s,a,o=0,c=e.length,u=t%d,l=t/d|0;for(e=e.slice();c--;)o=((i=u*(s=e[c]%d)+(r=l*s+(a=e[c]/d|0)*u)%d*d+o)/n|0)+(r/d|0)+l*a,e[c]=i%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,s,o,c){var f,h,d,p,b,m,w,y,_,v,k,E,x,S,A,R,T,N=r.s==i.s?1:-1,I=r.c,O=i.c;if(!(I&&I[0]&&O&&O[0]))return new q(r.s&&i.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*N:N/0:NaN);for(_=(y=new q(N)).c=[],N=s+(h=r.e-i.e)+1,c||(c=u,h=g(r.e/l)-g(i.e/l),N=N/l|0),d=0;O[d]==(I[d]||0);d++);if(O[d]>(I[d]||0)&&h--,N<0)_.push(1),p=!0;else{for(S=I.length,R=O.length,d=0,N+=2,(b=a(c/(O[0]+1)))>1&&(O=e(O,b,c),I=e(I,b,c),R=O.length,S=I.length),x=R,k=(v=I.slice(0,R)).length;k<R;v[k++]=0);T=O.slice(),T=[0].concat(T),A=O[0],O[1]>=c/2&&A++;do{if(b=0,(f=t(O,v,R,k))<0){if(E=v[0],R!=k&&(E=E*c+(v[1]||0)),(b=a(E/A))>1)for(b>=c&&(b=c-1),w=(m=e(O,b,c)).length,k=v.length;1==t(m,v,w,k);)b--,n(m,R<w?T:O,w,c),w=m.length,f=1;else 0==b&&(f=b=1),w=(m=O.slice()).length;if(w<k&&(m=[0].concat(m)),n(v,m,k,c),k=v.length,-1==f)for(;t(O,v,R,k)<1;)b++,n(v,R<k?T:O,k,c),k=v.length}else 0===f&&(b++,v=[0]);_[d++]=b,v[0]?v[k++]=I[x]||0:(v=[I[x]],k=1)}while((x++<S||null!=v[0])&&N--);p=null!=v[0],_[0]||_.splice(0,1)}if(c==u){for(d=1,N=_[0];N>=10;N/=10,d++);K(y,s+(y.e=d+h*l-1)+1,o,p)}else y.e=h,y.r=+p;return y}}(),A=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,T=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(e,t,n,r){var i,s=n?t:t.replace(I,"");if(N.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(A,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(R,"$1").replace(T,"0.$1")),t!=s))return new q(s,i);if(q.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},O.absoluteValue=O.abs=function(){var e=new q(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return m(this,new q(e,t))},O.decimalPlaces=O.dp=function(e,t){var n,r,i,s=this;if(null!=e)return w(e,0,p),null==t?t=D:w(t,0,8),K(new q(s),e+s.e+1,t);if(!(n=s.c))return null;if(r=((i=n.length-1)-g(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},O.dividedBy=O.div=function(e,t){return n(this,new q(e,t),L,D)},O.dividedToIntegerBy=O.idiv=function(e,t){return n(this,new q(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var n,r,i,c,u,f,h,d,p=this;if((e=new q(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+Z(e));if(null!=t&&(t=new q(t)),u=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new q(Math.pow(+Z(p),u?2-y(e):+Z(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new q(NaN);(r=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return c=p.s<0&&y(e)?-0:0,p.e>-1&&(c=1/c),new q(f?1/c:c);F&&(c=s(F/l+2))}for(u?(n=new q(.5),f&&(e.s=1),h=y(e)):h=(i=Math.abs(+Z(e)))%2,d=new q(P);;){if(h){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):r&&(d=d.mod(t))}if(i){if(0===(i=a(i/2)))break;h=i%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)h=y(e);else{if(0===(i=+Z(e)))break;h=i%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):r&&(p=p.mod(t))}return r?d:(f&&(d=P.div(d)),t?d.mod(t):c?K(d,F,D,undefined):d)},O.integerValue=function(e){var t=new q(this);return null==e?e=D:w(e,0,8),K(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===m(this,new q(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return m(this,new q(e,t))>0},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=m(this,new q(e,t)))||0===t},O.isInteger=function(){return!!this.c&&g(this.e/l)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return m(this,new q(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=m(this,new q(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var n,r,i,s,a=this,o=a.s;if(t=(e=new q(e,t)).s,!o||!t)return new q(NaN);if(o!=t)return e.s=-t,a.plus(e);var c=a.e/l,f=e.e/l,h=a.c,d=e.c;if(!c||!f){if(!h||!d)return h?(e.s=-t,e):new q(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new q(h[0]?a:3==D?-0:0)}if(c=g(c),f=g(f),h=h.slice(),o=c-f){for((s=o<0)?(o=-o,i=h):(f=c,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(r=(s=(o=h.length)<(t=d.length))?o:t,o=t=0;t<r;t++)if(h[t]!=d[t]){s=h[t]<d[t];break}if(s&&(i=h,h=d,d=i,e.s=-e.s),(t=(r=d.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=u-1;r>o;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=u}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?V(e,h,f):(e.s=3==D?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var r,i,s=this;return e=new q(e,t),!s.c||!e.s||e.c&&!e.c[0]?new q(NaN):!e.c||s.c&&!s.c[0]?new q(s):(9==z?(i=e.s,e.s=1,r=n(s,e,0,3),e.s=i,r.s*=i):r=n(s,e,0,z),(e=s.minus(r.times(e))).c[0]||1!=z||(e.s=s.s),e)},O.multipliedBy=O.times=function(e,t){var n,r,i,s,a,o,c,f,h,p,b,m,w,y,_,v=this,k=v.c,E=(e=new q(e,t)).c;if(!(k&&E&&k[0]&&E[0]))return!v.s||!e.s||k&&!k[0]&&!E||E&&!E[0]&&!k?e.c=e.e=e.s=null:(e.s*=v.s,k&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=g(v.e/l)+g(e.e/l),e.s*=v.s,(c=k.length)<(p=E.length)&&(w=k,k=E,E=w,i=c,c=p,p=i),i=c+p,w=[];i--;w.push(0));for(y=u,_=d,i=p;--i>=0;){for(n=0,b=E[i]%_,m=E[i]/_|0,s=i+(a=c);s>i;)n=((f=b*(f=k[--a]%_)+(o=m*f+(h=k[a]/_|0)*b)%_*_+w[s]+n)/y|0)+(o/_|0)+m*h,w[s--]=f%y;w[s]=n}return n?++r:w.splice(0,1),V(e,w,r)},O.negated=function(){var e=new q(this);return e.s=-e.s||null,e},O.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new q(e,t)).s,!i||!t)return new q(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/l,a=e.e/l,o=r.c,c=e.c;if(!s||!a){if(!o||!c)return new q(i/0);if(!o[0]||!c[0])return c[0]?e:new q(o[0]?r:0*i)}if(s=g(s),a=g(a),o=o.slice(),i=s-a){for(i>0?(a=s,n=c):(i=-i,n=o),n.reverse();i--;n.push(0));n.reverse()}for((i=o.length)-(t=c.length)<0&&(n=c,c=o,o=n,t=i),i=0;t;)i=(o[--t]=o[t]+c[t]+i)/u|0,o[t]=u===o[t]?0:o[t]%u;return i&&(o=[i].concat(o),++a),V(e,o,a)},O.precision=O.sd=function(e,t){var n,r,i,s=this;if(null!=e&&e!==!!e)return w(e,1,p),null==t?t=D:w(t,0,8),K(new q(s),e,t);if(!(n=s.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},O.shiftedBy=function(e){return w(e,-9007199254740991,f),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,r,i,s,a=this,o=a.c,c=a.s,u=a.e,l=L+4,f=new q("0.5");if(1!==c||!o||!o[0])return new q(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+Z(a)))||c==1/0?(((t=b(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=g((u+1)/2)-(u<0||u%2),r=new q(t=c==1/0?"1e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new q(c+""),r.c[0])for((c=(u=r.e)+l)<3&&(c=0);;)if(s=r,r=f.times(s.plus(n(a,s,l,1))),b(s.c).slice(0,c)===(t=b(r.c)).slice(0,c)){if(r.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(r,r.e+L+2,1),e=!r.times(r).eq(a));break}if(!i&&(K(s,s.e+L+2,0),s.times(s).eq(a))){r=s;break}l+=4,c+=4,i=1}return K(r,r.e+L+1,D,e)},O.toExponential=function(e,t){return null!=e&&(w(e,0,p),e++),W(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(w(e,0,p),e=e+this.e+1),W(this,e,t)},O.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=$;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",f=a[0],h=a[1],d=i.s<0,p=d?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),d&&(f="-"+f)}r=h?f+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):f}return(n.prefix||"")+r+(n.suffix||"")},O.toFraction=function(e){var t,r,i,s,a,c,u,f,d,p,g,m,w=this,y=w.c;if(null!=e&&(!(u=new q(e)).isInteger()&&(u.c||1!==u.s)||u.lt(P)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Z(u));if(!y)return new q(w);for(t=new q(P),d=r=new q(P),i=f=new q(P),m=b(y),a=t.e=m.length-w.e-1,t.c[0]=h[(c=a%l)<0?l+c:c],e=!e||u.comparedTo(t)>0?a>0?t:d:u,c=j,j=1/0,u=new q(m),f.c[0]=0;p=n(u,t,0,1),1!=(s=r.plus(p.times(i))).comparedTo(e);)r=i,i=s,d=f.plus(p.times(s=d)),f=s,t=u.minus(p.times(s=t)),u=s;return s=n(e.minus(r),i,0,1),f=f.plus(s.times(d)),r=r.plus(s.times(i)),f.s=d.s=w.s,g=n(d,i,a*=2,D).minus(w).abs().comparedTo(n(f,r,a,D).minus(w).abs())<1?[d,i]:[f,r],j=c,g},O.toNumber=function(){return+Z(this)},O.toPrecision=function(e,t){return null!=e&&w(e,1,p),W(this,e,t,2)},O.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=C||i>=B?_(b(n.c),i):v(b(n.c),i,"0"):10===e?t=v(b((n=K(new q(n),L+i+1,D)).c),n.e,"0"):(w(e,2,H.length,"Base"),t=k(v(b(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return Z(this)},O._isBigNumber=!0,i&&(O[Symbol.toStringTag]="BigNumber",O[Symbol.for("nodejs.util.inspect.custom")]=O.valueOf),null!=t&&q.set(t),q}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"3box>ipfs>ipfs-repo>bignumber.js"}],[4368,{buffer:1936,"interface-datastore":4283},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=new(0,e("interface-datastore").Key)("api");t.exports=e=>({get(t){e.get(r,((e,n)=>t(e,n&&n.toString())))},set(t,i){e.put(r,n.from(t.toString()),i)},delete(t){e.delete(r,t)}})}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo"}],[4369,{},function(){with(this)return function(){"use strict";return function(e,t,n){n.create=function(e,t,n){return new(0,n.storageBackends[e])(t,Object.assign({},n.storageBackendOptions[e]||{}))}}}},{package:"3box>ipfs>ipfs-repo"}],[4370,{"async/reject":1634,"async/setImmediate":1637,"base32.js":1816,cids:1973,"datastore-core":2087,"interface-datastore":4283,"ipfs-block":4313,"pull-stream/pull":5319,"pull-stream/sinks/collect":5320},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("datastore-core"),i=r.ShardingDatastore,s=e("interface-datastore").Key,a=e("base32.js"),o=e("ipfs-block"),c=e("async/setImmediate"),u=e("async/reject"),l=e("cids"),f=e("pull-stream/pull"),h=e("pull-stream/sinks/collect"),d=e=>(e=>{const t=new a.Encoder;return new s("/"+t.write(e).finalize(),!1)})(e.buffer);function p(e){try{return 0===e.version?e.toV1():e.toV0()}catch(e){return null}}t.exports=(e,t,n)=>{!function(e,t,n){if(t.sharding){const t=new r.shard.NextToLast(2);i.createOrOpen(e,t,n)}else c((()=>n(null,e)))}(e,t,((e,t)=>{if(e)return n(e);n(null,function(e){return{query(t,n){f(e.query(t),h(n))},get(t,n){if(!l.isCID(t))return c((()=>{n(new Error("Not a valid cid"))}));const r=d(t);e.get(r,((i,s)=>{if(i){if("ERR_NOT_FOUND"===i.code){const s=p(t);if(!s)return n(i);const a=d(s);return e.get(a,((i,s)=>{if(i)return n(i);e.put(r,s,(e=>{if(e)return n(e);n(null,new o(s,t))}))}))}return n(i)}n(null,new o(s,t))}))},put(t,n){if(!o.isBlock(t))return c((()=>{n(new Error("invalid block"))}));const r=d(t.cid);e.has(r,((i,s)=>i?n(i):s?n():void e.put(r,t.data,n)))},putMany(t,n){const r=t.map((e=>({key:d(e.cid),block:e}))),i=e.batch();u(r,((t,n)=>e.has(t.key,n)),((e,t)=>{if(e)return n(e);t.forEach((e=>{i.put(e.key,e.block.data)})),i.commit(n)}))},has(t,n){if(!l.isCID(t))return c((()=>{n(new Error("Not a valid cid"))}));e.has(d(t),((r,i)=>{if(r)return n(r);if(i)return n(null,!0);const s=p(t);if(!s)return n(null,!1);e.has(d(s),n)}))},delete(t,n){if(!l.isCID(t))return c((()=>{n(new Error("Not a valid cid"))}));e.delete(d(t),n)},close(t){e.close(t)}}}(t))}))}}}},{package:"3box>ipfs>ipfs-repo"}],[4371,{"async/queue":1633,"async/waterfall":1643,buffer:1936,dlv:2139,"interface-datastore":4283,"just-safe-set":4624},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("interface-datastore").Key,i=e("async/queue"),s=e("async/waterfall"),a=e("dlv"),o=e("just-safe-set"),c=e("buffer").Buffer,u=new r("config");t.exports=e=>{const t=i((function(e,t){const i=e.key,a=e.value;i?s([e=>n.get(e),(e,t)=>{o(e,i,a),t(null,e)},r],t):r(a,t)}),1),n={get(t,n){"function"==typeof t&&(n=t,t=undefined),t||(t=undefined),e.get(u,((e,r)=>{if(e)return n(e);let i;try{i=JSON.parse(r.toString())}catch(e){return n(e)}if(void 0===t)return n(null,i);if("string"!=typeof t)return n(new Error("Key "+t+" must be a string."));const s=a(i,t,null);if(null===s)return n(new Error("Key "+t+" does not exist in config."));n(null,s)}))},set(e,n,r){if("function"==typeof n)r=n,n=e,e=undefined;else if(!e||"string"!=typeof e)return r(new Error("Invalid key type"));if(n===undefined||c.isBuffer(n))return r(new Error("Invalid value type"));t.push({key:e,value:n},r)},exists(t){e.has(u,t)}};return n;function r(t,n){const r=c.from(JSON.stringify(t,null,2));e.put(u,r,n)}}}}},{package:"3box>ipfs>ipfs-repo"}],[4372,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={repoVersion:7}}}},{package:"3box>ipfs>ipfs-repo"}],[4373,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}}}},{package:"3box>ipfs>ipfs-repo"}],[4374,{"datastore-level":2102},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={lock:"memory",storageBackends:{root:e("datastore-level"),blocks:e("datastore-level"),keys:e("datastore-level"),datastore:e("datastore-level")},storageBackendOptions:{root:{extension:""},blocks:{sharding:!1},keys:{sharding:!1}}}}}},{package:"3box>ipfs>ipfs-repo"}],[4375,{},function(){with(this)return function(){"use strict";return function(e,t,n){n.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED"}}},{package:"3box>ipfs>ipfs-repo"}],[4376,{"./api-addr":4368,"./backends":4369,"./blockstore":4370,"./config":4371,"./constants":4372,"./default-datastore":4373,"./default-options":4374,"./errors":4375,"./lock":4377,"./lock-memory":4377,"./spec":4378,"./version":4379,assert:1564,"async/each":1597,"async/parallel":1632,"async/series":1636,"async/waterfall":1643,"bignumber.js":4367,debug:2108,dlv:2139,path:5237,"pull-stream/pull":5319,"pull-stream/sinks/reduce":5327,timers:5784},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("async/waterfall"),i=e("async/series"),s=e("async/parallel"),a=e("async/each"),o=e("dlv"),c=e("assert"),u=e("path"),l=e("debug"),f=e("bignumber.js"),h=e("pull-stream/pull"),d=e("pull-stream/sinks/reduce"),p=e("./backends"),g=e("./version"),b=e("./config"),m=e("./spec"),w=e("./api-addr"),y=e("./blockstore"),_=e("./default-options"),v=e("./default-datastore"),k=e("./errors"),E=l("repo"),x=Number.MAX_SAFE_INTEGER,S={memory:e("./lock-memory"),fs:e("./lock")},A=e("./constants").repoVersion;function R(e,t){h(e.query({}),d(((e,t)=>e.plus(t.value.byteLength).plus(t.key._buf.byteLength)),new f(0),t))}function T(e,t){return n=>{t(n&&!e(n)?n:null)}}function N(e){return T((e=>"Already open"===e.message),e)}t.exports=class{constructor(e,t){c.strictEqual(typeof e,"string","missing repoPath"),this.options=function(e){const t=Object.assign({},_,e);return t.storageBackends=Object.assign({},_.storageBackends,t.storageBackends),t.storageBackendOptions=Object.assign({},_.storageBackendOptions,t.storageBackendOptions),t}(t),this.closed=!0,this.path=e,this._locker=this._getLocker(),this.root=p.create("root",this.path,this.options),this.version=g(this.root),this.config=b(this.root),this.spec=m(this.root),this.apiAddr=w(this.root)}init(e,t){E("initializing at: %s",this.path),i([e=>this.root.open(N(e)),t=>{return this.config.set(((n=e).datastore=Object.assign({},v,o(n,"datastore",{})),n),t);var n},t=>this.spec.set(function(e){const t=Object.assign({},v.Spec,o(e,"datastore.Spec",{}));return{type:t.type,mounts:t.mounts.map((e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc})))}}(e),t),e=>this.version.set(A,e)],t)}open(e){this.closed?(E("opening at: %s",this.path),r([e=>this.root.open(N(e)),e=>this._isInitialized(e),e=>this._openLock(this.path,e),(e,t)=>{E("aquired repo.lock"),this.lockfile=e,t()},e=>{E("creating datastore"),this.datastore=p.create("datastore",u.join(this.path,"datastore"),this.options),E("creating blocks");const t=p.create("blocks",u.join(this.path,"blocks"),this.options);y(t,this.options.storageBackendOptions.blocks,e)},(e,t)=>{this.blocks=e,t()},e=>{E("creating keystore"),this.keys=p.create("keys",u.join(this.path,"keys"),this.options),e()},e=>{this.closed=!1,E("all opened"),e()}],(t=>{t&&this.lockfile?this._closeLock((n=>{n?E("error removing lock",n):this.lockfile=null,e(t)})):e(t)}))):n((()=>e(new Error("repo is already open"))))}_getLocker(){return"string"==typeof this.options.lock?(c(S[this.options.lock],"Unknown lock type: "+this.options.lock),S[this.options.lock]):(c(this.options.lock,"No lock provided"),this.options.lock)}_openLock(e,t){this._locker.lock(e,((e,n)=>{if(e)return t(e,null);c.strictEqual(typeof n.close,"function","Locks must have a close method"),t(null,n)}))}_closeLock(e){if(this.lockfile)return this.lockfile.close(e);e()}_isInitialized(e){E("init check"),s({config:e=>this.config.exists(e),spec:e=>this.spec.exists(e),version:e=>this.version.check(A,e)},((t,n)=>{if(E("init",t,n),t&&!n.config)return e(Object.assign(new Error("repo is not initialized yet"),{code:k.ERR_REPO_NOT_INITIALIZED,path:this.path}));e(t)}))}close(e){if(this.closed)return e(new Error("repo is already closed"));E("closing at: %s",this.path),i([e=>this.apiAddr.delete(function(e){return T((e=>e&&(e.code===k.ERR_REPO_NOT_INITIALIZED||e.message.startsWith("ENOENT"))),e)}(e)),e=>{a([this.blocks,this.keys,this.datastore],((e,t)=>e.close(t)),e)},e=>{E("unlocking"),this.closed=!0,this._closeLock(e)},e=>{this.lockfile=null,e()}],(t=>e(t)))}exists(e){this.version.exists(e)}stat(e,t){"function"==typeof e&&(t=e,e={}),e=Object.assign({},{human:!1},e),s({storageMax:e=>this.config.get("Datastore.StorageMax",((t,n)=>{e(null,new f(t?x:n))})),version:e=>this.version.get(e),blocks:e=>this.blocks.query({},((t,n)=>{const r=new f((n=n||[]).length);let i=new f(0);n.forEach((e=>{i=i.plus(e.value.byteLength).plus(e.key._buf.byteLength)})),e(t,{count:r,size:i})})),datastore:e=>R(this.datastore,e),keys:e=>R(this.keys,e)},((n,r)=>{if(n)return t(n);let i=r.blocks.size.plus(r.datastore).plus(r.keys);e.human&&(i=i.div(1048576)),t(null,{repoPath:this.path,storageMax:r.storageMax,version:r.version,numObjects:r.blocks.count,repoSize:i})}))}},t.exports.repoVersion=A,t.exports.errors=k}).call(this)}).call(this,e("timers").setImmediate)}}},{package:"3box>ipfs>ipfs-repo"}],[4377,{"async/setImmediate":1637,debug:2108},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("debug"),i=e("async/setImmediate"),s=r("repo:lock"),a="repo.lock",o={};n.lock=(e,t)=>{const n=e+"/"+a;s("locking %s",n),o[n]=!0;const r={close(e){o[n]&&delete o[n],i(e)}};i((()=>{t(null,r)}))},n.locked=(e,t)=>{const n=e+"/"+a;s("checking lock: %s");const r=o[n];i((()=>{t(null,r)}))}}}},{package:"3box>ipfs>ipfs-repo"}],[4378,{buffer:1936,"interface-datastore":4283,"sort-keys":5711},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("interface-datastore").Key,i=e("sort-keys"),s=new r("datastore_spec");t.exports=e=>({exists(t){e.has(s,t)},get(t){e.get(s,((e,n)=>{if(e)return t(e);t(null,JSON.parse(n.toString()))}))},set(t,r){e.put(s,n.from(JSON.stringify(i(t,{deep:!0}))),r)}})}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo"}],[4379,{buffer:1936,debug:2108,"interface-datastore":4283},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("interface-datastore").Key,i=e("debug")("repo:version"),s=new r("version");t.exports=e=>({exists(t){e.has(s,t)},get(t){e.get(s,((e,n)=>{if(e)return t(e);t(null,parseInt(n.toString().trim(),10))}))},set(t,r){e.put(s,n.from(String(t)),r)},check(e,t){this.get(((n,r)=>{if(n)return t(n);i("comparing version: %s and %s",r,e);if(r!==e&&!(6===r&&7===e||6===e&&7===r))return t(new Error(`ipfs repo needs migration: expected version v${e}, found version v${r}`));t()}))}})}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo"}],[4380,{"../../is-buffer/index.js":4558,"./resolvers":4382,"async-iterator-last":1571,cids:1973,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("err-code"),i=e("cids"),s=e("./resolvers"),a=e("async-iterator-last"),o=e=>{if(n.isBuffer(e))return{cid:new i(e),toResolve:[]};if(i.isCID(e))return{cid:e,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=((e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean))(e);return{cid:new i(t[0]),toResolve:t.slice(1)}}throw r(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")},c=async function*(e,t){let{cid:n,toResolve:i}=o(e),a=n.toBaseEncodedString(),c=a;const u=i.length;for(;;){const o=await s(n,a,c,i,u,t);if(!o.entry&&!o.next)throw r(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(o.entry&&(yield o.entry),!o.next)return;i=o.next.toResolve,n=o.next.cid,a=o.next.name,c=o.next.path}},u=(e,t)=>a(c(e,t));t.exports=u,t.exports.path=c,t.exports.recursive=async function*(e,t){const n=await u(e,t);if(yield n,n.unixfs&&n.unixfs.type.includes("dir"))for await(const e of async function*e(t){for await(const n of t.content())if(yield n,n.unixfs.type.includes("dir"))for await(const t of e(n))yield t}(n))yield e}}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4381,{cids:1973,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("cids"),i=e("err-code");t.exports=async(e,t,n,s,a,o,c)=>{let u=await c.get(e),l=u,f=n;for(;s.length;){const a=s[0];if(!(a in l))throw i(new Error(`No property named ${a} found in cbor node ${e.toBaseEncodedString()}`),"ERR_NO_PROP");if(s.shift(),f=`${f}/${a}`,r.isCID(l[a]))return{entry:{name:t,path:n,cid:e,node:u,depth:o},next:{cid:l[a],name:a,path:f,toResolve:s}};l=l[a]}return{entry:{name:t,path:n,cid:e,node:u,depth:o}}}}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4382,{"./dag-cbor":4381,"./raw":4383,"./unixfs-v1":4387,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i={"dag-pb":e("./unixfs-v1"),raw:e("./raw"),"dag-cbor":e("./dag-cbor")},s=(e,t,n,a,o,c)=>{const u=i[e.codec];if(!u)throw r(new Error(`No resolver for codec ${e.codec}`),"ERR_NO_RESOLVER");return u(e,t,n,a,s,o,c)};t.exports=s}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4383,{"../utils/extract-data-from-block":4388,"../utils/validate-offset-and-length":4390,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i=e("../utils/extract-data-from-block"),s=e("../utils/validate-offset-and-length");t.exports=async(e,t,n,a,o,c,u)=>{if(a.length)throw r(new Error(`No link named ${n} found in raw node ${e.toBaseEncodedString()}`),"ERR_NOT_FOUND");const l=await u.get(e);return{entry:{name:t,path:n,cid:e,node:l,content:(f=l,function*(e={}){const{offset:t,length:n}=s(f.length,e.offset,e.length);yield i(f,0,t,t+n)}),depth:c}};var f}}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4384,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=(e,t,n,r,i,s,a)=>async function*(e={}){const n=e.offset||0,o=e.length||t.Links.length,c=t.Links.slice(n,o);for(const e of c){const t=await i(e.Hash,e.Name,`${r}/${e.Name}`,[],s+1,a);yield t.entry}}}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4385,{"../../../../../is-buffer/index.js":4558,"../../../utils/extract-data-from-block":4388,"../../../utils/validate-offset-and-length":4390,"err-code":2210,"ipfs-unixfs":4409},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("../../../utils/extract-data-from-block"),i=e("../../../utils/validate-offset-and-length"),s=e("ipfs-unixfs"),a=e("err-code");async function*o(e,t,i,c,u=0){if(n.isBuffer(t)){const e=r(t,u,i,c);return e.length&&(yield e),u+=e.length}let l;try{l=s.unmarshal(t.Data)}catch(e){throw a(e,"ERR_NOT_UNIXFS")}if(Boolean(l.data&&l.data.length)){const e=r(l.data,u,i,c);e.length&&(yield e),u+=l.data.length}let f=u;for(let n=0;n<t.Links.length;n++){const r=t.Links[n],s=u+l.blockSizes[n];if(i>=f&&i<s||c>f&&c<=s||i<f&&c>s){const t=await e.get(r.Hash);for await(const n of o(e,t,i,c,u))u+=n.length,yield n}u=s,f=s+1}}t.exports=(e,t,n,r,s,a,c)=>(e={})=>{const r=n.fileSize(),{offset:s,length:a}=i(r,e.offset,e.length);return o(c,t,s,s+a)}}).call(this)}).call(this,{isBuffer:e("../../../../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4386,{},function(){with(this)return function(){"use strict";return function(e,t,n){async function*r(e,t,n,i,s,a){const o=e.Links;for(const c of o){const o=c.Name.substring(2);if(o){const e=await n(c.Hash,o,`${t}/${o}`,[],i+1,s);yield e.entry}else{e=await s.get(c.Hash);for await(const o of r(e,t,n,i,s,a))yield o}}}t.exports=(e,t,n,i,s,a,o)=>(e={})=>r(t,i,s,a,o,e)}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4387,{"../../utils/find-cid-in-shard":4389,"./content/directory":4384,"./content/file":4385,"./content/hamt-sharded-directory":4386,"err-code":2210,"ipfs-unixfs":4409},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i=e("ipfs-unixfs"),s=e("../../utils/find-cid-in-shard"),a={raw:e("./content/file"),file:e("./content/file"),directory:e("./content/directory"),"hamt-sharded-directory":e("./content/hamt-sharded-directory"),metadata:(e,t,n,r,i,s,a)=>{},symlink:(e,t,n,r,i,s,a)=>{}};t.exports=async(e,t,n,o,c,u,l)=>{const f=await l.get(e);let h,d;t||(t=e.toBaseEncodedString());try{h=i.unmarshal(f.Data)}catch(e){throw r(e,"ERR_NOT_UNIXFS")}if(n||(n=t),o.length){let e;if(e=h&&"hamt-sharded-directory"===h.type?await s(f,o[0],l):((e,t)=>{const n=e.Links.find((e=>e.Name===t));return n&&n.Hash})(f,o[0]),!e)throw r(new Error("file does not exist"),"ERR_NOT_FOUND");const t=o.shift();d={cid:e,toResolve:o,name:t,path:`${n}/${t}`}}return{entry:{name:t,path:n,cid:e,node:f,content:a[h.type](e,f,h,n,c,u,l),unixfs:h,depth:u},next:d}}}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4388,{buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e){(function(){t.exports=function(t,n,r,i){const s=n+t.length;return r>=s||i<n?e.alloc(0):(i>=n&&i<s&&(t=t.slice(0,i-n)),r>=n&&r<s&&(t=t.slice(r-n)),t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4389,{"hamt-sharding/src/bucket":4206,"ipfs-unixfs-importer/src/dir-sharded":4402},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("hamt-sharding/src/bucket"),i=e("ipfs-unixfs-importer/src/dir-sharded"),s=e=>e.toString("16").toUpperCase().padStart(2,"0").substring(0,2),a=async(e,t,n,o)=>{var c,u,l;o||((o={rootBucket:new r({hashFn:i.hashFn}),hamtDepth:1}).lastBucket=o.rootBucket),await(c=e.Links,u=o.lastBucket,l=o.rootBucket,Promise.all(c.map((e=>{if(2===e.Name.length){const t=parseInt(e.Name,16);return u._putObjectAt(t,new r({hashFn:i.hashFn},u,t))}return l.put(e.Name.substring(2),!0)}))));const f=await o.rootBucket._findNewBucketAndPos(t);let h=s(f.pos);const d=(e=>{let t=e.bucket;const n=[];for(;t._parent;)n.push(t),t=t._parent;return n.push(t),n.reverse()})(f);d.length>o.hamtDepth&&(o.lastBucket=d[o.hamtDepth],h=s(o.lastBucket._posAtParent));const p=e.Links.find((e=>{const n=e.Name.substring(0,2),r=e.Name.substring(2);if(n===h&&(!r||r===t))return!0}));return p?p.Name.substring(2)===t?p.Hash:(o.hamtDepth++,e=await n.get(p.Hash),a(e,t,n,o)):null};t.exports=a}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4390,{"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code");t.exports=(e,t,n)=>{if(t||(t=0),t<0)throw r(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw r(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(n||0===n||(n=e-t),n<0)throw r(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+n>e&&(n=e-t),{offset:t,length:n}}}}},{package:"3box>ipfs>ipfs-unixfs-exporter"}],[4391,{bl:1871},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("bl");t.exports=async function*(e,t){let n=new r,i=0,s=!1;const a=t.maxChunkSize;for await(const t of e)for(n.append(t),i+=t.length;i>=a;)if(yield n.slice(0,a),s=!0,a===n.length)n=new r,i=0;else{const e=new r;e.append(n.shallowSlice(a)),n=e,i-=a}s&&!i||(yield n.slice(0,i))}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4392,{"../chunker/fixed-size":4391,"../chunker/rabin":4393,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i={fixed:e("../chunker/fixed-size"),rabin:e("../chunker/rabin")};t.exports=(e,t,n)=>{const s=i[e];if(!s)throw r(new Error(`Unknkown chunker named ${e}`),"ERR_UNKNOWN_CHUNKER");return s(t,n)}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4393,{bl:1871,buffer:1936,"err-code":2210,"rabin-wasm":5393},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("bl"),{create:i}=e("rabin-wasm"),s=e("err-code");t.exports=async function*(e,t){const n=a();let r,i,o;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)o=t.avgChunkSize,r=t.minChunkSize,i=t.maxChunkSize;else{if(!t.avgChunkSize)throw s(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");o=t.avgChunkSize,r=o/3,i=o+o/2}if(r<16)throw s(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");i<r&&(i=r),o<r&&(o=r);const c=Math.floor(Math.log2(o));for await(const s of n(e,{min:r,max:i,bits:c,window:t.window,polynomial:t.polynomial}))yield s};const a=()=>async function*(e,t){const s=await i(t.bits,t.min,t.max,t.window),a=new r;let o=[];for await(const t of e){a.append(t),o.push(t);const e=s.fingerprint(n.concat(o));o=[];for(let t=0;t<e.length;t++){var c=e[t],u=a.slice(0,c);a.consume(c),yield u}}a.length&&(yield a.slice(0))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4394,{"../utils/persist":4407,"ipfs-unixfs":4409,"ipld-dag-pb":4546},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("ipfs-unixfs"),i=e("../utils/persist"),{DAGNode:s}=e("ipld-dag-pb");t.exports=async(e,t,n)=>{const a=new r("directory"),o=s.create(a.marshal(),[]);return{cid:await i(o,t,n),path:e.path,unixfs:a,node:o}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4395,{"async-iterator-batch":1569},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async-iterator-batch");async function i(e,t,n){const s=[];for await(const i of r(e,n.maxChildrenPerNode))s.push(await t(i));return s.length>1?i(s,t,n):s[0]}t.exports=async function*(e,t,n){yield await i(e,t,n)}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4396,{"async-iterator-batch":1569},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async-iterator-batch");t.exports=async function*(e,t){const n=[];for await(const i of r(e,Infinity))n.push(await t(i));yield n[0]}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4397,{"../../utils/persist":4407,"./balanced":4395,"./flat":4396,"./trickle":4398,"async-iterator-all":1568,"err-code":2210,"ipfs-unixfs":4409,"ipld-dag-pb":4546},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("err-code"),i=e("ipfs-unixfs"),s=e("../../utils/persist"),{DAGNode:a,DAGLink:o}=e("ipld-dag-pb"),c=e("async-iterator-all"),u={flat:e("./flat"),balanced:e("./balanced"),trickle:e("./trickle")};t.exports=async(e,t,n,l)=>{const f=u[l.strategy];if(!f)throw r(new Error(`Unknown importer build strategy name: ${l.strategy}`),"ERR_BAD_STRATEGY");const h=await c(f(async function*(e,t,n){let r,o=-1;for await(const c of e){let e,u;o++,n.progress(c.length);let l={...n};n.rawLeaves?(e=c,l.codec="raw",l.cidVersion=1):(u=new i(n.leafType,c),e=a.create(u.marshal(),[]));const f={cid:await s(e,t,l),unixfs:u,node:e};0!==o?(1===o&&(yield r,r=null),yield f):r=f}r&&(r.single=!0,yield r)}(t,n,l),((e,t,n)=>async function(r){if(1===r.length&&r[0].single&&n.reduceSingleLeafToSelf){const t=r[0];return{cid:t.cid,path:e.path,name:(e.path||"").split("/").pop(),unixfs:t.unixfs,node:t.node}}const c=new i("file"),u=r.filter((e=>!("raw"!==e.cid.codec||!e.node.length)||!(e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs.data.length))).map((e=>"raw"===e.cid.codec?(c.addBlockSize(e.node.length),new o(e.name,e.node.length,e.cid)):(e.unixfs.data?c.addBlockSize(e.unixfs.data.length):c.addBlockSize(e.unixfs.fileSize()),new o(e.name,e.node.size,e.cid)))),l=a.create(c.marshal(),u);return{cid:await s(l,t,n),path:e.path,unixfs:c,node:l,size:l.size}})(e,n,l),l.builderOptions));if(h.length>1)throw r(new Error("expected a maximum of 1 roots and got "+h.length),"ETOOMANYROOTS");return h[0]}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4398,{"async-iterator-batch":1569},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("async-iterator-batch");t.exports=function*(e,t,n){yield async function(e,t,n){let a,o=0,c=1,u=a=new s(n.layerRepeat);for await(const s of r(e,n.maxChildrenPerNode))u.isFull()&&(u!==a&&a.addChild(await u.reduce(t)),o&&o%n.layerRepeat==0&&c++,u=new i(c,n.layerRepeat,o),o++),u.append(s);u&&u!==a&&a.addChild(await u.reduce(t));return a.reduce(t)}(e,t,n)};class i{constructor(e,t,n){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=n,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let n=[];return e.children.length&&(n=await Promise.all(e.children.filter((e=>e.data)).map((e=>this._reduce(e,t))))),t(e.data.concat(n))}_findParent(e,t){const n=e.parent;if(n&&0!==n.depth)return n.children.length!==n.maxChildren&&n.maxChildren?n:this._findParent(n,t)}}class s extends i{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e(this.root.data.concat(this.root.children))}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4399,{"../chunker":4392,"./dir":4394,"./file":4397,"./validate-chunks":4400},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./dir"),i=e("./file"),s=e("../chunker"),a=e("./validate-chunks");t.exports=async function*(e,t,n){for await(const o of e)if(o.path&&("./"===o.path.substring(0,2)&&(n.wrapWithDirectory=!0),o.path=o.path.split("/").filter((e=>e&&"."!==e)).join("/")),o.content){let e=o.content;(e[Symbol.asyncIterator]||e[Symbol.iterator])&&e.length===undefined||(e={[Symbol.iterator]:function*(){yield o.content}});const r=s(n.chunker,a(e),n.chunkerOptions);yield i(o,r,t,n)}else yield r(o,t,n)}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[44,{"@babel/runtime/helpers/interopRequireDefault":200,loglevel:5029},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(t,n,r){r((r=>{n.error&&i.default.error("Error in RPC response:\n",n),t.isMetamaskInternal||(i.default.info(`RPC (${e.origin}):`,t,"->",n),r())}))}};var i=r(e("loglevel"))}}},{package:"$root$"}],[4400,{buffer:1936,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("err-code");t.exports=async function*(e){for await(const t of e){if(t.length===undefined)throw r(new Error("Content was invalid"),"ERR_INVALID_CONTENT");"string"==typeof t||t instanceof String?yield n.from(t,"utf8"):Array.isArray(t)?yield n.from(t):yield t}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4401,{"./dir":4403,"./utils/persist":4407,"ipfs-unixfs":4409,"ipld-dag-pb":4546},function(){with(this)return function(){"use strict";return function(e,t,n){const{DAGLink:r,DAGNode:i}=e("ipld-dag-pb"),s=e("ipfs-unixfs"),a=e("./dir"),o=e("./utils/persist");t.exports=class extends a{constructor(e,t){super(e,t),this._children={}}put(e,t){this.cid=undefined,this.size=undefined,this._children[e]=t}get(e){return this._children[e]}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const n=e[t];yield{key:n,child:this._children[n]}}}async*flush(e,t){const n=Object.keys(this._children),a=[];for(let e=0;e<n.length;e++){let i=this._children[n[e]];if("function"==typeof i.flush)for await(const e of i.flush(i.path,t))i=e,yield i;a.push(new r(n[e],i.node.length||i.node.size,i.cid))}const c=new s("directory");let u=i.create(c.marshal(),a);const l=await o(u,t,this.options);this.cid=l,this.size=u.size,yield{cid:l,unixfs:c,path:e,node:u}}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4402,{"./dir":4403,"./utils/persist":4407,buffer:1936,"deep-extend":2111,"hamt-sharding":4209,"ipfs-unixfs":4409,"ipld-dag-pb":4546,"multihashing-async":5084},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const{DAGLink:r,DAGNode:i}=e("ipld-dag-pb"),s=e("ipfs-unixfs"),a=e("multihashing-async"),o=e("./dir"),c=e("./utils/persist"),u=e("hamt-sharding"),l=e("deep-extend"),f=async function(e){const t=(await a(n.from(e,"utf8"),"murmur3-128")).slice(2,10),r=t.length,i=n.alloc(r);for(let e=0;e<r;e++)i[r-e-1]=t[e];return i};f.code=34;const h={hashFn:f};async function*d(e,t,a,o){const l=t._children,f=[];for(let e=0;e<l.length;e++){const t=l.get(e);if(!t)continue;const n=e.toString(16).toUpperCase().padStart(2,"0");if(u.isBucket(t)){let e;for await(const n of await d("",t,a,o))e=n;f.push(await new r(n,e.node.size,e.cid))}else if("function"==typeof t.value.flush){const e=t.value;let i;for await(const t of e.flush(e.path,a))i=t,yield i;const s=n+t.key;f.push(new r(s,i.node.size,i.cid))}else{const e=t.value;if(!e.node){if(!e.cid)continue;e.node=await a.get(e.cid)}const i=n+t.key,s=e.node.length||e.node.size||e.node.Size;f.push(await new r(i,s,e.cid))}}const h=n.from(l.bitField().reverse()),p=new s("hamt-sharded-directory",h);p.fanout=t.tableSize(),p.hashType=o.hashFn.code;const g=i.create(p.marshal(),f),b=await c(g,a,o);yield{cid:b,node:g,unixfs:p,path:e}}t.exports=class extends o{constructor(e,t){super(e,t=l({},h,t)),this._bucket=u(t)}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e,t){for await(const n of d(e,this._bucket,t,this.options))yield n}},t.exports.hashFn=f}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4403,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=class{constructor(e,t){this.options=t||{},Object.assign(this,e)}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4404,{"./dir-sharded":4402},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./dir-sharded");t.exports=async function e(t,n,i,s){let a=n;n.flat&&n.directChildrenCount()>=i&&(a=await async function(e,t){const n=new r({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1},t);for await(const{key:t,child:r}of e.eachChildSeries())await n.put(t,r);return n}(n,s));const o=a.parent;return o&&(a!==n&&(t&&(t.parent=a),await o.put(a.parentKey,a)),o)?e(a,o,i,s):a}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4405,{"./dag-builder":4399,"./tree-builder":4406,multihashes:5081,superstruct:5755},function(){with(this)return function(){"use strict";return function(e,t,n){const{superstruct:r}=e("superstruct"),i=e("./dag-builder"),s=e("./tree-builder"),a=e("multihashes"),o=r({types:{codec:e=>["dag-pb","dag-cbor","raw"].includes(e),hashAlg:e=>Object.keys(a.names).includes(e),leafType:e=>["file","raw"].includes(e)}}),c=o({minChunkSize:"number?",maxChunkSize:"number?",avgChunkSize:"number?",window:"number?",polynomial:"number?"},{maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804}),u=o({maxChildrenPerNode:"number?",layerRepeat:"number?"},{maxChildrenPerNode:174,layerRepeat:4}),l=o({chunker:o.enum(["fixed","rabin"]),rawLeaves:"boolean?",hashOnly:"boolean?",strategy:o.enum(["balanced","flat","trickle"]),reduceSingleLeafToSelf:"boolean?",codec:"codec?",format:"codec?",hashAlg:"hashAlg?",leafType:"leafType?",cidVersion:"number?",progress:"function?",wrapWithDirectory:"boolean?",shardSplitThreshold:"number?",onlyHash:"boolean?",chunkerOptions:c,builderOptions:u,wrap:"boolean?",pin:"boolean?",recursive:"boolean?",ignore:"array?",hidden:"boolean?",preload:"boolean?"},{chunker:"fixed",strategy:"balanced",rawLeaves:!1,reduceSingleLeafToSelf:!0,codec:"dag-pb",hashAlg:"sha2-256",leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3});t.exports=async function*(e,t,n={}){const r=l(n);n.cidVersion>0&&n.rawLeaves===undefined&&(r.rawLeaves=!0),n.hashAlg!==undefined&&n.rawLeaves===undefined&&(r.rawLeaves=!0),"trickle"===n.strategy&&(r.leafType="raw",r.reduceSingleLeafToSelf=!1),n.format&&(n.codec=n.format);for await(const n of s(i(e,t,r),t,r))yield{cid:n.cid,path:n.path,unixfs:n.unixfs,size:n.size}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4406,{"./dir":4403,"./dir-flat":4401,"./flat-to-shard":4404,"./utils/to-path-components":4408,"async-iterator-first":1570,"err-code":2210},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("./dir-flat"),i=e("./flat-to-shard"),s=e("./dir"),a=e("./utils/to-path-components"),o=e("err-code"),c=e("async-iterator-first");async function u(e,t,n){const o=a(e.path||""),c=o.length-1;let u=t,l="";for(let a=0;a<o.length;a++){const f=o[a];l+=`${l?"/":""}${f}`;const h=a===c;if(u.dirty=!0,u.cid=null,u.size=null,h)await u.put(f,e),t=await i(null,u,n.shardSplitThreshold,n);else{let e=await u.get(f);e&&e instanceof s||(e=new r({dir:!0,parent:u,parentKey:f,path:l,dirty:!0,flat:!0},n)),await u.put(f,e),u=e}}return t}t.exports=async function*(e,t,n){let i=new r({root:!0,dir:!0,path:"",dirty:!0,flat:!0},n);for await(const t of e)i=await u(t,i,n),yield t;if(i){if(!n.wrapWithDirectory){if(i.childCount()>1)throw o(new Error("detected more than one root"),"ERR_MORE_THAN_ONE_ROOT");const e=await c(i.eachChildSeries());if(!e)return;i=e.child}if(!i.dir)return;for await(const e of i.flush(i.path,t))yield e}}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4407,{multicodec:5066,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("multihashes"),i=e("multicodec");t.exports=(e,t,n)=>{!n.codec&&e.length&&(n.cidVersion=1,n.codec="raw"),isNaN(n.hashAlg)&&(n.hashAlg=r.names[n.hashAlg]),n.hashAlg!==r.names["sha2-256"]&&(n.cidVersion=1),n.format&&(n.codec=n.format);const s=i[n.codec.toUpperCase().replace(/-/g,"_")];return t.put(e,s,n)}}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4408,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}}},{package:"3box>ipfs>ipfs-unixfs-importer"}],[4409,{"./unixfs.proto":4410,protons:5281},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("protons")(e("./unixfs.proto")).Data,i=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],s=["directory","hamt-sharded-directory"];function a(e,t){if(!(this instanceof a))return new a(e,t);if(-1===i.indexOf(e))throw new Error("Type: "+e+" is not valid");this.type=e,this.data=t,this.blockSizes=[],this.addBlockSize=e=>{this.blockSizes.push(e)},this.removeBlockSize=e=>{this.blockSizes.splice(e,1)},this.fileSize=()=>{if(s.indexOf(this.type)>=0)return undefined;let e=0;return this.blockSizes.forEach((t=>{e+=t})),t&&(e+=t.length),e},this.marshal=()=>{let e;switch(this.type){case"raw":e=r.DataType.Raw;break;case"directory":e=r.DataType.Directory;break;case"file":e=r.DataType.File;break;case"metadata":e=r.DataType.Metadata;break;case"symlink":e=r.DataType.Symlink;break;case"hamt-sharded-directory":e=r.DataType.HAMTShard;break;default:throw new Error(`Unkown type: "${this.type}"`)}let t=this.fileSize(),n=this.data;this.data&&this.data.length||(n=undefined);let i=this.blockSizes;return this.blockSizes&&this.blockSizes.length||(i=undefined),r.encode({Type:e,Data:n,filesize:t,blocksizes:i,hashType:this.hashType,fanout:this.fanout})}}a.unmarshal=e=>{const t=r.decode(e);t.Data||(t.Data=undefined);const n=new a(i[t.Type],t.Data);return n.blockSizes=t.blocksizes,n},t.exports=a}}},{package:"3box>ipfs>ipfs-unixfs"}],[4410,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports="message Data {\n  enum DataType {\n    Raw = 0;\n    Directory = 1;\n    File = 2;\n    Metadata = 3;\n    Symlink = 4;\n    HAMTShard = 5;\n  }\n\n  required DataType Type = 1;\n  optional bytes Data = 2;\n  optional uint64 filesize = 3;\n  repeated uint64 blocksizes = 4;\n\n  optional uint64 hashType = 5;\n  optional uint64 fanout = 6;\n}\n\nmessage Metadata {\n  optional string MimeType = 1;\n}"}}},{package:"3box>ipfs>ipfs-unixfs"}],[4411,{},function(){with(this)return function(){"use strict";return function(e,t,n){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}}}},{package:"3box>ipfs>ipfs-utils>is-buffer"}],[4412,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r={};function i(e,t,n){n||(n=Error);var i=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);i.prototype.name=n.name,i.prototype.code=e,r[e]=i}function s(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,a,o;if("string"==typeof t&&(i="not ",t.substr(!a||a<0?0:+a,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(n===undefined||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))o="The ".concat(e," ").concat(r," ").concat(s(t,"type"));else{var c=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";o='The "'.concat(e,'" ').concat(c," ").concat(r," ").concat(s(t,"type"))}return o+=". Received type ".concat(typeof n)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4413,{"./_stream_readable":4415,"./_stream_writable":4417,_process:5261,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=u;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(u,i);for(var a=r(s.prototype),o=0;o<a.length;o++){var c=a[o];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4414,{"./_stream_transform":4416,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4415,{"../errors":4412,"./_stream_duplex":4413,"./internal/streams/async_iterator":4418,"./internal/streams/buffer_list":4419,"./internal/streams/destroy":4420,"./internal/streams/from":4422,"./internal/streams/state":4424,"./internal/streams/stream":4425,_process:5261,buffer:1936,events:1937,inherits:4276,"string_decoder/":5747,util:1935},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;t.exports=x,x.ReadableState=E;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),a=e("buffer").Buffer,o=global.Uint8Array||function(){};var c,u=e("util");c=u&&u.debuglog?u.debuglog("stream"):function(){};var l,f,h,d=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),g=e("./internal/streams/state").getHighWaterMark,b=e("../errors").codes,m=b.ERR_INVALID_ARG_TYPE,w=b.ERR_STREAM_PUSH_AFTER_EOF,y=b.ERR_METHOD_NOT_IMPLEMENTED,_=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(x,s);var v=p.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(t,n,i){r=r||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",i),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(l||(l=e("string_decoder/").StringDecoder),this.decoder=new l(t.encoding),this.encoding=t.encoding)}function x(t){if(r=r||e("./_stream_duplex"),!(this instanceof x))return new x(t);var n=this instanceof r;this._readableState=new E(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function S(e,t,n,r,i){c("readableAddChunk",t);var s,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?N(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,u);else if(i||(s=function(e,t){var n;r=t,a.isBuffer(r)||r instanceof o||"string"==typeof t||t===undefined||e.objectMode||(n=new m("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(u,t)),s)v(e,s);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),r)u.endEmitted?v(e,new _):A(e,u,t,!0);else if(u.ended)v(e,new w);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!n?(t=u.decoder.write(t),u.objectMode||0!==t.length?A(e,u,t,!1):O(e,u)):A(e,u,t,!1)}else r||(u.reading=!1,O(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function A(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&N(e)),O(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=p.destroy,x.prototype._undestroy=p.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=a.from(e,t),t=""),n=!0),S(this,e,t,!1,n)},x.prototype.unshift=function(e){return S(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(t){l||(l=e("string_decoder/").StringDecoder);var n=new l(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var R=1073741824;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function N(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(I,e))}function I(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,B(e)}function O(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(c("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){c("readable nexttick read 0"),e.read(0)}function C(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function M(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function j(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(U,t,e))}function U(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function z(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}x.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):N(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&j(this),null;var r,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(r=e>0?M(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&j(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){v(this,new y("_read()"))},x.prototype.pipe=function(e,t){var r=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,c("pipe count=%d opts=%j",s.pipesCount,t);var a=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:b;function o(t,n){c("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",g),e.removeListener("drain",l),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",u),r.removeListener("end",b),r.removeListener("data",h),f=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}s.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",o);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,B(e))}}(r);e.on("drain",l);var f=!1;function h(t){c("ondata");var n=e.write(t);c("dest.write",n),!1===n&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==z(s.pipes,e))&&!f&&(c("false write response, pause",s.awaitDrain),s.awaitDrain++),r.pause())}function d(t){c("onerror",t),b(),e.removeListener("error",d),0===i(e,"error")&&v(e,t)}function p(){e.removeListener("finish",g),b()}function g(){c("onfinish"),e.removeListener("close",p),b()}function b(){c("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",g),e.emit("pipe",r),s.flowing||(c("pipe resume"),r.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=z(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},x.prototype.on=function(e,t){var r=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?N(this):i.reading||n.nextTick(D,this))),r},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var r=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},x.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||n.nextTick(L,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(C,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&i!==undefined)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<k.length;s++)e.on(k[s],this.emit.bind(this,k[s]));return this._read=function(t){c("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return f===undefined&&(f=e("./internal/streams/async_iterator")),f(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=M,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(t,n){return h===undefined&&(h=e("./internal/streams/from")),h(x,t,n)})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4416,{"../errors":4412,"./_stream_duplex":4413,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=l;var r=e("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new o;if(e._transformState.transforming)throw new a;return e.push(null)}e("inherits")(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4417,{"../errors":4412,"./_stream_duplex":4413,"./internal/streams/destroy":4420,"./internal/streams/state":4424,"./internal/streams/stream":4425,_process:5261,buffer:1936,inherits:4276,"util-deprecate":5856},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=x,x.WritableState=E;var s={deprecate:e("util-deprecate")},a=e("./internal/streams/stream"),o=e("buffer").Buffer,c=global.Uint8Array||function(){};var u,l=e("./internal/streams/destroy"),f=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,d=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,b=h.ERR_STREAM_CANNOT_PIPE,m=h.ERR_STREAM_DESTROYED,w=h.ERR_STREAM_NULL_VALUES,y=h.ERR_STREAM_WRITE_AFTER_END,_=h.ERR_UNKNOWN_ENCODING,v=l.errorOrDestroy;function k(){}function E(t,s,a){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof a&&(a=s instanceof i),this.objectMode=!!t.objectMode,a&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=f(this,t,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,s){--t.pendingcb,r?(n.nextTick(s,i),n.nextTick(I,e,t),e._writableState.errorEmitted=!0,v(e,i)):(s(i),e._writableState.errorEmitted=!0,v(e,i),I(e,t))}(e,r,i,t,s);else{var a=T(r)||e.destroyed;a||r.corked||r.bufferProcessing||!r.bufferedRequest||R(e,r),i?n.nextTick(A,e,r,a,s):A(e,r,a,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function x(t){var n=this instanceof(i=i||e("./_stream_duplex"));if(!n&&!u.call(x,this))return new x(t);this._writableState=new E(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function S(e,t,n,r,i,s,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new m("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function A(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),I(e,t)}function R(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var o=0,c=!0;n;)s[o]=n,n.isBuf||(c=!1),n=n.next,o+=1;s.allBuffers=c,S(e,t,!0,t.length,s,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,f=n.callback;if(S(e,t,!1,t.objectMode?1:u.length,u,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function N(e,t){e._final((function(n){t.pendingcb--,n&&v(e,n),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var r=T(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(N,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(x,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===x&&(e&&e._writableState instanceof E)}})):u=function(e){return e instanceof this},x.prototype.pipe=function(){v(this,new b)},x.prototype.write=function(e,t,r){var i,s=this._writableState,a=!1,u=!s.objectMode&&(i=e,o.isBuffer(i)||i instanceof c);return u&&!o.isBuffer(e)&&(e=function(e){return o.from(e)}(e)),"function"==typeof t&&(r=t,t=null),u?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=k),s.ending?function(e,t){var r=new y;v(e,r),n.nextTick(t,r)}(this,r):(u||function(e,t,r,i){var s;return null===r?s=new w:"string"==typeof r||t.objectMode||(s=new d("chunk",["string","Buffer"],r)),!s||(v(e,s),n.nextTick(i,s),!1)}(this,s,e,r))&&(s.pendingcb++,a=function(e,t,n,r,i,s){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=o.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var c=t.objectMode?1:r.length;t.length+=c;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,c,r,i,s);return u}(this,s,u,e,t,r)),a},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,n){n(new p("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,I(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=l.destroy,x.prototype._undestroy=l.undestroy,x.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4418,{"./end-of-stream":4421,_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("./end-of-stream"),a=Symbol("lastResolve"),o=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),l=Symbol("lastPromise"),f=Symbol("handlePromise"),h=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[a];if(null!==t){var n=e[h].read();null!==n&&(e[l]=null,e[a]=null,e[o]=null,t(d(n,!1)))}}function g(e){n.nextTick(p,e)}var b=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(d(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[c]?r(e[c]):t(d(undefined,!0))}))}));var r,i=this[l];if(i)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[u]?n(d(undefined,!0)):t[f](n,r)}),r)}}(i,this));else{var s=this[h].read();if(null!==s)return Promise.resolve(d(s,!1));r=new Promise(this[f])}return this[l]=r,r}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(d(undefined,!0))}))}))})),r),b);t.exports=function(e){var t,n=Object.create(m,(i(t={},h,{value:e,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var r=n[h].read();r?(n[l]=null,n[a]=null,n[o]=null,e(d(r,!1))):(n[a]=e,n[o]=t)},writable:!0}),t));return n[l]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[o];return null!==t&&(n[l]=null,n[a]=null,n[o]=null,t(e)),void(n[c]=e)}var r=n[a];null!==r&&(n[l]=null,n[a]=null,n[o]=null,r(d(undefined,!0))),n[u]=!0})),e.on("readable",g.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4419,{buffer:1936,util:1935},function(){with(this)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=e("buffer").Buffer,o=e("util").inspect,c=o&&o.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,u;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,a.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:c,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&s(t.prototype,n),u&&s(t,u),e}()}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4420,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var a=this,o=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return o||c?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?a._writableState?a._writableState.errorEmitted?e.nextTick(r,a):(a._writableState.errorEmitted=!0,e.nextTick(n,a,t)):e.nextTick(n,a,t):s?(e.nextTick(r,a),s(t)):e.nextTick(r,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4421,{"../../../errors":4412},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var a=n.readable||!1!==n.readable&&t.readable,o=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){o=!1,u=!0,a||s.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,f=!0,o||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):o&&!u?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},g=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?o&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?g():t.on("request",g)),t.on("end",h),t.on("finish",l),!1!==n.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",d),t.removeListener("close",p)}}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4422,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4423,{"../../../errors":4412,"./end-of-stream":4421},function(){with(this)return function(){"use strict";return function(e,t,n){var r;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function c(t,n,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var o=!1;t.on("close",(function(){o=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},(function(e){if(e)return s(e);o=!0,s()}));var c=!1;return function(e){if(!o&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new a("pipe"))}}function u(e){e()}function l(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}t.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var a=t.map((function(e,n){var s=n<t.length-1;return c(e,s,n>0,(function(e){r||(r=e),e&&a.forEach(u),s||(a.forEach(u),i(r))}))}));return t.reduce(l)}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4424,{"../../../errors":4412},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4425,{events:1937},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4426,{"./lib/_stream_duplex.js":4413,"./lib/_stream_passthrough.js":4414,"./lib/_stream_readable.js":4415,"./lib/_stream_transform.js":4416,"./lib/_stream_writable.js":4417,"./lib/internal/streams/end-of-stream.js":4421,"./lib/internal/streams/pipeline.js":4423},function(){with(this)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"3box>ipfs>ipfs-utils>readable-stream"}],[4427,{"is-buffer":4411,"is-pull-stream":4574,"is-stream":4577,"kind-of":4626},function(){with(this)return function(){"use strict";return function(e,t,n){const r=e("kind-of"),i=e("is-stream"),{isSource:s}=e("is-pull-stream"),a=e("is-buffer");t.exports=e=>{const t=e=>a(e)||i.readable(e)||s(e)||"file"===r(e),n=e=>t(e)||(e=>"object"==typeof e&&(e.content?t(e.content):Boolean(e.path)&&"string"==typeof e.path))(e);if(n(e)||Array.isArray(e)&&e.every(n))return!0;throw new Error(`Input not supported. Expected Buffer|ReadableStream|PullStream|File|Array<Object> got ${r(e)}. Check the documentation for more info https://github.com/ipfs/interface-js-ipfs-core/blob/master/SPEC/FILES.md#add`)}}}},{package:"3box>ipfs>ipfs-utils"}],[4428,{"../supports":4429,"readable-stream":4426},function(){with(this)return function(){"use strict";return function(e,t,n){const{Readable:r}=e("readable-stream"),{supportsFileReader:i}=e("../supports");t.exports=(e,t)=>{if(!i)throw new Error("FileReader DOM API is not supported.");return new class extends r{constructor(e,t={}){super(t),this.file=e,this.offset=t.offset||0,this.chunkSize=t.chunkSize||1048576,this.fileReader=new self.FileReader(e),this.fileReader.onloadend=e=>{const t=e.target.result;0===t.byteLength&&this.push(null),this.push(new Uint8Array(t))},this.fileReader.onerror=e=>this.destroy(e)}_read(t){const n=this.offset+this.chunkSize,r=e.slice(this.offset,n);this.fileReader.readAsArrayBuffer(r),this.offset=n}}(e,t)}}}},{package:"3box>ipfs>ipfs-utils"}],[4429,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports={supportsFileReader:"undefined"!=typeof self&&"FileReader"in self}}}},{package:"3box>ipfs>ipfs-utils"}],[4430,{},function(){with(this)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=u-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function b(e,t){var n,r,i=e.c,s=t.c,a=e.s,o=t.s,c=e.e,u=t.e;if(!a||!o)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-o:a;if(a!=o)return a;if(n=a<0,r=c==u,!i||!s)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(o=(c=i.length)<(u=s.length)?c:u,a=0;a<o;a++)if(i[a]!=s[a])return i[a]>s[a]^n?1:-1;return c==u?0:c>u^n?1:-1}function m(e,t,n,r){if(e<t||e>n||e!==s(e))throw Error(a+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function w(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function _(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,v,k,E,x,S,A,R,T,N,I=H.prototype={constructor:H,toString:null,valueOf:null},O=new H(1),P=20,L=4,D=-7,C=21,B=-1e7,M=1e7,j=!1,U=1,z=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},$="0123456789abcdefghijklmnopqrstuvwxyz";function H(e,t){var n,i,a,c,f,h,d,p,g=this;if(!(g instanceof H))return new H(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>M?g.c=g.e=null:e.e<B?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,f=e;f>=10;f/=10,c++);return void(c>M?g.c=g.e=null:(g.e=c,g.c=[e]))}p=String(e)}else{if(!r.test(p=String(e)))return k(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(c<0&&(c=f),c+=+p.slice(f+1),p=p.substring(0,f)):c<0&&(c=p.length)}else{if(m(t,2,$.length,"Base"),10==t)return V(g=new H(e),P+g.e+1,L);if(p=String(e),h="number"==typeof e){if(0*e!=0)return k(g,p,h,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,H.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=$.slice(0,t),c=f=0,d=p.length;f<d;f++)if(n.indexOf(i=p.charAt(f))<0){if("."==i){if(f>c){c=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,c=0;continue}return k(g,String(e),h,t)}h=!1,(c=(p=v(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&H.DEBUG&&d>15&&(e>l||e!==s(e)))throw Error(o+g.s*e);if((c=c-f-1)>M)g.c=g.e=null;else if(c<B)g.c=[g.e=0];else{if(g.e=c,g.c=[],f=(c+1)%u,c<0&&(f+=u),f<d){for(f&&g.c.push(+p.slice(0,f)),d-=u;f<d;)g.c.push(+p.slice(f,f+=u));f=u-(p=p.slice(f)).length}else f-=d;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function q(e,t,n,r){var i,s,a,o,c;if(null==n?n=L:m(n,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)c=g(e.c),c=1==r||2==r&&(a<=D||a>=C)?y(c,a):_(c,a,"0");else if(s=(e=V(new H(e),t,n)).e,o=(c=g(e.c)).length,1==r||2==r&&(t<=s||s<=D)){for(;o<t;c+="0",o++);c=y(c,s)}else if(t-=a,c=_(c,s,"0"),s+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-o)>0)for(s+1==o&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function W(e,t){for(var n,r=1,i=new H(e[0]);r<e.length;r++){if(!(n=new H(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function G(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*u-1)>M?e.c=e.e=null:n<B?e.c=[e.e=0]:(e.e=n,e.c=t),e}function V(e,t,n,r){var a,o,l,h,d,p,g,b=e.c,m=f;if(b){e:{for(a=1,h=b[0];h>=10;h/=10,a++);if((o=t-a)<0)o+=u,l=t,g=(d=b[p=0])/m[a-l-1]%10|0;else if((p=i((o+1)/u))>=b.length){if(!r)break e;for(;b.length<=p;b.push(0));d=g=0,a=1,l=(o%=u)-u+1}else{for(d=h=b[p],a=1;h>=10;h/=10,a++);g=(l=(o%=u)-u+a)<0?0:d/m[a-l-1]%10|0}if(r=r||t<0||null!=b[p+1]||(l<0?d:d%m[a-l-1]),r=n<4?(g||r)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||r||6==n&&(o>0?l>0?d/m[a-l]:0:b[p-1])%10&1||n==(e.s<0?8:7)),t<1||!b[0])return b.length=0,r?(t-=e.e+1,b[0]=m[(u-t%u)%u],e.e=-t||0):b[0]=e.e=0,e;if(0==o?(b.length=p,h=1,p--):(b.length=p+1,h=m[u-o],b[p]=l>0?s(d/m[a-l]%m[l])*h:0),r)for(;;){if(0==p){for(o=1,l=b[0];l>=10;l/=10,o++);for(l=b[0]+=h,h=1;l>=10;l/=10,h++);o!=h&&(e.e++,b[0]==c&&(b[0]=1));break}if(b[p]+=h,b[p]!=c)break;b[p--]=0,h=1}for(o=b.length;0===b[--o];b.pop());}e.e>M?e.c=e.e=null:e.e<B&&(e.c=[e.e=0])}return e}function K(e){var t,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=D||n>=C?y(t,n):_(t,n,"0"),e.s<0?"-"+t:t)}return H.clone=e,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(n=e[t],0,d,t),P=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(n=e[t],0,8,t),L=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(m(n[0],-d,0,t),m(n[1],0,d,t),D=n[0],C=n[1]):(m(n,-d,d,t),D=-(C=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)m(n[0],-d,-1,t),m(n[1],1,d,t),B=n[0],M=n[1];else{if(m(n,-d,d,t),!n)throw Error(a+t+" cannot be zero: "+n);B=-(M=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(a+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!n,Error(a+"crypto unavailable");j=n}else j=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(n=e[t],0,9,t),U=n),e.hasOwnProperty(t="POW_PRECISION")&&(m(n=e[t],0,d,t),z=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(a+t+" not an object: "+n);F=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(a+t+" invalid: "+n);$=n}}return{DECIMAL_PLACES:P,ROUNDING_MODE:L,EXPONENTIAL_AT:[D,C],RANGE:[B,M],CRYPTO:j,MODULO_MODE:U,POW_PRECISION:z,FORMAT:F,ALPHABET:$}},H.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!H.DEBUG)return!0;var t,n,r=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&i>=-d&&i<=d&&i===s(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=c||n!==s(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===o||1===o||-1===o))return!0;throw Error(a+"Invalid BigNumber: "+e)},H.maximum=H.max=function(){return W(arguments,I.lt)},H.minimum=H.min=function(){return W(arguments,I.gt)},H.random=(E=9007199254740992,x=Math.random()*E&2097151?function(){return s(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,o,c,l=0,h=[],p=new H(O);if(null==e?e=P:m(e,0,d),o=i(e/u),j)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));l<o;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[l]=n[0],t[l+1]=n[1]):(h.push(c%1e14),l+=2);l=o/2}else{if(!crypto.randomBytes)throw j=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(o*=7);l<o;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(h.push(c%1e14),l+=7);l=o/7}if(!j)for(;l<o;)(c=x())<9e15&&(h[l++]=c%1e14);for(o=h[--l],e%=u,o&&e&&(c=f[u-e],h[l]=s(o/c)*c);0===h[l];h.pop(),l--);if(l<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=u);for(l=1,c=h[0];c>=10;c/=10,l++);l<u&&(r-=u-l)}return p.e=r,p.c=h,p}),H.sum=function(){for(var e=1,t=arguments,n=new H(t[0]);e<t.length;)n=n.plus(t[e++]);return n},v=function(){var e="0123456789";function t(e,t,n,r){for(var i,s,a=[0],o=0,c=e.length;o<c;){for(s=a.length;s--;a[s]*=t);for(a[0]+=r.indexOf(e.charAt(o++)),i=0;i<a.length;i++)a[i]>n-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/n|0,a[i]%=n)}return a.reverse()}return function(r,i,s,a,o){var c,u,l,f,h,d,p,b,m=r.indexOf("."),w=P,y=L;for(m>=0&&(f=z,z=0,r=r.replace(".",""),d=(b=new H(i)).pow(r.length-m),z=f,b.c=t(_(g(d.c),d.e,"0"),10,s,e),b.e=b.c.length),l=f=(p=t(r,i,s,o?(c=$,e):(c=e,$))).length;0==p[--f];p.pop());if(!p[0])return c.charAt(0);if(m<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=n(d,b,w,y,s)).c,h=d.r,l=d.e),m=p[u=l+w+1],f=s/2,h=h||u<0||null!=p[u+1],h=y<4?(null!=m||h)&&(0==y||y==(d.s<0?3:2)):m>f||m==f&&(4==y||h||6==y&&1&p[u-1]||y==(d.s<0?8:7)),u<1||!p[0])r=h?_(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,h)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(f=p.length;!p[--f];);for(m=0,r="";m<=f;r+=c.charAt(p[m++]));r=_(r,l,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,s,a,o=0,c=e.length,u=t%h,l=t/h|0;for(e=e.slice();c--;)o=((i=u*(s=e[c]%h)+(r=l*s+(a=e[c]/h|0)*u)%h*h+o)/n|0)+(r/h|0)+l*a,e[c]=i%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,a,o,l){var f,h,d,g,b,m,w,y,_,v,k,E,x,S,A,R,T,N=r.s==i.s?1:-1,I=r.c,O=i.c;if(!(I&&I[0]&&O&&O[0]))return new H(r.s&&i.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*N:N/0:NaN);for(_=(y=new H(N)).c=[],N=a+(h=r.e-i.e)+1,l||(l=c,h=p(r.e/u)-p(i.e/u),N=N/u|0),d=0;O[d]==(I[d]||0);d++);if(O[d]>(I[d]||0)&&h--,N<0)_.push(1),g=!0;else{for(S=I.length,R=O.length,d=0,N+=2,(b=s(l/(O[0]+1)))>1&&(O=e(O,b,l),I=e(I,b,l),R=O.length,S=I.length),x=R,k=(v=I.slice(0,R)).length;k<R;v[k++]=0);T=O.slice(),T=[0].concat(T),A=O[0],O[1]>=l/2&&A++;do{if(b=0,(f=t(O,v,R,k))<0){if(E=v[0],R!=k&&(E=E*l+(v[1]||0)),(b=s(E/A))>1)for(b>=l&&(b=l-1),w=(m=e(O,b,l)).length,k=v.length;1==t(m,v,w,k);)b--,n(m,R<w?T:O,w,l),w=m.length,f=1;else 0==b&&(f=b=1),w=(m=O.slice()).length;if(w<k&&(m=[0].concat(m)),n(v,m,k,l),k=v.length,-1==f)for(;t(O,v,R,k)<1;)b++,n(v,R<k?T:O,k,l),k=v.length}else 0===f&&(b++,v=[0]);_[d++]=b,v[0]?v[k++]=I[x]||0:(v=[I[x]],k=1)}while((x++<S||null!=v[0])&&N--);g=null!=v[0],_[0]||_.splice(0,1)}if(l==c){for(d=1,N=_[0];N>=10;N/=10,d++);V(y,a+(y.e=d+h*u-1)+1,o,g)}else y.e=h,y.r=+g;return y}}(),S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,R=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,k=function(e,t,n,r){var i,s=n?t:t.replace(N,"");if(T.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(S,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(A,"$1").replace(R,"0.$1")),t!=s))return new H(s,i);if(H.DEBUG)throw Error(a+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},I.absoluteValue=I.abs=function(){var e=new H(this);return e.s<0&&(e.s=1),e},I.comparedTo=function(e,t){return b(this,new H(e,t))},I.decimalPlaces=I.dp=function(e,t){var n,r,i,s=this;if(null!=e)return m(e,0,d),null==t?t=L:m(t,0,8),V(new H(s),e+s.e+1,t);if(!(n=s.c))return null;if(r=((i=n.length-1)-p(this.e/u))*u,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},I.dividedBy=I.div=function(e,t){return n(this,new H(e,t),P,L)},I.dividedToIntegerBy=I.idiv=function(e,t){return n(this,new H(e,t),0,1)},I.exponentiatedBy=I.pow=function(e,t){var n,r,o,c,l,f,h,d,p=this;if((e=new H(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+K(e));if(null!=t&&(t=new H(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new H(Math.pow(+K(p),l?2-w(e):+K(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new H(NaN);(r=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&w(e)?-0:0,p.e>-1&&(c=1/c),new H(f?1/c:c);z&&(c=i(z/u+2))}for(l?(n=new H(.5),f&&(e.s=1),h=w(e)):h=(o=Math.abs(+K(e)))%2,d=new H(O);;){if(h){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):r&&(d=d.mod(t))}if(o){if(0===(o=s(o/2)))break;h=o%2}else if(V(e=e.times(n),e.e+1,1),e.e>14)h=w(e);else{if(0===(o=+K(e)))break;h=o%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):r&&(p=p.mod(t))}return r?d:(f&&(d=O.div(d)),t?d.mod(t):c?V(d,z,L,undefined):d)},I.integerValue=function(e){var t=new H(this);return null==e?e=L:m(e,0,8),V(t,t.e+1,e)},I.isEqualTo=I.eq=function(e,t){return 0===b(this,new H(e,t))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(e,t){return b(this,new H(e,t))>0},I.isGreaterThanOrEqualTo=I.gte=function(e,t){return 1===(t=b(this,new H(e,t)))||0===t},I.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},I.isLessThan=I.lt=function(e,t){return b(this,new H(e,t))<0},I.isLessThanOrEqualTo=I.lte=function(e,t){return-1===(t=b(this,new H(e,t)))||0===t},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(e,t){var n,r,i,s,a=this,o=a.s;if(t=(e=new H(e,t)).s,!o||!t)return new H(NaN);if(o!=t)return e.s=-t,a.plus(e);var l=a.e/u,f=e.e/u,h=a.c,d=e.c;if(!l||!f){if(!h||!d)return h?(e.s=-t,e):new H(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new H(h[0]?a:3==L?-0:0)}if(l=p(l),f=p(f),h=h.slice(),o=l-f){for((s=o<0)?(o=-o,i=h):(f=l,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(r=(s=(o=h.length)<(t=d.length))?o:t,o=t=0;t<r;t++)if(h[t]!=d[t]){s=h[t]<d[t];break}if(s&&(i=h,h=d,d=i,e.s=-e.s),(t=(r=d.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=c-1;r>o;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=c}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?G(e,h,f):(e.s=3==L?-1:1,e.c=[e.e=0],e)},I.modulo=I.mod=function(e,t){var r,i,s=this;return e=new H(e,t),!s.c||!e.s||e.c&&!e.c[0]?new H(NaN):!e.c||s.c&&!s.c[0]?new H(s):(9==U?(i=e.s,e.s=1,r=n(s,e,0,3),e.s=i,r.s*=i):r=n(s,e,0,U),(e=s.minus(r.times(e))).c[0]||1!=U||(e.s=s.s),e)},I.multipliedBy=I.times=function(e,t){var n,r,i,s,a,o,l,f,d,g,b,m,w,y,_,v=this,k=v.c,E=(e=new H(e,t)).c;if(!(k&&E&&k[0]&&E[0]))return!v.s||!e.s||k&&!k[0]&&!E||E&&!E[0]&&!k?e.c=e.e=e.s=null:(e.s*=v.s,k&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(v.e/u)+p(e.e/u),e.s*=v.s,(l=k.length)<(g=E.length)&&(w=k,k=E,E=w,i=l,l=g,g=i),i=l+g,w=[];i--;w.push(0));for(y=c,_=h,i=g;--i>=0;){for(n=0,b=E[i]%_,m=E[i]/_|0,s=i+(a=l);s>i;)n=((f=b*(f=k[--a]%_)+(o=m*f+(d=k[a]/_|0)*b)%_*_+w[s]+n)/y|0)+(o/_|0)+m*d,w[s--]=f%y;w[s]=n}return n?++r:w.splice(0,1),G(e,w,r)},I.negated=function(){var e=new H(this);return e.s=-e.s||null,e},I.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new H(e,t)).s,!i||!t)return new H(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/u,a=e.e/u,o=r.c,l=e.c;if(!s||!a){if(!o||!l)return new H(i/0);if(!o[0]||!l[0])return l[0]?e:new H(o[0]?r:0*i)}if(s=p(s),a=p(a),o=o.slice(),i=s-a){for(i>0?(a=s,n=l):(i=-i,n=o),n.reverse();i--;n.push(0));n.reverse()}for((i=o.length)-(t=l.length)<0&&(n=l,l=o,o=n,t=i),i=0;t;)i=(o[--t]=o[t]+l[t]+i)/c|0,o[t]=c===o[t]?0:o[t]%c;return i&&(o=[i].concat(o),++a),G(e,o,a)},I.precision=I.sd=function(e,t){var n,r,i,s=this;if(null!=e&&e!==!!e)return m(e,1,d),null==t?t=L:m(t,0,8),V(new H(s),e,t);if(!(n=s.c))return null;if(r=(i=n.length-1)*u+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},I.shiftedBy=function(e){return m(e,-9007199254740991,l),this.times("1e"+e)},I.squareRoot=I.sqrt=function(){var e,t,r,i,s,a=this,o=a.c,c=a.s,u=a.e,l=P+4,f=new H("0.5");if(1!==c||!o||!o[0])return new H(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+K(a)))||c==1/0?(((t=g(o)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),r=new H(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new H(c+""),r.c[0])for((c=(u=r.e)+l)<3&&(c=0);;)if(s=r,r=f.times(s.plus(n(a,s,l,1))),g(s.c).slice(0,c)===(t=g(r.c)).slice(0,c)){if(r.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(V(r,r.e+P+2,1),e=!r.times(r).eq(a));break}if(!i&&(V(s,s.e+P+2,0),s.times(s).eq(a))){r=s;break}l+=4,c+=4,i=1}return V(r,r.e+P+1,L,e)},I.toExponential=function(e,t){return null!=e&&(m(e,0,d),e++),q(this,e,t,1)},I.toFixed=function(e,t){return null!=e&&(m(e,0,d),e=e+this.e+1),q(this,e,t)},I.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=F;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,o=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",f=o[0],h=o[1],d=i.s<0,p=d?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),d&&(f="-"+f)}r=h?f+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):f}return(n.prefix||"")+r+(n.suffix||"")},I.toFraction=function(e){var t,r,i,s,o,c,l,h,d,p,b,m,w=this,y=w.c;if(null!=e&&(!(l=new H(e)).isInteger()&&(l.c||1!==l.s)||l.lt(O)))throw Error(a+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+K(l));if(!y)return new H(w);for(t=new H(O),d=r=new H(O),i=h=new H(O),m=g(y),o=t.e=m.length-w.e-1,t.c[0]=f[(c=o%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?o>0?t:d:l,c=M,M=1/0,l=new H(m),h.c[0]=0;p=n(l,t,0,1),1!=(s=r.plus(p.times(i))).comparedTo(e);)r=i,i=s,d=h.plus(p.times(s=d)),h=s,t=l.minus(p.times(s=t)),l=s;return s=n(e.minus(r),i,0,1),h=h.plus(s.times(d)),r=r.plus(s.times(i)),h.s=d.s=w.s,b=n(d,i,o*=2,L).minus(w).abs().comparedTo(n(h,r,o,L).minus(w).abs())<1?[d,i]:[h,r],M=c,b},I.toNumber=function(){return+K(this)},I.toPrecision=function(e,t){return null!=e&&m(e,1,d),q(this,e,t,2)},I.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=D||i>=C?y(g(n.c),i):_(g(n.c),i,"0"):10===e?t=_(g((n=V(new H(n),P+i+1,L)).c),n.e,"0"):(m(e,2,$.length,"Base"),t=v(_(g(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},I.valueOf=I.toJSON=function(){return K(this)},I._isBigNumber=!0,null!=t&&H.set(t),H}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"3box>ipfs>bignumber.js"}],[4431,{"./utils":4435,blakejs:1889,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("blakejs"),i=e("./utils").toCallback,s={init:r.blake2bInit,update:r.blake2bUpdate,digest:r.blake2bFinal},a={init:r.blake2sInit,update:r.blake2sUpdate,digest:r.blake2sFinal},o=(e,t)=>i((r=>{const i=t.init(e,null);return t.update(i,r),n.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=o(t+1,s);for(let t=0;t<32;t++)e[45633+t]=o(t+1,a)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multihashing-async"}],[4432,{buffer:1936,nodeify:5141},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const a=i.digest({name:e},t);if("function"!=typeof a.then)return a.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(a.oncomplete=e=>{s(null,e.target.result)});r(a.then((e=>n.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multihashing-async"}],[4433,{"./blake":4431,"./crypto-sha1-2":4432,"./utils":4435,buffer:1936,"js-sha3":4590,murmurhash3js:5101},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),a=e("./crypto-sha1-2"),o=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:a.sha1,sha2256:a.sha2256,sha2512:a.sha2512,sha3512:o(c(r.sha3_512)),sha3384:o(c(r.sha3_384)),sha3256:o(c(r.sha3_256)),sha3224:o(c(r.sha3_224)),shake128:o(c(r.shake_128,128)),shake256:o(c(r.shake_256,256)),keccak224:o(c(r.keccak_224)),keccak256:o(c(r.keccak_256)),keccak384:o(c(r.keccak_384)),keccak512:o(c(r.keccak_512)),murmur3128:o(c(u(i.x64.hash128))),murmur332:o(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{a.sha2256(e,((e,r)=>{e&&t(e),a.sha2256(n.from(r),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multihashing-async"}],[4434,{"./crypto":4433,buffer:1936,multihashes:5081},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){const r=e("multihashes"),i=e("./crypto");function s(e,t,n,i){if("function"==typeof n&&(i=n,n=undefined),!i)throw new Error("Missing callback");s.digest(e,t,n,((e,s)=>{if(e)return i(e);i(null,r.encode(s,t,n))}))}t.exports=s,s.Buffer=n,s.multihash=r,s.digest=function(e,t,n,r){if("function"==typeof n&&(r=n,n=undefined),!r)throw new Error("Missing callback");let i,a=r;n&&(a=(e,t)=>{if(e)return r(e);r(null,t.slice(0,n))});try{i=s.createHash(t)}catch(e){return a(e)}i(e,a)},s.createHash=function(e){if(e=r.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions),s.validate=(e,t,i)=>{s(e,r.decode(t).name,((e,r)=>{if(e)return i(e);i(e,0===n.compare(t,r))}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multihashing-async"}],[4435,{_process:5261,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e,t){(function(){n.toCallback=t=>function(n,r){let i;try{i=t(n)}catch(t){return void e.nextTick(r,t)}e.nextTick(r,null,i)},n.toBuf=(e,n)=>r=>{let i=e(r,n);return t.from(i,"hex")},n.fromString=(e,n)=>r=>{const i=t.isBuffer(r)?r.toString():r;return e(i,n)},n.fromNumberTo32BitBuf=(e,n)=>r=>{let i=e(r,n);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>multihashing-async"}],[4436,{},function(){with(this)return function(){"use strict";return function(e,t,n){var r={};function i(e,t,n){n||(n=Error);var i=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);i.prototype.name=n.name,i.prototype.code=e,r[e]=i}function s(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,a,o;if("string"==typeof t&&(i="not ",t.substr(!a||a<0?0:+a,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(n===undefined||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))o="The ".concat(e," ").concat(r," ").concat(s(t,"type"));else{var c=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";o='The "'.concat(e,'" ').concat(c," ").concat(r," ").concat(s(t,"type"))}return o+=". Received type ".concat(typeof n)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r}}},{package:"3box>ipfs>readable-stream"}],[4437,{"./_stream_readable":4439,"./_stream_writable":4441,_process:5261,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=u;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(u,i);for(var a=r(s.prototype),o=0;o<a.length;o++){var c=a[o];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>readable-stream"}],[4438,{"./_stream_transform":4440,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}}}},{package:"3box>ipfs>readable-stream"}],[4439,{"../errors":4436,"./_stream_duplex":4437,"./internal/streams/async_iterator":4442,"./internal/streams/buffer_list":4443,"./internal/streams/destroy":4444,"./internal/streams/from":4446,"./internal/streams/state":4448,"./internal/streams/stream":4449,_process:5261,buffer:1936,events:1937,inherits:4276,"string_decoder/":5747,util:1935},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;t.exports=x,x.ReadableState=E;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),a=e("buffer").Buffer,o=global.Uint8Array||function(){};var c,u=e("util");c=u&&u.debuglog?u.debuglog("stream"):function(){};var l,f,h,d=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),g=e("./internal/streams/state").getHighWaterMark,b=e("../errors").codes,m=b.ERR_INVALID_ARG_TYPE,w=b.ERR_STREAM_PUSH_AFTER_EOF,y=b.ERR_METHOD_NOT_IMPLEMENTED,_=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(x,s);var v=p.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(t,n,i){r=r||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",i),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(l||(l=e("string_decoder/").StringDecoder),this.decoder=new l(t.encoding),this.encoding=t.encoding)}function x(t){if(r=r||e("./_stream_duplex"),!(this instanceof x))return new x(t);var n=this instanceof r;this._readableState=new E(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function S(e,t,n,r,i){c("readableAddChunk",t);var s,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?N(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,u);else if(i||(s=function(e,t){var n;r=t,a.isBuffer(r)||r instanceof o||"string"==typeof t||t===undefined||e.objectMode||(n=new m("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(u,t)),s)v(e,s);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),r)u.endEmitted?v(e,new _):A(e,u,t,!0);else if(u.ended)v(e,new w);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!n?(t=u.decoder.write(t),u.objectMode||0!==t.length?A(e,u,t,!1):O(e,u)):A(e,u,t,!1)}else r||(u.reading=!1,O(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function A(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&N(e)),O(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=p.destroy,x.prototype._undestroy=p.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=a.from(e,t),t=""),n=!0),S(this,e,t,!1,n)},x.prototype.unshift=function(e){return S(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(t){l||(l=e("string_decoder/").StringDecoder);var n=new l(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var R=1073741824;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function N(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(I,e))}function I(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,B(e)}function O(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(c("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){c("readable nexttick read 0"),e.read(0)}function C(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function M(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function j(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(U,t,e))}function U(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function z(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}x.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):N(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&j(this),null;var r,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(r=e>0?M(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&j(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){v(this,new y("_read()"))},x.prototype.pipe=function(e,t){var r=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,c("pipe count=%d opts=%j",s.pipesCount,t);var a=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:b;function o(t,n){c("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",g),e.removeListener("drain",l),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",u),r.removeListener("end",b),r.removeListener("data",h),f=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}s.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",o);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,B(e))}}(r);e.on("drain",l);var f=!1;function h(t){c("ondata");var n=e.write(t);c("dest.write",n),!1===n&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==z(s.pipes,e))&&!f&&(c("false write response, pause",s.awaitDrain),s.awaitDrain++),r.pause())}function d(t){c("onerror",t),b(),e.removeListener("error",d),0===i(e,"error")&&v(e,t)}function p(){e.removeListener("finish",g),b()}function g(){c("onfinish"),e.removeListener("close",p),b()}function b(){c("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",g),e.emit("pipe",r),s.flowing||(c("pipe resume"),r.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=z(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},x.prototype.on=function(e,t){var r=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?N(this):i.reading||n.nextTick(D,this))),r},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var r=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},x.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||n.nextTick(L,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(C,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&i!==undefined)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<k.length;s++)e.on(k[s],this.emit.bind(this,k[s]));return this._read=function(t){c("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return f===undefined&&(f=e("./internal/streams/async_iterator")),f(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=M,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(t,n){return h===undefined&&(h=e("./internal/streams/from")),h(x,t,n)})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>readable-stream"}],[4440,{"../errors":4436,"./_stream_duplex":4437,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=l;var r=e("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new o;if(e._transformState.transforming)throw new a;return e.push(null)}e("inherits")(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"3box>ipfs>readable-stream"}],[4441,{"../errors":4436,"./_stream_duplex":4437,"./internal/streams/destroy":4444,"./internal/streams/state":4448,"./internal/streams/stream":4449,_process:5261,buffer:1936,inherits:4276,"util-deprecate":5856},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=x,x.WritableState=E;var s={deprecate:e("util-deprecate")},a=e("./internal/streams/stream"),o=e("buffer").Buffer,c=global.Uint8Array||function(){};var u,l=e("./internal/streams/destroy"),f=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,d=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,b=h.ERR_STREAM_CANNOT_PIPE,m=h.ERR_STREAM_DESTROYED,w=h.ERR_STREAM_NULL_VALUES,y=h.ERR_STREAM_WRITE_AFTER_END,_=h.ERR_UNKNOWN_ENCODING,v=l.errorOrDestroy;function k(){}function E(t,s,a){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof a&&(a=s instanceof i),this.objectMode=!!t.objectMode,a&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=f(this,t,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,s){--t.pendingcb,r?(n.nextTick(s,i),n.nextTick(I,e,t),e._writableState.errorEmitted=!0,v(e,i)):(s(i),e._writableState.errorEmitted=!0,v(e,i),I(e,t))}(e,r,i,t,s);else{var a=T(r)||e.destroyed;a||r.corked||r.bufferProcessing||!r.bufferedRequest||R(e,r),i?n.nextTick(A,e,r,a,s):A(e,r,a,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function x(t){var n=this instanceof(i=i||e("./_stream_duplex"));if(!n&&!u.call(x,this))return new x(t);this._writableState=new E(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function S(e,t,n,r,i,s,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new m("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function A(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),I(e,t)}function R(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var o=0,c=!0;n;)s[o]=n,n.isBuf||(c=!1),n=n.next,o+=1;s.allBuffers=c,S(e,t,!0,t.length,s,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,f=n.callback;if(S(e,t,!1,t.objectMode?1:u.length,u,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function N(e,t){e._final((function(n){t.pendingcb--,n&&v(e,n),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var r=T(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(N,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(x,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===x&&(e&&e._writableState instanceof E)}})):u=function(e){return e instanceof this},x.prototype.pipe=function(){v(this,new b)},x.prototype.write=function(e,t,r){var i,s=this._writableState,a=!1,u=!s.objectMode&&(i=e,o.isBuffer(i)||i instanceof c);return u&&!o.isBuffer(e)&&(e=function(e){return o.from(e)}(e)),"function"==typeof t&&(r=t,t=null),u?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=k),s.ending?function(e,t){var r=new y;v(e,r),n.nextTick(t,r)}(this,r):(u||function(e,t,r,i){var s;return null===r?s=new w:"string"==typeof r||t.objectMode||(s=new d("chunk",["string","Buffer"],r)),!s||(v(e,s),n.nextTick(i,s),!1)}(this,s,e,r))&&(s.pendingcb++,a=function(e,t,n,r,i,s){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=o.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var c=t.objectMode?1:r.length;t.length+=c;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,c,r,i,s);return u}(this,s,u,e,t,r)),a},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,n){n(new p("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,I(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=l.destroy,x.prototype._undestroy=l.undestroy,x.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>readable-stream"}],[4442,{"./end-of-stream":4445,_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("./end-of-stream"),a=Symbol("lastResolve"),o=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),l=Symbol("lastPromise"),f=Symbol("handlePromise"),h=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[a];if(null!==t){var n=e[h].read();null!==n&&(e[l]=null,e[a]=null,e[o]=null,t(d(n,!1)))}}function g(e){n.nextTick(p,e)}var b=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(d(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[c]?r(e[c]):t(d(undefined,!0))}))}));var r,i=this[l];if(i)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[u]?n(d(undefined,!0)):t[f](n,r)}),r)}}(i,this));else{var s=this[h].read();if(null!==s)return Promise.resolve(d(s,!1));r=new Promise(this[f])}return this[l]=r,r}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(d(undefined,!0))}))}))})),r),b);t.exports=function(e){var t,n=Object.create(m,(i(t={},h,{value:e,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var r=n[h].read();r?(n[l]=null,n[a]=null,n[o]=null,e(d(r,!1))):(n[a]=e,n[o]=t)},writable:!0}),t));return n[l]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[o];return null!==t&&(n[l]=null,n[a]=null,n[o]=null,t(e)),void(n[c]=e)}var r=n[a];null!==r&&(n[l]=null,n[a]=null,n[o]=null,r(d(undefined,!0))),n[u]=!0})),e.on("readable",g.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>readable-stream"}],[4443,{buffer:1936,util:1935},function(){with(this)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=e("buffer").Buffer,o=e("util").inspect,c=o&&o.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,u;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,a.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:c,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&s(t.prototype,n),u&&s(t,u),e}()}}},{package:"3box>ipfs>readable-stream"}],[4444,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var a=this,o=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return o||c?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?a._writableState?a._writableState.errorEmitted?e.nextTick(r,a):(a._writableState.errorEmitted=!0,e.nextTick(n,a,t)):e.nextTick(n,a,t):s?(e.nextTick(r,a),s(t)):e.nextTick(r,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>readable-stream"}],[4445,{"../../../errors":4436},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var a=n.readable||!1!==n.readable&&t.readable,o=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){o=!1,u=!0,a||s.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,f=!0,o||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):o&&!u?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},g=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?o&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?g():t.on("request",g)),t.on("end",h),t.on("finish",l),!1!==n.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",d),t.removeListener("close",p)}}}}},{package:"3box>ipfs>readable-stream"}],[4446,{},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"3box>ipfs>readable-stream"}],[4447,{"../../../errors":4436,"./end-of-stream":4445},function(){with(this)return function(){"use strict";return function(e,t,n){var r;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function c(t,n,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var o=!1;t.on("close",(function(){o=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},(function(e){if(e)return s(e);o=!0,s()}));var c=!1;return function(e){if(!o&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new a("pipe"))}}function u(e){e()}function l(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}t.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var a=t.map((function(e,n){var s=n<t.length-1;return c(e,s,n>0,(function(e){r||(r=e),e&&a.forEach(u),s||(a.forEach(u),i(r))}))}));return t.reduce(l)}}}},{package:"3box>ipfs>readable-stream"}],[4448,{"../../../errors":4436},function(){with(this)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"3box>ipfs>readable-stream"}],[4449,{events:1937},function(){with(this)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"3box>ipfs>readable-stream"}],[4450,{"./lib/_stream_duplex.js":4437,"./lib/_stream_passthrough.js":4438,"./lib/_stream_readable.js":4439,"./lib/_stream_transform.js":4440,"./lib/_stream_writable.js":4441,"./lib/internal/streams/end-of-stream.js":4445,"./lib/internal/streams/pipeline.js":4447},function(){with(this)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"3box>ipfs>readable-stream"}]],[],{});