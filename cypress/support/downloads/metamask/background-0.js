LavaPack.loadBundle([[10,{"@babel/runtime/helpers/interopRequireDefault":200,"ethereum-ens-network-map":2352,"ethjs-ens":2409},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("ethjs-ens")),s=n(e("ethereum-ens-network-map"));r.default=class{static getNetworkEnsSupport(e){return Boolean(s.default[e])}constructor({network:e,provider:t}={}){this._ethJsEns=new i.default({network:e,provider:t})}lookup(e){return this._ethJsEns.lookup(e)}reverse(e){return this._ethJsEns.reverse(e)}}}}},{package:"$root$"}],[100,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:17,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=17;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(!e.status===i.TRANSACTION_STATUSES.FAILED||e.retryCount>0&&e.retryCount<2&&(e.status=i.TRANSACTION_STATUSES.SUBMITTED,delete e.err),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #17${e.stack}`)}return Promise.resolve(t)}};r.default=s}}},{package:"$root$"}],[101,{"../controllers/transactions/lib/tx-state-history-helpers":33,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../controllers/transactions/lib/tx-state-history-helpers");var s={version:18,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=18;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>{if(!e.history||0===e.history.length){const t=(0,i.snapshotFromTxMeta)(e);return e.history=[t],e}const t=(0,i.migrateFromSnapshotsToDiffs)(e.history).filter((e=>!Array.isArray(e)||e.length>0));return e.history=t,e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #18${e.stack}`)}return Promise.resolve(t)}};r.default=s}}},{package:"$root$"}],[102,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:19,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=19;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(((e,t,r)=>{if(e.status!==i.TRANSACTION_STATUSES.SUBMITTED)return e;const n=function(e){const t=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t||"0x0",16)}));return Math.max.apply(null,t)}(r.filter((e=>e.status===i.TRANSACTION_STATUSES.CONFIRMED)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from))),s=function(e,t){const r=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t,16)}));let n=t;for(;r.includes(n);)n+=1;return n}(r.filter((e=>e.status===i.TRANSACTION_STATUSES.SUBMITTED)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from)),n),o=Math.max(s,n);return parseInt(e.txParams.nonce,16)>o+1&&(e.status=i.TRANSACTION_STATUSES.FAILED,e.err={message:"nonce too high",note:"migration 019 custom error"}),e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #19${e.stack}`)}return Promise.resolve(t)}};r.default=s}}},{package:"$root$"}],[103,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:20,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=20;try{const e=function(e){const t=e;"metamask"in t&&!("firstTimeInfo"in t.metamask)&&(t.metamask.firstTimeInfo={version:"3.12.0",date:Date.now()});return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #20${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[104,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:21,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=21;try{const e=function(e){const t=e;return delete t.BlacklistController,delete t.RecentBlocks,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #21${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[105,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:22,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=22;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==i.TRANSACTION_STATUSES.SUBMITTED||e.submittedTime||(e.submittedTime=(new Date).getTime()),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #22${e.stack}`)}return Promise.resolve(t)}};r.default=s}}},{package:"$root$"}],[106,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:23,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=23;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=t.TransactionController;if(e.length<=40)return t;const r=e.reverse();let n=!0;for(;r.length>40&&n;){const e=r.findIndex((e=>e.status===i.TRANSACTION_STATUSES.FAILED||e.status===i.TRANSACTION_STATUSES.REJECTED||e.status===i.TRANSACTION_STATUSES.CONFIRMED||e.status===i.TRANSACTION_STATUSES.DROPPED));e<0?n=!1:r.splice(e,1)}t.TransactionController.transactions=r.reverse()}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #23${e.stack}`)}return Promise.resolve(t)}};r.default=s}}},{package:"$root$"}],[107,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:24,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=24;const r=function(e){const t=e;if(!t.TransactionController)return t;const{transactions:r}=t.TransactionController;return t.TransactionController.transactions=r.map(((e,t)=>(e.status===i.TRANSACTION_STATUSES.UNAPPROVED&&e.txParams&&e.txParams.from&&(e.txParams.from=e.txParams.from.toLowerCase()),e))),t}(t.data);return t.data=r,t}};r.default=s}}},{package:"$root$"}],[108,{"../../../shared/constants/transaction":6033,"../lib/util":83,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../lib/util"),s=e("../../../shared/constants/transaction");var o={version:25,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=25;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==s.TRANSACTION_STATUSES.UNAPPROVED||(e.txParams=function(e){const t={from:e=>(0,i.addHexPrefix)(e).toLowerCase(),to:()=>(0,i.addHexPrefix)(e.to).toLowerCase(),nonce:e=>(0,i.addHexPrefix)(e),value:e=>(0,i.addHexPrefix)(e),data:e=>(0,i.addHexPrefix)(e),gas:e=>(0,i.addHexPrefix)(e),gasPrice:e=>(0,i.addHexPrefix)(e)},r={};return Object.keys(t).forEach((n=>{e[n]&&(r[n]=t[n](e[n]))})),r}(e.txParams)),e)))}return t}(t.data);return t.data=r,t}};r.default=o}}},{package:"$root$"}],[109,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:26,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=26;try{const e=t.data;t.data=function(e){if(!e.KeyringController||!e.PreferencesController)return e;if(!e.KeyringController.walletNicknames)return e;return e.PreferencesController.identities=Object.keys(e.KeyringController.walletNicknames).reduce(((t,r)=>(t[r]={name:e.KeyringController.walletNicknames[r],address:r},t)),{}),delete e.KeyringController.walletNicknames,e}(e)}catch(e){return console.warn(`MetaMask Migration #26${e.stack}`),Promise.reject(e)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[11,{"../../../../shared/constants/network":6028,"../../../../shared/modules/hexstring-utils":6039,"./ens":10,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,"@metamask/obs-store":1203,loglevel:5029,"punycode/punycode":5361},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("punycode/punycode")),o=e("@metamask/obs-store"),a=n(e("loglevel")),c=e("../../../../shared/constants/network"),u=e("../../../../shared/modules/hexstring-utils"),l=n(e("./ens"));function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.default=class{constructor({ens:e,provider:t,onNetworkDidChange:r,getCurrentChainId:n}={}){const i={ensResolutionsByAddress:{}};if(this._ens=e,!this._ens){const e=n(),r=c.CHAIN_ID_TO_NETWORK_ID_MAP[e];l.default.getNetworkEnsSupport(r)&&(this._ens=new l.default({network:r,provider:t}))}this.store=new o.ObservableStore(i),r((()=>{this.store.putState(i);const e=n(),r=c.CHAIN_ID_TO_NETWORK_ID_MAP[e];l.default.getNetworkEnsSupport(r)?this._ens=new l.default({network:r,provider:t}):delete this._ens}))}reverseResolveAddress(e){return this._reverseResolveAddress((0,u.toChecksumHexAddress)(e))}async _reverseResolveAddress(e){if(!this._ens)return undefined;const t=this.store.getState();if(t.ensResolutionsByAddress[e])return t.ensResolutionsByAddress[e];let r,n;try{r=await this._ens.reverse(e)}catch(e){return a.default.debug(e),undefined}try{n=await this._ens.lookup(r)}catch(e){return a.default.debug(e),undefined}return"0x0000000000000000000000000000000000000000"===n||"0x"===n||(0,u.toChecksumHexAddress)(n)!==e?undefined:(this._updateResolutionsByAddress(e,s.default.toASCII(r)),r)}_updateResolutionsByAddress(e,t){const r=this.store.getState();this.store.putState({ensResolutionsByAddress:f(f({},r.ensResolutionsByAddress),{},{[e]:t})})}}}}},{package:"$root$"}],[110,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:27,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=27;const r=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.filter((e=>e.status!==i.TRANSACTION_STATUSES.REJECTED))}return t}(t.data);return t.data=r,t}};r.default=s}}},{package:"$root$"}],[111,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:28,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=28;const r=function(e){const t=e;if(t.PreferencesController&&t.PreferencesController.tokens&&t.PreferencesController.identities){const{identities:e,tokens:r}=t.PreferencesController;t.PreferencesController.accountTokens={},Object.keys(e).forEach((e=>{t.PreferencesController.accountTokens[e]={mainnet:r}})),t.PreferencesController.tokens=[]}return t}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[1118,{"@ethereumjs/tx":410,buffer:1936,"eth-sig-util":1119,"ethereumjs-util":2373,events:1937,hdkey:1125},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const{EventEmitter:n}=e("events"),i=e("hdkey"),s=e("ethereumjs-util"),o=e("eth-sig-util"),{TransactionFactory:a}=e("@ethereumjs/tx"),c="m",u="Ledger Hardware",l={ropsten:"http://api-ropsten.etherscan.io",kovan:"http://api-kovan.etherscan.io",rinkeby:"https://api-rinkeby.etherscan.io",mainnet:"https://api.etherscan.io"};class d extends n{constructor(e={}){super(),this.accountDetails={},this.bridgeUrl=null,this.type=u,this.page=0,this.perPage=5,this.unlockedAccount=0,this.hdk=new i,this.paths={},this.iframe=null,this.network="mainnet",this.implementFullBIP44=!1,this.deserialize(e),this.iframeLoaded=!1,this._setupIframe(),this.currentMessageId=0,this.messageCallbacks={},this._setupListener()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,accountDetails:this.accountDetails,bridgeUrl:this.bridgeUrl,implementFullBIP44:!1})}deserialize(e={}){return this.hdPath=e.hdPath||"m/44'/60'/0'",this.bridgeUrl=e.bridgeUrl||"https://metamask.github.io/eth-ledger-bridge-keyring",this.accounts=e.accounts||[],this.accountDetails=e.accountDetails||{},e.accountDetails||this._migrateAccountDetails(e),this.implementFullBIP44=e.implementFullBIP44||!1,this.accounts=this.accounts.filter((e=>Object.keys(this.accountDetails).includes(s.toChecksumAddress(e)))),Promise.resolve()}_migrateAccountDetails(e){if(this._isLedgerLiveHdPath()&&e.accountIndexes)for(const t of Object.keys(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:this._getPathForIndex(e.accountIndexes[t])};this._isLedgerLiveHdPath()||this.accounts.filter((e=>!Object.keys(this.accountDetails).includes(s.toChecksumAddress(e)))).forEach((e=>{try{this.accountDetails[s.toChecksumAddress(e)]={bip44:!1,hdPath:this._pathFromAddress(e)}}catch(t){console.log(`failed to migrate account ${e}`)}}))}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}isConnected(){return this.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount=parseInt(e,10)}setHdPath(e){this.hdPath!==e&&(this.hdk=new i),this.hdPath=e}unlock(e,t=!0){if(this.isUnlocked()&&!e)return Promise.resolve("already unlocked");const n=e?this._toLedgerPath(e):this.hdPath;return new Promise(((e,i)=>{this._sendMessage({action:"ledger-unlock",params:{hdPath:n}},(({success:n,payload:s})=>{n?(t&&(this.hdk.publicKey=r.from(s.publicKey,"hex"),this.hdk.chainCode=r.from(s.chainCode,"hex")),e(s.address)):i(s.error||new Error("Unknown error"))}))}))}addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((async r=>{const n=this.unlockedAccount,i=n+e;for(let e=n;e<i;e++){const t=this._getPathForIndex(e);let r;r=this._isLedgerLiveHdPath()?await this.unlock(t):this._addressFromIndex(c,e),this.accountDetails[s.toChecksumAddress(r)]={bip44:this._isLedgerLiveHdPath(),hdPath:t},this.accounts.includes(r)||this.accounts.push(r),this.page=0}t(this.accounts)})).catch(r)}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase())),delete this.accountDetails[s.toChecksumAddress(e)]}attemptMakeApp(){return new Promise(((e,t)=>{this._sendMessage({action:"ledger-make-app"},(({success:r,error:n})=>{r?e(!0):t(n)}))}))}updateTransportMethod(e){return new Promise(((t,r)=>{this.iframeLoaded?this._sendMessage({action:"ledger-update-transport",params:{transportType:e}},(({success:e})=>{e?t(!0):r(new Error("Ledger transport could not be updated"))})):this.delayedPromise={resolve:t,reject:r,transportType:e}}))}signTransaction(e,t){let n;if("function"==typeof t.getChainId)return t.v=s.bufferToHex(t.getChainId()),t.r="0x00",t.s="0x00",n=t.serialize().toString("hex"),this._signTransaction(e,n,(e=>(t.v=r.from(e.v,"hex"),t.r=r.from(e.r,"hex"),t.s=r.from(e.s,"hex"),t)));const i=t.getMessageToSign(!1);return n=r.isBuffer(i)?i.toString("hex"):s.rlp.encode(i).toString("hex"),this._signTransaction(e,n,(e=>{const r=t.toJSON();return r.type=t.type,r.v=s.addHexPrefix(e.v),r.r=s.addHexPrefix(e.r),r.s=s.addHexPrefix(e.s),a.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}_signTransaction(e,t,r){return new Promise(((n,i)=>{this.unlockAccountByAddress(e).then((e=>{this._sendMessage({action:"ledger-sign-transaction",params:{tx:t,hdPath:e}},(({success:e,payload:t})=>{if(e){const e=r(t);e.verifySignature()?n(e):i(new Error("Ledger: The transaction signature is not valid"))}else i(t.error||new Error("Ledger: Unknown error while signing transaction"))}))})).catch(i)}))}signMessage(e,t){return this.signPersonalMessage(e,t)}signPersonalMessage(e,t){return new Promise(((r,n)=>{this.unlockAccountByAddress(e).then((i=>{this._sendMessage({action:"ledger-sign-personal-message",params:{hdPath:i,message:s.stripHexPrefix(t)}},(({success:i,payload:a})=>{if(i){let i=a.v-27;i=i.toString(16),i.length<2&&(i=`0${i}`);const c=`0x${a.r}${a.s}${i}`,u=o.recoverPersonalSignature({data:t,sig:c});s.toChecksumAddress(u)!==s.toChecksumAddress(e)&&n(new Error("Ledger: The signature doesnt match the right address")),r(c)}else n(a.error||new Error("Ledger: Unknown error while signing message"))}))})).catch(n)}))}async unlockAccountByAddress(e){const t=s.toChecksumAddress(e);if(!Object.keys(this.accountDetails).includes(t))throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:r}=this.accountDetails[t];if((await this.unlock(r,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return r}async signTypedData(e,t,r={}){const n="V4"===r.version;if(!n)throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:i,types:a,primaryType:c,message:u}=o.TypedDataUtils.sanitizeData(t),l=o.TypedDataUtils.hashStruct("EIP712Domain",i,a,n).toString("hex"),d=o.TypedDataUtils.hashStruct(c,u,a,n).toString("hex"),f=await this.unlockAccountByAddress(e),{success:h,payload:p}=await new Promise((e=>{this._sendMessage({action:"ledger-sign-typed-data",params:{hdPath:f,domainSeparatorHex:l,hashStructMessageHex:d}},(t=>e(t)))}));if(h){let r=p.v-27;r=r.toString(16),r.length<2&&(r=`0${r}`);const n=`0x${p.r}${p.s}${r}`,i=o.recoverTypedSignature_v4({data:t,sig:n});if(s.toChecksumAddress(i)!==s.toChecksumAddress(e))throw new Error("Ledger: The signature doesnt match the right address");return n}throw p.error||new Error("Ledger: Unknown error while signing message")}exportAccount(){throw new Error("Not supported on this device")}forgetDevice(){this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new i}_setupIframe(){this.iframe=document.createElement("iframe"),this.iframe.src=this.bridgeUrl,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{if(this.iframeLoaded=!0,this.delayedPromise)try{const e=await this.updateTransportMethod(this.delayedPromise.transportType);this.delayedPromise.resolve(e)}catch(e){this.delayedPromise.reject(e)}finally{delete this.delayedPromise}},document.head.appendChild(this.iframe)}_getOrigin(){const e=this.bridgeUrl.split("/");return e.splice(-1,1),e.join("/")}_sendMessage(e,t){e.target="LEDGER-IFRAME",this.currentMessageId+=1,e.messageId=this.currentMessageId,this.messageCallbacks[this.currentMessageId]=t,this.iframe.contentWindow.postMessage(e,"*")}_setupListener(){this._eventListener=({origin:e,data:t})=>e===this._getOrigin()&&(t&&(this.messageCallbacks[t.messageId]?this.messageCallbacks[t.messageId](t):"ledger-connection-change"===t.action&&(this.isDeviceConnected=t.payload.connected)),undefined),window.addEventListener("message",this._eventListener)}destroy(){window.removeEventListener("message",this._eventListener)}async __getPage(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage;let n;return await this.unlock(),n=this._isLedgerLiveHdPath()?await this._getAccountsBIP44(t,r):this._getAccountsLegacy(t,r),n}async _getAccountsBIP44(e,t){const r=[];for(let n=e;n<t;n++){const e=this._getPathForIndex(n),t=await this.unlock(e),i=!this.implementFullBIP44||await this._hasPreviousTransactions(t);if(r.push({address:t,balance:null,index:n}),!i)break}return r}_getAccountsLegacy(e,t){const r=[];for(let n=e;n<t;n++){const e=this._addressFromIndex(c,n);r.push({address:e,balance:null,index:n}),this.paths[s.toChecksumAddress(e)]=n}return r}_padLeftEven(e){return e.length%2==0?e:`0${e}`}_normalize(e){return this._padLeftEven(s.bufferToHex(e).toLowerCase())}_addressFromIndex(e,t){const r=this.hdk.derive(`${e}/${t}`),n=s.publicToAddress(r.publicKey,!0).toString("hex");return s.toChecksumAddress(`0x${n}`)}_pathFromAddress(e){const t=s.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===this._addressFromIndex(c,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return this._getPathForIndex(r)}_toAscii(e){let t="",r=0;const n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){const n=parseInt(e.substr(r,2),16);t+=String.fromCharCode(n)}return t}_getPathForIndex(e){return this._isLedgerLiveHdPath()?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`}_isLedgerLiveHdPath(){return"m/44'/60'/0'/0/0"===this.hdPath}_toLedgerPath(e){return e.toString().replace("m/","")}async _hasPreviousTransactions(e){const t=this._getApiUrl(),r=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),n=await r.json();return"0"!==n.status&&n.result.length>0}_getApiUrl(){return l[this.network]||l.mainnet}}d.type=u,t.exports=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring"}],[1119,{buffer:1936,"ethereumjs-abi":2353,"ethereumjs-util":1120,tweetnacl:5841,"tweetnacl-util":5840},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("ethereumjs-util"),s=e("ethereumjs-abi"),o=e("tweetnacl");o.util=e("tweetnacl-util");const a={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},c={encodeData(e,t,r,o=!0){const a=["bytes32"],c=[this.hashType(e,r)];if(o){const u=(e,t,a)=>{if(r[t]!==undefined)return["bytes32",null===a||a===undefined?"0x0000000000000000000000000000000000000000000000000000000000000000":i.keccak(this.encodeData(t,a,r,o))];if(a===undefined)throw new Error(`missing value for field ${e} of type ${t}`);if("bytes"===t)return["bytes32",i.keccak(a)];if("string"===t)return"string"==typeof a&&(a=n.from(a,"utf8")),["bytes32",i.keccak(a)];if(t.lastIndexOf("]")===t.length-1){const r=t.slice(0,t.lastIndexOf("[")),n=a.map((t=>u(e,r,t)));return["bytes32",i.keccak(s.rawEncode(n.map((([e])=>e)),n.map((([,e])=>e))))]}return[t,a]};for(const n of r[e]){const[e,r]=u(n.name,n.type,t[n.name]);a.push(e),c.push(r)}}else for(const s of r[e]){let e=t[s.name];if(e!==undefined)if("bytes"===s.type)a.push("bytes32"),e=i.keccak(e),c.push(e);else if("string"===s.type)a.push("bytes32"),"string"==typeof e&&(e=n.from(e,"utf8")),e=i.keccak(e),c.push(e);else if(r[s.type]!==undefined)a.push("bytes32"),e=i.keccak(this.encodeData(s.type,e,r,o)),c.push(e);else{if(s.type.lastIndexOf("]")===s.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");a.push(s.type),c.push(e)}}return s.rawEncode(a,c)},encodeType(e,t){let r="",n=this.findTypeDependencies(e,t).filter((t=>t!==e));n=[e].concat(n.sort());for(const e of n){if(!t[e])throw new Error(`No type definition specified: ${e}`);r+=`${e}(${t[e].map((({name:e,type:t})=>`${t} ${e}`)).join(",")})`}return r},findTypeDependencies(e,t,r=[]){const[n]=e.match(/^\w*/u);if(e=n,r.includes(e)||t[e]===undefined)return r;r.push(e);for(const n of t[e])for(const e of this.findTypeDependencies(n.type,t,r))!r.includes(e)&&r.push(e);return r},hashStruct(e,t,r,n=!0){return i.keccak(this.encodeData(e,t,r,n))},hashType(e,t){return i.keccak(this.encodeType(e,t))},sanitizeData(e){const t={};for(const r of Object.keys(a.properties))e[r]&&(t[r]=e[r]);return t.types&&(t.types={EIP712Domain:[],...t.types}),t},sign(e,t=!0){const r=this.sanitizeData(e),s=[n.from("1901","hex")];return s.push(this.hashStruct("EIP712Domain",r.domain,r.types,t)),"EIP712Domain"!==r.primaryType&&s.push(this.hashStruct(r.primaryType,r.message,r.types,t)),i.keccak(n.concat(s))}};function u(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!e.length)throw t;const r=e.map((function(e){return"bytes"===e.type?i.toBuffer(e.value):e.value})),n=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return`${e.type} ${e.name}`}));return s.soliditySHA3(["bytes32","bytes32"],[s.soliditySHA3(new Array(e.length).fill("string"),o),s.soliditySHA3(n,r)])}function l(e,t){const r=i.toBuffer(t),n=i.fromRpcSig(r);return i.ecrecover(e,n.v,n.r,n.s)}function d(e){const t=i.toBuffer(e.data);return l(i.hashPersonalMessage(t),e.sig)}function f(e,t){let r=`${e}`;for(;r.length<t;)r=`0${r}`;return r}function h(e){const t=n.from(e,"hex").toString("base64");return o.util.decodeBase64(t)}t.exports={TYPED_MESSAGE_SCHEMA:a,TypedDataUtils:c,concatSig(e,t,r){const n=i.fromSigned(t),s=i.fromSigned(r),o=i.bufferToInt(e),a=f(i.toUnsigned(n).toString("hex"),64),c=f(i.toUnsigned(s).toString("hex"),64),u=i.stripHexPrefix(i.intToHex(o));return i.addHexPrefix(a.concat(c,u)).toString("hex")},normalize(e){if(!e)return undefined;if("number"==typeof e){const t=i.toBuffer(e);e=i.bufferToHex(t)}if("string"!=typeof e){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return i.addHexPrefix(e.toLowerCase())},personalSign(e,t){const r=i.toBuffer(t.data),n=i.hashPersonalMessage(r),s=i.ecsign(n,e);return i.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverPersonalSignature(e){const t=d(e),r=i.publicToAddress(t);return i.bufferToHex(r)},extractPublicKey:e=>`0x${d(e).toString("hex")}`,typedSignatureHash(e){const t=u(e);return i.bufferToHex(t)},signTypedDataLegacy(e,t){const r=u(t.data),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},recoverTypedSignatureLegacy(e){const t=l(u(e.data),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)},encrypt(e,t,r){if("x25519-xsalsa20-poly1305"===r){if(void 0===t.data)throw new Error('Cannot detect secret message, message params should be of the form {data: "secret message"} ');const r=o.box.keyPair();let n;try{n=o.util.decodeBase64(e)}catch(e){throw new Error("Bad public key")}const i=o.util.decodeUTF8(t.data),s=o.randomBytes(o.box.nonceLength),a=o.box(i,s,n,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:o.util.encodeBase64(s),ephemPublicKey:o.util.encodeBase64(r.publicKey),ciphertext:o.util.encodeBase64(a)}}throw new Error("Encryption type/version not supported")},encryptSafely(e,t,r){const{data:i}=t;if(!i)throw new Error("Cannot encrypt empty msg.data");if("object"==typeof i&&i.toJSON)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const s={data:i,padding:""},o=n.byteLength(JSON.stringify(s),"utf-8")%2048;let a=0;o>0&&(a=2048-o-16),s.padding="0".repeat(a);const c={data:JSON.stringify(s)};return this.encrypt(e,c,r)},decrypt(e,t){if("x25519-xsalsa20-poly1305"===e.version){const r=h(t),n=o.box.keyPair.fromSecretKey(r).secretKey,i=o.util.decodeBase64(e.nonce),s=o.util.decodeBase64(e.ciphertext),a=o.util.decodeBase64(e.ephemPublicKey),c=o.box.open(s,i,a,n);let u;try{u=o.util.encodeUTF8(c)}catch(e){throw new Error("Decryption failed.")}if(u)return u;throw new Error("Decryption failed.")}throw new Error("Encryption type/version not supported.")},decryptSafely(e,t){return JSON.parse(this.decrypt(e,t)).data},getEncryptionPublicKey(e){const t=h(e),r=o.box.keyPair.fromSecretKey(t).publicKey;return o.util.encodeBase64(r)},signTypedMessage(e,t,r="V4"){switch(r){case"V1":return this.signTypedDataLegacy(e,t);case"V3":return this.signTypedData(e,t);default:return this.signTypedData_v4(e,t)}},recoverTypedMessage(e,t="V4"){switch(t){case"V1":return this.recoverTypedSignatureLegacy(e);case"V3":return this.recoverTypedSignature(e);default:return this.recoverTypedSignature_v4(e)}},signTypedData(e,t){const r=c.sign(t.data,!1),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},signTypedData_v4(e,t){const r=c.sign(t.data),n=i.ecsign(r,e);return i.bufferToHex(this.concatSig(n.v,n.r,n.s))},recoverTypedSignature(e){const t=l(c.sign(e.data,!1),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)},recoverTypedSignature_v4(e){const t=l(c.sign(e.data),e.sig),r=i.publicToAddress(t);return i.bufferToHex(r)}}}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util"}],[112,{"../../../shared/constants/transaction":6033,"./fail-tx":156,"@babel/runtime/helpers/interopRequireDefault":200},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../../../shared/constants/transaction"),s=n(e("./fail-tx"));var o={version:29,migrate:(0,s.default)(29,"Stuck in approved state for too long.",(e=>{const t=e.status===i.TRANSACTION_STATUSES.APPROVED,r=e.submittedTime,n=Date.now();return t&&n-r>432e5}))};r.default=o}}},{package:"$root$"}],[1120,{"./secp256k1-adapter":1121,assert:1564,"bn.js":1892,"create-hash":2039,"ethereum-cryptography/keccak":2318,"ethjs-util":1124,rlp:5577,"safe-buffer":5579},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("ethereum-cryptography/keccak"),s=i.keccak224,o=i.keccak384,a=i.keccak256,c=i.keccak512,u=e("./secp256k1-adapter"),l=e("assert"),d=e("rlp"),f=e("bn.js"),h=e("create-hash"),p=e("safe-buffer").Buffer;Object.assign(r,e("ethjs-util")),r.MAX_INTEGER=new f("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new f("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.SHA3_NULL_S=r.KECCAK256_NULL_S,r.KECCAK256_NULL=p.from(r.KECCAK256_NULL_S,"hex"),r.SHA3_NULL=r.KECCAK256_NULL,r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.SHA3_RLP_ARRAY_S=r.KECCAK256_RLP_ARRAY_S,r.KECCAK256_RLP_ARRAY=p.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.SHA3_RLP_ARRAY=r.KECCAK256_RLP_ARRAY,r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.SHA3_RLP_S=r.KECCAK256_RLP_S,r.KECCAK256_RLP=p.from(r.KECCAK256_RLP_S,"hex"),r.SHA3_RLP=r.KECCAK256_RLP,r.BN=f,r.rlp=d,r.secp256k1=u,r.zeros=function(e){return p.allocUnsafe(e).fill(0)},r.zeroAddress=function(){var e=r.zeros(20);return r.bufferToHex(e)},r.setLengthLeft=r.setLength=function(e,t,n){var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=r.stripZeros=function(e){for(var t=(e=r.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.toBuffer=function(e){if(!p.isBuffer(e))if(Array.isArray(e))e=p.from(e);else if("string"==typeof e)e=r.isHexString(e)?p.from(r.padToEven(r.stripHexPrefix(e)),"hex"):p.from(e);else if("number"==typeof e)e=r.intToBuffer(e);else if(null===e||e===undefined)e=p.allocUnsafe(0);else if(f.isBN(e))e=e.toArrayLike(p);else{if(!e.toArray)throw new Error("invalid type");e=p.from(e.toArray())}return e},r.bufferToInt=function(e){return new f(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new f(e).fromTwos(256)},r.toUnsigned=function(e){return p.from(e.toTwos(256).toArray())},r.keccak=function(e,t){switch(e=r.toBuffer(e),t||(t=256),t){case 224:return s(e);case 256:return a(e);case 384:return o(e);case 512:return c(e);default:throw new Error("Invald algorithm: keccak"+t)}},r.keccak256=function(e){return r.keccak(e)},r.sha3=r.keccak,r.sha256=function(e){return e=r.toBuffer(e),h("sha256").update(e).digest()},r.ripemd160=function(e,t){e=r.toBuffer(e);var n=h("rmd160").update(e).digest();return!0===t?r.setLength(n,32):n},r.rlphash=function(e){return r.keccak(d.encode(e))},r.isValidPrivate=function(e){return u.privateKeyVerify(e)},r.isValidPublic=function(e,t){return 64===e.length?u.publicKeyVerify(p.concat([p.from([4]),e])):!!t&&u.publicKeyVerify(e)},r.pubToAddress=r.publicToAddress=function(e,t){return e=r.toBuffer(e),t&&64!==e.length&&(e=u.publicKeyConvert(e,!1).slice(1)),l(64===e.length),r.keccak(e).slice(-20)};var m=r.privateToPublic=function(e){return e=r.toBuffer(e),u.publicKeyCreate(e,!1).slice(1)};r.importPublic=function(e){return 64!==(e=r.toBuffer(e)).length&&(e=u.publicKeyConvert(e,!1).slice(1)),e},r.ecsign=function(e,t){var r=u.sign(e,t),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},r.hashPersonalMessage=function(e){var t=r.toBuffer("Ethereum Signed Message:\n"+e.length.toString());return r.keccak(p.concat([t,e]))},r.ecrecover=function(e,t,n,i){var s=p.concat([r.setLength(n,32),r.setLength(i,32)],64),o=t-27;if(0!==o&&1!==o)throw new Error("Invalid signature v value");var a=u.recover(e,s,o);return u.publicKeyConvert(a,!1).slice(1)},r.toRpcSig=function(e,t,n){if(27!==e&&28!==e)throw new Error("Invalid recovery id");return r.bufferToHex(p.concat([r.setLengthLeft(t,32),r.setLengthLeft(n,32),r.toBuffer(e-27)]))},r.fromRpcSig=function(e){if(65!==(e=r.toBuffer(e)).length)throw new Error("Invalid signature length");var t=e[64];return t<27&&(t+=27),{v:t,r:e.slice(0,32),s:e.slice(32,64)}},r.privateToAddress=function(e){return r.publicToAddress(m(e))},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===r.addHexPrefix(e)},r.toChecksumAddress=function(e){e=r.stripHexPrefix(e).toLowerCase();for(var t=r.keccak(e).toString("hex"),n="0x",i=0;i<e.length;i++)parseInt(t[i],16)>=8?n+=e[i].toUpperCase():n+=e[i];return n},r.isValidChecksumAddress=function(e){return r.isValidAddress(e)&&r.toChecksumAddress(e)===e},r.generateAddress=function(e,t){return e=r.toBuffer(e),t=(t=new f(t)).isZero()?null:p.from(t.toArray()),r.rlphash([e,t]).slice(-20)},r.isPrecompiled=function(e){var t=r.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.addHexPrefix=function(e){return"string"!=typeof e||r.isHexPrefixed(e)?e:"0x"+e},r.isValidSignature=function(e,t,r,n){var i=new f("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),s=new f("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return 32===t.length&&32===r.length&&((27===e||28===e)&&(t=new f(t),r=new f(r),!(t.isZero()||t.gt(s)||r.isZero()||r.gt(s))&&(!1!==n||1!==new f(r).cmp(i))))},r.baToJSON=function(e){if(p.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(r.baToJSON(e[n]));return t}},r.defineProperties=function(e,t,i){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(t){var n={};return e._fields.forEach((function(t){n[t]="0x"+e[t].toString("hex")})),n}return r.baToJSON(this.raw)},e.serialize=function(){return d.encode(e.raw)},t.forEach((function(t,n){function i(){return e.raw[n]}function s(i){"00"!==(i=r.toBuffer(i)).toString("hex")||t.allowZero||(i=p.allocUnsafe(0)),t.allowLess&&t.length?(i=r.stripZeros(i),l(t.length>=i.length,"The field "+t.name+" must not have more "+t.length+" bytes")):t.allowZero&&0===i.length||!t.length||l(t.length===i.length,"The field "+t.name+" must have byte length of "+t.length),e.raw[n]=i}e._fields.push(t.name),Object.defineProperty(e,t.name,{enumerable:!0,configurable:!0,get:i,set:s}),t.default&&(e[t.name]=t.default),t.alias&&Object.defineProperty(e,t.alias,{enumerable:!1,configurable:!0,set:s,get:i})})),i)if("string"==typeof i&&(i=p.from(r.stripHexPrefix(i),"hex")),p.isBuffer(i)&&(i=d.decode(i)),Array.isArray(i)){if(i.length>e._fields.length)throw new Error("wrong number of fields in data");i.forEach((function(t,n){e[e._fields[n]]=r.toBuffer(t)}))}else{if("object"!==(void 0===i?"undefined":n(i)))throw new Error("invalid data");var s=Object.keys(i);t.forEach((function(t){-1!==s.indexOf(t.name)&&(e[t.name]=i[t.name]),-1!==s.indexOf(t.alias)&&(e[t.alias]=i[t.alias])}))}}}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util>ethereumjs-util"}],[1121,{"./secp256k1-lib/der":1122,"./secp256k1-lib/index":1123,buffer:1936,"ethereum-cryptography/secp256k1":2350},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1-lib/index"),s=e("./secp256k1-lib/der"),o=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))};t.exports={privateKeyVerify:o,privateKeyExport:function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return s.privateKeyExport(e,r,t)},privateKeyImport:function(e){if(null!==(e=s.privateKeyImport(e))&&32===e.length&&o(e))return e;throw new Error("couldn't import from DER format")},privateKeyNegate:function(e){return r.from(n.privateKeyNegate(Uint8Array.from(e)))},privateKeyModInverse:function(e){if(32!==e.length)throw new Error("private key length is invalid");return r.from(i.privateKeyModInverse(Uint8Array.from(e)))},privateKeyTweakAdd:function(e,t){return r.from(n.privateKeyTweakAdd(Uint8Array.from(e),t))},privateKeyTweakMul:function(e,t){return r.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t)))},publicKeyCreate:function(e,t){return r.from(n.publicKeyCreate(Uint8Array.from(e),t))},publicKeyConvert:function(e,t){return r.from(n.publicKeyConvert(Uint8Array.from(e),t))},publicKeyVerify:function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},publicKeyTweakAdd:function(e,t,i){return r.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(t),i))},publicKeyTweakMul:function(e,t,i){return r.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t),i))},publicKeyCombine:function(e,t){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),r.from(n.publicKeyCombine(i,t))},signatureNormalize:function(e){return r.from(n.signatureNormalize(Uint8Array.from(e)))},signatureExport:function(e){return r.from(n.signatureExport(Uint8Array.from(e)))},signatureImport:function(e){return r.from(n.signatureImport(Uint8Array.from(e)))},signatureImportLax:function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=s.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},sign:function(e,t,i){if(null===i)throw new TypeError("options should be an Object");var s=void 0;if(i){if(s={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!==i.data.length)throw new RangeError("options.data length is invalid");s.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(s.noncefn=function(e,t,n,s,o){var a=null!=n?r.from(n):null,c=null!=s?r.from(s):null,u=r.from("");return i.noncefn&&(u=i.noncefn(r.from(e),r.from(t),a,c,o)),Uint8Array.from(u)})}var o=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(t),s);return{signature:r.from(o.signature),recovery:o.recid}},verify:function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},recover:function(e,t,i,s){return r.from(n.ecdsaRecover(Uint8Array.from(t),i,Uint8Array.from(e),s))},ecdh:function(e,t){return r.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(t),{}))},ecdhUnsafe:function(e,t,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==t.length)throw new RangeError("private key length is invalid");return r.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(t),n))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util>ethereumjs-util"}],[1122,{buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t=e.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=e.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,s){var o=e.from(s?t:n);return r.copy(o,s?8:9),i.copy(o,s?181:214),o},r.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},r.signatureImportLax=function(t){var r=e.alloc(32,0),n=e.alloc(32,0),i=t.length,s=0;if(48!==t[s++])return null;var o=t[s++];if(128&o&&(s+=o-128)>i)return null;if(2!==t[s++])return null;var a=t[s++];if(128&a){if(s+(o=a-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(a=0;o>0;s+=1,o-=1)a=(a<<8)+t[s]}if(a>i-s)return null;var c=s;if(s+=a,2!==t[s++])return null;var u=t[s++];if(128&u){if(s+(o=u-128)>i)return null;for(;o>0&&0===t[s];s+=1,o-=1);for(u=0;o>0;s+=1,o-=1)u=(u<<8)+t[s]}if(u>i-s)return null;var l=s;for(s+=u;a>0&&0===t[c];a-=1,c+=1);if(a>32)return null;var d=t.slice(c,c+a);for(d.copy(r,32-d.length);u>0&&0===t[l];u-=1,l+=1);if(u>32)return null;var f=t.slice(l,l+u);return f.copy(n,32-f.length),{r:r,s:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util>ethereumjs-util"}],[1123,{"bn.js":1892,buffer:1936,elliptic:2170},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("bn.js"),i=new(0,e("elliptic").ec)("secp256k1"),s=i.curve;r.privateKeyExport=function(e,t){var r=new n(e);if(r.ucmp(s.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return o(a.getX(),a.getY(),t)},r.privateKeyModInverse=function(e){var r=new n(e);if(r.ucmp(s.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(s.n).toArrayLike(t,"be",32)},r.signatureImport=function(e){var r=new n(e.r);r.ucmp(s.n)>=0&&(r=new n(0));var i=new n(e.s);return i.ucmp(s.n)>=0&&(i=new n(0)),t.concat([r.toArrayLike(t,"be",32),i.toArrayLike(t,"be",32)])},r.ecdhUnsafe=function(e,t,r){var a=i.keyFromPublic(e),c=new n(t);if(c.ucmp(s.n)>=0||c.isZero())throw new Error("scalar was invalid (zero or overflow)");var u=a.pub.mul(c);return o(u.getX(),u.getY(),r)};var o=function(e,r,n){var i=void 0;return n?((i=t.alloc(33))[0]=r.isOdd()?3:2,e.toArrayLike(t,"be",32).copy(i,1)):((i=t.alloc(65))[0]=4,e.toArrayLike(t,"be",32).copy(i,1),r.toArrayLike(t,"be",32).copy(i,33)),i}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util>ethereumjs-util"}],[1124,{buffer:1936,"is-hex-prefixed":4566,"strip-hex-prefix":5748},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function o(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=o(e);return new r(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:s,intToHex:o,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+s(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(s(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var s=e[i][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");n.push(s)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring>eth-sig-util>ethereumjs-util>ethjs-util"}],[1125,{assert:1564,coinstring:1979,crypto:2046,"safe-buffer":5579,secp256k1:5590},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,s=e("crypto"),o=e("coinstring"),a=e("secp256k1"),c=i.from("Bitcoin seed","utf8"),u=2147483648,l={private:76066276,public:76067358};function d(e){this.versions=e||l,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function f(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var s=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(s,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function h(e){var t=s.createHash("sha256").update(e).digest();return s.createHash("rmd160").update(t).digest()}Object.defineProperty(d.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(d.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(d.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(d.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===a.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=a.publicKeyCreate(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(d.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===a.publicKeyVerify(e),"Invalid public key"),this._publicKey=a.publicKeyConvert(e,!0),this._identifier=h(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(d.prototype,"privateExtendedKey",{get:function(){return this._privateKey?o.encode(f(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(d.prototype,"publicExtendedKey",{get:function(){return o.encode(f(this,this.versions.public,this.publicKey))}}),d.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],s=parseInt(e,10);n(s<u,"Invalid index"),i&&(s+=u),r=r.deriveChild(s)}else n(e,"m","Invalid path")})),r},d.prototype.deriveChild=function(e){var t,r=e>=u,o=i.allocUnsafe(4);if(o.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,l=i.alloc(1,0);c=i.concat([l,c]),t=i.concat([c,o])}else t=i.concat([this.publicKey,o]);var f=s.createHmac("sha512",this.chainCode).update(t).digest(),h=f.slice(0,32),p=f.slice(32),m=new d(this.versions);if(this.privateKey)try{m.privateKey=a.privateKeyTweakAdd(this.privateKey,h)}catch(t){return this.derive(e+1)}else try{m.publicKey=a.publicKeyTweakAdd(this.publicKey,h,!0)}catch(t){return this.derive(e+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=e,m},d.prototype.sign=function(e){return a.sign(e,this.privateKey).signature},d.prototype.verify=function(e,t){return a.verify(e,t,this.publicKey)},d.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},d.fromMasterSeed=function(e,t){var r=s.createHmac("sha512",c).update(e).digest(),n=r.slice(0,32),i=r.slice(32),o=new d(t);return o.chainCode=i,o.privateKey=n,o},d.fromExtendedKey=function(e,t){var r=new d(t=t||l),i=o.decode(e),s=i.readUInt32BE(0);n(s===t.private||s===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var a=i.slice(45);return 0===a.readUInt8(0)?(n(s===t.private,"Version mismatch: version does not match private"),r.privateKey=a.slice(1)):(n(s===t.public,"Version mismatch: version does not match public"),r.publicKey=a),r},d.fromJSON=function(e){return d.fromExtendedKey(e.xpriv)},d.HARDENED_OFFSET=u,t.exports=d}}},{package:"@metamask/eth-ledger-bridge-keyring>hdkey"}],[113,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:30,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=30;const r=function(e){const t=e;if(e.PreferencesController){const{frequentRpcListDetail:e}=t.PreferencesController;e&&(e.forEach(((t,r)=>{Boolean(t.chainId)&&Number.isNaN(parseInt(t.chainId))&&delete e[r].chainId})),t.PreferencesController.frequentRpcListDetail=e)}e.NetworkController&&(t.NetworkController.network&&Number.isNaN(parseInt(t.NetworkController.network))&&delete t.NetworkController.network,t.NetworkController.provider&&t.NetworkController.provider.chainId&&Number.isNaN(parseInt(t.NetworkController.provider.chainId))&&delete t.NetworkController.provider.chainId);return t}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[114,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:31,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=31;const r=function(e){const{KeyringController:t,PreferencesController:r}=e;if(t&&r){const{vault:e}=t;r.completedOnboarding=Boolean(e)}return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[115,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:32,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=32;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const{betaUI:e}=t.featureFlags||{};t.completedUiMigration=e}return e}(r),t}};r.default=i}}},{package:"$root$"}],[116,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:33,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=33;const r=function(e){const t=e;e.NoticeController&&delete t.NoticeController;return t}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[1168,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SNAP_STREAM_NAMES=void 0,function(e){e.JSON_RPC="jsonRpc",e.COMMAND="command"}(r.SNAP_STREAM_NAMES||(r.SNAP_STREAM_NAMES={}))}}},{package:"@metamask/snap-controllers>@metamask/execution-environments"}],[1169,{"./common/enums":1168},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./common/enums"),r)}}},{package:"@metamask/snap-controllers>@metamask/execution-environments"}],[117,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:34,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=34;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};e.privacyMode||void 0!==t.migratedPrivacyMode||(t.migratedPrivacyMode=!0,e.privacyMode=!0)}return e}(r),t}};r.default=i}}},{package:"$root$"}],[1173,{"./BIP44Node":1174,"./SLIP10Node":1175,"./constants":1176,"./utils":1187},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.getBIP44AddressKeyDeriver=r.deriveBIP44AddressKey=r.BIP44CoinTypeNode=r.BIP_44_COIN_TYPE_DEPTH=void 0;const o=e("./constants"),a=e("./BIP44Node"),c=e("./utils"),u=e("./SLIP10Node");r.BIP_44_COIN_TYPE_DEPTH=2;class l{constructor(e,t){n.set(this,void 0),i(this,n,e,"f"),this.coin_type=t,this.path=c.getBIP44CoinTypePathString(t),Object.freeze(this)}static async fromJSON(e,t){f(t),d(e.depth);const r=await a.BIP44Node.fromExtendedKey({depth:e.depth,index:e.index,parentFingerprint:e.parentFingerprint,chainCode:c.hexStringToBuffer(e.chainCode),privateKey:c.nullableHexStringToBuffer(e.privateKey),publicKey:c.hexStringToBuffer(e.publicKey)});return new l(r,t)}static async fromDerivationPath(e){d(e.length-1);const t=await a.BIP44Node.fromDerivationPath({derivationPath:e}),n=Number.parseInt(e[r.BIP_44_COIN_TYPE_DEPTH].split(":")[1].replace("'",""),10);return new l(t,n)}static async fromNode(e,t){if(!(e instanceof a.BIP44Node))throw new Error("Invalid node: Expected an instance of BIP44Node.");return f(t),d(e.depth),new l(e,t)}get depth(){return s(this,n,"f").depth}get privateKeyBuffer(){return s(this,n,"f").privateKeyBuffer}get publicKeyBuffer(){return s(this,n,"f").publicKeyBuffer}get chainCodeBuffer(){return s(this,n,"f").chainCodeBuffer}get privateKey(){return s(this,n,"f").privateKey}get publicKey(){return s(this,n,"f").publicKey}get compressedPublicKeyBuffer(){return s(this,n,"f").compressedPublicKeyBuffer}get chainCode(){return s(this,n,"f").chainCode}get address(){return s(this,n,"f").address}get parentFingerprint(){return s(this,n,"f").parentFingerprint}get fingerprint(){return s(this,n,"f").fingerprint}get index(){return s(this,n,"f").index}get curve(){return s(this,n,"f").curve}get extendedKey(){return s(this,n,"f").extendedKey}async deriveBIP44AddressKey({account:e=0,change:t=0,address_index:r}){return await s(this,n,"f").derive(c.getBIP44CoinTypeToAddressPathTuple({account:e,change:t,address_index:r}))}toJSON(){return Object.assign(Object.assign({},s(this,n,"f").toJSON()),{coin_type:this.coin_type,path:this.path})}}function d(e){if(e!==r.BIP_44_COIN_TYPE_DEPTH)throw new Error(`Invalid depth: Coin type nodes must be of depth ${r.BIP_44_COIN_TYPE_DEPTH}. Received: "${e}"`)}function f(e){if("number"!=typeof e||!Number.isInteger(e)||e<0)throw new Error("Invalid coin type: The specified coin type must be a non-negative integer number.")}async function h(e){if(e instanceof l)return d(e.depth),e;if("string"==typeof e){const t=await a.BIP44Node.fromExtendedKey(e),r=await l.fromNode(t,t.index-o.BIP_32_HARDENED_OFFSET);return d(r.depth),r}return l.fromJSON(e,e.coin_type)}r.BIP44CoinTypeNode=l,n=new WeakMap,r.deriveBIP44AddressKey=async function(e,{account:t=0,change:r=0,address_index:n}){const i=c.getBIP44CoinTypeToAddressPathTuple({account:t,change:r,address_index:n}),s=await h(e),o=await u.deriveChildNode({path:i,node:s});return new a.BIP44Node(o)},r.getBIP44AddressKeyDeriver=async function(e,t){const{account:r=0,change:n=0}=t||{},i=await h(e),s=c.getHardenedBIP32NodeToken(r),o=c.getBIP32NodeToken(n),l=async(e,t=!1)=>{const r=await u.deriveChildNode({path:[s,o,t?c.getHardenedBIP32NodeToken(e):c.getUnhardenedBIP32NodeToken(e)],node:i});return new a.BIP44Node(r)};return l.coin_type=i.coin_type,l.path=c.getBIP44ChangePathString(i.path,{account:r,change:n}),Object.freeze(l),l}}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1174,{"./SLIP10Node":1175,"./constants":1176,"./extended-keys":1185,"./utils":1187},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.validateBIP44Depth=r.BIP44Node=void 0;const o=e("./constants"),a=e("./utils"),c=e("./SLIP10Node"),u=e("./extended-keys");class l{constructor(e){n.set(this,void 0),i(this,n,e,"f"),Object.freeze(this)}static async fromJSON(e){return l.fromExtendedKey(e)}static async fromExtendedKey(e){if("string"==typeof e){const t=u.decodeExtendedKey(e),{chainCode:r,depth:n,parentFingerprint:i,index:s}=t;if(t.version===u.PRIVATE_KEY_VERSION){const{privateKey:e}=t;return l.fromExtendedKey({depth:n,parentFingerprint:i,index:s,privateKey:e,chainCode:r})}const{publicKey:o}=t;return l.fromExtendedKey({depth:n,parentFingerprint:i,index:s,publicKey:o,chainCode:r})}const{privateKey:t,publicKey:r,chainCode:n,depth:i,parentFingerprint:s,index:o}=e;d(i);const a=await c.SLIP10Node.fromExtendedKey({privateKey:t,publicKey:r,chainCode:n,depth:i,parentFingerprint:s,index:o,curve:"secp256k1"});return new l(a)}static async fromDerivationPath({derivationPath:e}){d(e.length-1),f(e,o.MIN_BIP_44_DEPTH);const t=await c.SLIP10Node.fromDerivationPath({derivationPath:e,curve:"secp256k1"});return new l(t)}get depth(){return s(this,n,"f").depth}get privateKeyBuffer(){return s(this,n,"f").privateKeyBuffer}get publicKeyBuffer(){return s(this,n,"f").publicKeyBuffer}get chainCodeBuffer(){return s(this,n,"f").chainCodeBuffer}get privateKey(){return s(this,n,"f").privateKey}get publicKey(){return s(this,n,"f").publicKey}get compressedPublicKeyBuffer(){return s(this,n,"f").compressedPublicKeyBuffer}get chainCode(){return s(this,n,"f").chainCode}get address(){return s(this,n,"f").address}get parentFingerprint(){return s(this,n,"f").parentFingerprint}get fingerprint(){return s(this,n,"f").fingerprint}get index(){return s(this,n,"f").index}get extendedKey(){const e={depth:this.depth,parentFingerprint:this.parentFingerprint,index:this.index,chainCode:this.chainCodeBuffer};return this.privateKeyBuffer?u.encodeExtendedKey(Object.assign(Object.assign({},e),{version:u.PRIVATE_KEY_VERSION,privateKey:this.privateKeyBuffer})):u.encodeExtendedKey(Object.assign(Object.assign({},e),{version:u.PUBLIC_KEY_VERSION,publicKey:this.publicKeyBuffer}))}get curve(){return s(this,n,"f").curve}neuter(){const e=s(this,n,"f").neuter();return new l(e)}async derive(e){if(this.depth===o.MAX_BIP_44_DEPTH)throw new Error("Illegal operation: This HD tree node is already a leaf node.");d(this.depth+e.length),f(e,this.depth+1);const t=await s(this,n,"f").derive(e);return new l(t)}toJSON(){return{depth:this.depth,parentFingerprint:this.parentFingerprint,index:this.index,privateKey:this.privateKey,publicKey:this.publicKey,chainCode:this.chainCode}}}function d(e){if(c.validateBIP32Depth(e),e<o.MIN_BIP_44_DEPTH||e>o.MAX_BIP_44_DEPTH)throw new Error(`Invalid HD tree path depth: The depth must be a positive integer N such that 0 <= N <= 5. Received: "${e}"`)}function f(e,t){e.forEach(((e,r)=>{switch(t+r){case o.MIN_BIP_44_DEPTH:if(!o.BIP_39_PATH_REGEX.test(e))throw new Error('Invalid derivation path: The "m" / seed node (depth 0) must be a BIP-39 node.');break;case 1:if(e!==o.BIP44PurposeNodeToken)throw new Error(`Invalid derivation path: The "purpose" node (depth 1) must be the string "${o.BIP44PurposeNodeToken}".`);break;case 2:if(!o.BIP_32_PATH_REGEX.test(e)||!a.isHardened(e))throw new Error('Invalid derivation path: The "coin_type" node (depth 2) must be a hardened BIP-32 node.');break;case 3:if(!o.BIP_32_PATH_REGEX.test(e)||!a.isHardened(e))throw new Error('Invalid derivation path: The "account" node (depth 3) must be a hardened BIP-32 node.');break;case 4:if(!o.BIP_32_PATH_REGEX.test(e))throw new Error('Invalid derivation path: The "change" node (depth 4) must be a BIP-32 node.');break;case o.MAX_BIP_44_DEPTH:if(!o.BIP_32_PATH_REGEX.test(e))throw new Error('Invalid derivation path: The "address_index" node (depth 5) must be a BIP-32 node.');break;default:throw new Error("Invalid derivation path: The path exceeds the maximum BIP-44 depth.")}}))}r.BIP44Node=l,n=new WeakMap,r.validateBIP44Depth=d}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1175,{"./constants":1176,"./curves":1179,"./derivation":1181,"./derivers/bip32":1182,"./utils":1187},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.deriveChildNode=r.validateParentFingerprint=r.validateBIP32Depth=r.SLIP10Node=void 0;const n=e("./constants"),i=e("./curves"),s=e("./derivation"),o=e("./derivers/bip32"),a=e("./utils");class c{constructor({depth:e,parentFingerprint:t,index:r,chainCode:n,privateKey:i,publicKey:s,curve:o}){this.depth=e,this.parentFingerprint=t,this.index=r,this.chainCodeBuffer=n,this.privateKeyBuffer=i,this.publicKeyBuffer=s,this.curve=o,Object.freeze(this)}static async fromJSON(e){return c.fromExtendedKey(e)}static async fromExtendedKey({depth:e,parentFingerprint:t,index:r,privateKey:s,publicKey:o,chainCode:f,curve:h}){const p=a.getBuffer(f,n.BUFFER_KEY_LENGTH);if(u(h),l(e),a.validateBIP32Index(r),d(t),s){const o=a.getBuffer(s,n.BUFFER_KEY_LENGTH);return new c({depth:e,parentFingerprint:t,index:r,chainCode:p,privateKey:o,publicKey:await i.getCurveByName(h).getPublicKey(s),curve:h})}if(o){const n=a.getBuffer(o,i.getCurveByName(h).publicKeyLength);return new c({depth:e,parentFingerprint:t,index:r,chainCode:p,publicKey:n,curve:h})}throw new Error("Invalid options: Must provide either a private key or a public key.")}static async fromDerivationPath({derivationPath:e,curve:t}){if(u(t),!e)throw new Error("Invalid options: Must provide a derivation path.");if(0===e.length)throw new Error("Invalid derivation path: May not specify an empty derivation path.");return await s.deriveKeyFromPath({path:e,depth:e.length-1,curve:t})}get chainCode(){return this.chainCodeBuffer.toString("hex")}get privateKey(){var e;return null===(e=this.privateKeyBuffer)||void 0===e?void 0:e.toString("hex")}get publicKey(){return this.publicKeyBuffer.toString("hex")}get compressedPublicKeyBuffer(){return i.getCurveByName(this.curve).compressPublicKey(this.publicKeyBuffer)}get address(){if("secp256k1"!==this.curve)throw new Error("Unable to get address for this node: Only secp256k1 is supported.");return`0x${o.publicKeyToEthAddress(this.publicKeyBuffer).toString("hex")}`}get fingerprint(){return a.getFingerprint(this.compressedPublicKeyBuffer)}neuter(){return new c({depth:this.depth,parentFingerprint:this.parentFingerprint,index:this.index,chainCode:this.chainCodeBuffer,publicKey:this.publicKeyBuffer,curve:this.curve})}async derive(e){return await f({path:e,node:this})}toJSON(){return{depth:this.depth,parentFingerprint:this.parentFingerprint,index:this.index,curve:this.curve,privateKey:this.privateKey,publicKey:this.publicKey,chainCode:this.chainCode}}}function u(e){if(!e||"string"!=typeof e)throw new Error("Invalid curve: Must specify a curve.");if(!Object.keys(i.curves).includes(e))throw new Error(`Invalid curve: Only the following curves are supported: ${Object.keys(i.curves).join(", ")}.`)}function l(e){if(!a.isValidInteger(e))throw new Error(`Invalid HD tree path depth: The depth must be a positive integer. Received: "${e}".`)}function d(e){if(!a.isValidInteger(e))throw new Error(`Invalid parent fingerprint: The fingerprint must be a positive integer. Received: "${e}".`)}async function f({path:e,node:t}){if(0===e.length)throw new Error("Invalid HD tree derivation path: Deriving a path of length 0 is not defined.");const r=t.depth+e.length;return l(r),await s.deriveKeyFromPath({path:e,node:t,depth:r})}r.SLIP10Node=c,r.validateBIP32Depth=l,r.validateParentFingerprint=d,r.deriveChildNode=f}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1176,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BIP_32_HARDENED_OFFSET=r.BIP_39_PATH_REGEX=r.BIP_32_PATH_REGEX=r.BIP44PurposeNodeToken=r.MAX_BIP_44_DEPTH=r.MIN_BIP_44_DEPTH=r.HEXADECIMAL_KEY_LENGTH=r.BUFFER_KEY_LENGTH=r.BUFFER_EXTENDED_KEY_LENGTH=void 0,r.BUFFER_EXTENDED_KEY_LENGTH=64,r.BUFFER_KEY_LENGTH=32,r.HEXADECIMAL_KEY_LENGTH=64,r.MIN_BIP_44_DEPTH=0,r.MAX_BIP_44_DEPTH=5,r.BIP44PurposeNodeToken="bip32:44'",r.BIP_32_PATH_REGEX=/^bip32:\d+'?$/u,r.BIP_39_PATH_REGEX=/^bip39:([a-z]+){1}( [a-z]+){11,23}$/u,r.BIP_32_HARDENED_OFFSET=2147483648}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1177,{"./ed25519":1178,"./secp256k1":1180,"@noble/secp256k1":1331},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.mod=r.getCurveByName=r.curves=void 0;const o=e("@noble/secp256k1"),a=s(e("./secp256k1")),c=s(e("./ed25519"));r.curves={secp256k1:a,ed25519:c},r.getCurveByName=function(e){return r.curves[e]},r.mod=o.utils.mod}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1178,{"@noble/ed25519":1320,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.decompressPublicKey=r.compressPublicKey=r.publicAdd=r.getPublicKey=r.publicKeyLength=r.deriveUnhardenedKeys=r.isValidPrivateKey=r.secret=r.name=r.curve=void 0;const n=e("@noble/ed25519");var i=e("@noble/ed25519");Object.defineProperty(r,"curve",{enumerable:!0,get:function(){return i.CURVE}}),r.name="ed25519",r.secret=t.from("ed25519 seed","utf8");r.isValidPrivateKey=e=>!0,r.deriveUnhardenedKeys=!1,r.publicKeyLength=33;r.getPublicKey=async(e,r)=>{const i=await n.getPublicKey(e);return t.concat([t.alloc(1,0),i])};r.publicAdd=(e,t)=>{throw new Error("Ed25519 does not support public key derivation.")};r.compressPublicKey=e=>e;r.decompressPublicKey=e=>e}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1179,{"./curve":1177,"./ed25519":1178,"./secp256k1":1180},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.ed25519=r.secp256k1=void 0,s(e("./curve"),r),r.secp256k1=o(e("./secp256k1")),r.ed25519=o(e("./ed25519"))}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[118,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:35,async migrate(e){const t=(0,n.cloneDeep)(e);return t.meta.version=35,t.data=function(e){e.PreferencesController&&e.PreferencesController.seedWords!==undefined&&delete e.PreferencesController.seedWords;return e}(t.data),t}};r.default=i}}},{package:"$root$"}],[1180,{"@noble/secp256k1":1331,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.decompressPublicKey=r.compressPublicKey=r.publicAdd=r.getPublicKey=r.publicKeyLength=r.deriveUnhardenedKeys=r.secret=r.name=r.isValidPrivateKey=r.curve=void 0;const n=e("@noble/secp256k1");var i=e("@noble/secp256k1");Object.defineProperty(r,"curve",{enumerable:!0,get:function(){return i.CURVE}}),r.isValidPrivateKey=n.utils.isValidPrivateKey,r.name="secp256k1",r.secret=t.from("Bitcoin seed","utf8"),r.deriveUnhardenedKeys=!0,r.publicKeyLength=65;r.getPublicKey=(e,r)=>t.from(n.getPublicKey(e,r));r.publicAdd=(e,r)=>{const i=n.Point.fromHex(e).add(n.Point.fromPrivateKey(r));return i.assertValidity(),t.from(i.toRawBytes(!1))};r.compressPublicKey=e=>{const r=n.Point.fromHex(e);return t.from(r.toRawBytes(!0))};r.decompressPublicKey=e=>{const r=n.Point.fromHex(e);return t.from(r.toRawBytes(!1))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1181,{"./BIP44CoinTypeNode":1173,"./BIP44Node":1174,"./SLIP10Node":1175,"./constants":1176,"./curves":1179,"./derivers":1184},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validatePathSegment=r.deriveKeyFromPath=void 0;const n=e("./constants"),i=e("./derivers"),s=e("./SLIP10Node"),o=e("./BIP44Node"),a=e("./BIP44CoinTypeNode"),c=e("./curves");function u(e,t,r){if(0===e.length)throw new Error("Invalid HD path segment: The segment must not be empty.");if(e.length-1>n.MAX_BIP_44_DEPTH)throw new Error("Invalid HD path segment: The segment cannot exceed a 0-indexed depth of 5.");let i=!1;if(e.forEach(((e,t)=>{if(0===t){if(i=n.BIP_39_PATH_REGEX.test(e),!i&&!n.BIP_32_PATH_REGEX.test(e))throw l()}else if(!n.BIP_32_PATH_REGEX.test(e))throw l()})),r===n.MIN_BIP_44_DEPTH&&(!i||1!==e.length))throw new Error(`Invalid HD path segment: The segment must consist of a single BIP-39 node for depths of ${n.MIN_BIP_44_DEPTH}. Received: "${e}".`);if(!t&&!i)throw new Error("Invalid derivation parameters: Must specify parent key if the first node of the path segment is not a BIP-39 node.");if(t&&i)throw new Error("Invalid derivation parameters: May not specify parent key if the path segment starts with a BIP-39 node.")}function l(){throw new Error("Invalid HD path segment: The path segment is malformed.")}r.deriveKeyFromPath=async function(e){const{path:t,depth:r=t.length}=e,n="node"in e?e.node:undefined,l="curve"in e?e.curve:null==n?void 0:n.curve;if(n&&!(n instanceof s.SLIP10Node)&&!(n instanceof o.BIP44Node)&&!(n instanceof a.BIP44CoinTypeNode))throw new Error("Invalid arguments: Node must be a SLIP-10 node or a BIP-44 node when provided.");if(!l)throw new Error("Invalid arguments: Must specify either a parent node or curve.");return u(t,Boolean(null==n?void 0:n.privateKey)||Boolean(null==n?void 0:n.publicKey),r),await t.reduce((async(e,t)=>{const r=await e,[n,s]=t.split(":");if(!function(e){return e in i.derivers}(n))throw new Error(`Unknown derivation type: "${n}"`);const o=i.derivers[n];return await o.deriveChildKey({path:s,node:r,curve:c.getCurveByName(l)})}),Promise.resolve(n))},r.validatePathSegment=u}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1182,{"../SLIP10Node":1175,"../constants":1176,"../curves":1179,"../utils":1187,"@noble/hashes/hmac":1324,"@noble/hashes/sha3":1328,"@noble/hashes/sha512":1329,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.privateAdd=r.deriveChildKey=r.publicKeyToEthAddress=r.privateKeyToEthAddress=void 0;const n=e("@noble/hashes/sha3"),i=e("@noble/hashes/hmac"),s=e("@noble/hashes/sha512"),o=e("../constants"),a=e("../utils"),c=e("../curves"),u=e("../SLIP10Node");function l(e){if(!t.isBuffer(e)||!a.isValidBufferKey(e,c.secp256k1.publicKeyLength))throw new Error("Invalid key: The key must be a 65-byte, non-zero Buffer.");return t.from(n.keccak_256(e.slice(1)).slice(-20))}function d(e,t,r){const n=a.bytesToNumber(e),i=a.bytesToNumber(t);if(i>=r.curve.n)throw new Error("Invalid tweak: Tweak is larger than the curve order.");const s=c.mod(n+i,r.curve.n);if(!r.isValidPrivateKey(s))throw new Error("Invalid private key or tweak: The resulting private key is invalid.");return a.hexStringToBuffer(s.toString(16).padStart(64,"0"))}r.privateKeyToEthAddress=function(e){if(!t.isBuffer(e)||!a.isValidBufferKey(e,o.BUFFER_KEY_LENGTH))throw new Error("Invalid key: The key must be a 32-byte, non-zero Buffer.");return l(c.secp256k1.getPublicKey(e,!1))},r.publicKeyToEthAddress=l,r.deriveChildKey=async function({path:e,node:r,curve:n=c.secp256k1}){const a=e.includes("'");if(!a&&!n.deriveUnhardenedKeys)throw new Error(`Invalid path: Cannot derive unhardened child keys with ${n.name}.`);if(!r)throw new Error("Invalid parameters: Must specify a node to derive from.");if(a&&!r.privateKey)throw new Error("Invalid parameters: Cannot derive hardened child keys without a private key.");const l=e.split("'")[0],f=parseInt(l,10);if(!/^\d+$/u.test(l)||!Number.isInteger(f)||f<0||f>=o.BIP_32_HARDENED_OFFSET)throw new Error(`Invalid BIP-32 index: The index must be a non-negative decimal integer less than ${o.BIP_32_HARDENED_OFFSET}.`);if(r.privateKeyBuffer){const e=await async function({privateKey:e,childIndex:r,isHardened:n,curve:i}){if(n){const n=t.allocUnsafe(4);n.writeUInt32BE(r+o.BIP_32_HARDENED_OFFSET,0);const i=e,s=t.alloc(1,0);return t.concat([s,i,n])}const s=t.allocUnsafe(4);s.writeUInt32BE(r,0);const a=await i.getPublicKey(e,!0);return t.concat([a,s])}({privateKey:r.privateKeyBuffer,childIndex:f,isHardened:a,curve:n}),{privateKey:c,chainCode:l}=await async function({privateKey:e,chainCode:r,secretExtension:n,curve:o}){const a=i.hmac(s.sha512,r,n),c=t.from(a.slice(0,32)),u=t.from(a.slice(32));if("ed25519"===o.name){return{privateKey:c,publicKey:await o.getPublicKey(c),chainCode:u}}const l=d(e,c,o),f=await o.getPublicKey(l);return{privateKey:l,publicKey:f,chainCode:u}}({privateKey:r.privateKeyBuffer,chainCode:r.chainCodeBuffer,secretExtension:e,curve:n});return u.SLIP10Node.fromExtendedKey({privateKey:c,chainCode:l,depth:r.depth+1,parentFingerprint:r.fingerprint,index:f+(a?o.BIP_32_HARDENED_OFFSET:0),curve:n.name})}const h=await async function({parentPublicKey:e,childIndex:r}){const n=t.alloc(4);return n.writeUInt32BE(r,0),t.concat([e,n])}({parentPublicKey:r.compressedPublicKeyBuffer,childIndex:f,curve:n}),{publicKey:p,chainCode:m}=function({publicKey:e,chainCode:r,publicExtension:n,curve:o}){const a=i.hmac(s.sha512,r,n),c=a.slice(0,32),u=a.slice(32),l=o.publicAdd(e,t.from(c));return{publicKey:t.from(l),chainCode:t.from(u)}}({publicKey:r.compressedPublicKeyBuffer,chainCode:r.chainCodeBuffer,publicExtension:h,curve:n});return u.SLIP10Node.fromExtendedKey({publicKey:p,chainCode:m,depth:r.depth+1,parentFingerprint:r.fingerprint,index:f,curve:n.name})},r.privateAdd=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1183,{"../SLIP10Node":1175,"../curves":1179,"@noble/hashes/hmac":1324,"@noble/hashes/sha512":1329,"@scure/bip39":1337,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.createBip39KeyFromSeed=r.deriveChildKey=r.bip39MnemonicToMultipath=void 0;const n=e("@scure/bip39"),i=e("@noble/hashes/hmac"),s=e("@noble/hashes/sha512"),o=e("../curves"),a=e("../SLIP10Node");async function c(e,r=o.secp256k1){const n=t.from(i.hmac(s.sha512,r.secret,e)),c=n.slice(0,32),u=n.slice(32);return a.SLIP10Node.fromExtendedKey({privateKey:c,chainCode:u,depth:0,parentFingerprint:0,index:0,curve:r.name})}r.bip39MnemonicToMultipath=function(e){return`bip39:${e.toLowerCase().trim()}`},r.deriveChildKey=async function({path:e,curve:r}){return c(t.from(n.mnemonicToSeedSync(e)),r)},r.createBip39KeyFromSeed=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1184,{"./bip32":1182,"./bip39":1183},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.derivers=void 0;const o=s(e("./bip32")),a=s(e("./bip39"));r.derivers={bip32:o,bip39:a}}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1185,{"./BIP44Node":1174,"./curves/secp256k1":1180,"./utils":1187,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.encodeExtendedKey=r.decodeExtendedKey=r.PRIVATE_KEY_VERSION=r.PUBLIC_KEY_VERSION=void 0;const n=e("./utils"),i=e("./BIP44Node"),s=e("./curves/secp256k1");r.PUBLIC_KEY_VERSION=76067358,r.PRIVATE_KEY_VERSION=76066276;r.decodeExtendedKey=e=>{const t=n.decodeBase58check(e);if(78!==t.length)throw new Error(`Invalid extended key: Expected a length of 78, got ${t.length}.`);const o=t.readUInt32BE(0),a=t.readUInt8(4);i.validateBIP44Depth(a);const c=t.readUInt32BE(5),u=t.readUInt32BE(9),l=t.slice(13,45);if(!n.isValidBufferKey(l,32))throw new Error("Invalid extended key: Chain code must be a 32-byte non-zero Buffer.");const d=t.slice(45,78);if(!n.isValidBufferKey(d,33))throw new Error("Invalid extended key: Key must be a 33-byte non-zero Buffer.");if(o===r.PUBLIC_KEY_VERSION){if(2!==d.readUInt8(0)&&3!==d.readUInt8(0))throw new Error("Invalid extended key: Public key must start with 0x02 or 0x03.");return{version:o,depth:a,parentFingerprint:c,index:u,chainCode:l,publicKey:s.decompressPublicKey(d)}}if(o===r.PRIVATE_KEY_VERSION){if(0!==d.readUInt8(0))throw new Error("Invalid extended key: Private key must start with 0x00.");return{version:o,depth:a,parentFingerprint:c,index:u,chainCode:l,privateKey:d.slice(1)}}throw new Error("Invalid extended key: Expected a public (xpub) or private key (xprv) version.")};r.encodeExtendedKey=e=>{const{version:i,depth:o,parentFingerprint:a,index:c,chainCode:u}=e,l=t.alloc(78);if(l.writeUInt32BE(i,0),l.writeUInt8(o,4),l.writeUInt32BE(a,5),l.writeUInt32BE(c,9),u.copy(l,13),e.version===r.PUBLIC_KEY_VERSION){const{publicKey:t}=e;s.compressPublicKey(t).copy(l,45)}if(e.version===r.PRIVATE_KEY_VERSION){const{privateKey:t}=e;t.copy(l,46)}return n.encodeBase58check(l)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1186,{"./BIP44CoinTypeNode":1173,"./BIP44Node":1174,"./SLIP10Node":1175,"./constants":1176,"./curves":1179,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.PackageBuffer=r.BIP44PurposeNodeToken=r.MAX_BIP_44_DEPTH=r.MIN_BIP_44_DEPTH=r.getBIP44AddressKeyDeriver=r.deriveBIP44AddressKey=r.BIP_44_COIN_TYPE_DEPTH=r.BIP44CoinTypeNode=r.ed25519=r.secp256k1=r.SLIP10Node=r.BIP44Node=void 0;var n=e("./BIP44Node");Object.defineProperty(r,"BIP44Node",{enumerable:!0,get:function(){return n.BIP44Node}});var i=e("./SLIP10Node");Object.defineProperty(r,"SLIP10Node",{enumerable:!0,get:function(){return i.SLIP10Node}});var s=e("./curves");Object.defineProperty(r,"secp256k1",{enumerable:!0,get:function(){return s.secp256k1}}),Object.defineProperty(r,"ed25519",{enumerable:!0,get:function(){return s.ed25519}});var o=e("./BIP44CoinTypeNode");Object.defineProperty(r,"BIP44CoinTypeNode",{enumerable:!0,get:function(){return o.BIP44CoinTypeNode}}),Object.defineProperty(r,"BIP_44_COIN_TYPE_DEPTH",{enumerable:!0,get:function(){return o.BIP_44_COIN_TYPE_DEPTH}}),Object.defineProperty(r,"deriveBIP44AddressKey",{enumerable:!0,get:function(){return o.deriveBIP44AddressKey}}),Object.defineProperty(r,"getBIP44AddressKeyDeriver",{enumerable:!0,get:function(){return o.getBIP44AddressKeyDeriver}});var a=e("./constants");Object.defineProperty(r,"MIN_BIP_44_DEPTH",{enumerable:!0,get:function(){return a.MIN_BIP_44_DEPTH}}),Object.defineProperty(r,"MAX_BIP_44_DEPTH",{enumerable:!0,get:function(){return a.MAX_BIP_44_DEPTH}}),Object.defineProperty(r,"BIP44PurposeNodeToken",{enumerable:!0,get:function(){return a.BIP44PurposeNodeToken}}),r.PackageBuffer=t}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[1187,{"./constants":1176,"@noble/hashes/ripemd160":1326,"@noble/hashes/sha256":1327,"@noble/hashes/utils":1330,"@scure/base":1336,buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.getFingerprint=r.encodeBase58check=r.decodeBase58check=r.getBuffer=r.bytesToNumber=r.isValidInteger=r.isValidBufferKey=r.nullableHexStringToBuffer=r.hexStringToBuffer=r.isValidHexString=r.stripHexPrefix=r.isHardened=r.isValidBIP32Index=r.validateBIP32Index=r.getBIP32NodeToken=r.getUnhardenedBIP32NodeToken=r.getHardenedBIP32NodeToken=r.getBIP44CoinTypeToAddressPathTuple=r.getBIP44ChangePathString=r.getBIP44CoinTypePathString=void 0;const n=e("@noble/hashes/utils"),i=e("@scure/base"),s=e("@noble/hashes/sha256"),o=e("@noble/hashes/ripemd160"),a=e("./constants");function c(e){return d(e),`${u(e)}'`}function u(e){return d(e),`bip32:${e}`}function l(e){if("number"==typeof e)return u(e);if(!e||!Number.isInteger(e.index)||"boolean"!=typeof e.hardened)throw new Error("Invalid BIP-32 index: Must be an object containing the index and whether it is hardened.");return e.hardened?c(e.index):u(e.index)}function d(e){if(!f(e))throw new Error("Invalid BIP-32 index: Must be a non-negative integer.")}function f(e){return y(e)}function h(e){return e.replace(/^0x/iu,"")}function p(e){return/^(?:0x)?[a-f0-9]+$/iu.test(e)}function m(e){if(t.isBuffer(e))return e;if("string"!=typeof e||!p(e))throw new Error(`Invalid hex string: "${e}".`);return t.from(h(e),"hex")}function g(e,t){if(e.length!==t)return!1;for(const t of e)if(0!==t)return!0;return!1}function y(e){return"number"==typeof e&&Number.isInteger(e)&&e>=0}function b(e,t){if(!g(e,t))throw new Error(`Invalid value: Must be a non-zero ${t}-byte buffer.`)}r.getBIP44CoinTypePathString=function(e){return`m / ${a.BIP44PurposeNodeToken} / ${u(e)}'`},r.getBIP44ChangePathString=function(e,t){return`${e} / ${c(t.account||0)} / ${l(t.change||0)}`},r.getBIP44CoinTypeToAddressPathTuple=function({account:e=0,change:t=0,address_index:r}){return[c(e),l(t),l(r)]},r.getHardenedBIP32NodeToken=c,r.getUnhardenedBIP32NodeToken=u,r.getBIP32NodeToken=l,r.validateBIP32Index=d,r.isValidBIP32Index=f,r.isHardened=function(e){return e.endsWith("'")},r.stripHexPrefix=h,r.isValidHexString=p,r.hexStringToBuffer=m,r.nullableHexStringToBuffer=function(e){return e?m(e):undefined},r.isValidBufferKey=g,r.isValidInteger=y,r.bytesToNumber=function(e){return BigInt(`0x${n.bytesToHex(e)}`)},r.getBuffer=function(e,r){if(e instanceof t)return b(e,r),e;if("string"==typeof e){if(!p(e))throw new Error(`Invalid value: Must be a valid hex string of length: ${2*r}.`);const t=m(e);return b(t,r),t}throw new Error("Invalid value: Expected a Buffer or hexadecimal string.")};r.decodeBase58check=e=>{const r=i.base58check(s.sha256);try{return t.from(r.decode(e))}catch(e){throw new Error("Invalid value: Value is not base58-encoded, or the checksum is invalid.")}};r.encodeBase58check=e=>i.base58check(s.sha256).encode(e);r.getFingerprint=e=>{if(!g(e,33))throw new Error("Invalid public key: The key must be a 33-byte, non-zero Buffer.");return t.from(o.ripemd160(e)).readUInt32BE(0)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/rpc-methods>@metamask/key-tree"}],[119,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:36,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=36;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};void 0!==e.privacyMode&&delete e.privacyMode}return e}(r),t}};r.default=i}}},{package:"$root$"}],[1195,{"./Substream":1196,"end-of-stream":2193,once:5154,"readable-stream":5541},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectMultiplex=void 0;const i=e("readable-stream"),s=n(e("end-of-stream")),o=n(e("once")),a=e("./Substream"),c=Symbol("IGNORE_SUBSTREAM");class u extends i.Duplex{constructor(e={}){super(Object.assign(Object.assign({},e),{objectMode:!0})),this._substreams={}}createStream(e){if(this.destroyed)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already destroyed`);if(this._readableState.ended||this._writableState.ended)throw new Error(`ObjectMultiplex - parent stream for name "${e}" already ended`);if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);const t=new a.Substream({parent:this,name:e});return this._substreams[e]=t,function(e,t){const r=o.default(t);s.default(e,{readable:!1},r),s.default(e,{writable:!1},r)}(this,(e=>t.destroy(e||undefined))),t}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=c}_read(){return undefined}_write(e,t,r){const{name:n,data:i}=e;if(!n)return console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),r();const s=this._substreams[n];return s?(s!==c&&s.push(i),r()):(console.warn(`ObjectMultiplex - orphaned data for stream "${n}"`),r())}}r.ObjectMultiplex=u}}},{package:"@metamask/providers>@metamask/object-multiplex"}],[1196,{"readable-stream":5541},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Substream=void 0;const n=e("readable-stream");class i extends n.Duplex{constructor({parent:e,name:t}){super({objectMode:!0}),this._parent=e,this._name=t}_read(){return undefined}_write(e,t,r){this._parent.push({name:this._name,data:e}),r()}}r.Substream=i}}},{package:"@metamask/providers>@metamask/object-multiplex"}],[1197,{"./ObjectMultiplex":1195},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./ObjectMultiplex");t.exports=n.ObjectMultiplex}}},{package:"@metamask/providers>@metamask/object-multiplex"}],[1198,{"./ObservableStore":1201},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposedStore=void 0;const n=e("./ObservableStore");class i extends n.ObservableStore{constructor(e){super();this.getState()||this.putState({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}r.ComposedStore=i}}},{package:"@metamask/obs-store"}],[1199,{"./ObservableStore":1201},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LocalStorageStore=void 0;const n=e("./ObservableStore");class i extends n.ObservableStore{constructor(e={}){if(!global.localStorage)throw new Error("LocalStorageStore - can't find localStorage.");if(super(),!e.storageKey)throw new Error("LocalStorageStore - no storageKey specified.");this._storageKey=e.storageKey}_getState(){const e=global.localStorage.getItem(this._storageKey);return e?JSON.parse(e):undefined}_putState(e){const t=JSON.stringify(e);return global.localStorage.setItem(this._storageKey,t)}}r.LocalStorageStore=i}}},{package:"@metamask/obs-store"}],[12,{"../../../shared/constants/network":6028,"../../../shared/constants/time":6032,"../../../shared/constants/transaction":6033,"../../../shared/modules/fetch-with-timeout":6037,"../../../shared/modules/random-id":6042,"../lib/util":83,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,"@metamask/obs-store":1203,"bn.js":1892,loglevel:5029},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("@metamask/obs-store"),o=n(e("loglevel")),a=n(e("bn.js")),c=n(e("../../../shared/modules/random-id")),u=e("../lib/util"),l=n(e("../../../shared/modules/fetch-with-timeout")),d=e("../../../shared/constants/transaction"),f=e("../../../shared/constants/network"),h=e("../../../shared/constants/time");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const g=(0,l.default)(30*h.SECOND),y=[f.GOERLI_CHAIN_ID,f.KOVAN_CHAIN_ID,f.MAINNET_CHAIN_ID,f.RINKEBY_CHAIN_ID,f.ROPSTEN_CHAIN_ID];function b(e,t){let r,n=!0;return i=>{try{return n?(n=!1,e(null!=t?t:i,i)):e(r,i)}finally{r=i}}}r.default=class{constructor(e={}){const{blockTracker:t,onNetworkDidChange:r,getCurrentChainId:n,preferencesController:i}=e;this.blockTracker=t,this.getCurrentChainId=n,this.preferencesController=i,this._onLatestBlock=async e=>{const t=this.preferencesController.getSelectedAddress(),r=parseInt(e,16);await this._update(t,r)};const o=m({incomingTransactions:{},incomingTxLastFetchedBlockByChainId:{[f.GOERLI_CHAIN_ID]:null,[f.KOVAN_CHAIN_ID]:null,[f.MAINNET_CHAIN_ID]:null,[f.RINKEBY_CHAIN_ID]:null,[f.ROPSTEN_CHAIN_ID]:null}},e.initState);this.store=new s.ObservableStore(o),this.preferencesController.store.subscribe(b(((e,t)=>{const{featureFlags:{showIncomingTransactions:r}={}}=e,{featureFlags:{showIncomingTransactions:n}={}}=t;n!==r&&(!r||n?this.start():this.stop())}),this.preferencesController.store.getState())),this.preferencesController.store.subscribe(b((async(e,t)=>{const{selectedAddress:r}=e,{selectedAddress:n}=t;n!==r&&await this._update(n)}),this.preferencesController.store.getState())),r((async()=>{const e=this.preferencesController.getSelectedAddress();await this._update(e)}))}start(){const{featureFlags:e={}}=this.preferencesController.store.getState(),{showIncomingTransactions:t}=e;t&&(this.blockTracker.removeListener("latest",this._onLatestBlock),this.blockTracker.addListener("latest",this._onLatestBlock))}stop(){this.blockTracker.removeListener("latest",this._onLatestBlock)}async _update(e,t){const r=this.getCurrentChainId();if(y.includes(r)&&e)try{var n;const i=this.store.getState(),s=parseInt(this.blockTracker.getCurrentBlock(),16),o=i.incomingTxLastFetchedBlockByChainId[r],a=null!==(n=null!=o?o:t)&&void 0!==n?n:s,c=await this._getNewIncomingTransactions(e,a,r);let u=a;c.forEach((e=>{e.blockNumber&&parseInt(u,10)<parseInt(e.blockNumber,10)&&(u=parseInt(e.blockNumber,10))})),this.store.updateState({incomingTxLastFetchedBlockByChainId:m(m({},i.incomingTxLastFetchedBlockByChainId),{},{[r]:u+1}),incomingTransactions:c.reduce(((e,t)=>(e[t.hash]=t,e)),m({},i.incomingTransactions))})}catch(e){o.default.error(e)}}async _getNewIncomingTransactions(e,t,r){let n=`${`https://${r===f.MAINNET_CHAIN_ID?"api":`api-${f.CHAIN_ID_TO_TYPE_MAP[r]}`}.etherscan.io`}/api?module=account&action=txlist&address=${e}&tag=latest&page=1`;t&&(n+=`&startBlock=${parseInt(t,10)}`);const i=await g(n),{status:s,result:o}=await i.json();let a=[];if("1"===s&&Array.isArray(o)&&o.length>0){const t={},n=[];o.forEach((e=>{t[e.hash]||(n.push(this._normalizeTxFromEtherscan(e,r)),t[e.hash]=1)})),a=n.filter((t=>{var r,n;return(null===(r=t.txParams)||void 0===r||null===(n=r.to)||void 0===n?void 0:n.toLowerCase())===e.toLowerCase()})),a.sort(((e,t)=>e.time<t.time?-1:1))}return a}_normalizeTxFromEtherscan(e,t){const r=1e3*parseInt(e.timeStamp,10),n="0"===e.isError?d.TRANSACTION_STATUSES.CONFIRMED:d.TRANSACTION_STATUSES.FAILED,i={from:e.from,gas:(0,u.bnToHex)(new a.default(e.gas)),nonce:(0,u.bnToHex)(new a.default(e.nonce)),to:e.to,value:(0,u.bnToHex)(new a.default(e.value))};return e.gasPrice?i.gasPrice=(0,u.bnToHex)(new a.default(e.gasPrice)):e.maxFeePerGas&&(i.maxFeePerGas=(0,u.bnToHex)(new a.default(e.maxFeePerGas)),i.maxPriorityFeePerGas=(0,u.bnToHex)(new a.default(e.maxPriorityFeePerGas))),{blockNumber:e.blockNumber,id:(0,c.default)(),chainId:t,metamaskNetworkId:f.CHAIN_ID_TO_NETWORK_ID_MAP[t],status:n,time:r,txParams:i,hash:e.hash,type:d.TRANSACTION_TYPES.INCOMING}}}}}},{package:"$root$"}],[120,{"@metamask/controllers":1060,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("@metamask/controllers");var s={version:37,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=37;const r=t.data;return t.data=function(e){if(e.AddressBookController){const t=e.AddressBookController.addressBook,r=new Set,n={};Object.values(t).forEach((e=>{r.add(e.chainId)}));for(const e of r.values()){n[e]={};for(const r in t)t[r].chainId===e&&(t[r].isEns=!1,i.util.normalizeEnsName(t[r].name)&&(t[r].isEns=!0),n[e][r]=t[r])}e.AddressBookController.addressBook=n}return e}(r),t}};r.default=s}}},{package:"$root$"}],[1200,{"./ObservableStore":1201},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MergedStore=void 0;const n=e("./ObservableStore");class i extends n.ObservableStore{constructor(e=[]){super();this.getState()||this.putState({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}r.MergedStore=i}}},{package:"@metamask/obs-store"}],[1201,{"@metamask/safe-event-emitter":1238},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObservableStore=void 0;const i=n(e("@metamask/safe-event-emitter"));class s extends i.default{constructor(e={}){super(),this._state=e}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState(),r=Object.assign({},t,e);this.putState(r)}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}r.ObservableStore=s}}},{package:"@metamask/obs-store"}],[1202,{stream:1939},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class i extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new i(e)}}}},{package:"@metamask/obs-store"}],[1203,{"./ComposedStore":1198,"./LocalStorageStore":1199,"./MergedStore":1200,"./ObservableStore":1201,"./asStream":1202,"./transform":1204},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./asStream"),r),i(e("./ComposedStore"),r),i(e("./LocalStorageStore"),r),i(e("./MergedStore"),r),i(e("./ObservableStore"),r),i(e("./transform"),r)}}},{package:"@metamask/obs-store"}],[1204,{through2:1205},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@metamask/obs-store"}],[1205,{_process:5261,"readable-stream":5541,util:1942,xtend:6010},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,i=e("util").inherits,s=e("xtend");function o(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(o,n),o.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new o(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=s(e,t),o.call(this,this.options)}return i(n,o),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new o(s({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/obs-store>through2"}],[1206,{"readable-stream":1220},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BasePostMessageStream=void 0;const n=e("readable-stream");function i(){return undefined}const s="ACK";class o extends n.Duplex{constructor(){super({objectMode:!0}),this._init=!1,this._haveSyn=!1}_handshake(){this._write("SYN",null,i),this.cork()}_onData(e){if(this._init)try{this.push(e)}catch(e){this.emit("error",e)}else"SYN"===e?(this._haveSyn=!0,this._write(s,null,i)):e===s&&(this._init=!0,this._haveSyn||this._write(s,null,i),this.uncork())}_read(){return undefined}_write(e,t,r){this._postMessage(e),r()}}r.BasePostMessageStream=o}}},{package:"@metamask/post-message-stream"}],[1207,{"./BasePostMessageStream":1206},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WindowPostMessageStream=void 0;const n=e("./BasePostMessageStream");class i extends n.BasePostMessageStream{constructor({name:e,target:t,targetWindow:r}){if(!e||!t)throw new Error("Invalid input.");super(),this._name=e,this._target=t,this._targetOrigin=r?"*":location.origin,this._targetWindow=r||window,this._onMessage=this._onMessage.bind(this),window.addEventListener("message",this._onMessage,!1),this._handshake()}_postMessage(e){this._targetWindow.postMessage({target:this._target,data:e},this._targetOrigin)}_onMessage(e){const t=e.data;"*"!==this._targetOrigin&&e.origin!==this._targetOrigin||e.source!==this._targetWindow||"object"!=typeof t||t.target!==this._name||!t.data||this._onData(t.data)}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}r.WindowPostMessageStream=i}}},{package:"@metamask/post-message-stream"}],[1208,{"./BasePostMessageStream":1206,"./enums":1210},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WorkerParentPostMessageStream=void 0;const n=e("./BasePostMessageStream"),i=e("./enums");class s extends n.BasePostMessageStream{constructor({worker:e}){if(!e)throw new Error("Invalid input.");super(),this._target=i.DEDICATED_WORKER_NAME,this._worker=e,this._worker.onmessage=this._onMessage.bind(this),this._handshake()}_postMessage(e){this._worker.postMessage({target:this._target,data:e})}_onMessage(e){const t=e.data;"object"==typeof t&&t.data&&this._onData(t.data)}_destroy(){this._worker.onmessage=null,this._worker=null}}r.WorkerParentPostMessageStream=s}}},{package:"@metamask/post-message-stream"}],[1209,{"./BasePostMessageStream":1206,"./enums":1210},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WorkerPostMessageStream=void 0;const n=e("./BasePostMessageStream"),i=e("./enums");class s extends n.BasePostMessageStream{constructor(){super(),this._name=i.DEDICATED_WORKER_NAME,self.onmessage=this._onMessage.bind(this),this._handshake()}_postMessage(e){self.postMessage({data:e})}_onMessage(e){const t=e.data;"object"==typeof t&&t.target===this._name&&t.data&&this._onData(t.data)}_destroy(){return undefined}}r.WorkerPostMessageStream=s}}},{package:"@metamask/post-message-stream"}],[121,{"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:38,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=38;const r=t.data;return t.data=function(e){const{ABTestController:t={}}=e,{abTests:r={}}=t;if(r.fullScreenVsPopup)return e;return a(a({},e),{},{ABTestController:a(a({},t),{},{abTests:a(a({},r),{},{fullScreenVsPopup:"control"})})})}(r),t}};r.default=c}}},{package:"$root$"}],[1210,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEDICATED_WORKER_NAME=void 0,r.DEDICATED_WORKER_NAME="dedicatedWorker"}}},{package:"@metamask/post-message-stream"}],[1211,{"./WindowPostMessageStream":1207,"./WorkerParentPostMessageStream":1208,"./WorkerPostMessageStream":1209},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WorkerParentPostMessageStream=r.WorkerPostMessageStream=r.WindowPostMessageStream=void 0;var n=e("./WindowPostMessageStream");Object.defineProperty(r,"WindowPostMessageStream",{enumerable:!0,get:function(){return n.WindowPostMessageStream}});var i=e("./WorkerPostMessageStream");Object.defineProperty(r,"WorkerPostMessageStream",{enumerable:!0,get:function(){return i.WorkerPostMessageStream}});var s=e("./WorkerParentPostMessageStream");Object.defineProperty(r,"WorkerParentPostMessageStream",{enumerable:!0,get:function(){return s.WorkerParentPostMessageStream}})}}},{package:"@metamask/post-message-stream"}],[1212,{"./_stream_readable":1214,"./_stream_writable":1216,"core-util-is":2009,inherits:4276,"process-nextick-args":5260},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=d;var s=e("core-util-is");s.inherits=e("inherits");var o=e("./_stream_readable"),a=e("./_stream_writable");s.inherits(d,o);for(var c=i(a.prototype),u=0;u<c.length;u++){var l=c[u];d.prototype[l]||(d.prototype[l]=a.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n(h,this)}function h(e){e.end()}Object.defineProperty(d.prototype,"destroyed",{get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),n(t,e)}}}},{package:"@metamask/post-message-stream>readable-stream"}],[1213,{"./_stream_transform":1215,"core-util-is":2009,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=s;var n=e("./_stream_transform"),i=e("core-util-is");function s(e){if(!(this instanceof s))return new s(e);n.call(this,e)}i.inherits=e("inherits"),i.inherits(s,n),s.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"@metamask/post-message-stream>readable-stream"}],[1214,{"./_stream_duplex":1212,"./internal/streams/BufferList":1217,"./internal/streams/destroy":1218,"./internal/streams/stream":1219,_process:5261,"core-util-is":2009,events:1937,inherits:4276,isarray:4581,"process-nextick-args":5260,"safe-buffer":1221,"string_decoder/":1222,util:1935},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("process-nextick-args");t.exports=b;var i,s=e("isarray");b.ReadableState=y;e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},a=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,u=global.Uint8Array||function(){};var l=e("core-util-is");l.inherits=e("inherits");var d=e("util"),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var h,p=e("./internal/streams/BufferList"),m=e("./internal/streams/destroy");l.inherits(b,a);var g=["error","close","destroy","pause","resume"];function y(t,r){i=i||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,r instanceof i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,s=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(h||(h=e("string_decoder/").StringDecoder),this.decoder=new h(t.encoding),this.encoding=t.encoding)}function b(t){if(i=i||e("./_stream_duplex"),!(this instanceof b))return new b(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),a.call(this)}function w(e,t,r,n,i){var s,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,E(e)}(e,o)):(i||(s=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||t===undefined||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(o,t)),s?e.emit("error",s):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):v(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?v(e,o,t,!1):P(e,o)):v(e,o,t,!1))):n||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function v(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&E(e)),P(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=m.destroy,b.prototype._undestroy=m.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),w(this,e,t,!1,r)},b.prototype.unshift=function(e){return w(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return h||(h=e("string_decoder/").StringDecoder),this._readableState.decoder=new h(t),this._readableState.encoding=t,this};var _=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=_?e=_:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function E(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n(k,e):k(e))}function k(e){f("emit readable"),e.emit("readable"),x(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n(T,e,t))}function T(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function A(e){f("readable nexttick read 0"),e.read(0)}function O(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),x(e),t.flowing&&!t.reading&&e.read(0)}function x(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var s=r.data,o=e>s.length?s.length:e;if(o===s.length?i+=s:i+=s.slice(0,e),0===(e-=o)){o===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(o));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var s=n.data,o=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,o),0===(e-=o)){o===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(o));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function j(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):E(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&j(this),null;var n,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(n=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&j(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var c=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:w;function u(t,r){f("onunpipe"),t===i&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,f("cleanup"),e.removeListener("close",y),e.removeListener("finish",b),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",u),i.removeListener("end",l),i.removeListener("end",w),i.removeListener("data",m),h=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function l(){f("onend"),e.end()}a.endEmitted?n(c):i.once("end",c),e.on("unpipe",u);var d=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,x(e))}}(i);e.on("drain",d);var h=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==R(a.pipes,e))&&!h&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,p=!0),i.pause())}function g(t){f("onerror",t),w(),e.removeListener("error",g),0===o(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",b),w()}function b(){f("onfinish"),e.removeListener("close",y),w()}function w(){f("unpipe"),i.unpipe(e)}return i.on("data",m),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",y),e.once("finish",b),e.emit("pipe",i),a.flowing||(f("pipe resume"),i.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,r);return this}var o=R(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},b.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&E(this):n(A,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n(O,e,t))}(this,e)),this},b.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(f("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){(f("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&i!==undefined)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<g.length;s++)e.on(g[s],n.emit.bind(n,g[s]));return n._read=function(t){f("wrapped _read",t),r&&(r=!1,e.resume())},n},b._fromList=I}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream"}],[1215,{"./_stream_duplex":1212,"core-util-is":2009,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=o;var n=e("./_stream_duplex"),i=e("core-util-is");function s(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!==r&&r!==undefined&&e.push(r);i(t);var s=e._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&e._read(s.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e),this._transformState=new s(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e,r){a(t,e,r)})):a(t)}))}function a(e,t,r){if(t)return e.emit("error",t);null!==r&&r!==undefined&&e.push(r);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}}}},{package:"@metamask/post-message-stream>readable-stream"}],[1216,{"./_stream_duplex":1212,"./internal/streams/destroy":1218,"./internal/streams/stream":1219,_process:5261,"core-util-is":2009,inherits:4276,"process-nextick-args":5260,"safe-buffer":1221,timers:5784,"util-deprecate":5856},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r,n){(function(){var i=e("process-nextick-args");function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=y;var o,a=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?n:i;y.WritableState=g;var c=e("core-util-is");c.inherits=e("inherits");var u={deprecate:e("util-deprecate")},l=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,f=global.Uint8Array||function(){};var h,p=e("./internal/streams/destroy");function m(){}function g(t,r){o=o||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,r instanceof o&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,c=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===t.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,s=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,s){--t.pendingcb,r?(i(s,n),i(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(s(n),e._writableState.errorEmitted=!0,e.emit("error",n),E(e,t))}(e,r,n,t,s);else{var o=_(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||v(e,r),n?a(w,e,r,o,s):w(e,r,o,s)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function y(t){if(o=o||e("./_stream_duplex"),!(h.call(y,this)||this instanceof o))return new y(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function b(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function w(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),E(e,t)}function v(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,c=!0;r;)i[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;i.allBuffers=c,b(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t)}else{for(;r;){var u=r.chunk,l=r.encoding,d=r.callback;if(b(e,t,!1,t.objectMode?1:u.length,u,l,d),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),E(e,t)}))}function E(e,t){var r=_(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,i(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(y,l),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||e&&e._writableState instanceof g}})):h=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,s=this._writableState,o=!1,a=(n=e,(d.isBuffer(n)||n instanceof f)&&!s.objectMode);return a&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=m),s.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),i(t,r)}(this,r):(a||function(e,t,r,n){var s=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||r===undefined||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),i(n,o),s=!1),s}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,a,n,i,s);return c}(this,s,a,e,t,r)),o},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||v(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,E(e,t),r&&(t.finished?i(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=p.destroy,y.prototype._undestroy=p.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this)}).call(this,e("_process"),e("timers").setImmediate)}}},{package:"@metamask/post-message-stream>readable-stream"}],[1217,{"safe-buffer":1221},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer;t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,s=n.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,r=s,i=a,t.copy(r,i),a+=o.data.length,o=o.next;return s},e}()}}},{package:"@metamask/post-message-stream>readable-stream"}],[1218,{"process-nextick-args":5260},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;s||o?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})))},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}}}},{package:"@metamask/post-message-stream>readable-stream"}],[1219,{events:1937},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("events").EventEmitter}}},{package:"@metamask/post-message-stream>readable-stream"}],[122,{"../../../shared/modules/hexstring-utils":6039,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/modules/hexstring-utils");const s="SAI";function o(e={}){return e&&"object"==typeof e&&"DAI"===e.symbol&&"0x89d24A6b4CcB1B6fAA2625fE562bDD9a23260359"===(0,i.toChecksumHexAddress)(e.address)}var a={version:39,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=39;const r=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.tokens||[];if(Array.isArray(e))for(const t of e)o(t)&&(t.symbol=s);const r=t.accountTokens||{};if(r&&"object"==typeof r)for(const e of Object.keys(r)){const t=r[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const r=t[e];if(Array.isArray(r))for(const e of r)o(e)&&(e.symbol=s)}}}return e}(r),t}};r.default=a}}},{package:"$root$"}],[1220,{"./lib/_stream_duplex.js":1212,"./lib/_stream_passthrough.js":1213,"./lib/_stream_readable.js":1214,"./lib/_stream_transform.js":1215,"./lib/_stream_writable.js":1216},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")}}},{package:"@metamask/post-message-stream>readable-stream"}],[1221,{buffer:1936},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("buffer"),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=o),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return t!==undefined?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}}},{package:"@metamask/post-message-stream>readable-stream>safe-buffer"}],[1222,{"safe-buffer":1221},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�".repeat(r);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�".repeat(r+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�".repeat(r+2)}}(this,e,t);return r!==undefined?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if((t=this.fillLast(e))===undefined)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�".repeat(this.lastTotal-this.lastNeed):t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r)return 0;if((i=o(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r)return 0;if((i=o(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}}}},{package:"@metamask/post-message-stream>readable-stream>string_decoder"}],[1223,{"./permitted":1228,"./restricted":1233,"./utils":1237},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.selectHooks=r.restrictedMethodPermissionBuilders=r.permittedMethods=void 0;var n=e("./permitted");Object.defineProperty(r,"permittedMethods",{enumerable:!0,get:function(){return n.handlers}});var i=e("./restricted");Object.defineProperty(r,"restrictedMethodPermissionBuilders",{enumerable:!0,get:function(){return i.builders}});var s=e("./utils");Object.defineProperty(r,"selectHooks",{enumerable:!0,get:function(){return s.selectHooks}})}}},{package:"@metamask/rpc-methods"}],[1224,{"@metamask/snap-controllers":1250,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleInstallSnaps=r.preprocessRequestedPermissions=void 0;const n=e("eth-rpc-errors"),i=e("@metamask/snap-controllers"),s=e("@metamask/utils");r.preprocessRequestedPermissions=function(e){if(!(0,s.isObject)(e))throw n.ethErrors.rpc.invalidRequest({data:{requestedPermissions:e}});return e.wallet_snap?Object.keys(e).reduce(((t,r)=>{if("wallet_snap"===r){if(!(0,s.isObject)(e[r]))throw n.ethErrors.rpc.invalidParams({message:"Invalid params to 'wallet_requestPermissions'",data:{requestedPermissions:e}});const o=e[r];Object.keys(o).forEach((r=>{const s=i.SNAP_PREFIX+r;if(e[s])throw n.ethErrors.rpc.invalidParams({message:`Snap '${r}' requested both as direct permission and under 'wallet_snap'. We recommend using 'wallet_snap' only.`,data:{requestedPermissions:e}});t[s]=o[r]}))}else t[r]=e[r];return t}),{}):e},r.handleInstallSnaps=async function(e,t){if(!(0,s.isObject)(e))throw n.ethErrors.rpc.invalidParams({message:"Invalid snap installation params.",data:{requestedSnaps:e}});if(0===Object.keys(e).length)throw n.ethErrors.rpc.invalidParams({message:"Must specify at least one snap to install.",data:{requestedSnaps:e}});return await t(e)}}}},{package:"@metamask/rpc-methods"}],[1225,{"./common/snapInstallation":1224,"@metamask/snap-controllers":1250,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.enableWalletHandler=void 0;const n=e("@metamask/snap-controllers"),i=e("@metamask/utils"),s=e("eth-rpc-errors"),o=e("./common/snapInstallation");r.enableWalletHandler={methodNames:["wallet_enable"],implementation:async function(e,t,r,a,{getAccounts:c,installSnaps:u,requestPermissions:l,getPermissions:d}){if(!Array.isArray(e.params))return a(s.ethErrors.rpc.invalidParams({message:'"params" must be an array.'}));const f={accounts:[],permissions:[],snaps:{}};let h;try{h=(0,o.preprocessRequestedPermissions)(e.params[0]);const t=await d();if(t&&function(e,t){return Object.entries(t).every((([t,r])=>!(r?.caveats&&r.caveats.length>0)&&(0,i.hasProperty)(e,t)))}(t,h)?f.permissions=Object.values(t):f.permissions=await l(h),!f.permissions||!f.permissions.length)throw s.ethErrors.provider.userRejectedRequest({data:e})}catch(e){return a(e)}const p=f.permissions.filter((e=>e.parentCapability.startsWith(n.SNAP_PREFIX)&&e.parentCapability in h)).reduce(((e,t)=>(e[t.parentCapability.replace(n.SNAP_PREFIX_REGEX,"")]=h[t.parentCapability],e)),{});try{Object.keys(p).length>0&&(f.snaps=await(0,o.handleInstallSnaps)(p,u))}catch(e){f.errors||(f.errors=[]),f.errors.push((0,s.serializeError)(e))}return f.accounts=await c(),t.result=f,a()},hookNames:{getAccounts:!0,installSnaps:!0,requestPermissions:!0,getPermissions:!0}}}}},{package:"@metamask/rpc-methods"}],[1226,{"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getAppKeyHandler=void 0;const n=e("eth-rpc-errors");r.getAppKeyHandler={methodNames:["snap_getAppKey"],implementation:async function(e,t,r,i,{getAppKey:s,getUnlockPromise:o}){const[a]=e?.params||[];if(a!==undefined&&(!a||"string"!=typeof a))return i(n.ethErrors.rpc.invalidParams({message:"Must omit params completely or specify a single hexadecimal string Ethereum account."}));try{return await o(!0),t.result=await s(a),i()}catch(e){return i(e)}},hookNames:{getAppKey:!0,getUnlockPromise:!0}}}}},{package:"@metamask/rpc-methods"}],[1227,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSnapsHandler=void 0,r.getSnapsHandler={methodNames:["wallet_getSnaps"],implementation:async function(e,t,r,n,{getSnaps:i}){return t.result=i(),n()},hookNames:{getSnaps:!0}}}}},{package:"@metamask/rpc-methods"}],[1228,{"./enable":1225,"./getAppKey":1226,"./getSnaps":1227,"./installSnaps":1229,"./invokeSnapSugar":1230},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handlers=void 0;const n=e("./enable"),i=e("./getAppKey"),s=e("./getSnaps"),o=e("./installSnaps"),a=e("./invokeSnapSugar");r.handlers=[n.enableWalletHandler,i.getAppKeyHandler,s.getSnapsHandler,o.installSnapsHandler,a.invokeSnapSugarHandler]}}},{package:"@metamask/rpc-methods"}],[1229,{"./common/snapInstallation":1224,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.installSnapsHandler=void 0;const n=e("eth-rpc-errors"),i=e("./common/snapInstallation");r.installSnapsHandler={methodNames:["wallet_installSnaps"],implementation:async function(e,t,r,s,{installSnaps:o}){if(!Array.isArray(e.params))return s(n.ethErrors.rpc.invalidParams({message:'"params" must be an array.'}));try{t.result=await(0,i.handleInstallSnaps)(e.params[0],o)}catch(e){t.error=e}return s()},hookNames:{installSnaps:!0}}}}},{package:"@metamask/rpc-methods"}],[123,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:40,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=40;const r=t.data;return t.data=function(e){return delete e.ProviderApprovalController,e}(r),t}};r.default=i}}},{package:"$root$"}],[1230,{"@metamask/snap-controllers":1250,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.invokeSnapSugarHandler=void 0;const n=e("eth-rpc-errors"),i=e("@metamask/snap-controllers"),s=e("@metamask/utils");r.invokeSnapSugarHandler={methodNames:["wallet_invokeSnap"],implementation:async function(e,t,r,o){if(!Array.isArray(e.params)||"string"!=typeof e.params[0]||!(0,s.isObject)(e.params[1]))return o(n.ethErrors.rpc.invalidParams({message:"Must specify a string snap ID and a plain request object."}));return e.method=i.SNAP_PREFIX+e.params[0],e.params=[e.params[1]],r()},hookNames:undefined}}}},{package:"@metamask/rpc-methods"}],[1231,{"@metamask/controllers":1060,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.confirmBuilder=void 0;const n=e("@metamask/controllers"),i=e("@metamask/utils"),s=e("eth-rpc-errors"),o="snap_confirm";function a({showConfirmation:e}){return async function(t){const{params:r,context:{origin:n}}=t;return await e(n,function(e){if(!Array.isArray(e)||!(0,i.isObject)(e[0]))throw s.ethErrors.rpc.invalidParams({message:"Expected array params with single object."});const{prompt:t,description:r,textAreaContent:n}=e[0];if(!t||"string"!=typeof t||t.length>40)throw s.ethErrors.rpc.invalidParams({message:'Must specify a non-empty string "prompt" less than 40 characters long.'});if(r&&("string"!=typeof r||r.length>140))throw s.ethErrors.rpc.invalidParams({message:'"description" must be a string no more than 140 characters long if specified.'});if(n&&("string"!=typeof n||n.length>1800))throw s.ethErrors.rpc.invalidParams({message:'"textAreaContent" must be a string no more than 1800 characters long if specified.'});return e[0]}(r))}}r.confirmBuilder=Object.freeze({targetKey:o,specificationBuilder:({allowedCaveats:e=null,methodHooks:t})=>({permissionType:n.PermissionType.RestrictedMethod,targetKey:o,allowedCaveats:e,methodImplementation:a(t)}),methodHooks:{showConfirmation:!0}})}}},{package:"@metamask/rpc-methods"}],[1232,{"@metamask/controllers":1060,"@metamask/key-tree":1186,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getBip44EntropyBuilder=void 0;const n=e("@metamask/controllers"),i=e("eth-rpc-errors"),s=e("@metamask/key-tree"),o="snap_getBip44Entropy_",a=`${o}*`;r.getBip44EntropyBuilder=Object.freeze({targetKey:a,specificationBuilder:({allowedCaveats:e=null,methodHooks:t})=>({permissionType:n.PermissionType.RestrictedMethod,targetKey:a,allowedCaveats:e,methodImplementation:u(t)}),methodHooks:{getMnemonic:!0,getUnlockPromise:!0}});const c=/^\d+$/u;function u({getMnemonic:e,getUnlockPromise:t}){return async function(r){const n=r.method.substr(o.length);if(!c.test(n))throw i.ethErrors.rpc.methodNotFound({message:`Invalid BIP-44 code: ${n}`});await t(!0);return(await s.BIP44CoinTypeNode.fromDerivationPath([`bip39:${await e()}`,"bip32:44'",`bip32:${Number(n)}'`])).toJSON()}}}}},{package:"@metamask/rpc-methods"}],[1233,{"./confirm":1231,"./getBip44Entropy":1232,"./invokeSnap":1234,"./manageState":1235,"./notify":1236},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.builders=r.NotificationType=r.ManageStateOperation=void 0;const n=e("./confirm"),i=e("./getBip44Entropy"),s=e("./invokeSnap"),o=e("./manageState"),a=e("./notify");var c=e("./manageState");Object.defineProperty(r,"ManageStateOperation",{enumerable:!0,get:function(){return c.ManageStateOperation}});var u=e("./notify");Object.defineProperty(r,"NotificationType",{enumerable:!0,get:function(){return u.NotificationType}}),r.builders={[n.confirmBuilder.targetKey]:n.confirmBuilder,[i.getBip44EntropyBuilder.targetKey]:i.getBip44EntropyBuilder,[s.invokeSnapBuilder.targetKey]:s.invokeSnapBuilder,[o.manageStateBuilder.targetKey]:o.manageStateBuilder,[a.notifyBuilder.targetKey]:a.notifyBuilder}}}},{package:"@metamask/rpc-methods"}],[1234,{"@metamask/controllers":1060,"@metamask/snap-controllers":1250,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.invokeSnapBuilder=void 0;const n=e("@metamask/controllers"),i=e("@metamask/snap-controllers"),s=e("@metamask/utils"),o=e("eth-rpc-errors"),a=`${i.SNAP_PREFIX}*`;function c({getSnap:e,getSnapRpcHandler:t}){return async function(r){const{params:n=[],method:a,context:c}=r,u=n[0];if(!(0,s.isObject)(u))throw o.ethErrors.rpc.invalidParams({message:"Must specify snap RPC request object as single parameter."});const l=a.substr(i.SNAP_PREFIX.length);if(!e(l))throw o.ethErrors.rpc.invalidRequest({message:`The snap "${l}" is not installed. This is a bug, please report it.`});const d=await t(l);if(!d)throw o.ethErrors.rpc.methodNotFound({message:`Snap RPC message handler not found for snap "${l}".`});const f=c.origin;return await d(f,u)}}r.invokeSnapBuilder=Object.freeze({targetKey:a,specificationBuilder:({allowedCaveats:e=null,methodHooks:t})=>({permissionType:n.PermissionType.RestrictedMethod,targetKey:a,allowedCaveats:e,methodImplementation:c(t)}),methodHooks:{getSnap:!0,getSnapRpcHandler:!0}})}}},{package:"@metamask/rpc-methods"}],[1235,{"@metamask/controllers":1060,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ManageStateOperation=r.manageStateBuilder=void 0;const n=e("@metamask/controllers"),i=e("@metamask/utils"),s=e("eth-rpc-errors"),o="snap_manageState";var a;function c({clearSnapState:e,getSnapState:t,updateSnapState:r}){return async function(n){const{params:o=[],method:c,context:{origin:u}}=n,[l,d]=o;switch(l){case a.clearState:return await e(u),null;case a.getState:return await t(u);case a.updateState:if(!(0,i.isObject)(d))throw s.ethErrors.rpc.invalidParams({message:`Invalid ${c} "updateState" parameter: The new state must be a plain object.`,data:{receivedNewState:void 0===d?"undefined":d}});if(!(0,i.isValidJson)(d))throw s.ethErrors.rpc.invalidParams({message:`Invalid ${c} "updateState" parameter: The new state must be JSON serializable.`,data:{receivedNewState:void 0===d?"undefined":d}});return await r(u,d),null;default:throw s.ethErrors.rpc.invalidParams(`Invalid ${c} operation: "${l}"`)}}}r.manageStateBuilder=Object.freeze({targetKey:o,specificationBuilder:({allowedCaveats:e=null,methodHooks:t})=>({permissionType:n.PermissionType.RestrictedMethod,targetKey:o,allowedCaveats:e,methodImplementation:c(t)}),methodHooks:{clearSnapState:!0,getSnapState:!0,updateSnapState:!0}}),function(e){e.clearState="clear",e.getState="get",e.updateState="update"}(a=r.ManageStateOperation||(r.ManageStateOperation={}))}}},{package:"@metamask/rpc-methods"}],[1236,{"@metamask/controllers":1060,"@metamask/utils":1302,"eth-rpc-errors":2298},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.notifyBuilder=r.NotificationType=void 0;const n=e("@metamask/controllers"),i=e("@metamask/utils"),s=e("eth-rpc-errors"),o="snap_notify";var a;!function(e){e.native="native",e.inApp="inApp"}(a=r.NotificationType||(r.NotificationType={}));function c({showNativeNotification:e,showInAppNotification:t}){return async function(r){const{params:n,context:{origin:o}}=r,c=function(e){if(!Array.isArray(e)||!(0,i.isObject)(e[0]))throw s.ethErrors.rpc.invalidParams({message:"Expected array params with single object."});const{type:t,message:r}=e[0];if(!t||"string"!=typeof t||!Object.values(a).includes(t))throw s.ethErrors.rpc.invalidParams({message:'Must specify a valid notification "type".'});if(!r||"string"!=typeof r||r.length>=50)throw s.ethErrors.rpc.invalidParams({message:'Must specify a non-empty string "message" less than 50 characters long.'});return e[0]}(n);switch(c.type){case a.native:return await e(o,c);case a.inApp:return await t(o,c);default:throw s.ethErrors.rpc.invalidParams({message:'Must specify a valid notification "type".'})}}}r.notifyBuilder=Object.freeze({targetKey:o,specificationBuilder:({allowedCaveats:e=null,methodHooks:t})=>({permissionType:n.PermissionType.RestrictedMethod,targetKey:o,allowedCaveats:e,methodImplementation:c(t)}),methodHooks:{showNativeNotification:!0,showInAppNotification:!0}})}}},{package:"@metamask/rpc-methods"}],[1237,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.selectHooks=void 0,r.selectHooks=function(e,t){return t?Object.keys(t).reduce(((t,r)=>{const n=r;return t[n]=e[n],t}),{}):undefined}}}},{package:"@metamask/rpc-methods"}],[124,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:41,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=41;const r=t.data;return t.data=function(e){e.PreferencesController&&e.PreferencesController.preferences&&(e.PreferencesController.preferences.autoLockTimeLimit=e.PreferencesController.preferences.autoLogoutTimeLimit,delete e.PreferencesController.preferences.autoLogoutTimeLimit);return e}(r),t}};r.default=i}}},{package:"$root$"}],[1240,{"./constants":1241,"./types":1243,"./utils":1244,"@metamask/controllers":1060,"bignumber.js":1245,ethers:2397,"lodash/cloneDeep":4990,"lodash/mapValues":5017},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_INTERVAL=void 0;const i=e("@metamask/controllers"),s=e("bignumber.js"),o=e("ethers"),a=n(e("lodash/mapValues")),c=n(e("lodash/cloneDeep")),u=e("./types"),l=e("./utils"),d=e("./constants"),{safelyExecute:f}=i.util;r.DEFAULT_INTERVAL=5e3;class h extends i.BaseController{constructor({onNetworkStateChange:e,getNonceLock:t,getNetwork:n,provider:i,confirmExternalTransaction:s,trackMetaMetricsEvent:a},c,u){super(c,u),this.defaultConfig={interval:r.DEFAULT_INTERVAL,chainId:d.CHAIN_IDS.ETHEREUM,clientId:"default",supportedChainIds:[d.CHAIN_IDS.ETHEREUM,d.CHAIN_IDS.RINKEBY]},this.defaultState={smartTransactionsState:{smartTransactions:{},userOptIn:undefined,fees:{approvalTxFees:undefined,tradeTxFees:undefined},liveness:!0}},this.getNonceLock=t,this.getNetwork=n,this.ethersProvider=new o.ethers.providers.Web3Provider(i),this.confirmExternalTransaction=s,this.trackMetaMetricsEvent=a,this.initialize(),this.initializeSmartTransactionsForChainId(),e((({provider:e})=>{const{chainId:t}=e;this.configure({chainId:t}),this.initializeSmartTransactionsForChainId(),this.checkPoll(this.state),this.ethersProvider=new o.ethers.providers.Web3Provider(i)})),this.subscribe((e=>this.checkPoll(e)))}async fetch(e,t){const{clientId:r}=this.config,n=Object.assign(Object.assign({},t),{headers:Object.assign({"Content-Type":"application/json"},r&&{"X-Client-Id":r})});return l.handleFetch(e,n)}checkPoll(e){const{smartTransactions:t}=e.smartTransactionsState,r=t[this.config.chainId],n=null==r?void 0:r.filter(l.isSmartTransactionPending);!this.timeoutHandle&&(null==n?void 0:n.length)>0?this.poll():this.timeoutHandle&&0===(null==n?void 0:n.length)&&this.stop()}initializeSmartTransactionsForChainId(){var e;if(this.config.supportedChainIds.includes(this.config.chainId)){const{smartTransactionsState:t}=this.state;this.update({smartTransactionsState:Object.assign(Object.assign({},t),{smartTransactions:Object.assign(Object.assign({},t.smartTransactions),{[this.config.chainId]:null!==(e=t.smartTransactions[this.config.chainId])&&void 0!==e?e:[]})})})}}async poll(e){const{chainId:t,supportedChainIds:r}=this.config;e&&this.configure({interval:e},!1,!1),this.timeoutHandle&&clearInterval(this.timeoutHandle),r.includes(t)&&(await f((()=>this.updateSmartTransactions())),this.timeoutHandle=setInterval((()=>{f((()=>this.updateSmartTransactions()))}),this.config.interval))}async stop(){this.timeoutHandle&&clearInterval(this.timeoutHandle),this.timeoutHandle=undefined}setOptInState(e){this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{userOptIn:e})})}trackStxStatusChange(e,t){var r,n;if(!t)return;let i=c.default(e);if(i=Object.assign(Object.assign({},c.default(t)),i),!i.swapMetaData||i.status===t.status&&t.swapMetaData)return;const s={uuid:i.uuid,stx_status:i.status,token_from_address:null===(r=i.txParams)||void 0===r?void 0:r.from,token_from_symbol:i.sourceTokenSymbol,token_to_address:null===(n=i.txParams)||void 0===n?void 0:n.to,token_to_symbol:i.destinationTokenSymbol,processing_time:l.getStxProcessingTime(i.time),stx_enabled:!0,current_stx_enabled:!0,stx_user_opt_in:!0};this.trackMetaMetricsEvent({event:"STX Status Updated",category:"swaps",sensitiveProperties:s})}isNewSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:n}=r,i=n[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e));return-1===s||s===undefined}updateSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:n}=r,i=n[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e.uuid)),o=this.isNewSmartTransaction(e.uuid);if(this.trackStxStatusChange(e,o?undefined:i[s]),o){const n=i.findIndex((t=>{var r,n,i;return(null===(r=t.txParams)||void 0===r?void 0:r.nonce)===(null===(n=e.txParams)||void 0===n?void 0:n.nonce)&&(null===(i=t.status)||void 0===i?void 0:i.startsWith("cancelled"))})),s=[c.default(e)],o=Object.assign(Object.assign({},e),{history:s}),a=n>-1?i.slice(0,n).concat(i.slice(n+1)).concat(o):i.concat(o);this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[t]:a})})})}else{if((e.status===u.SmartTransactionStatuses.SUCCESS||e.status===u.SmartTransactionStatuses.REVERTED)&&!e.confirmed){const t=i[s],r=Object.assign(Object.assign({},t),e);this.confirmSmartTransaction(r)}this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[t]:r.smartTransactions[t].map(((t,r)=>r===s?Object.assign(Object.assign({},t),e):t))})})})}}async updateSmartTransactions(){const{smartTransactions:e}=this.state.smartTransactionsState,{chainId:t}=this.config,r=(null==e?void 0:e[t]).filter(l.isSmartTransactionPending).map((e=>e.uuid));r.length>0&&this.fetchSmartTransactionsStatus(r)}async confirmSmartTransaction(e){var t,r,n;const i=null===(t=e.statusMetadata)||void 0===t?void 0:t.minedHash;try{const t=await this.ethersProvider.getTransactionReceipt(i),s=await this.ethersProvider.getTransaction(i),c=null===(r=s.maxFeePerGas)||void 0===r?void 0:r.toHexString(),u=null===(n=s.maxPriorityFeePerGas)||void 0===n?void 0:n.toHexString();if(null==t?void 0:t.blockNumber){const r=await this.ethersProvider.getBlock(null==t?void 0:t.blockNumber,!1),n=null==r?void 0:r.baseFeePerGas.toHexString(),s=a.default(t,(e=>e instanceof o.ethers.BigNumber?e.toHexString():e)),d=Object.assign(Object.assign({},e.txParams),{maxFeePerGas:c,maxPriorityFeePerGas:u}),f=Object.assign(Object.assign({},e),{id:e.uuid,status:"confirmed",hash:i,txParams:d}),h=l.snapshotFromTxMeta(f),p=l.replayHistory(f.history),m=l.generateHistoryEntry(p,h,"txStateManager: setting status to confirmed"),g=m.length>0?Object.assign(Object.assign({},f),{history:f.history.concat(m)}):f;this.confirmExternalTransaction(g,s,n),this.trackMetaMetricsEvent({event:"STX Confirmed",category:"swaps"}),this.updateSmartTransaction(Object.assign(Object.assign({},e),{confirmed:!0}))}}catch(e){this.trackMetaMetricsEvent({event:"STX Confirmation Failed",category:"swaps"}),console.error("confirm error",e)}}async fetchSmartTransactionsStatus(e){const{chainId:t}=this.config,r=new URLSearchParams({uuids:e.join(",")}),n=`${l.getAPIRequestURL(u.APIType.BATCH_STATUS,t)}?${r.toString()}`,i=await this.fetch(n);return Object.entries(i).forEach((([e,t])=>{this.updateSmartTransaction({statusMetadata:t,status:l.calculateStatus(t),cancellable:l.isSmartTransactionCancellable(t),uuid:e})})),i}async addNonceToTransaction(e){const t=await this.getNonceLock(e.from),r=t.nextNonce;return t.releaseLock(),Object.assign(Object.assign({},e),{nonce:`0x${r.toString(16)}`})}async getFees(e,t){const{chainId:r}=this.config,n=[];let i;if(t){const r=await this.addNonceToTransaction(t);n.push(r),i=Object.assign(Object.assign({},e),{nonce:l.incrementNonceInHex(r.nonce)})}else i=await this.addNonceToTransaction(e);n.push(i);const s=await this.fetch(l.getAPIRequestURL(u.APIType.GET_FEES,r),{method:"POST",body:JSON.stringify({txs:n})});let o,a;return t?(o=null==s?void 0:s.txs[0],a=null==s?void 0:s.txs[1]):a=null==s?void 0:s.txs[0],this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{fees:{approvalTxFees:o,tradeTxFees:a}})}),{approvalTxFees:o,tradeTxFees:a}}async submitSignedTransactions({txParams:e,signedTransactions:t,signedCanceledTransactions:r}){const{chainId:n}=this.config,i=await this.fetch(l.getAPIRequestURL(u.APIType.SUBMIT_TRANSACTIONS,n),{method:"POST",body:JSON.stringify({rawTxs:t,rawCancelTxs:r})}),a=Date.now(),c=this.getNetwork();let d;try{const t=await this.ethersProvider.getBalance(null==e?void 0:e.from);d=new s.BigNumber(t.toHexString()).toString(16)}catch(e){console.error("ethers error",e)}const f=await this.getNonceLock(null==e?void 0:e.from),h=o.ethers.utils.hexlify(f.nextNonce);e&&!(null==e?void 0:e.nonce)&&(e.nonce=h);const{nonceDetails:p}=f;return this.updateSmartTransaction({chainId:n,nonceDetails:p,metamaskNetworkId:c,preTxBalance:d,status:u.SmartTransactionStatuses.PENDING,time:a,txParams:e,uuid:i.uuid,cancellable:!0}),f.releaseLock(),i}async cancelSmartTransaction(e){const{chainId:t}=this.config;await this.fetch(l.getAPIRequestURL(u.APIType.CANCEL,t),{method:"POST",body:JSON.stringify({uuid:e})})}async fetchLiveness(){const{chainId:e}=this.config;let t=!1;try{const r=await this.fetch(l.getAPIRequestURL(u.APIType.LIVENESS,e));t=Boolean(r.lastBlock)}catch(e){console.log('"fetchLiveness" API call failed')}return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{liveness:t})}),t}async setStatusRefreshInterval(e){e!==this.config.interval&&this.configure({interval:e},!1,!1)}getTransactions({addressFrom:e,status:t}){const{smartTransactions:r}=this.state.smartTransactionsState,{chainId:n}=this.config,i=null==r?void 0:r[n];return i&&0!==i.length?i.filter((r=>{var n;return r.status===t&&(null===(n=r.txParams)||void 0===n?void 0:n.from)===e})):[]}}r.default=h}}},{package:"@metamask/smart-transactions-controller"}],[1241,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CHAIN_IDS=r.API_BASE_URL=void 0,r.API_BASE_URL="https://transaction.metaswap.codefi.network",r.CHAIN_IDS={ETHEREUM:"0x1",RINKEBY:"0x4",BSC:"0x38"}}}},{package:"@metamask/smart-transactions-controller"}],[1242,{"./SmartTransactionsController":1240,"isomorphic-fetch":4586},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),e("isomorphic-fetch");const i=n(e("./SmartTransactionsController"));r.default=i.default}}},{package:"@metamask/smart-transactions-controller"}],[1243,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.cancellationReasonToStatusMap=r.SmartTransactionStatuses=r.SmartTransactionCancellationReason=r.SmartTransactionMinedTx=r.APIType=void 0,function(e){e[e.GET_FEES=0]="GET_FEES",e[e.ESTIMATE_GAS=1]="ESTIMATE_GAS",e[e.SUBMIT_TRANSACTIONS=2]="SUBMIT_TRANSACTIONS",e[e.CANCEL=3]="CANCEL",e[e.BATCH_STATUS=4]="BATCH_STATUS",e[e.LIVENESS=5]="LIVENESS"}(r.APIType||(r.APIType={})),function(e){e.NOT_MINED="not_mined",e.SUCCESS="success",e.CANCELLED="cancelled",e.REVERTED="reverted",e.UNKNOWN="unknown"}(r.SmartTransactionMinedTx||(r.SmartTransactionMinedTx={})),function(e){e.WOULD_REVERT="would_revert",e.TOO_CHEAP="too_cheap",e.DEADLINE_MISSED="deadline_missed",e.INVALID_NONCE="invalid_nonce",e.USER_CANCELLED="user_cancelled",e.NOT_CANCELLED="not_cancelled",e.PREVIOUS_TX_CANCELLED="previous_tx_cancelled"}(n=r.SmartTransactionCancellationReason||(r.SmartTransactionCancellationReason={})),function(e){e.PENDING="pending",e.SUCCESS="success",e.REVERTED="reverted",e.UNKNOWN="unknown",e.CANCELLED="cancelled",e.CANCELLED_WOULD_REVERT="cancelled_would_revert",e.CANCELLED_TOO_CHEAP="cancelled_too_cheap",e.CANCELLED_DEADLINE_MISSED="cancelled_deadline_missed",e.CANCELLED_INVALID_NONCE="cancelled_invalid_nonce",e.CANCELLED_USER_CANCELLED="cancelled_user_cancelled",e.CANCELLED_PREVIOUS_TX_CANCELLED="cancelled_previous_tx_cancelled",e.RESOLVED="resolved"}(i=r.SmartTransactionStatuses||(r.SmartTransactionStatuses={})),r.cancellationReasonToStatusMap={[n.WOULD_REVERT]:i.CANCELLED_WOULD_REVERT,[n.TOO_CHEAP]:i.CANCELLED_TOO_CHEAP,[n.DEADLINE_MISSED]:i.CANCELLED_DEADLINE_MISSED,[n.INVALID_NONCE]:i.CANCELLED_INVALID_NONCE,[n.USER_CANCELLED]:i.CANCELLED_USER_CANCELLED,[n.PREVIOUS_TX_CANCELLED]:i.CANCELLED_PREVIOUS_TX_CANCELLED}}}},{package:"@metamask/smart-transactions-controller"}],[1244,{"./constants":1241,"./types":1243,"bignumber.js":1245,ethers:2397,"fast-json-patch":1249,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.incrementNonceInHex=r.isSmartTransactionCancellable=r.handleFetch=r.getStxProcessingTime=r.snapshotFromTxMeta=r.replayHistory=r.generateHistoryEntry=r.calculateStatus=r.getAPIRequestURL=r.isSmartTransactionStatusResolved=r.isSmartTransactionPending=void 0;const i=n(e("fast-json-patch")),s=e("lodash"),o=e("bignumber.js"),a=e("ethers"),c=e("./types"),u=e("./constants");r.isSmartTransactionPending=function(e){return e.status===c.SmartTransactionStatuses.PENDING};r.isSmartTransactionStatusResolved=e=>"uuid_not_found"===e,r.getAPIRequestURL=function(e,t){const r=parseInt(t,16);switch(e){case c.APIType.GET_FEES:return`${u.API_BASE_URL}/networks/${r}/getFees`;case c.APIType.ESTIMATE_GAS:return`${u.API_BASE_URL}/networks/${r}/estimateGas`;case c.APIType.SUBMIT_TRANSACTIONS:return`${u.API_BASE_URL}/networks/${r}/submitTransactions`;case c.APIType.CANCEL:return`${u.API_BASE_URL}/networks/${r}/cancel`;case c.APIType.BATCH_STATUS:return`${u.API_BASE_URL}/networks/${r}/batchStatus`;case c.APIType.LIVENESS:return`${u.API_BASE_URL}/networks/${r}/health`;default:throw new Error("Invalid APIType")}};r.calculateStatus=e=>{if(r.isSmartTransactionStatusResolved(e))return c.SmartTransactionStatuses.RESOLVED;const t=[c.SmartTransactionCancellationReason.WOULD_REVERT,c.SmartTransactionCancellationReason.TOO_CHEAP,c.SmartTransactionCancellationReason.DEADLINE_MISSED,c.SmartTransactionCancellationReason.INVALID_NONCE,c.SmartTransactionCancellationReason.USER_CANCELLED,c.SmartTransactionCancellationReason.PREVIOUS_TX_CANCELLED];if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.NOT_MINED){if(e.cancellationReason===c.SmartTransactionCancellationReason.NOT_CANCELLED)return c.SmartTransactionStatuses.PENDING;const r=t.findIndex((t=>t===e.cancellationReason))>-1;if(e.cancellationReason&&r)return c.cancellationReasonToStatusMap[e.cancellationReason]}else{if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.SUCCESS)return c.SmartTransactionStatuses.SUCCESS;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.CANCELLED)return c.SmartTransactionStatuses.CANCELLED;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.REVERTED)return c.SmartTransactionStatuses.REVERTED;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.UNKNOWN)return c.SmartTransactionStatuses.UNKNOWN}return c.SmartTransactionStatuses.UNKNOWN},r.generateHistoryEntry=function(e,t,r){const n=i.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n},r.replayHistory=function(e){return s.cloneDeep(e).reduce(((e,t)=>i.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t=Object.assign({},e);return delete t.history,s.cloneDeep(t)};r.getStxProcessingTime=e=>e?Math.round((Date.now()-e)/1e3):undefined,r.handleFetch=async function(e,t){const r=await fetch(e,t),n=await r.json();if(!r.ok){const{error:e,error_details:t}=n;throw console.log("response",r),new Error(`Fetch error:${JSON.stringify({status:r.status,type:e,message:t})}`)}return n};r.isSmartTransactionCancellable=e=>e.minedTx===c.SmartTransactionMinedTx.NOT_MINED&&(!e.cancellationReason||e.cancellationReason===c.SmartTransactionCancellationReason.NOT_CANCELLED);r.incrementNonceInHex=e=>{const t=new o.BigNumber(e,16).toString(10);return a.ethers.utils.hexlify(Number(t)+1)}}}},{package:"@metamask/smart-transactions-controller"}],[1245,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,l=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,h=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=u-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function y(e,t,r,n){if(e<t||e>r||e!==s(e))throw Error(o+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,_,S,E,k,P,T,A,O,x,I=F.prototype={constructor:F,toString:null,valueOf:null},j=new F(1),N=20,R=4,C=-7,M=21,B=-1e7,D=1e7,L=!1,U=1,H=0,K={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},$="0123456789abcdefghijklmnopqrstuvwxyz";function F(e,t){var r,i,o,c,d,f,h,p,m=this;if(!(m instanceof F))return new F(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>D?m.c=m.e=null:e.e<B?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((f="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,d=e;d>=10;d/=10,c++);return void(c>D?m.c=m.e=null:(m.e=c,m.c=[e]))}p=String(e)}else{if(!n.test(p=String(e)))return S(m,p,f);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(d=p.search(/e/i))>0?(c<0&&(c=d),c+=+p.slice(d+1),p=p.substring(0,d)):c<0&&(c=p.length)}else{if(y(t,2,$.length,"Base"),10==t)return W(m=new F(e),N+m.e+1,R);if(p=String(e),f="number"==typeof e){if(0*e!=0)return S(m,p,f,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,F.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=$.slice(0,t),c=d=0,h=p.length;d<h;d++)if(r.indexOf(i=p.charAt(d))<0){if("."==i){if(d>c){c=h;continue}}else if(!o&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){o=!0,d=-1,c=0;continue}return S(m,String(e),f,t)}f=!1,(c=(p=_(p,t,10,m.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(d=0;48===p.charCodeAt(d);d++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(d,++h)){if(h-=d,f&&F.DEBUG&&h>15&&(e>l||e!==s(e)))throw Error(a+m.s*e);if((c=c-d-1)>D)m.c=m.e=null;else if(c<B)m.c=[m.e=0];else{if(m.e=c,m.c=[],d=(c+1)%u,c<0&&(d+=u),d<h){for(d&&m.c.push(+p.slice(0,d)),h-=u;d<h;)m.c.push(+p.slice(d,d+=u));d=u-(p=p.slice(d)).length}else d-=h;for(;d--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function q(e,t,r,n){var i,s,o,a,c;if(null==r?r=R:y(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=m(e.c),c=1==n||2==n&&(o<=C||o>=M)?w(c,o):v(c,o,"0");else if(s=(e=W(new F(e),t,r)).e,a=(c=m(e.c)).length,1==n||2==n&&(t<=s||s<=C)){for(;a<t;c+="0",a++);c=w(c,s)}else if(t-=o,c=v(c,s,"0"),s+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-a)>0)for(s+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function V(e,t){for(var r,n=1,i=new F(e[0]);n<e.length;n++){if(!(r=new F(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function z(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*u-1)>D?e.c=e.e=null:r<B?e.c=[e.e=0]:(e.e=r,e.c=t),e}function W(e,t,r,n){var o,a,l,f,h,p,m,g=e.c,y=d;if(g){e:{for(o=1,f=g[0];f>=10;f/=10,o++);if((a=t-o)<0)a+=u,l=t,m=(h=g[p=0])/y[o-l-1]%10|0;else if((p=i((a+1)/u))>=g.length){if(!n)break e;for(;g.length<=p;g.push(0));h=m=0,o=1,l=(a%=u)-u+1}else{for(h=f=g[p],o=1;f>=10;f/=10,o++);m=(l=(a%=u)-u+o)<0?0:h/y[o-l-1]%10|0}if(n=n||t<0||null!=g[p+1]||(l<0?h:h%y[o-l-1]),n=r<4?(m||n)&&(0==r||r==(e.s<0?3:2)):m>5||5==m&&(4==r||n||6==r&&(a>0?l>0?h/y[o-l]:0:g[p-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,n?(t-=e.e+1,g[0]=y[(u-t%u)%u],e.e=-t||0):g[0]=e.e=0,e;if(0==a?(g.length=p,f=1,p--):(g.length=p+1,f=y[u-a],g[p]=l>0?s(h/y[o-l]%y[l])*f:0),n)for(;;){if(0==p){for(a=1,l=g[0];l>=10;l/=10,a++);for(l=g[0]+=f,f=1;l>=10;l/=10,f++);a!=f&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=f,g[p]!=c)break;g[p--]=0,f=1}for(a=g.length;0===g[--a];g.pop());}e.e>D?e.c=e.e=null:e.e<B&&(e.c=[e.e=0])}return e}function G(e){var t,r=e.e;return null===r?e.toString():(t=m(e.c),t=r<=C||r>=M?w(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return F.clone=e,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(y(r=e[t],0,h,t),N=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(y(r=e[t],0,8,t),R=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(y(r[0],-h,0,t),y(r[1],0,h,t),C=r[0],M=r[1]):(y(r,-h,h,t),C=-(M=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)y(r[0],-h,-1,t),y(r[1],1,h,t),B=r[0],D=r[1];else{if(y(r,-h,h,t),!r)throw Error(o+t+" cannot be zero: "+r);B=-(D=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(o+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!r,Error(o+"crypto unavailable");L=r}else L=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(y(r=e[t],0,9,t),U=r),e.hasOwnProperty(t="POW_PRECISION")&&(y(r=e[t],0,h,t),H=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(o+t+" not an object: "+r);K=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+t+" invalid: "+r);$=r}}return{DECIMAL_PLACES:N,ROUNDING_MODE:R,EXPONENTIAL_AT:[C,M],RANGE:[B,D],CRYPTO:L,MODULO_MODE:U,POW_PRECISION:H,FORMAT:K,ALPHABET:$}},F.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!F.DEBUG)return!0;var t,r,n=e.c,i=e.e,a=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===a||-1===a)&&i>=-h&&i<=h&&i===s(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%u)<1&&(t+=u),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=c||r!==s(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===a||1===a||-1===a))return!0;throw Error(o+"Invalid BigNumber: "+e)},F.maximum=F.max=function(){return V(arguments,I.lt)},F.minimum=F.min=function(){return V(arguments,I.gt)},F.random=(E=9007199254740992,k=Math.random()*E&2097151?function(){return s(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,a,c,l=0,f=[],p=new F(j);if(null==e?e=N:y(e,0,h),a=i(e/u),L)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)(c=131072*t[l]+(t[l+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[l]=r[0],t[l+1]=r[1]):(f.push(c%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw L=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);l<a;)(c=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(f.push(c%1e14),l+=7);l=a/7}if(!L)for(;l<a;)(c=k())<9e15&&(f[l++]=c%1e14);for(a=f[--l],e%=u,a&&e&&(c=d[u-e],f[l]=s(a/c)*c);0===f[l];f.pop(),l--);if(l<0)f=[n=0];else{for(n=-1;0===f[0];f.splice(0,1),n-=u);for(l=1,c=f[0];c>=10;c/=10,l++);l<u&&(n-=u-l)}return p.e=n,p.c=f,p}),F.sum=function(){for(var e=1,t=arguments,r=new F(t[0]);e<t.length;)r=r.plus(t[e++]);return r},_=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,l,d,f,h,p,g,y=n.indexOf("."),b=N,w=R;for(y>=0&&(d=H,H=0,n=n.replace(".",""),h=(g=new F(i)).pow(n.length-y),H=d,g.c=t(v(m(h.c),h.e,"0"),10,s,e),g.e=g.c.length),l=d=(p=t(n,i,s,a?(c=$,e):(c=e,$))).length;0==p[--d];p.pop());if(!p[0])return c.charAt(0);if(y<0?--l:(h.c=p,h.e=l,h.s=o,p=(h=r(h,g,b,w,s)).c,f=h.r,l=h.e),y=p[u=l+b+1],d=s/2,f=f||u<0||null!=p[u+1],f=w<4?(null!=y||f)&&(0==w||w==(h.s<0?3:2)):y>d||y==d&&(4==w||f||6==w&&1&p[u-1]||w==(h.s<0?8:7)),u<1||!p[0])n=f?v(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(p.length=u,f)for(--s;++p[--u]>s;)p[u]=0,u||(++l,p=[1].concat(p));for(d=p.length;!p[--d];);for(y=0,n="";y<=d;n+=c.charAt(p[y++]));n=v(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,u=t%f,l=t/f|0;for(e=e.slice();c--;)a=((i=u*(s=e[c]%f)+(n=l*s+(o=e[c]/f|0)*u)%f*f+a)/r|0)+(n/f|0)+l*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,o,a,l){var d,f,h,m,g,y,b,w,v,_,S,E,k,P,T,A,O,x=n.s==i.s?1:-1,I=n.c,j=i.c;if(!(I&&I[0]&&j&&j[0]))return new F(n.s&&i.s&&(I?!j||I[0]!=j[0]:j)?I&&0==I[0]||!j?0*x:x/0:NaN);for(v=(w=new F(x)).c=[],x=o+(f=n.e-i.e)+1,l||(l=c,f=p(n.e/u)-p(i.e/u),x=x/u|0),h=0;j[h]==(I[h]||0);h++);if(j[h]>(I[h]||0)&&f--,x<0)v.push(1),m=!0;else{for(P=I.length,A=j.length,h=0,x+=2,(g=s(l/(j[0]+1)))>1&&(j=e(j,g,l),I=e(I,g,l),A=j.length,P=I.length),k=A,S=(_=I.slice(0,A)).length;S<A;_[S++]=0);O=j.slice(),O=[0].concat(O),T=j[0],j[1]>=l/2&&T++;do{if(g=0,(d=t(j,_,A,S))<0){if(E=_[0],A!=S&&(E=E*l+(_[1]||0)),(g=s(E/T))>1)for(g>=l&&(g=l-1),b=(y=e(j,g,l)).length,S=_.length;1==t(y,_,b,S);)g--,r(y,A<b?O:j,b,l),b=y.length,d=1;else 0==g&&(d=g=1),b=(y=j.slice()).length;if(b<S&&(y=[0].concat(y)),r(_,y,S,l),S=_.length,-1==d)for(;t(j,_,A,S)<1;)g++,r(_,A<S?O:j,S,l),S=_.length}else 0===d&&(g++,_=[0]);v[h++]=g,_[0]?_[S++]=I[k]||0:(_=[I[k]],S=1)}while((k++<P||null!=_[0])&&x--);m=null!=_[0],v[0]||v.splice(0,1)}if(l==c){for(h=1,x=v[0];x>=10;x/=10,h++);W(w,o+(w.e=h+f*u-1)+1,a,m)}else w.e=f,w.r=+m;return w}}(),P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,A=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(e,t,r,n){var i,s=r?t:t.replace(x,"");if(O.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(P,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(T,"$1").replace(A,"0.$1")),t!=s))return new F(s,i);if(F.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},I.absoluteValue=I.abs=function(){var e=new F(this);return e.s<0&&(e.s=1),e},I.comparedTo=function(e,t){return g(this,new F(e,t))},I.decimalPlaces=I.dp=function(e,t){var r,n,i,s=this;if(null!=e)return y(e,0,h),null==t?t=R:y(t,0,8),W(new F(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-p(this.e/u))*u,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},I.dividedBy=I.div=function(e,t){return r(this,new F(e,t),N,R)},I.dividedToIntegerBy=I.idiv=function(e,t){return r(this,new F(e,t),0,1)},I.exponentiatedBy=I.pow=function(e,t){var r,n,a,c,l,d,f,h,p=this;if((e=new F(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+G(e));if(null!=t&&(t=new F(t)),l=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return h=new F(Math.pow(+G(p),l?2-b(e):+G(e))),t?h.mod(t):h;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new F(NaN);(n=!d&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return c=p.s<0&&b(e)?-0:0,p.e>-1&&(c=1/c),new F(d?1/c:c);H&&(c=i(H/u+2))}for(l?(r=new F(.5),d&&(e.s=1),f=b(e)):f=(a=Math.abs(+G(e)))%2,h=new F(j);;){if(f){if(!(h=h.times(p)).c)break;c?h.c.length>c&&(h.c.length=c):n&&(h=h.mod(t))}if(a){if(0===(a=s(a/2)))break;f=a%2}else if(W(e=e.times(r),e.e+1,1),e.e>14)f=b(e);else{if(0===(a=+G(e)))break;f=a%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):n&&(p=p.mod(t))}return n?h:(d&&(h=j.div(h)),t?h.mod(t):c?W(h,H,R,undefined):h)},I.integerValue=function(e){var t=new F(this);return null==e?e=R:y(e,0,8),W(t,t.e+1,e)},I.isEqualTo=I.eq=function(e,t){return 0===g(this,new F(e,t))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(e,t){return g(this,new F(e,t))>0},I.isGreaterThanOrEqualTo=I.gte=function(e,t){return 1===(t=g(this,new F(e,t)))||0===t},I.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},I.isLessThan=I.lt=function(e,t){return g(this,new F(e,t))<0},I.isLessThanOrEqualTo=I.lte=function(e,t){return-1===(t=g(this,new F(e,t)))||0===t},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new F(e,t)).s,!a||!t)return new F(NaN);if(a!=t)return e.s=-t,o.plus(e);var l=o.e/u,d=e.e/u,f=o.c,h=e.c;if(!l||!d){if(!f||!h)return f?(e.s=-t,e):new F(h?o:NaN);if(!f[0]||!h[0])return h[0]?(e.s=-t,e):new F(f[0]?o:3==R?-0:0)}if(l=p(l),d=p(d),f=f.slice(),a=l-d){for((s=a<0)?(a=-a,i=f):(d=l,i=h),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=f.length)<(t=h.length))?a:t,a=t=0;t<n;t++)if(f[t]!=h[t]){s=f[t]<h[t];break}if(s&&(i=f,f=h,h=i,e.s=-e.s),(t=(n=h.length)-(r=f.length))>0)for(;t--;f[r++]=0);for(t=c-1;n>a;){if(f[--n]<h[n]){for(r=n;r&&!f[--r];f[r]=t);--f[r],f[n]+=c}f[n]-=h[n]}for(;0==f[0];f.splice(0,1),--d);return f[0]?z(e,f,d):(e.s=3==R?-1:1,e.c=[e.e=0],e)},I.modulo=I.mod=function(e,t){var n,i,s=this;return e=new F(e,t),!s.c||!e.s||e.c&&!e.c[0]?new F(NaN):!e.c||s.c&&!s.c[0]?new F(s):(9==U?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,U),(e=s.minus(n.times(e))).c[0]||1!=U||(e.s=s.s),e)},I.multipliedBy=I.times=function(e,t){var r,n,i,s,o,a,l,d,h,m,g,y,b,w,v,_=this,S=_.c,E=(e=new F(e,t)).c;if(!(S&&E&&S[0]&&E[0]))return!_.s||!e.s||S&&!S[0]&&!E||E&&!E[0]&&!S?e.c=e.e=e.s=null:(e.s*=_.s,S&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(_.e/u)+p(e.e/u),e.s*=_.s,(l=S.length)<(m=E.length)&&(b=S,S=E,E=b,i=l,l=m,m=i),i=l+m,b=[];i--;b.push(0));for(w=c,v=f,i=m;--i>=0;){for(r=0,g=E[i]%v,y=E[i]/v|0,s=i+(o=l);s>i;)r=((d=g*(d=S[--o]%v)+(a=y*d+(h=S[o]/v|0)*g)%v*v+b[s]+r)/w|0)+(a/v|0)+y*h,b[s--]=d%w;b[s]=r}return r?++n:b.splice(0,1),z(e,b,n)},I.negated=function(){var e=new F(this);return e.s=-e.s||null,e},I.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new F(e,t)).s,!i||!t)return new F(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/u,o=e.e/u,a=n.c,l=e.c;if(!s||!o){if(!a||!l)return new F(i/0);if(!a[0]||!l[0])return l[0]?e:new F(a[0]?n:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=l):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=l.length)<0&&(r=l,l=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+l[t]+i)/c|0,a[t]=c===a[t]?0:a[t]%c;return i&&(a=[i].concat(a),++o),z(e,a,o)},I.precision=I.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return y(e,1,h),null==t?t=R:y(t,0,8),W(new F(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*u+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},I.shiftedBy=function(e){return y(e,-9007199254740991,l),this.times("1e"+e)},I.squareRoot=I.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,u=o.e,l=N+4,d=new F("0.5");if(1!==c||!a||!a[0])return new F(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+G(o)))||c==1/0?(((t=m(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),n=new F(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new F(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(s=n,n=d.times(s.plus(r(o,s,l,1))),m(s.c).slice(0,c)===(t=m(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(W(n,n.e+N+2,1),e=!n.times(n).eq(o));break}if(!i&&(W(s,s.e+N+2,0),s.times(s).eq(o))){n=s;break}l+=4,c+=4,i=1}return W(n,n.e+N+1,R,e)},I.toExponential=function(e,t){return null!=e&&(y(e,0,h),e++),q(this,e,t,1)},I.toFixed=function(e,t){return null!=e&&(y(e,0,h),e=e+this.e+1),q(this,e,t)},I.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=K;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",d=a[0],f=a[1],h=i.s<0,p=h?d.slice(1):d,m=p.length;if(u&&(s=c,c=u,u=s,m-=s),c>0&&m>0){for(s=m%c||c,d=p.substr(0,s);s<m;s+=c)d+=l+p.substr(s,c);u>0&&(d+=l+p.slice(s)),h&&(d="-"+d)}n=f?d+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):d}return(r.prefix||"")+n+(r.suffix||"")},I.toFraction=function(e){var t,n,i,s,a,c,l,f,h,p,g,y,b=this,w=b.c;if(null!=e&&(!(l=new F(e)).isInteger()&&(l.c||1!==l.s)||l.lt(j)))throw Error(o+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+G(l));if(!w)return new F(b);for(t=new F(j),h=n=new F(j),i=f=new F(j),y=m(w),a=t.e=y.length-b.e-1,t.c[0]=d[(c=a%u)<0?u+c:c],e=!e||l.comparedTo(t)>0?a>0?t:h:l,c=D,D=1/0,l=new F(y),f.c[0]=0;p=r(l,t,0,1),1!=(s=n.plus(p.times(i))).comparedTo(e);)n=i,i=s,h=f.plus(p.times(s=h)),f=s,t=l.minus(p.times(s=t)),l=s;return s=r(e.minus(n),i,0,1),f=f.plus(s.times(h)),n=n.plus(s.times(i)),f.s=h.s=b.s,g=r(h,i,a*=2,R).minus(b).abs().comparedTo(r(f,n,a,R).minus(b).abs())<1?[h,i]:[f,n],D=c,g},I.toNumber=function(){return+G(this)},I.toPrecision=function(e,t){return null!=e&&y(e,1,h),q(this,e,t,2)},I.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=C||i>=M?w(m(r.c),i):v(m(r.c),i,"0"):10===e?t=v(m((r=W(new F(r),N+i+1,R)).c),r.e,"0"):(y(e,2,$.length,"Base"),t=_(v(m(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},I.valueOf=I.toJSON=function(){return G(this)},I._isBigNumber=!0,null!=t&&F.set(t),F}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"@metamask/smart-transactions-controller>bignumber.js"}],[1246,{"./helpers.js":1248},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./helpers.js");r.JsonPatchError=n.PatchError,r.deepClone=n._deepClone;var i={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var i=o(r,this.path);i&&(i=n._deepClone(i));var s=a(r,{op:"remove",path:this.from}).removed;return a(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:i}},copy:function(e,t,r){var i=o(r,this.from);return a(r,{op:"add",path:this.path,value:n._deepClone(i)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:d(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},s={add:function(e,t,r){return n.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:i.move,copy:i.copy,test:i.test,_get:i._get};function o(e,t){if(""==t)return e;var r={op:"_get",path:t};return a(e,r),r.value}function a(e,t,a,c,l,f){if(void 0===a&&(a=!1),void 0===c&&(c=!0),void 0===l&&(l=!0),void 0===f&&(f=0),a&&("function"==typeof a?a(t,0,e,t.path):u(t,0)),""===t.path){var h={newDocument:e};if("add"===t.op)return h.newDocument=t.value,h;if("replace"===t.op)return h.newDocument=t.value,h.removed=e,h;if("move"===t.op||"copy"===t.op)return h.newDocument=o(e,t.from),"move"===t.op&&(h.removed=e),h;if("test"===t.op){if(h.test=d(e,t.value),!1===h.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return h.newDocument=e,h}if("remove"===t.op)return h.removed=e,h.newDocument=null,h;if("_get"===t.op)return t.value=e,h;if(a)throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",f,t,e);return h}c||(e=n._deepClone(e));var p=(t.path||"").split("/"),m=e,g=1,y=p.length,b=undefined,w=void 0,v=void 0;for(v="function"==typeof a?a:u;;){if((w=p[g])&&-1!=w.indexOf("~")&&(w=n.unescapePathComponent(w)),l&&"__proto__"==w)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(a&&b===undefined&&(m[w]===undefined?b=p.slice(0,g).join("/"):g==y-1&&(b=t.path),b!==undefined&&v(t,0,e,b)),g++,Array.isArray(m)){if("-"===w)w=m.length;else{if(a&&!n.isInteger(w))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",f,t,e);n.isInteger(w)&&(w=~~w)}if(g>=y){if(a&&"add"===t.op&&w>m.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",f,t,e);if(!1===(h=s[t.op].call(t,m,w,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return h}}else if(g>=y){if(!1===(h=i[t.op].call(t,m,w,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,t,e);return h}if(m=m[w],a&&g<y&&(!m||"object"!=typeof m))throw new r.JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",f,t,e)}}function c(e,t,i,s,o){if(void 0===s&&(s=!0),void 0===o&&(o=!0),i&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");s||(e=n._deepClone(e));for(var c=new Array(t.length),u=0,l=t.length;u<l;u++)c[u]=a(e,t[u],i,!0,o,u),e=c[u].newDocument;return c.newDocument=e,c}function u(e,t,s,o){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,s);if(!i[e.op])throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,s);if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,s);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,s);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,s);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&e.value===undefined)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,s);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&n.hasUndefined(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,s);if(s)if("add"==e.op){var a=e.path.split("/").length,c=o.split("/").length;if(a!==c+1&&a!==c)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,s)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,s)}else if("move"===e.op||"copy"===e.op){var u=l([{op:"_get",path:e.from,value:undefined}],s);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,s)}}function l(e,t,i){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)c(n._deepClone(t),n._deepClone(e),i||!0);else{i=i||u;for(var s=0;s<e.length;s++)i(e[s],s,t,undefined)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}function d(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,i,s=Array.isArray(e),o=Array.isArray(t);if(s&&o){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!d(e[r],t[r]))return!1;return!0}if(s!=o)return!1;var a=Object.keys(e);if((n=a.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=n;0!=r--;)if(!d(e[i=a[r]],t[i]))return!1;return!0}return e!=e&&t!=t}r.getValueByPointer=o,r.applyOperation=a,r.applyPatch=c,r.applyReducer=function(e,t,n){var i=a(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument},r.validator=u,r.validate=l,r._areEquals=d}}},{package:"@metamask/smart-transactions-controller>fast-json-patch"}],[1247,{"./core.js":1246,"./helpers.js":1248},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n=e("./helpers.js"),i=e("./core.js"),s=new WeakMap,o=function(e){this.observers=new Map,this.obj=e},a=function(e,t){this.callback=e,this.observer=t};function c(e,t){void 0===t&&(t=!1);var r=s.get(e.object);u(r.value,e.object,e.patches,"",t),e.patches.length&&i.applyPatch(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function u(e,t,r,i,s){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=n._objectKeys(t),a=n._objectKeys(e),c=!1,l=a.length-1;l>=0;l--){var d=e[h=a[l]];if(!n.hasOwnProperty(t,h)||t[h]===undefined&&d!==undefined&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(s&&r.push({op:"test",path:i+"/"+n.escapePathComponent(h),value:n._deepClone(d)}),r.push({op:"remove",path:i+"/"+n.escapePathComponent(h)}),c=!0):(s&&r.push({op:"test",path:i,value:e}),r.push({op:"replace",path:i,value:t}),!0);else{var f=t[h];"object"==typeof d&&null!=d&&"object"==typeof f&&null!=f&&Array.isArray(d)===Array.isArray(f)?u(d,f,r,i+"/"+n.escapePathComponent(h),s):d!==f&&(!0,s&&r.push({op:"test",path:i+"/"+n.escapePathComponent(h),value:n._deepClone(d)}),r.push({op:"replace",path:i+"/"+n.escapePathComponent(h),value:n._deepClone(f)}))}}if(c||o.length!=a.length)for(l=0;l<o.length;l++){var h=o[l];n.hasOwnProperty(e,h)||t[h]===undefined||r.push({op:"add",path:i+"/"+n.escapePathComponent(h),value:n._deepClone(t[h])})}}}r.unobserve=function(e,t){t.unobserve()},r.observe=function(e,t){var r,i=function(e){return s.get(e)}(e);if(i){var u=function(e,t){return e.observers.get(t)}(i,t);r=u&&u.observer}else i=new o(e),s.set(e,i);if(r)return r;if(r={},i.value=n._deepClone(e),t){r.callback=t,r.next=null;var l=function(){c(r)},d=function(){clearTimeout(r.next),r.next=setTimeout(l)};"undefined"!=typeof window&&(window.addEventListener("mouseup",d),window.addEventListener("keyup",d),window.addEventListener("mousedown",d),window.addEventListener("keydown",d),window.addEventListener("change",d))}return r.patches=[],r.object=e,r.unobserve=function(){c(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(i,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",d),window.removeEventListener("keyup",d),window.removeEventListener("mousedown",d),window.removeEventListener("keydown",d),window.removeEventListener("change",d))},i.observers.set(t,new a(t,r)),r},r.generate=c,r.compare=function(e,t,r){void 0===r&&(r=!1);var n=[];return u(e,t,n,"",r),n}}}},{package:"@metamask/smart-transactions-controller>fast-json-patch"}],[1248,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=Object.prototype.hasOwnProperty;function o(e,t){return s.call(e,t)}function a(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)o(e,n)&&t.push(n);return t}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e,t){var r;for(var n in e)if(o(e,n)){if(e[n]===t)return c(n)+"/";if("object"==typeof e[n]&&""!=(r=u(e[n],t)))return c(n)+"/"+r}return""}function l(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}Object.defineProperty(r,"hasOwnProperty",{value:o}),r._objectKeys=a,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0},r.escapePathComponent=c,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=u,r.getPath=function(e,t){if(e===t)return"/";var r=u(e,t);if(""===r)throw new Error("Object not found in root");return"/"+r},r.hasUndefined=function e(t){if(t===undefined)return!0;if(t)if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){var i=a(t),s=i.length;for(r=0;r<s;r++)if(e(t[i[r]]))return!0}return!1};var d=function(e){function t(t,r,n,i,s){var o=this.constructor,a=e.call(this,l(t,{name:r,index:n,operation:i,tree:s}))||this;return a.name=r,a.index=n,a.operation=i,a.tree=s,Object.setPrototypeOf(a,o.prototype),a.message=l(t,{name:r,index:n,operation:i,tree:s}),a}return i(t,e),t}(Error);r.PatchError=d}}},{package:"@metamask/smart-transactions-controller>fast-json-patch"}],[1249,{"./commonjs/core.js":1246,"./commonjs/duplex.js":1247,"./commonjs/helpers.js":1248},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./commonjs/core.js");Object.assign(r,n);var i=e("./commonjs/duplex.js");Object.assign(r,i);var s=e("./commonjs/helpers.js");r.JsonPatchError=s.PatchError,r.deepClone=s._deepClone,r.escapePathComponent=s.escapePathComponent,r.unescapePathComponent=s.unescapePathComponent}}},{package:"@metamask/smart-transactions-controller>fast-json-patch"}],[125,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:42,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=42;const r=t.data;return t.data=function(e){e.AppStateController?e.AppStateController.connectedStatusPopoverHasBeenShown=!1:e.AppStateController={connectedStatusPopoverHasBeenShown:!1};return e}(r),t}};r.default=i}}},{package:"$root$"}],[1250,{"./resource":1252,"./services":1258,"./snaps":1266,"./utils":1271},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./resource"),r),i(e("./services"),r),i(e("./snaps"),r),i(e("./utils"),r)}}},{package:"@metamask/snap-controllers"}],[1251,{"@metamask/obs-store":1276,"@metamask/safe-event-emitter":1238,"eth-rpc-errors":2298,nanoid:1299},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalResourceController=void 0;const i=e("@metamask/obs-store"),s=n(e("@metamask/safe-event-emitter")),o=e("eth-rpc-errors"),a=e("nanoid"),c=e=>`Not authorized to access resource with id "${e}".`;class u extends s.default{constructor({storageKey:e,requiredFields:t,initialResources:r}){super(),this.requiredFields=t,this.storageKey=e,this.store=new i.ObservableStore(((e,t)=>({[e]:t}))(e,r))}getResources(){return{...this.store.getState()[this.storageKey]}}setResources(e){this.store.updateState({[this.storageKey]:e})}clearResources(){this.setResources({})}deleteResourcesFor(e){const t=this.getResources(),r=Object.entries(t).reduce(((t,[r,n])=>(n.fromDomain!==e&&(t[r]=n),t)),{});this.setResources(r)}get(e,t){const r=this.getResources()[t];if(r&&r.fromDomain!==e)throw o.ethErrors.provider.unauthorized({message:c(t)});return r?{...r}:null}getAllResources(e){return Object.values(this.getResources()).filter((t=>t.fromDomain===e))}add(e,t){const r=this.processNewResource(e,t),{id:n}=r,i=this.getResources();if(i[n])throw new Error(`Resource with id "${n}" already exists.`);return i[n]=r,this.setResources(i),r.id}update(e,t){const{id:r}=t,n=this.getResources(),i=n[r];if(!i)throw o.ethErrors.rpc.resourceNotFound({message:`Resource with id "${r}" not found.`});if(i.fromDomain!==e)throw o.ethErrors.provider.unauthorized({message:c(r)});return n[r]=this.processNewResource(e,{...n[r],...t}),this.setResources(n),r}processNewResource(e,t){return this.requiredFields.forEach((r=>{if(!(r in t))throw o.ethErrors.rpc.invalidParams(`Resource from "${e}" missing required field: ${r}`)})),{...t,fromDomain:e,id:t.id||(0,a.nanoid)()}}delete(e,t){const r=this.getResources(),n=r[t];if(!n)throw o.ethErrors.rpc.invalidParams({message:`Resource with id "${t}" not found.`});if(n.fromDomain!==e)throw o.ethErrors.provider.unauthorized({message:c(t)});return delete r[t],this.setResources(r),null}handleRpcRequest(e,t,r){if(!e||"string"!=typeof e)throw new Error("Invalid fromDomain.");switch(t){case"get":return this.get(e,r);case"getAll":return this.getAllResources(e);case"add":return this.add(e,r);case"update":return this.update(e,r);case"delete":return this.delete(e,r);default:throw o.ethErrors.rpc.methodNotFound({message:`Not an asset method: ${t}`})}}}r.ExternalResourceController=u}}},{package:"@metamask/snap-controllers"}],[1252,{"./ExternalResourceController":1251},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./ExternalResourceController"),r)}}},{package:"@metamask/snap-controllers"}],[1253,{"@metamask/object-multiplex":1197,"@metamask/utils":1302,nanoid:1299,pump:5360},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.setupMultiplex=r.AbstractExecutionService=void 0;const i=n(e("@metamask/object-multiplex")),s=e("@metamask/utils"),o=e("nanoid"),a=n(e("pump"));r.AbstractExecutionService=class{constructor({setupSnapProvider:e,messenger:t,terminationTimeout:r=s.Duration.Second}){this._snapRpcHooks=new Map,this.jobs=new Map,this.setupSnapProvider=e,this.snapToJobMap=new Map,this.jobToSnapMap=new Map,this._messenger=t,this._terminationTimeout=r}async terminate(e){const t=this.jobs.get(e);if(!t)throw new Error(`Job with id "${e}" not found.`);let r;const n=new Promise((e=>{r=setTimeout((()=>{e()}),this._terminationTimeout)}));try{await Promise.race([this._command(e,{jsonrpc:"2.0",method:"terminate",params:[],id:(0,o.nanoid)()}),n])}catch(t){console.error(`Job "${e}" failed to terminate gracefully.`,t)}clearTimeout(r),Object.values(t.streams).forEach((e=>{try{!e.destroyed&&e.destroy(),e.removeAllListeners()}catch(e){console.error("Error while destroying stream",e)}})),this._terminate(t),this._removeSnapAndJobMapping(e),this.jobs.delete(e),console.log(`job: "${e}" terminated`)}async terminateSnap(e){const t=this.snapToJobMap.get(e);t&&await this.terminate(t)}async terminateAllSnaps(){await Promise.all([...this.jobs.keys()].map((e=>this.terminate(e)))),this._snapRpcHooks.clear()}async getRpcMessageHandler(e){return this._snapRpcHooks.get(e)}async executeSnap(e){if(this.snapToJobMap.has(e.snapId))throw new Error(`Snap "${e.snapId}" is already being executed.`);const t=await this._initJob();this._mapSnapAndJob(e.snapId,t.id),await this._command(t.id,{jsonrpc:"2.0",method:"ping",id:(0,o.nanoid)()}),this.setupSnapProvider(e.snapId,t.streams.rpc);const r=await this._command(t.id,{jsonrpc:"2.0",method:"executeSnap",params:e,id:(0,o.nanoid)()});return this._createSnapHooks(e.snapId,t.id),r}async _command(e,t){if("object"!=typeof t)throw new Error("Must send object.");const r=this.jobs.get(e);if(!r)throw new Error(`Job with id "${e}" not found.`);console.log("Parent: Sending Command",t);const n=await r.rpcEngine.handle(t);if(n.error)throw new Error(n.error.message);return n.result}_removeSnapHooks(e){this._snapRpcHooks.delete(e)}_createSnapHooks(e,t){this._snapRpcHooks.set(e,(async(r,n)=>await this._command(t,{id:(0,o.nanoid)(),jsonrpc:"2.0",method:"snapRpc",params:{origin:r,request:n,target:e}})))}_getJobForSnap(e){return this.snapToJobMap.get(e)}_getSnapForJob(e){return this.jobToSnapMap.get(e)}_mapSnapAndJob(e,t){this.snapToJobMap.set(e,t),this.jobToSnapMap.set(t,e)}_removeSnapAndJobMapping(e){const t=this.jobToSnapMap.get(e);if(!t)throw new Error(`job: "${e}" has no mapped snap.`);this.jobToSnapMap.delete(e),this.snapToJobMap.delete(t),this._removeSnapHooks(t)}},r.setupMultiplex=function(e,t){const r=new i.default;return(0,a.default)(e,r,e,(e=>{e&&(t?console.error(`"${t}" stream failure.`,e):console.error(e))})),r}}}},{package:"@metamask/snap-controllers"}],[1254,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/snap-controllers"}],[1255,{"./AbstractExecutionService":1253,"@metamask/execution-environments":1169,"@metamask/obs-store":1276,"@metamask/post-message-stream":1211,"json-rpc-engine":4598,"json-rpc-middleware-stream":1298,nanoid:1299,pump:5360},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.WebWorkerExecutionService=void 0;const i=e("@metamask/obs-store"),s=e("@metamask/post-message-stream"),o=e("@metamask/execution-environments"),a=e("json-rpc-engine"),c=e("json-rpc-middleware-stream"),u=e("nanoid"),l=n(e("pump")),d=e("./AbstractExecutionService");class f extends d.AbstractExecutionService{constructor({setupSnapProvider:e,workerUrl:t,messenger:r}){super({setupSnapProvider:e,messenger:r}),this.workerUrl=t,this.store=new i.ObservableStore({workers:{}})}_setWorker(e,t){this.jobs.set(e,t);const r={...this.store.getState().workers,[e]:t};this.store.updateState({workers:r})}_deleteWorker(e){const t={...this.store.getState().workers};delete t[e],this.store.updateState({workers:t})}_terminate(e){e.worker.terminate(),this._deleteWorker(e.id)}async _initJob(){const e=(0,u.nanoid)(),t=new Worker(this.workerUrl,{name:e});t.addEventListener("error",(t=>{if(this._messenger){const r=this.jobToSnapMap.get(e);r&&this._messenger.publish("ExecutionService:unhandledError",r,{code:t.error.code,message:t.error.message,data:t.error.data})}}),{once:!0});const r=this._initWorkerStreams(t,e),n=new a.JsonRpcEngine,i=(0,c.createStreamMiddleware)();(0,l.default)(i.stream,r.command,i.stream),n.push(i.middleware);const s={id:e,streams:r,rpcEngine:n,worker:t};return this._setWorker(e,s),await this._command(e,{jsonrpc:"2.0",method:"ping",id:(0,u.nanoid)()}),s}_initWorkerStreams(e,t){const r=new s.WorkerParentPostMessageStream({worker:e}),n=(0,d.setupMultiplex)(r,`Worker:${t}`);return{command:n.createStream(o.SNAP_STREAM_NAMES.COMMAND),rpc:n.createStream(o.SNAP_STREAM_NAMES.JSON_RPC),_connection:r}}}r.WebWorkerExecutionService=f}}},{package:"@metamask/snap-controllers"}],[1256,{"../AbstractExecutionService":1253,"@metamask/execution-environments":1169,"@metamask/post-message-stream":1211,"json-rpc-engine":4598,"json-rpc-middleware-stream":1298,nanoid:1299,pump:5360},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.IframeExecutionService=void 0;const i=e("@metamask/post-message-stream"),s=e("@metamask/execution-environments"),o=e("json-rpc-engine"),a=e("json-rpc-middleware-stream"),c=e("nanoid"),u=n(e("pump")),l=e("../AbstractExecutionService");class d extends l.AbstractExecutionService{constructor({setupSnapProvider:e,iframeUrl:t,messenger:r}){super({setupSnapProvider:e,messenger:r}),this.iframeUrl=t}_terminate(e){document.getElementById(e.id)?.remove()}async _initJob(){const e=(0,c.nanoid)(),t=await this._initStreams(e),r=new o.JsonRpcEngine,n=(0,a.createStreamMiddleware)();(0,u.default)(n.stream,t.command,n.stream),r.push(n.middleware);const i={id:e,streams:t,rpcEngine:r};return this.jobs.set(e,i),i}async _initStreams(e){this._iframeWindow=await this._createWindow(this.iframeUrl.toString(),e);const t=new i.WindowPostMessageStream({name:"parent",target:"child",targetWindow:this._iframeWindow}),r=(0,l.setupMultiplex)(t,`Job: "${e}"`),n=r.createStream(s.SNAP_STREAM_NAMES.COMMAND),o=t=>{if(t.error&&(null===t.id||t.id===undefined)){const r=this.jobToSnapMap.get(e);r&&this._messenger.publish("ExecutionService:unhandledError",r,t.error),n.removeListener("data",o)}};n.on("data",o);const a=r.createStream(s.SNAP_STREAM_NAMES.JSON_RPC);return{command:n,rpc:a,_connection:t}}_createWindow(e,t){return new Promise(((r,n)=>{const i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("src",e),document.body.appendChild(i),i.addEventListener("load",(()=>{i.contentWindow?r(i.contentWindow):n(new Error(`iframe.contentWindow not present on load for job "${t}".`))})),i.setAttribute("sandbox","allow-scripts")}))}}r.IframeExecutionService=d}}},{package:"@metamask/snap-controllers"}],[1257,{"./IframeExecutionService":1256},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./IframeExecutionService"),r)}}},{package:"@metamask/snap-controllers"}],[1258,{"./AbstractExecutionService":1253,"./ExecutionService":1254,"./WebWorkerExecutionService":1255,"./iframe":1257},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./AbstractExecutionService"),r),i(e("./ExecutionService"),r),i(e("./WebWorkerExecutionService"),r),i(e("./iframe"),r)}}},{package:"@metamask/snap-controllers"}],[1259,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.RequestQueue=void 0;r.RequestQueue=class{constructor(e){this.maxQueueSize=e,this.queueSizes=new Map}increment(e){const t=this.queueSizes.get(e)??0;if(t>=this.maxQueueSize)throw new Error("Maximum number of requests reached. Try again later.");this.queueSizes.set(e,t+1)}decrement(e){const t=this.queueSizes.get(e)??0;if(0===t)throw new Error(`Cannot decrement, ${e} does not have any outstanding requests.`);this.queueSizes.set(e,t-1)}get(e){return this.queueSizes.get(e)??0}}}}},{package:"@metamask/snap-controllers"}],[126,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:43,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=43;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.PreferencesController)&&void 0!==t&&t.currentAccountTab&&delete e.PreferencesController.currentAccountTab;return e}(r),t}};r.default=i}}},{package:"$root$"}],[1260,{"..":1250,"../utils":1271,"./RequestQueue":1259,"./default-endowments":1261,"./endowments":1263,"./json-schemas":1267,"./utils":1270,"@metamask/controllers":1060,"@metamask/utils":1302,"eth-rpc-errors":2298,nanoid:1299,semver:5631},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapController=r.SnapStatusEvent=r.SnapStatus=r.SNAP_APPROVAL_UPDATE=r.SNAP_PREFIX_REGEX=r.controllerName=void 0;const n=e("@metamask/controllers"),i=e("@metamask/utils"),s=e("eth-rpc-errors"),o=e("nanoid"),a=e("semver"),c=e(".."),u=e("../utils"),l=e("./default-endowments"),d=e("./json-schemas"),f=e("./endowments"),h=e("./RequestQueue"),p=e("./utils");r.controllerName="SnapController",r.SNAP_PREFIX_REGEX=new RegExp(`^${p.SNAP_PREFIX}`,"u"),r.SNAP_APPROVAL_UPDATE="wallet_updateSnap";const m=new Set(["initialPermissions","id","permissionName","version"]),g={snapErrors:{},snaps:{},snapStates:{}};var y,b;!function(e){e.installing="installing",e.running="running",e.stopped="stopped",e.crashed="crashed"}(y=r.SnapStatus||(r.SnapStatus={})),function(e){e.start="start",e.stop="stop",e.crash="crash",e.update="update"}(b=r.SnapStatusEvent||(r.SnapStatusEvent={}));const w=e=>e.enabled,v={initial:y.installing,states:{[y.installing]:{on:{[b.start]:{target:y.running,cond:w}}},[y.running]:{on:{[b.stop]:y.stopped,[b.crash]:y.crashed}},[y.stopped]:{on:{[b.start]:{target:y.running,cond:w},[b.update]:y.installing}},[y.crashed]:{on:{[b.start]:{target:y.running,cond:w}}}}};class _ extends n.BaseControllerV2{constructor({closeAllConnections:e,executeSnap:t,getRpcMessageHandler:r,messenger:n,state:s,terminateAllSnaps:o,terminateSnap:a,environmentEndowmentPermissions:c=[],npmRegistryUrl:u,idleTimeCheckInterval:l=(0,i.inMilliseconds)(5,i.Duration.Second),maxIdleTime:d=(0,i.inMilliseconds)(30,i.Duration.Second),maxRequestTime:f=(0,i.inMilliseconds)(60,i.Duration.Second),fetchFunction:h=globalThis.fetch.bind(globalThis),featureFlags:p={}}){super({messenger:n,metadata:{snapErrors:{persist:!1,anonymous:!1},snapStates:{persist:!0,anonymous:!1},snaps:{persist:e=>Object.values(e).map((e=>({...e,status:y.stopped}))).reduce(((e,t)=>(e[t.id]=t,e)),{}),anonymous:!1}},name:"SnapController",state:{...g,...s}}),this._closeAllConnections=e,this._environmentEndowmentPermissions=c,this._executeSnap=t,this._getRpcMessageHandler=r,this._onUnhandledSnapError=this._onUnhandledSnapError.bind(this),this._terminateSnap=a,this._terminateAllSnaps=o,this._idleTimeCheckInterval=l,this._maxIdleTime=d,this._maxRequestTime=f,this._pollForLastRequestStatus(),this._snapsRuntimeData=new Map,this._npmRegistryUrl=u,this._fetchFunction=h,this._featureFlags=p,this.messagingSystem.subscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.registerMessageHandlers()}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${r.controllerName}:add`,((...e)=>this.add(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:get`,((...e)=>this.get(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:getRpcMessageHandler`,((...e)=>this.getRpcMessageHandler(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:getSnapState`,((...e)=>this.getSnapState(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:has`,((...e)=>this.has(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:updateSnapState`,((...e)=>this.updateSnapState(...e))),this.messagingSystem.registerActionHandler(`${r.controllerName}:clearSnapState`,((...e)=>this.clearSnapState(...e)))}_pollForLastRequestStatus(){this._timeoutForLastRequestStatus=setTimeout((async()=>{await this._stopSnapsLastRequestPastMax(),this._pollForLastRequestStatus()}),this._idleTimeCheckInterval)}async _stopSnapsLastRequestPastMax(){const e=[...this._snapsRuntimeData.entries()];return Promise.all(e.filter((([e,t])=>0===t.pendingRequests&&t.lastRequest&&this._maxIdleTime&&(0,i.timeSince)(t.lastRequest)>this._maxIdleTime)).map((([e])=>this.stopSnap(e,b.stop))))}async _onUnhandledSnapError(e,t){await this.stopSnap(e,b.crash),this.addSnapError(t)}_transitionSnapState(e,t){const r=this.state.snaps[e].status;let n=v.states[r].on[t]??r;if(n.cond){if(!1===n.cond(this.state.snaps[e]))throw new Error(`Condition failed for state transition "${e}" with event "${t}".`)}n.target&&(n=n.target),n!==r&&this.update((t=>{t.snaps[e].status=n}))}async startSnap(e){const t=this.get(e);if(!t)throw new Error(`Snap "${e}" not found.`);if(!1===this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);await this._startSnap({snapId:e,sourceCode:t.sourceCode})}enableSnap(e){this.update((t=>{t.snaps[e].enabled=!0}))}disableSnap(e){return this.update((t=>{if(!t.snaps[e])throw new Error(`Snap "${e}" not found.`);t.snaps[e].enabled=!1})),this.isRunning(e)?this.stopSnap(e,b.stop):Promise.resolve()}async stopSnap(e,t=b.stop){const r=this._getSnapRuntimeData(e);if(r){r.lastRequest=null,r.pendingRequests=0;try{this.isRunning(e)&&(this._closeAllConnections(e),await this.terminateSnap(e))}finally{this.isRunning(e)&&this._transitionSnapState(e,t)}}}async terminateSnap(e){await this._terminateSnap(e),this.messagingSystem.publish("SnapController:snapTerminated",e)}isRunning(e){const t=this.get(e);if(!t)throw new Error(`Snap "${e}" not found.`);return t.status===y.running}has(e){return Boolean(this.get(e))}get(e){return this.state.snaps[e]}getTruncated(e){const t=this.get(e);return t?Object.keys(t).reduce(((e,r)=>(m.has(r)&&(e[r]=t[r]),e)),{}):null}async updateSnapState(e,t){this.update((r=>{r.snapStates[e]=t}))}async clearSnapState(e){this.update((t=>{delete t.snapStates[e]}))}addSnapError(e){this.update((t=>{const r=(0,o.nanoid)();t.snapErrors[r]={...e,internalID:r}}))}async removeSnapError(e){this.update((t=>{delete t.snapErrors[e]}))}async clearSnapErrors(){this.update((e=>{e.snapErrors={}}))}async getSnapState(e){return this.state.snapStates[e]??null}clearState(){const e=Object.keys(this.state.snaps);e.forEach((e=>{this._closeAllConnections(e)})),this._terminateAllSnaps(),e.forEach(this.revokeAllSnapPermissions),this.update((e=>{e.snaps={},e.snapStates={}}))}async removeSnap(e){return this.removeSnaps([e])}async removeSnaps(e){if(!Array.isArray(e))throw new Error("Expected array of snap ids.");await Promise.all(e.map((async e=>{await this.disableSnap(e),this.revokeAllSnapPermissions(e);const t=(0,p.getSnapPermissionName)(e);this.messagingSystem.call("PermissionController:revokePermissionForAllSubjects",t),this._snapsRuntimeData.delete(e),this.update((t=>{delete t.snaps[e],delete t.snapStates[e]})),this.messagingSystem.publish("SnapController:snapRemoved",e)})))}revokeAllSnapPermissions(e){this.messagingSystem.call("PermissionController:hasPermissions",e)&&this.messagingSystem.call("PermissionController:revokeAllPermissions",e)}getPermittedSnaps(e){return Object.values(this.messagingSystem.call("PermissionController:getPermissions",e)??{}).reduce(((e,t)=>{if(t.parentCapability.startsWith(p.SNAP_PREFIX)){const n=t.parentCapability.replace(r.SNAP_PREFIX_REGEX,""),i=this.getTruncated(n);e[n]=i||{error:(0,s.serializeError)(new Error("Snap permitted but not installed."))}}return e}),{})}async installSnaps(e,t){const r={};return await Promise.all(Object.entries(t).map((async([t,{version:n}])=>{const i=(0,p.resolveVersion)(n),o=(0,p.getSnapPermissionName)(t);(0,p.isValidSnapVersionRange)(i)?this.messagingSystem.call("PermissionController:hasPermission",e,o)?r[t]={...await this.processRequestedSnap(e,t,i)}:r[t]={error:s.ethErrors.provider.unauthorized(`Not authorized to install snap "${t}". Request the permission for the snap before attempting to install it.`)}:r[t]={error:s.ethErrors.rpc.invalidParams(`The "version" field must be a valid SemVer version range if specified. Received: "${i}".`)}}))),r}async processRequestedSnap(e,t,r){try{this.validateSnapId(t)}catch(e){return{error:s.ethErrors.rpc.invalidParams(`"${t}" is not a valid snap id.`)}}const n=t,i=this.getTruncated(n);if(i&&(0,p.getSnapPrefix)(n)!==p.SnapIdPrefixes.local){if((0,a.satisfies)(i.version,r))return i;if(!0!==this._featureFlags.dappsCanUpdateSnaps)return{error:s.ethErrors.rpc.invalidParams(`Version mismatch with already installed snap. ${n}@${i.version} doesn't satisfy requested version ${r}`)};try{const t=await this.updateSnap(e,n,r);return null===t?{error:s.ethErrors.rpc.invalidParams(`Snap "${n}@${i.version}" is already installed, couldn't update to a version inside requested "${r}" range.`)}:t}catch(e){return{error:(0,s.serializeError)(e)}}}i&&this.isRunning(n)&&await this.stopSnap(n,b.stop);try{const{sourceCode:t}=await this.add({origin:e,id:n,versionRange:r});return await this.authorize(n),await this._startSnap({snapId:n,sourceCode:t}),this.messagingSystem.publish("SnapController:snapInstalled",n),this.getTruncated(n)}catch(e){return console.error("Error when adding snap.",e),this.has(n)&&this.removeSnap(n),{error:(0,s.serializeError)(e)}}}async updateSnap(e,t,n=p.DEFAULT_REQUESTED_SNAP_VERSION){const s=this.get(t);if(s===undefined)throw new Error(`Could not find snap ${t}. Install the snap before attempting to update it.`);if(!(0,p.isValidSnapVersionRange)(n))throw new Error(`Received invalid Snap version range: "${n}".`);const o=await this._fetchSnap(t,n);if(!(0,a.gt)(o.manifest.version,s.version))return console.warn(`Tried updating snap "${t}" within "${n}" version range, but newer version "${s.version}" is already installed`),null;const{newPermissions:c,unusedPermissions:u,approvedPermissions:l}=await this.calculatePermissionsChange(t,o.manifest.initialPermissions);if(!await this.messagingSystem.call("ApprovalController:addRequest",{origin:e,type:r.SNAP_APPROVAL_UPDATE,requestData:{snapId:t,newVersion:o.manifest.version,newPermissions:c,approvedPermissions:l}},!0))return null;this.isRunning(t)&&await this.stopSnap(t,b.stop),this._transitionSnapState(t,b.update),await this._set({origin:e,id:t,manifest:o.manifest,sourceCode:o.sourceCode,versionRange:n});const d=Object.keys(u);return(0,i.isNonEmptyArray)(d)&&this.messagingSystem.call("PermissionController:revokePermissions",{[t]:d}),(0,i.isNonEmptyArray)(Object.keys(c))&&this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:c,subject:{origin:t}}),await this._startSnap({snapId:t,sourceCode:o.sourceCode}),this.messagingSystem.publish("SnapController:snapUpdated",t,o.manifest.version,s.version),this.getTruncated(t)}async add(e){const{id:t}=e;this.validateSnapId(t);const r=t;if(!e||!("origin"in e)||!("id"in e)||!("manifest"in e)&&"sourceCode"in e||"manifest"in e&&!("sourceCode"in e))throw new Error(`Invalid add snap args for snap "${r}".`);const n=this._getSnapRuntimeData(r);n.installPromise||(console.info(`Adding snap: ${r}`),n.installPromise=this._set(e));try{return await n.installPromise}catch(e){throw n.installPromise=null,e}}validateSnapId(e){if(!e||"string"!=typeof e)throw new Error(`Invalid snap id: Not a string. Received "${e}"`);for(const t of Object.values(p.SnapIdPrefixes))if(e.startsWith(t)&&e.replace(t,"").length>0)return;throw new Error(`Invalid snap id. Received: "${e}"`)}async _startSnap(e){const{snapId:t}=e;if(this.isRunning(t))throw new Error(`Snap "${t}" is already started.`);try{const r=await this._executeWithTimeout(t,this._executeSnap({...e,endowments:await this._getEndowments(t)}));return this._transitionSnapState(t,b.start),r}catch(e){throw await this.terminateSnap(t),e}}async _getEndowments(e){let t=[];for(const r of this._environmentEndowmentPermissions)if(this.messagingSystem.call("PermissionController:hasPermission",e,r)){const n=await this.messagingSystem.call("PermissionController:getEndowments",e,r);if(n){if(!Array.isArray(n)||n.some((e=>"string"!=typeof e)))throw new Error("Expected an array of string endowment names.");t=t.concat(n)}}const r=[...new Set([...l.DEFAULT_ENDOWMENTS,...t])];return r.length<l.DEFAULT_ENDOWMENTS.length+t.length&&console.error("Duplicate endowments found. Default endowments should not be requested.",t),r}async _set(e){const{id:t,versionRange:r=p.DEFAULT_REQUESTED_SNAP_VERSION,origin:n}=e;let i,s,o;if("manifest"in e?(i=e.manifest,s=e.sourceCode,(0,d.validateSnapJsonFile)(p.NpmSnapFileNames.Manifest,i)):({manifest:i,sourceCode:s,svgIcon:o}=await this._fetchSnap(t,r)),!(0,a.satisfies)(i.version,r))throw new Error(`Version mismatch. Manifest for ${t} specifies version ${i.version} which doesn't satisfy requested version range ${r}`);if("string"!=typeof s||0===s.length)throw new Error(`Invalid source code for snap "${t}".`);const c=i?.initialPermissions;if(!c||"object"!=typeof c||Array.isArray(c))throw new Error(`Invalid initial permissions for snap "${t}".`);const u=this.state.snaps[t],{version:l}=i,f=[...u?.versionHistory??[],{version:l,date:Date.now(),origin:n}],h={...u,enabled:!0,id:t,initialPermissions:c,manifest:i,permissionName:(0,p.getSnapPermissionName)(t),sourceCode:s,status:v.initial,version:l,versionHistory:f};return this.update((e=>{e.snaps[t]=h})),this.messagingSystem.publish("SnapController:snapAdded",t,h,o),h}async _fetchSnap(e,t=p.DEFAULT_REQUESTED_SNAP_VERSION){try{const r=(0,p.getSnapPrefix)(e);switch(r){case p.SnapIdPrefixes.local:return this._fetchLocalSnap(e.replace(p.SnapIdPrefixes.local,""));case p.SnapIdPrefixes.npm:return this._fetchNpmSnap(e.replace(p.SnapIdPrefixes.npm,""),t);default:return(0,c.assertExhaustive)(r)}}catch(t){throw new Error(`Failed to fetch Snap "${e}": ${t.message}`)}}async _fetchNpmSnap(e,t){if(!(0,p.isValidSnapVersionRange)(t))throw new Error(`Received invalid Snap version range: "${t}".`);const{manifest:r,sourceCode:n,svgIcon:i}=await(0,p.fetchNpmSnap)(e,t,this._npmRegistryUrl,this._fetchFunction);return{manifest:r,sourceCode:n,svgIcon:i}}async _fetchLocalSnap(e){const t={cache:"no-cache"},r=new URL(p.NpmSnapFileNames.Manifest,e);if(!p.LOCALHOST_HOSTNAMES.has(r.hostname))throw new Error(`Invalid URL: Locally hosted Snaps must be hosted on localhost. Received URL: "${r.toString()}"`);const n=await(await this._fetchFunction(r.toString(),t)).json();(0,d.validateSnapJsonFile)(p.NpmSnapFileNames.Manifest,n);const i=n,{source:{location:{npm:{filePath:s,iconPath:o}}}}=i,[a,c]=await Promise.all([(await this._fetchFunction(new URL(s,e).toString(),t)).text(),o?(await this._fetchFunction(new URL(o,e).toString(),t)).text():undefined]);return(0,p.validateSnapShasum)(i,a),{manifest:i,sourceCode:a,svgIcon:c}}async authorize(e){console.info(`Authorizing snap: ${e}`);const t=this.state.snaps[e],{initialPermissions:r}=t;try{const{newPermissions:t,unusedPermissions:n}=await this.calculatePermissionsChange(e,r),s=Object.keys(n);if((0,i.isNonEmptyArray)(s)&&this.messagingSystem.call("PermissionController:revokePermissions",{[e]:s}),(0,i.isNonEmptyArray)(Object.keys(t))){const[r]=await this.messagingSystem.call("PermissionController:requestPermissions",{origin:e},t);return Object.values(r).map((e=>e.parentCapability))}return[]}finally{this._getSnapRuntimeData(e).installPromise=null}}destroy(){super.destroy(),this._timeoutForLastRequestStatus&&clearTimeout(this._timeoutForLastRequestStatus),this.messagingSystem.unsubscribe("ExecutionService:unhandledError",this._onUnhandledSnapError)}async getRpcMessageHandler(e){const t=this._getSnapRuntimeData(e),r=t?.rpcHandler;if(r)return r;const n=new h.RequestQueue(5),o=new Map,a=async(t,r)=>{if(!1===this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);if(this.state.snaps[e].status===y.installing)throw new Error(`Snap "${e}" is currently being installed. Please try again later.`);let a=await this._getRpcMessageHandler(e);if(!1===this.isRunning(e)){if(a)throw new Error("This snap should not have a handler in its current state. This is a bug, please report it.");let r=o.get(e);if(r){if(n.get(t)>=n.maxQueueSize)throw new Error("Exceeds maximum number of requests waiting to be resolved, please try again.")}else r=this.startSnap(e),o.set(e,r);n.increment(t);try{await r}finally{n.decrement(t),o.get(e)===r&&o.delete(e)}a=await this._getRpcMessageHandler(e)}if(!a)throw new Error(`Snap execution service returned no RPC handler for running snap "${e}".`);let c=r;if((0,i.hasProperty)(r,"jsonrpc")){if("2.0"!==r.jsonrpc)throw s.ethErrors.rpc.invalidRequest({message:'Invalid "jsonrpc" property. Must be "2.0" if provided.',data:r.jsonrpc})}else c={...r,jsonrpc:"2.0"};this._recordSnapRpcRequestStart(e);try{const r=await this._executeWithTimeout(e,a(t,c));return this._recordSnapRpcRequestFinish(e),r}catch(t){throw await this.stopSnap(e,b.crash),t}};return t.rpcHandler=a,a}async _executeWithTimeout(e,t){if(this.messagingSystem.call("PermissionController:hasPermission",e,f.LONG_RUNNING_PERMISSION))return t;let r;const n=new Promise(((e,t)=>{r=setTimeout((async()=>{t(new Error("The request timed out."))}),this._maxRequestTime)})),i=await Promise.race([t,n]);return clearTimeout(r),i}_recordSnapRpcRequestStart(e){const t=this._getSnapRuntimeData(e);t.pendingRequests+=1,t.lastRequest=null}_recordSnapRpcRequestFinish(e){const t=this._getSnapRuntimeData(e);t.pendingRequests-=1,0===t.pendingRequests&&(t.lastRequest=Date.now())}_getSnapRuntimeData(e){return this._snapsRuntimeData.has(e)||this._snapsRuntimeData.set(e,{lastRequest:null,rpcHandler:null,installPromise:null,pendingRequests:0}),this._snapsRuntimeData.get(e)}async calculatePermissionsChange(e,t){const r=await this.messagingSystem.call("PermissionController:getPermissions",e)??{},n=(0,u.setDiff)(t,r),i=(0,u.setDiff)(r,t);return{newPermissions:n,unusedPermissions:i,approvedPermissions:(0,u.setDiff)(r,i)}}}r.SnapController=_}}},{package:"@metamask/snap-controllers"}],[1261,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_ENDOWMENTS=void 0,r.DEFAULT_ENDOWMENTS=Object.freeze(["atob","btoa","BigInt","Buffer","console","crypto","Date","Math","setTimeout","clearTimeout","SubtleCrypto","TextDecoder","TextEncoder","URL","WebAssembly","setInterval","clearInterval"])}}},{package:"@metamask/snap-controllers"}],[1262,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LONG_RUNNING_PERMISSION=void 0,r.LONG_RUNNING_PERMISSION="endowment:long-running"}}},{package:"@metamask/snap-controllers"}],[1263,{"./constants":1262,"./long-running":1264,"./network-access":1265},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.endowmentPermissionBuilders=void 0;const s=e("./long-running"),o=e("./network-access");r.endowmentPermissionBuilders={[o.networkAccessEndowmentBuilder.targetKey]:o.networkAccessEndowmentBuilder,[s.longRunningEndowmentBuilder.targetKey]:s.longRunningEndowmentBuilder},i(e("./constants"),r)}}},{package:"@metamask/snap-controllers"}],[1264,{"./constants":1262,"@metamask/controllers":1060},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.longRunningEndowmentBuilder=void 0;const n=e("@metamask/controllers"),i=e("./constants").LONG_RUNNING_PERMISSION;r.longRunningEndowmentBuilder=Object.freeze({targetKey:i,specificationBuilder:e=>({permissionType:n.PermissionType.Endowment,targetKey:i,allowedCaveats:null,endowmentGetter:e=>undefined})})}}},{package:"@metamask/snap-controllers"}],[1265,{"@metamask/controllers":1060},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.networkAccessEndowmentBuilder=void 0;const n=e("@metamask/controllers"),i="endowment:network-access";r.networkAccessEndowmentBuilder=Object.freeze({targetKey:i,specificationBuilder:e=>({permissionType:n.PermissionType.Endowment,targetKey:i,allowedCaveats:null,endowmentGetter:e=>["fetch","WebSocket"]})})}}},{package:"@metamask/snap-controllers"}],[1266,{"./SnapController":1260,"./default-endowments":1261,"./endowments":1263,"./json-schemas":1267,"./utils":1270},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./SnapController"),r),i(e("./json-schemas"),r),i(e("./utils"),r),i(e("./default-endowments"),r),i(e("./endowments"),r)}}},{package:"@metamask/snap-controllers"}],[1267,{"../utils":1270,"./validateNpmSnapPackageJson.js":1268,"./validateSnapManifest.js":1269},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.validateSnapJsonFile=void 0;const i=n(e("./validateNpmSnapPackageJson.js")),s=n(e("./validateSnapManifest.js")),o=e("../utils");r.validateSnapJsonFile=function(e,t){let r;switch(e){case o.NpmSnapFileNames.Manifest:t&&"object"==typeof t&&!Array.isArray(t)&&t.repository===undefined&&(t.repository=null),r=(0,s.default)(t);break;case o.NpmSnapFileNames.PackageJson:r=(0,i.default)(t);break;default:throw new Error(`Unrecognized file name "${e}".`)}if(r&&0!==r.length)throw new Error(`${r.reduce(((e,t={})=>{const{instancePath:r,message:n="unknown error"}=t;return`${e}${r?`\t${r}\n\t${n}\n\n`:`\t${n}\n\n`}`}),"").replace(/\n$/u,"")}`)}}}},{package:"@metamask/snap-controllers"}],[1268,{"ajv/dist/runtime/equal":1278,"ajv/dist/runtime/ucs2length":1279},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=a,t.exports.default=a;const n={title:"npm Snap package.json",type:"object",required:["version","name"],properties:{version:{type:"string",title:"Version",pattern:"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"},name:{type:"string",title:"Package Name",minLength:1,maxLength:214,pattern:"^(?:@[a-z0-9-*~][a-z0-9-*._~]*/)?[a-z0-9-~][a-z0-9-._~]*$"},private:{type:"boolean",title:"Private"},main:{type:"string",title:"Main",minLength:1},publishConfig:{type:"object",title:"Publish Config",required:["registry"],properties:{access:{type:"string",minLength:1},registry:{type:"string",enum:["https://registry.npmjs.org","https://registry.npmjs.org/"]}}},repository:{type:"object",title:"Repository",additionalProperties:!1,required:["type","url"],properties:{type:{type:"string",minLength:1},url:{type:"string",minLength:1}}}}},i=new RegExp("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$","u"),s=new RegExp("^(?:@[a-z0-9-*~][a-z0-9-*._~]*/)?[a-z0-9-~][a-z0-9-._~]*$","u"),o=e("ajv/dist/runtime/ucs2length").default;e("ajv/dist/runtime/equal").default;function a(e,{instancePath:t="",parentData:r,parentDataProperty:c,rootData:u=e}={}){let l=null;if(e&&"object"==typeof e&&!Array.isArray(e)){if(e.version===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"version"},message:"must have required property '"+"version"+"'"};null===l?l=[e]:l.push(e)}if(e.name===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"name"},message:"must have required property '"+"name"+"'"};null===l?l=[e]:l.push(e)}if(e.version!==undefined){let r=e.version;if("string"==typeof r){if(!i.test(r)){const e={instancePath:t+"/version",schemaPath:"#/properties/version/pattern",keyword:"pattern",params:{pattern:"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"},message:'must match pattern "'+"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"+'"'};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}if(e.name!==undefined){let r=e.name;if("string"==typeof r){if(o(r)>214){const e={instancePath:t+"/name",schemaPath:"#/properties/name/maxLength",keyword:"maxLength",params:{limit:214},message:"must NOT have more than 214 characters"};null===l?l=[e]:l.push(e)}if(o(r)<1){const e={instancePath:t+"/name",schemaPath:"#/properties/name/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===l?l=[e]:l.push(e)}if(!s.test(r)){const e={instancePath:t+"/name",schemaPath:"#/properties/name/pattern",keyword:"pattern",params:{pattern:"^(?:@[a-z0-9-*~][a-z0-9-*._~]*/)?[a-z0-9-~][a-z0-9-._~]*$"},message:'must match pattern "'+"^(?:@[a-z0-9-*~][a-z0-9-*._~]*/)?[a-z0-9-~][a-z0-9-._~]*$"+'"'};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}if(e.private!==undefined&&"boolean"!=typeof e.private){const e={instancePath:t+"/private",schemaPath:"#/properties/private/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};null===l?l=[e]:l.push(e)}if(e.main!==undefined){let r=e.main;if("string"==typeof r){if(o(r)<1){const e={instancePath:t+"/main",schemaPath:"#/properties/main/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/main",schemaPath:"#/properties/main/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}if(e.publishConfig!==undefined){let r=e.publishConfig;if(r&&"object"==typeof r&&!Array.isArray(r)){if(r.registry===undefined){const e={instancePath:t+"/publishConfig",schemaPath:"#/properties/publishConfig/required",keyword:"required",params:{missingProperty:"registry"},message:"must have required property '"+"registry"+"'"};null===l?l=[e]:l.push(e)}if(r.access!==undefined){let e=r.access;if("string"==typeof e){if(o(e)<1){const e={instancePath:t+"/publishConfig/access",schemaPath:"#/properties/publishConfig/properties/access/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/publishConfig/access",schemaPath:"#/properties/publishConfig/properties/access/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}if(r.registry!==undefined){let e=r.registry;if("string"!=typeof e){const e={instancePath:t+"/publishConfig/registry",schemaPath:"#/properties/publishConfig/properties/registry/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}if("https://registry.npmjs.org"!==e&&"https://registry.npmjs.org/"!==e){const e={instancePath:t+"/publishConfig/registry",schemaPath:"#/properties/publishConfig/properties/registry/enum",keyword:"enum",params:{allowedValues:n.properties.publishConfig.properties.registry.enum},message:"must be equal to one of the allowed values"};null===l?l=[e]:l.push(e)}}}else{const e={instancePath:t+"/publishConfig",schemaPath:"#/properties/publishConfig/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[e]:l.push(e)}}if(e.repository!==undefined){let r=e.repository;if(r&&"object"==typeof r&&!Array.isArray(r)){if(r.type===undefined){const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property '"+"type"+"'"};null===l?l=[e]:l.push(e)}if(r.url===undefined){const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/required",keyword:"required",params:{missingProperty:"url"},message:"must have required property '"+"url"+"'"};null===l?l=[e]:l.push(e)}for(const e in r)if("type"!==e&&"url"!==e){const r={instancePath:t+"/repository",schemaPath:"#/properties/repository/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"};null===l?l=[r]:l.push(r)}if(r.type!==undefined){let e=r.type;if("string"==typeof e){if(o(e)<1){const e={instancePath:t+"/repository/type",schemaPath:"#/properties/repository/properties/type/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/repository/type",schemaPath:"#/properties/repository/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}if(r.url!==undefined){let e=r.url;if("string"==typeof e){if(o(e)<1){const e={instancePath:t+"/repository/url",schemaPath:"#/properties/repository/properties/url/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===l?l=[e]:l.push(e)}}else{const e={instancePath:t+"/repository/url",schemaPath:"#/properties/repository/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"};null===l?l=[e]:l.push(e)}}}else{const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[e]:l.push(e)}}}else{const e={instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};null===l?l=[e]:l.push(e)}return a.errors=l,l}}}},{package:"@metamask/snap-controllers"}],[1269,{"ajv/dist/runtime/equal":1278,"ajv/dist/runtime/ucs2length":1279},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=u,t.exports.default=u;const n={title:"Snap Manifest",description:"The Snap manifest file MUST be named `snap.manifest.json` and located in the package root directory.",type:"object",additionalProperties:!1,required:["version","description","proposedName","source","initialPermissions","manifestVersion"],properties:{version:{type:"string",title:"Version",description:"MUST be a valid SemVer version string and equal to the corresponding `package.json` field.",pattern:"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"},description:{type:"string",title:"Description",description:"MUST be a non-empty string less than or equal to 280 characters. A short description of the Snap.",minLength:1,maxLength:280},proposedName:{type:"string",title:"Proposed Name",description:"MUST be a string less than or equal to 214 characters. The Snap author's proposed name for the Snap. The Snap host application may display this name unmodified in its user interface. The proposed name SHOULD be human-readable.",minLength:1,maxLength:214,pattern:"^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$"},repository:{title:"Repository",description:"MAY be omitted. If present, MUST be equal to the corresponding package.json field.",oneOf:[{type:"null"},{type:"object",additionalProperties:!1,required:["type","url"],properties:{type:{type:"string",minLength:1},url:{type:"string",minLength:1}}}]},source:{type:"object",title:"Source",description:"Specifies some Snap metadata and where to fetch the Snap during installation.",additionalProperties:!1,required:["shasum","location"],properties:{shasum:{type:"string",description:"MUST be the Base64-encoded string representation of the SHA-256 hash of the Snap source file.",minLength:44,maxLength:44,pattern:"^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"},location:{title:"Source Location",type:"object",additionalProperties:!1,required:["npm"],properties:{npm:{title:"npm",type:"object",additionalProperties:!1,required:["filePath","packageName","registry"],properties:{filePath:{type:"string",title:"File Path",description:"The path to the Snap bundle file from the project root directory.",minLength:1},iconPath:{type:"string",title:"Icon Path",description:"The path to an .svg file from the project root directory.",pattern:"\\w+\\.svg$"},packageName:{type:"string",title:"Package Name",description:"The Snap's npm package name.",minLength:1},registry:{type:"string",title:"npm Registry",description:"The npm registry URL.",enum:["https://registry.npmjs.org","https://registry.npmjs.org/"]}}}}}}},initialPermissions:{type:"object",title:"Initial Permissions",description:"MUST be a valid EIP-2255 wallet_requestPermissions parameter object, specifying the initial permissions that will be requested when the Snap is added to the host application."},manifestVersion:{type:"string",title:"Manifest Version",description:"The Snap manifest specification version targeted by the manifest.",enum:["0.1"]}}},i=new RegExp("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$","u"),s=new RegExp("^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$","u"),o=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$","u"),a=new RegExp("\\w+\\.svg$","u"),c=e("ajv/dist/runtime/ucs2length").default;e("ajv/dist/runtime/equal").default;function u(e,{instancePath:t="",parentData:r,parentDataProperty:l,rootData:d=e}={}){let f=null,h=0;if(e&&"object"==typeof e&&!Array.isArray(e)){if(e.version===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"version"},message:"must have required property '"+"version"+"'"};null===f?f=[e]:f.push(e),h++}if(e.description===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"description"},message:"must have required property '"+"description"+"'"};null===f?f=[e]:f.push(e),h++}if(e.proposedName===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"proposedName"},message:"must have required property '"+"proposedName"+"'"};null===f?f=[e]:f.push(e),h++}if(e.source===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"source"},message:"must have required property '"+"source"+"'"};null===f?f=[e]:f.push(e),h++}if(e.initialPermissions===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initialPermissions"},message:"must have required property '"+"initialPermissions"+"'"};null===f?f=[e]:f.push(e),h++}if(e.manifestVersion===undefined){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"manifestVersion"},message:"must have required property '"+"manifestVersion"+"'"};null===f?f=[e]:f.push(e),h++}for(const r in e)if("version"!==r&&"description"!==r&&"proposedName"!==r&&"repository"!==r&&"source"!==r&&"initialPermissions"!==r&&"manifestVersion"!==r){const e={instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===f?f=[e]:f.push(e),h++}if(e.version!==undefined){let r=e.version;if("string"==typeof r){if(!i.test(r)){const e={instancePath:t+"/version",schemaPath:"#/properties/version/pattern",keyword:"pattern",params:{pattern:"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"},message:'must match pattern "'+"^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"+'"'};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(e.description!==undefined){let r=e.description;if("string"==typeof r){if(c(r)>280){const e={instancePath:t+"/description",schemaPath:"#/properties/description/maxLength",keyword:"maxLength",params:{limit:280},message:"must NOT have more than 280 characters"};null===f?f=[e]:f.push(e),h++}if(c(r)<1){const e={instancePath:t+"/description",schemaPath:"#/properties/description/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(e.proposedName!==undefined){let r=e.proposedName;if("string"==typeof r){if(c(r)>214){const e={instancePath:t+"/proposedName",schemaPath:"#/properties/proposedName/maxLength",keyword:"maxLength",params:{limit:214},message:"must NOT have more than 214 characters"};null===f?f=[e]:f.push(e),h++}if(c(r)<1){const e={instancePath:t+"/proposedName",schemaPath:"#/properties/proposedName/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}if(!s.test(r)){const e={instancePath:t+"/proposedName",schemaPath:"#/properties/proposedName/pattern",keyword:"pattern",params:{pattern:"^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$"},message:'must match pattern "'+"^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$"+'"'};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/proposedName",schemaPath:"#/properties/proposedName/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(e.repository!==undefined){let r=e.repository;const n=h;let i=!1,s=null;const o=h;if(null!==r){const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf/0/type",keyword:"type",params:{type:"null"},message:"must be null"};null===f?f=[e]:f.push(e),h++}(p=o===h)&&(i=!0,s=0);const a=h;if(r&&"object"==typeof r&&!Array.isArray(r)){if(r.type===undefined){const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf/1/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property '"+"type"+"'"};null===f?f=[e]:f.push(e),h++}if(r.url===undefined){const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf/1/required",keyword:"required",params:{missingProperty:"url"},message:"must have required property '"+"url"+"'"};null===f?f=[e]:f.push(e),h++}for(const e in r)if("type"!==e&&"url"!==e){const r={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"};null===f?f=[r]:f.push(r),h++}if(r.type!==undefined){let e=r.type;if("string"==typeof e){if(c(e)<1){const e={instancePath:t+"/repository/type",schemaPath:"#/properties/repository/oneOf/1/properties/type/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/repository/type",schemaPath:"#/properties/repository/oneOf/1/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(r.url!==undefined){let e=r.url;if("string"==typeof e){if(c(e)<1){const e={instancePath:t+"/repository/url",schemaPath:"#/properties/repository/oneOf/1/properties/url/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/repository/url",schemaPath:"#/properties/repository/oneOf/1/properties/url/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}}else{const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}var p;if((p=a===h)&&i?(i=!1,s=[s,1]):p&&(i=!0,s=1),i)h=n,null!==f&&(n?f.length=n:f=null);else{const e={instancePath:t+"/repository",schemaPath:"#/properties/repository/oneOf",keyword:"oneOf",params:{passingSchemas:s},message:"must match exactly one schema in oneOf"};null===f?f=[e]:f.push(e),h++}}if(e.source!==undefined){let r=e.source;if(r&&"object"==typeof r&&!Array.isArray(r)){if(r.shasum===undefined){const e={instancePath:t+"/source",schemaPath:"#/properties/source/required",keyword:"required",params:{missingProperty:"shasum"},message:"must have required property '"+"shasum"+"'"};null===f?f=[e]:f.push(e),h++}if(r.location===undefined){const e={instancePath:t+"/source",schemaPath:"#/properties/source/required",keyword:"required",params:{missingProperty:"location"},message:"must have required property '"+"location"+"'"};null===f?f=[e]:f.push(e),h++}for(const e in r)if("shasum"!==e&&"location"!==e){const r={instancePath:t+"/source",schemaPath:"#/properties/source/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"};null===f?f=[r]:f.push(r),h++}if(r.shasum!==undefined){let e=r.shasum;if("string"==typeof e){if(c(e)>44){const e={instancePath:t+"/source/shasum",schemaPath:"#/properties/source/properties/shasum/maxLength",keyword:"maxLength",params:{limit:44},message:"must NOT have more than 44 characters"};null===f?f=[e]:f.push(e),h++}if(c(e)<44){const e={instancePath:t+"/source/shasum",schemaPath:"#/properties/source/properties/shasum/minLength",keyword:"minLength",params:{limit:44},message:"must NOT have fewer than 44 characters"};null===f?f=[e]:f.push(e),h++}if(!o.test(e)){const e={instancePath:t+"/source/shasum",schemaPath:"#/properties/source/properties/shasum/pattern",keyword:"pattern",params:{pattern:"^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"},message:'must match pattern "'+"^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"+'"'};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/source/shasum",schemaPath:"#/properties/source/properties/shasum/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(r.location!==undefined){let e=r.location;if(e&&"object"==typeof e&&!Array.isArray(e)){if(e.npm===undefined){const e={instancePath:t+"/source/location",schemaPath:"#/properties/source/properties/location/required",keyword:"required",params:{missingProperty:"npm"},message:"must have required property '"+"npm"+"'"};null===f?f=[e]:f.push(e),h++}for(const r in e)if("npm"!==r){const e={instancePath:t+"/source/location",schemaPath:"#/properties/source/properties/location/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:r},message:"must NOT have additional properties"};null===f?f=[e]:f.push(e),h++}if(e.npm!==undefined){let r=e.npm;if(r&&"object"==typeof r&&!Array.isArray(r)){if(r.filePath===undefined){const e={instancePath:t+"/source/location/npm",schemaPath:"#/properties/source/properties/location/properties/npm/required",keyword:"required",params:{missingProperty:"filePath"},message:"must have required property '"+"filePath"+"'"};null===f?f=[e]:f.push(e),h++}if(r.packageName===undefined){const e={instancePath:t+"/source/location/npm",schemaPath:"#/properties/source/properties/location/properties/npm/required",keyword:"required",params:{missingProperty:"packageName"},message:"must have required property '"+"packageName"+"'"};null===f?f=[e]:f.push(e),h++}if(r.registry===undefined){const e={instancePath:t+"/source/location/npm",schemaPath:"#/properties/source/properties/location/properties/npm/required",keyword:"required",params:{missingProperty:"registry"},message:"must have required property '"+"registry"+"'"};null===f?f=[e]:f.push(e),h++}for(const e in r)if("filePath"!==e&&"iconPath"!==e&&"packageName"!==e&&"registry"!==e){const r={instancePath:t+"/source/location/npm",schemaPath:"#/properties/source/properties/location/properties/npm/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"};null===f?f=[r]:f.push(r),h++}if(r.filePath!==undefined){let e=r.filePath;if("string"==typeof e){if(c(e)<1){const e={instancePath:t+"/source/location/npm/filePath",schemaPath:"#/properties/source/properties/location/properties/npm/properties/filePath/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/source/location/npm/filePath",schemaPath:"#/properties/source/properties/location/properties/npm/properties/filePath/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(r.iconPath!==undefined){let e=r.iconPath;if("string"==typeof e){if(!a.test(e)){const e={instancePath:t+"/source/location/npm/iconPath",schemaPath:"#/properties/source/properties/location/properties/npm/properties/iconPath/pattern",keyword:"pattern",params:{pattern:"\\w+\\.svg$"},message:'must match pattern "'+"\\w+\\.svg$"+'"'};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/source/location/npm/iconPath",schemaPath:"#/properties/source/properties/location/properties/npm/properties/iconPath/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(r.packageName!==undefined){let e=r.packageName;if("string"==typeof e){if(c(e)<1){const e={instancePath:t+"/source/location/npm/packageName",schemaPath:"#/properties/source/properties/location/properties/npm/properties/packageName/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===f?f=[e]:f.push(e),h++}}else{const e={instancePath:t+"/source/location/npm/packageName",schemaPath:"#/properties/source/properties/location/properties/npm/properties/packageName/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}}if(r.registry!==undefined){let e=r.registry;if("string"!=typeof e){const e={instancePath:t+"/source/location/npm/registry",schemaPath:"#/properties/source/properties/location/properties/npm/properties/registry/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}if("https://registry.npmjs.org"!==e&&"https://registry.npmjs.org/"!==e){const e={instancePath:t+"/source/location/npm/registry",schemaPath:"#/properties/source/properties/location/properties/npm/properties/registry/enum",keyword:"enum",params:{allowedValues:n.properties.source.properties.location.properties.npm.properties.registry.enum},message:"must be equal to one of the allowed values"};null===f?f=[e]:f.push(e),h++}}}else{const e={instancePath:t+"/source/location/npm",schemaPath:"#/properties/source/properties/location/properties/npm/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}}}else{const e={instancePath:t+"/source/location",schemaPath:"#/properties/source/properties/location/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}}}else{const e={instancePath:t+"/source",schemaPath:"#/properties/source/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}}if(e.initialPermissions!==undefined){let r=e.initialPermissions;if(!r||"object"!=typeof r||Array.isArray(r)){const e={instancePath:t+"/initialPermissions",schemaPath:"#/properties/initialPermissions/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}}if(e.manifestVersion!==undefined){let r=e.manifestVersion;if("string"!=typeof r){const e={instancePath:t+"/manifestVersion",schemaPath:"#/properties/manifestVersion/type",keyword:"type",params:{type:"string"},message:"must be string"};null===f?f=[e]:f.push(e),h++}if("0.1"!==r){const e={instancePath:t+"/manifestVersion",schemaPath:"#/properties/manifestVersion/enum",keyword:"enum",params:{allowedValues:n.properties.manifestVersion.enum},message:"must be equal to one of the allowed values"};null===f?f=[e]:f.push(e),h++}}}else{const e={instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};null===f?f=[e]:f.push(e),h++}return u.errors=f,f}}}},{package:"@metamask/snap-controllers"}],[127,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:44,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=44;const r=t.data;return t.data=function(e){var t;void 0!==(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.mkrMigrationReminderTimestamp)&&delete e.AppStateController.mkrMigrationReminderTimestamp;return e}(r),t}};r.default=i}}},{package:"$root$"}],[1270,{"./json-schemas":1267,"@metamask/utils":1302,buffer:1936,"concat-stream":1280,crypto:2046,"fast-deep-equal":4145,"gunzip-maybe":4188,pump:5360,"readable-web-to-node-stream":5544,semver:5631,"tar-stream":5762},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getSnapPermissionName=r.SNAP_PREFIX=r.getSnapPrefix=r.isValidSnapVersionRange=r.resolveVersion=r.validateSnapShasum=r.validateNpmSnapManifest=r.validateNpmSnap=r.ProgrammaticallyFixableSnapError=r.SnapValidationFailureReason=r.fetchNpmSnap=r.getSnapSourceShasum=r.PROPOSED_NAME_REGEX=r.DEFAULT_REQUESTED_SNAP_VERSION=r.DEFAULT_NPM_REGISTRY=r.LOCALHOST_HOSTNAMES=r.NpmSnapFileNames=r.SnapIdPrefixes=void 0;const i=e("crypto"),s=e("@metamask/utils"),o=n(e("concat-stream")),a=n(e("fast-deep-equal")),c=n(e("gunzip-maybe")),u=n(e("pump")),l=e("readable-web-to-node-stream"),d=e("semver"),f=e("tar-stream"),h=e("./json-schemas");var p,m;!function(e){e.npm="npm:",e.local="local:"}(p=r.SnapIdPrefixes||(r.SnapIdPrefixes={})),function(e){e.PackageJson="package.json",e.Manifest="snap.manifest.json"}(m=r.NpmSnapFileNames||(r.NpmSnapFileNames={})),r.LOCALHOST_HOSTNAMES=new Set(["localhost","127.0.0.1","::1"]),r.DEFAULT_NPM_REGISTRY="https://registry.npmjs.org",r.DEFAULT_REQUESTED_SNAP_VERSION="*";const g=1e5,y=`${Math.floor(100)}kb`;function b(e){return(0,i.createHash)("sha256").update(e,"utf8").digest("base64")}r.PROPOSED_NAME_REGEX=/^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*\/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$/u,r.getSnapSourceShasum=b;const w=["manifest","packageJson","sourceCode"],v={manifest:m.Manifest,packageJson:m.PackageJson,sourceCode:"source code bundle"};var _;r.fetchNpmSnap=async function(e,t,n=r.DEFAULT_NPM_REGISTRY,i=fetch){const[a,h]=await async function(e,t,n=r.DEFAULT_NPM_REGISTRY,i=fetch){const o=await(await i(new URL(e,n).toString())).json();if(!(0,s.isObject)(o))throw new Error(`Failed to fetch package "${e}" metadata from npm.`);const a=(0,d.maxSatisfying)(Object.keys(o?.versions??{}),t);if(null===a)throw new Error(`Failed to find a matching version in npm metadata for package "${e}" and requested semver range "${t}"`);const c=o.versions?.[a]?.dist?.tarball;if(!function(e){try{return Boolean(new URL(e))}catch(e){return!1}}(c)||!c.endsWith(".tgz"))throw new Error(`Failed to find valid tarball URL in npm metadata for package "${e}".`);const u=new URL(n),l=new URL(c);l.hostname=u.hostname,l.protocol=u.protocol;const f=await i(l.toString());if(!f.ok)throw new Error(`Failed to fetch tarball for package "${e}".`);return[await f.blob().then((e=>e.stream())),a]}(e,t,n,i),p={};return await new Promise(((e,t)=>{(0,u.default)(function(e){if("function"!=typeof e.getReader)return e;return new l.ReadableWebToNodeStream(e)}(a),(0,c.default)(),function(e){const t=(0,f.extract)(),r=new Map;return t.on("entry",((n,i,s)=>{const{name:a,type:c}=n;if("file"===c){const n=a.replace(P,"");if(n===m.PackageJson)return i.pipe((0,o.default)((r=>{try{e.packageJson=JSON.parse(r.toString())}catch(e){return t.destroy(new Error(`Failed to parse "${m.PackageJson}".`))}return s()})));if(n===m.Manifest)return i.pipe((0,o.default)((r=>{try{e.manifest=JSON.parse(r.toString())}catch(e){return t.destroy(new Error(`Failed to parse "${m.Manifest}".`))}return s()})));if(/\w+\.(?:js|svg)$/u.test(n))return i.pipe((0,o.default)((e=>(r.set(n,e),s()))))}return i.on("end",(()=>s())),i.resume()})),t.on("finish",(()=>{if((0,s.isObject)(e.manifest)){const{filePath:t,iconPath:n}=e.manifest.source?.location?.npm??{};t&&(e.sourceCode=r.get(t)?.toString("utf8")),"string"==typeof n&&n.endsWith(".svg")&&(e.svgIcon=r.get(n)?.toString("utf8"))}r.clear()})),t}(p),(r=>{r?t(r):e()}))})),E(p,`npm Snap "${e}@${h}" validation error: `)},function(e){e.NameMismatch='"name" field mismatch',e.VersionMismatch='"version" field mismatch',e.RepositoryMismatch='"repository" field mismatch',e.ShasumMismatch='"shasum" field mismatch'}(_=r.SnapValidationFailureReason||(r.SnapValidationFailureReason={}));class S extends Error{constructor(e,t){super(e),this.reason=t}}function E(e,r){w.forEach((t=>{if(!e[t])throw new Error(`${r}Missing file "${v[t]}".`)}));const{manifest:n,packageJson:i,sourceCode:s,svgIcon:o}=e;try{(0,h.validateSnapJsonFile)(m.Manifest,n)}catch(e){throw new Error(`${r}"${m.Manifest}" is invalid:\n${e.message}`)}const a=n,{iconPath:c}=a.source.location.npm;if(c&&!o)throw new Error(`${r}Missing file "${c}".`);try{(0,h.validateSnapJsonFile)(m.PackageJson,i)}catch(e){throw new Error(`${r}"${m.PackageJson}" is invalid:\n${e.message}`)}const u=i;if(k({manifest:a,packageJson:u,sourceCode:s},r),o&&t.byteLength(o,"utf8")>g)throw new Error(`${r}The specified SVG icon exceeds the maximum size of ${y}.`);return{manifest:a,packageJson:u,sourceCode:s,svgIcon:o}}function k({manifest:e,packageJson:t,sourceCode:r},n){const i=t.name,s=t.version,o=t.repository,c=e.source.location.npm.packageName,u=e.version,l=e.repository;if(i!==c)throw new S(`${n}"${m.Manifest}" npm package name ("${c}") does not match the "${m.PackageJson}" "name" field ("${i}").`,_.NameMismatch);if(s!==u)throw new S(`${n}"${m.Manifest}" npm package version ("${u}") does not match the "${m.PackageJson}" "version" field ("${s}").`,_.VersionMismatch);if((o||l)&&!(0,a.default)(o,l))throw new S(`${n}"${m.Manifest}" "repository" field does not match the "${m.PackageJson}" "repository" field.`,_.RepositoryMismatch);return T(e,r,`${n}"${m.Manifest}" "shasum" field does not match computed shasum.`),[e,r,t]}r.ProgrammaticallyFixableSnapError=S,r.validateNpmSnap=E,r.validateNpmSnapManifest=k;const P=/^package\//u;function T(e,t,r="Invalid Snap manifest: manifest shasum does not match computed shasum."){if(e.source.shasum!==b(t))throw new S(r,_.ShasumMismatch)}r.validateSnapShasum=T,r.resolveVersion=function(e){return e===undefined||"latest"===e?r.DEFAULT_REQUESTED_SNAP_VERSION:e},r.isValidSnapVersionRange=function(e){return Boolean("string"==typeof e&&null!==(0,d.validRange)(e))},r.getSnapPrefix=function(e){const t=Object.values(p).find((t=>e.startsWith(t)));if(t!==undefined)return t;throw new Error(`Invalid or no prefix found for "${e}"`)},r.SNAP_PREFIX="wallet_snap_",r.getSnapPermissionName=function(e){return r.SNAP_PREFIX+e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snap-controllers"}],[1271,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.assertExhaustive=r.setDiff=void 0,r.setDiff=function(e,t){return Object.entries(e).reduce(((e,[r,n])=>(r in t||(e[r]=n),e)),{})},r.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation")}}}},{package:"@metamask/snap-controllers"}],[1272,{"./ObservableStore":1274},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ComposedStore=void 0;const n=e("./ObservableStore");class i extends n.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}r.ComposedStore=i}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1273,{"./ObservableStore":1274},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MergedStore=void 0;const n=e("./ObservableStore");class i extends n.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}r.MergedStore=i}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1274,{"@metamask/safe-event-emitter":1238},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ObservableStore=void 0;const i=n(e("@metamask/safe-event-emitter"));class s extends i.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}r.ObservableStore=s}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1275,{stream:1939},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class i extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new i(e)}}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1276,{"./ComposedStore":1272,"./MergedStore":1273,"./ObservableStore":1274,"./asStream":1275,"./transform":1277},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./asStream"),r),i(e("./ComposedStore"),r),i(e("./MergedStore"),r),i(e("./ObservableStore"),r),i(e("./transform"),r)}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1277,{through2:1301},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@metamask/snap-controllers>@metamask/obs-store"}],[1278,{"fast-deep-equal":4145},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});const n=e("fast-deep-equal");n.code='require("ajv/dist/runtime/equal").default',r.default=n}}},{package:"@metamask/snap-controllers>ajv"}],[1279,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,r=e.charCodeAt(i++),r>=55296&&r<=56319&&i<t&&(r=e.charCodeAt(i),56320==(64512&r)&&i++);return n}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n,n.code='require("ajv/dist/runtime/ucs2length").default'}}},{package:"@metamask/snap-controllers>ajv"}],[128,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:45,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=45;const r=t.data;return t.data=function(e){var t;s.includes(null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.ipfsGateway)&&(e.PreferencesController.ipfsGateway="dweb.link");return e}(r),t}};r.default=i;const s=["ipfs.io","ipfs.dweb.link"]}}},{package:"$root$"}],[1280,{buffer:1936,inherits:4276,"readable-stream":1295},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Writable,i=e("inherits"),s=Uint8Array;function o(e,t){if(!(this instanceof o))return new o(e,t);"function"==typeof e&&(t=e,e={}),e||(e={});var r=e.encoding,i=!1;r?"u8"!==(r=String(r).toLowerCase())&&"uint8"!==r||(r="uint8array"):i=!0,n.call(this,{objectMode:!0}),this.encoding=r,this.shouldInferEncoding=i,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}function a(e){return"string"==typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"==typeof e.subarray;var t}t.exports=o,i(o,n),o.prototype._write=function(e,t,r){this.body.push(e),r()},o.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;return r.isBuffer(t)?"buffer":"undefined"!=typeof Uint8Array&&t instanceof Uint8Array?"uint8array":Array.isArray(t)?"array":"string"==typeof t?"string":"[object Object]"===Object.prototype.toString.call(t)?"object":"buffer"},o.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++)t.push.apply(t,e[r]);return t}(this.body):"string"===this.encoding?function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];"string"==typeof i||r.isBuffer(i)?t.push(i):a(i)?t.push(r.from(i)):t.push(r.from(String(i)))}t=r.isBuffer(e[0])?(t=r.concat(t)).toString("utf8"):t.join("");return t}(this.body):"buffer"===this.encoding?function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];r.isBuffer(i)?t.push(i):a(i)?t.push(r.from(i)):t.push(r.from(String(i)))}return r.concat(t)}(this.body):"uint8array"===this.encoding?function(e){for(var t=0,n=0;n<e.length;n++)"string"==typeof e[n]&&(e[n]=r.from(e[n])),t+=e[n].length;for(var i=new s(t),o=(n=0,0);n<e.length;n++)for(var a=e[n],c=0;c<a.length;c++)i[o++]=a[c];return i}(this.body):this.body):[]}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>concat-stream"}],[1281,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(r===undefined||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(s(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1282,{"./_stream_readable":1284,"./_stream_writable":1286,_process:5261,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=u;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(u,i);for(var o=n(s.prototype),a=0;a<o.length;a++){var c=o[a];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1283,{"./_stream_transform":1285,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1284,{"../errors":1281,"./_stream_duplex":1282,"./internal/streams/async_iterator":1287,"./internal/streams/buffer_list":1288,"./internal/streams/destroy":1289,"./internal/streams/from":1291,"./internal/streams/state":1293,"./internal/streams/stream":1294,_process:5261,buffer:1936,events:1937,inherits:4276,"string_decoder/":5747,util:1935},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;t.exports=k,k.ReadableState=E;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=global.Uint8Array||function(){};var c,u=e("util");c=u&&u.debuglog?u.debuglog("stream"):function(){};var l,d,f,h=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,y=g.ERR_INVALID_ARG_TYPE,b=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,v=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(k,s);var _=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function E(t,r,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(l||(l=e("string_decoder/").StringDecoder),this.decoder=new l(t.encoding),this.encoding=t.encoding)}function k(t){if(n=n||e("./_stream_duplex"),!(this instanceof k))return new k(t);var r=this instanceof n;this._readableState=new E(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function P(e,t,r,n,i){c("readableAddChunk",t);var s,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?x(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,u);else if(i||(s=function(e,t){var r;n=t,o.isBuffer(n)||n instanceof a||"string"==typeof t||t===undefined||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(u,t)),s)_(e,s);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),n)u.endEmitted?_(e,new v):T(e,u,t,!0);else if(u.ended)_(e,new b);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?T(e,u,t,!1):j(e,u)):T(e,u,t,!1)}else n||(u.reading=!1,j(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function T(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&x(e)),j(e,t)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),k.prototype.destroy=p.destroy,k.prototype._undestroy=p.undestroy,k.prototype._destroy=function(e,t){t(e)},k.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=o.from(e,t),t=""),r=!0),P(this,e,t,!1,r)},k.prototype.unshift=function(e){return P(this,e,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(t){l||(l=e("string_decoder/").StringDecoder);var r=new l(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(I,e))}function I(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,B(e)}function j(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(N,e,t))}function N(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(c("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function R(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){c("readable nexttick read 0"),e.read(0)}function M(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function L(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(U,t,e))}function U(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function H(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}k.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):x(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&L(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(r,t))),null===(n=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&L(this)),null!==n&&this.emit("data",n),n},k.prototype._read=function(e){_(this,new w("_read()"))},k.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,c("pipe count=%d opts=%j",s.pipesCount,t);var o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?u:g;function a(t,r){c("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",h),e.removeListener("unpipe",a),n.removeListener("end",u),n.removeListener("end",g),n.removeListener("data",f),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}s.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,B(e))}}(n);e.on("drain",l);var d=!1;function f(t){c("ondata");var r=e.write(t);c("dest.write",r),!1===r&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==H(s.pipes,e))&&!d&&(c("false write response, pause",s.awaitDrain),s.awaitDrain++),n.pause())}function h(t){c("onerror",t),g(),e.removeListener("error",h),0===i(e,"error")&&_(e,t)}function p(){e.removeListener("finish",m),g()}function m(){c("onfinish"),e.removeListener("close",p),g()}function g(){c("unpipe"),n.unpipe(e)}return n.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",p),e.once("finish",m),e.emit("pipe",n),s.flowing||(c("pipe resume"),n.resume()),e},k.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=H(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},k.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?x(this):i.reading||r.nextTick(C,this))),n},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(R,this),n},k.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||r.nextTick(R,this),t},k.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(M,e,t))}(this,e)),e.paused=!1,this},k.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&i!==undefined)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(k.prototype[Symbol.asyncIterator]=function(){return d===undefined&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),k._fromList=D,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(k.from=function(t,r){return f===undefined&&(f=e("./internal/streams/from")),f(k,t,r)})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1285,{"../errors":1281,"./_stream_duplex":1282,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=l;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new i("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1286,{"../errors":1281,"./_stream_duplex":1282,"./internal/streams/destroy":1289,"./internal/streams/state":1293,"./internal/streams/stream":1294,_process:5261,buffer:1936,inherits:4276,"util-deprecate":5856},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=k,k.WritableState=E;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,c=global.Uint8Array||function(){};var u,l=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,h=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,g=f.ERR_STREAM_CANNOT_PIPE,y=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,v=f.ERR_UNKNOWN_ENCODING,_=l.errorOrDestroy;function S(){}function E(t,s,o){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=s instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if("function"!=typeof s)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(I,e,t),e._writableState.errorEmitted=!0,_(e,i)):(s(i),e._writableState.errorEmitted=!0,_(e,i),I(e,t))}(e,n,i,t,s);else{var o=O(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||A(e,n),i?r.nextTick(T,e,n,o,s):T(e,n,o,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function k(t){var r=this instanceof(i=i||e("./_stream_duplex"));if(!r&&!u.call(k,this))return new k(t);this._writableState=new E(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function P(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function T(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),I(e,t)}function A(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,s=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,c=!0;r;)s[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;s.allBuffers=c,P(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,d=r.callback;if(P(e,t,!1,t.objectMode?1:u.length,u,l,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function x(e,t){e._final((function(r){t.pendingcb--,r&&_(e,r),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var n=O(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(x,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(k,o),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===k&&(e&&e._writableState instanceof E)}})):u=function(e){return e instanceof this},k.prototype.pipe=function(){_(this,new g)},k.prototype.write=function(e,t,n){var i,s=this._writableState,o=!1,u=!s.objectMode&&(i=e,a.isBuffer(i)||i instanceof c);return u&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(n=t,t=null),u?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=S),s.ending?function(e,t){var n=new w;_(e,n),r.nextTick(t,n)}(this,n):(u||function(e,t,n,i){var s;return null===n?s=new b:"string"==typeof n||t.objectMode||(s=new h("chunk",["string","Buffer"],n)),!s||(_(e,s),r.nextTick(i,s),!1)}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var c=t.objectMode?1:n.length;t.length+=c;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else P(e,t,!1,c,n,i,s);return u}(this,s,u,e,t,n)),o},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},k.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new v(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(e,t,r){r(new p("_write()"))},k.prototype._writev=null,k.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,I(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),k.prototype.destroy=l.destroy,k.prototype._undestroy=l.undestroy,k.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1287,{"./end-of-stream":1290,_process:5261},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),l=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function h(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[l]=null,e[o]=null,e[a]=null,t(h(r,!1)))}}function m(e){r.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(h(undefined,!0));if(this[f].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(h(undefined,!0))}))}));var n,i=this[l];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(h(undefined,!0)):t[d](r,n)}),n)}}(i,this));else{var s=this[f].read();if(null!==s)return Promise.resolve(h(s,!1));n=new Promise(this[d])}return this[l]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(h(undefined,!0))}))}))})),n),g);t.exports=function(e){var t,r=Object.create(y,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var n=r[f].read();n?(r[l]=null,r[o]=null,r[a]=null,e(h(n,!1))):(r[o]=e,r[a]=t)},writable:!0}),t));return r[l]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[l]=null,r[o]=null,r[a]=null,t(e)),void(r[c]=e)}var n=r[o];null!==n&&(r[l]=null,r[o]=null,r[a]=null,n(h(undefined,!0))),r[u]=!0})),e.on("readable",m.bind(null,r)),r}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1288,{buffer:1936,util:1935},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=e("buffer").Buffer,a=e("util").inspect,c=a&&a.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,u;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=i,n=a,o.prototype.copy.call(t,r,n),a+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0==(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&s(t.prototype,r),u&&s(t,u),e}()}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1289,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(n,o):(o._writableState.errorEmitted=!0,e.nextTick(r,o,t)):e.nextTick(r,o,t):s?(e.nextTick(n,o),s(t)):e.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[129,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:46,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=46;const r=t.data;return t.data=function(e){void 0!==(null==e?void 0:e.ABTestController)&&delete e.ABTestController;return e}(r),t}};r.default=i}}},{package:"$root$"}],[1290,{"../../../errors":1281},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,o||s.call(t)},d=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,d=!0,a||s.call(t)},h=function(e){s.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",f),t.on("finish",l),!1!==r.error&&t.on("error",h),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",f),t.removeListener("error",h),t.removeListener("close",p)}}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1291,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1292,{"../../../errors":1281,"./end-of-stream":1290},function(){with(this)return function(){"use strict";return function(e,t,r){var n;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(t,r,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),n===undefined&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var c=!1;return function(e){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}function u(e){e()}function l(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}t.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var o=t.map((function(e,r){var s=r<t.length-1;return c(e,s,r>0,(function(e){n||(n=e),e&&o.forEach(u),s||(o.forEach(u),i(n))}))}));return t.reduce(l)}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1293,{"../../../errors":1281},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1294,{events:1937},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("events").EventEmitter}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1295,{"./lib/_stream_duplex.js":1282,"./lib/_stream_passthrough.js":1283,"./lib/_stream_readable.js":1284,"./lib/_stream_transform.js":1285,"./lib/_stream_writable.js":1286,"./lib/internal/streams/end-of-stream.js":1290,"./lib/internal/streams/pipeline.js":1292},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/snap-controllers>concat-stream>readable-stream"}],[1296,{"readable-stream":5541},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});const n=e("readable-stream");r.default=function(e){if(!e||!e.engine)throw new Error("Missing engine parameter!");const{engine:t}=e,r=new n.Duplex({objectMode:!0,read:function(){return undefined},write:function(e,n,i){t.handle(e,((e,t)=>{r.push(t)})),i()}});return t.on&&t.on("notification",(e=>{r.push(e)})),r}}}},{package:"@metamask/snap-controllers>json-rpc-middleware-stream"}],[1297,{"@metamask/safe-event-emitter":1238,"readable-stream":5541},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const i=n(e("@metamask/safe-event-emitter")),s=e("readable-stream");r.default=function(){const e={},t=new s.Duplex({objectMode:!0,read:function(){return!1},write:function(t,n,i){let s;try{!t.id?function(e){r.emit("notification",e)}(t):function(t){const r=e[t.id];if(!r)throw new Error(`StreamMiddleware - Unknown response id "${t.id}"`);delete e[t.id],Object.assign(r.res,t),setTimeout(r.end)}(t)}catch(e){s=e}i(s)}}),r=new i.default;return{events:r,middleware:(r,n,i,s)=>{t.push(r),e[r.id]={req:r,res:n,next:i,end:s}},stream:t}}}}},{package:"@metamask/snap-controllers>json-rpc-middleware-stream"}],[1298,{"./createEngineStream":1296,"./createStreamMiddleware":1297},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createStreamMiddleware=r.createEngineStream=void 0;const i=n(e("./createEngineStream"));r.createEngineStream=i.default;const s=n(e("./createStreamMiddleware"));r.createStreamMiddleware=s.default}}},{package:"@metamask/snap-controllers>json-rpc-middleware-stream"}],[1299,{"./url-alphabet/index.cjs":1300},function(){with(this)return function(){"use strict";return function(e,t,r){let{urlAlphabet:n}=e("./url-alphabet/index.cjs"),i=e=>crypto.getRandomValues(new Uint8Array(e)),s=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*n*t/e.length);return(s=t)=>{let o="";for(;;){let t=r(i),a=i;for(;a--;)if(o+=e[t[a]&n]||"",o.length===s)return o}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>s(e,t,i),customRandom:s,urlAlphabet:n,random:i}}}},{package:"@metamask/snap-controllers>nanoid"}],[13,{"../../../shared/constants/app":6023,"../../../shared/constants/metametrics":6027,"../../../shared/constants/time":6032,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,"@metamask/obs-store":1203,buffer:1936,"ethereumjs-util":2373,lodash:5016,pubnub:5289},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash"),o=e("@metamask/obs-store"),a=e("ethereumjs-util"),c=e("pubnub"),u=e("../../../shared/constants/app"),l=e("../../../shared/constants/metametrics"),d=e("../../../shared/constants/time");function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const p=e=>{setTimeout((()=>{throw e}))},m={'You must pass either an "anonymousId" or a "userId".':!0};r.default=class{constructor({segment:e,preferencesStore:t,onNetworkDidChange:r,getCurrentChainId:n,getNetworkIdentifier:a,version:c,environment:u,initState:l,captureException:f=p}){(0,i.default)(this,"_getAllNFTsFlattened",(0,s.memoize)(((e={})=>Object.values(e).reduce(((e,t)=>e.concat(...Object.values(t))),[])))),(0,i.default)(this,"_isValidTraitArray",(e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"boolean"==typeof e))||e.every((e=>"number"==typeof e))))),(0,i.default)(this,"_isValidTraitDate",(e=>"[object Date]"===Object.prototype.toString.call(e))),this._captureException=e=>{m[e.message]||f(e)};const g=t.getState();this.chainId=n(),this.network=a(),this.locale=g.currentLocale.replace("_","-"),this.version="production"===u?c:`${c}-${u}`;const y=(0,s.omitBy)(null==l?void 0:l.fragments,"persist");this.store=new o.ObservableStore(h(h({participateInMetaMetrics:null,metaMetricsId:null},l),{},{fragments:h({},null==l?void 0:l.fragments)})),t.subscribe((({currentLocale:e})=>{this.locale=e.replace("_","-")})),r((()=>{this.chainId=n(),this.network=a()})),this.segment=e,Object.values(y).forEach((e=>{this.finalizeEventFragment(e.id,{abandoned:!0})})),setInterval((()=>{Object.values(this.store.getState().fragments).forEach((e=>{e.timeout&&Date.now()-e.lastUpdated/1e3>e.timeout&&this.finalizeEventFragment(e.id,{abandoned:!0})}))}),30*d.SECOND)}generateMetaMetricsId(){return(0,a.bufferToHex)((0,a.keccak)(t.from(String(Date.now())+String(Math.round(Math.random()*Number.MAX_SAFE_INTEGER)))))}createEventFragment(e){var t;if(!e.successEvent||!e.category)throw new Error(`Must specify success event and category. Success event was: ${e.event}. Category was: ${e.category}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`);const{fragments:r}=this.store.getState(),n=null!==(t=e.uniqueIdentifier)&&void 0!==t?t:(0,c.generateUUID)(),i=h(h({id:n},e),{},{lastUpdated:Date.now()});return this.store.updateState({fragments:h(h({},r),{},{[n]:i})}),e.initialEvent&&this.trackEvent({event:i.initialEvent,category:i.category,properties:i.properties,sensitiveProperties:i.sensitiveProperties,page:i.page,referrer:i.referrer,revenue:i.revenue,value:i.value,currency:i.currency,environmentType:i.environmentType}),i}getEventFragmentById(e){const{fragments:t}=this.store.getState();return t[e]}updateEventFragment(e,t){const{fragments:r}=this.store.getState();if(!r[e])throw new Error(`Event fragment with id ${e} does not exist.`);this.store.updateState({fragments:h(h({},r),{},{[e]:(0,s.merge)(r[e],h(h({},t),{},{lastUpdated:Date.now()}))})})}finalizeEventFragment(e,{abandoned:t=!1,page:r,referrer:n}={}){var i;const s=this.store.getState().fragments[e];if(!s)throw new Error(`Funnel with id ${e} does not exist.`);const o=t?s.failureEvent:s.successEvent;this.trackEvent({event:o,category:s.category,properties:s.properties,sensitiveProperties:s.sensitiveProperties,page:null!=r?r:s.page,referrer:null!==(i=s.referrer)&&void 0!==i?i:n,revenue:s.revenue,value:s.value,currency:s.currency,environmentType:s.environmentType});const{fragments:a}=this.store.getState();delete a[e],this.store.updateState({fragments:a})}identify(e){const{metaMetricsId:t,participateInMetaMetrics:r}=this.state;if(!r||!t||!e)return;if("object"!=typeof e)return void console.warn("MetaMetricsController#identify: userTraits parameter must be an object. Received type: "+typeof e);const n=this._buildValidTraits(e);this._identify(n)}setParticipateInMetaMetrics(e){let{metaMetricsId:t}=this.state;return e&&!t?t=this.generateMetaMetricsId():!1===e&&(t=null),this.store.updateState({participateInMetaMetrics:e,metaMetricsId:t}),t}get state(){return this.store.getState()}trackPage({name:e,params:t,environmentType:r,page:n,referrer:i},s){try{if(!1===this.state.participateInMetaMetrics)return;if(null===this.state.participateInMetaMetrics&&(null==s||!s.isOptInPath))return;const{metaMetricsId:o}=this.state,a=o?"userId":"anonymousId",c=null!=o?o:l.METAMETRICS_ANONYMOUS_ID;this.segment.page({[a]:c,name:e,properties:{params:t,locale:this.locale,network:this.network,chain_id:this.chainId,environment_type:r},context:this._buildContext(i,n)})}catch(e){this._captureException(e)}}trackEvent(e,t){this.validatePayload(e),this.submitEvent(e,t).catch((e=>this._captureException(e)))}async submitEvent(e,t){if(this.validatePayload(e),!(this.state.participateInMetaMetrics||null!=t&&t.isOptIn))return;const r=[];if(e.sensitiveProperties){if(!0===(null==t?void 0:t.excludeMetaMetricsId))throw new Error("sensitiveProperties was specified in an event payload that also set the excludeMetaMetricsId flag");const n=(0,s.merge)(e.sensitiveProperties,e.properties);r.push(this._track(this._buildEventPayload(h(h({},e),{},{properties:n})),h(h({},t),{},{excludeMetaMetricsId:!0})))}r.push(this._track(this._buildEventPayload(e),t)),await Promise.all(r)}validatePayload(e){if(!e.event||!e.category)throw new Error(`Must specify event and category. Event was: ${e.event}. Category was: ${e.category}. Payload keys were: ${Object.keys(e)}. ${"object"==typeof e.properties?`Payload property keys were: ${Object.keys(e.properties)}`:""}`)}handleMetaMaskStateUpdate(e){const t=this._buildUserTraitsObject(e);t&&this.identify(t)}_buildContext(e,t=l.METAMETRICS_BACKGROUND_PAGE_OBJECT){return{app:{name:"MetaMask Extension",version:this.version},userAgent:window.navigator.userAgent,page:t,referrer:e}}_buildEventPayload(e){var t,r;const{event:n,properties:i,revenue:o,value:a,currency:c,category:l,page:d,referrer:f,environmentType:p=u.ENVIRONMENT_TYPE_BACKGROUND}=e;return{event:n,properties:h(h({},(0,s.omit)(i,["revenue","locale","currency","value"])),{},{revenue:o,value:a,currency:c,category:l,network:null!==(t=null==i?void 0:i.network)&&void 0!==t?t:this.network,locale:this.locale,chain_id:null!==(r=null==i?void 0:i.chain_id)&&void 0!==r?r:this.chainId,environment_type:p}),context:this._buildContext(f,d)}}_buildUserTraitsObject(e){const t={[l.TRAITS.ADDRESS_BOOK_ENTRIES]:(0,s.sum)(Object.values(e.addressBook).map(s.size)),[l.TRAITS.LEDGER_CONNECTION_TYPE]:e.ledgerTransportType,[l.TRAITS.NETWORKS_ADDED]:e.frequentRpcListDetail.map((e=>e.chainId)),[l.TRAITS.NETWORKS_WITHOUT_TICKER]:e.frequentRpcListDetail.reduce(((e,t)=>(t.ticker||e.push(t.chainId),e)),[]),[l.TRAITS.NFT_AUTODETECTION_ENABLED]:e.useCollectibleDetection,[l.TRAITS.NUMBER_OF_ACCOUNTS]:Object.values(e.identities).length,[l.TRAITS.NUMBER_OF_NFT_COLLECTIONS]:this._getAllUniqueNFTAddressesLength(e.allCollectibles),[l.TRAITS.NUMBER_OF_NFTS]:this._getAllNFTsFlattened(e.allCollectibles).length,[l.TRAITS.NUMBER_OF_TOKENS]:this._getNumberOfTokens(e),[l.TRAITS.OPENSEA_API_ENABLED]:e.openSeaEnabled,[l.TRAITS.THREE_BOX_ENABLED]:e.threeBoxSyncingAllowed,[l.TRAITS.THEME]:e.theme||"default",[l.TRAITS.TOKEN_DETECTION_ENABLED]:e.useTokenDetection};if(!this.previousTraits)return this.previousTraits=t,t;if(this.previousTraits&&!(0,s.isEqual)(this.previousTraits,t)){const e=(0,s.pickBy)(t,((e,t)=>!(0,s.isEqual)(this.previousTraits[t],e)));return this.previousTraits=t,e}return null}_buildValidTraits(e){return Object.entries(e).reduce(((e,[t,r])=>(this._isValidTraitDate(r)?e[t]=r.toISOString():this._isValidTrait(r)?e[t]=r:console.warn(`MetaMetricsController: "${t}" value is not a valid trait type`),e)),{})}_getAllUniqueNFTAddressesLength(e={}){const t=this._getAllNFTsFlattened(e).map((e=>e.address));return new Set(t).size}_getNumberOfTokens(e){return Object.values(e.allTokens).reduce(((e,t)=>e+(0,s.sum)(Object.values(t).map(s.size))),0)}_identify(e){const{metaMetricsId:t}=this.state;if(e&&0!==Object.keys(e).length)try{this.segment.identify({userId:t,traits:e})}catch(e){this._captureException(e)}else console.warn("MetaMetricsController#_identify: No userTraits found")}_isValidTrait(e){const t=typeof e;return"string"===t||"boolean"===t||"number"===t||this._isValidTraitArray(e)||this._isValidTraitDate(e)}_track(e,t){var r;const{isOptIn:n,metaMetricsId:i,matomoEvent:s,flushImmediately:o}=t||{};let a="userId",c=this.state.metaMetricsId,u=null!==(r=null==t?void 0:t.excludeMetaMetricsId)&&void 0!==r&&r;return Boolean(e.event.match(/^send|^confirm/iu))&&(u=!0),u||n&&!i?(a="anonymousId",c=l.METAMETRICS_ANONYMOUS_ID):n&&i&&(c=i),e[a]=c,!0===s&&(e.properties.legacy_event=!0),new Promise(((t,r)=>{this.segment.track(e,(e=>{if(e){const t=new Error(e.message);return t.stack=e.stack,r(t)}return t()})),o&&this.segment.flush()}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$"}],[130,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:47,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=47;const r=t.data;return t.data=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;Array.isArray(r)&&r.forEach((e=>{"number"==typeof e.metamaskNetworkId&&(e.metamaskNetworkId=e.metamaskNetworkId.toString())}));return e}(r),t}};r.default=i}}},{package:"$root$"}],[1300,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}}}},{package:"@metamask/snap-controllers>nanoid"}],[1301,{_process:5261,"readable-stream":5541,util:1942,xtend:6010},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,i=e("util").inherits,s=e("xtend");function o(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(o,n),o.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new o(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=s(e,t),o.call(this,this.options)}return i(n,o),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new o(s({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>@metamask/obs-store>through2"}],[1302,{"./json":1303,"./misc":1304,"./time":1305},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./json"),r),i(e("./misc"),r),i(e("./time"),r)}}},{package:"@metamask/rpc-methods>@metamask/utils"}],[1303,{"./misc":1304,"fast-deep-equal":4145},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getJsonRpcIdValidator=r.assertIsJsonRpcFailure=r.isJsonRpcFailure=r.assertIsJsonRpcSuccess=r.isJsonRpcSuccess=r.assertIsJsonRpcRequest=r.isJsonRpcRequest=r.assertIsJsonRpcNotification=r.isJsonRpcNotification=r.jsonrpc2=r.isValidJson=void 0;const i=n(e("fast-deep-equal")),s=e("./misc");function o(e){return!s.hasProperty(e,"id")}function a(e){return s.hasProperty(e,"id")}function c(e){return s.hasProperty(e,"result")}function u(e){return s.hasProperty(e,"error")}r.isValidJson=function(e){try{return i.default(e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}},r.jsonrpc2="2.0",r.isJsonRpcNotification=o,r.assertIsJsonRpcNotification=function(e){if(!o(e))throw new Error("Not a JSON-RPC notification.")},r.isJsonRpcRequest=a,r.assertIsJsonRpcRequest=function(e){if(!a(e))throw new Error("Not a JSON-RPC request.")},r.isJsonRpcSuccess=c,r.assertIsJsonRpcSuccess=function(e){if(!c(e))throw new Error("Not a successful JSON-RPC response.")},r.isJsonRpcFailure=u,r.assertIsJsonRpcFailure=function(e){if(!u(e))throw new Error("Not a failed JSON-RPC response.")},r.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}=Object.assign({permitEmptyString:!0,permitFractions:!1,permitNull:!0},e);return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)}}}},{package:"@metamask/rpc-methods>@metamask/utils"}],[1304,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hasProperty=r.isObject=r.isNullOrUndefined=r.isNonEmptyArray=void 0,r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isNullOrUndefined=function(e){return null===e||e===undefined},r.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};r.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t)}}},{package:"@metamask/rpc-methods>@metamask/utils"}],[1305,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.timeSince=r.inMilliseconds=r.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(r.Duration||(r.Duration={}));const n=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};r.inMilliseconds=function(e,t){return n(e,"count"),e*t},r.timeSince=function(e){return n(e,"timestamp"),Date.now()-e}}}},{package:"@metamask/rpc-methods>@metamask/utils"}],[1306,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=n}var o=e.length,a=e.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,i=0;e[r]===a;)n++,r++;for(var s=(e.length-r)*c+1>>>0,u=new Uint8Array(s);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var d=0,f=s-1;(0!==l||d<i)&&-1!==f;f--,d++)l+=o*u[f]>>>0,u[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=d,r++}if(" "!==e[r]){for(var h=s-i;h!==s&&0===u[h];)h++;for(var p=new Uint8Array(n+(s-h)),m=n;h!==s;)p[m++]=u[h++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var c=(s-i)*u+1>>>0,l=new Uint8Array(c);i!==s;){for(var d=t[i],f=0,h=c-1;(0!==d||f<n)&&-1!==h;h--,f++)d+=256*l[h]>>>0,l[h]=d%o>>>0,d=d/o>>>0;if(0!==d)throw new Error("Non-zero carry");n=f,i++}for(var p=c-n;p!==c&&0===l[p];)p++;for(var m=a.repeat(r);p<c;++p)m+=e.charAt(l[p]);return m},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+o+" character")}}}}}},{package:"@ensdomains/content-hash>cids>multibase>@multiformats/base-x"}],[131,{"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:48,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=48;const r=t.data;return t.data=function(e={}){var t,r,n,i,s,o,c,d,f;null===(t=e.NetworkController)||void 0===t||delete t.settings;const h=(null===(r=e.NetworkController)||void 0===r?void 0:r.provider)||{};if(("rpc"!==h.type||"string"==typeof h.chainId&&l.test(h.chainId))&&"localhost"!==h.type){if(null!==(n=e.NetworkController)&&void 0!==n&&n.provider){var p,m;if("rpcTarget"in e.NetworkController.provider){const t=e.NetworkController.provider.rpcTarget;e.NetworkController.provider.rpcUrl=t}null===(p=e.NetworkController)||void 0===p||(null===(m=p.provider)||void 0===m||delete m.rpcTarget)}}else e.NetworkController.provider={type:"rinkeby",rpcUrl:"",chainId:"0x4",nickname:"",rpcPrefs:{},ticker:"ETH"};e.PreferencesController||(e.PreferencesController={});e.PreferencesController.frequentRpcListDetail||(e.PreferencesController.frequentRpcListDetail=[]);e.PreferencesController.frequentRpcListDetail.unshift({rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}),null===(i=e.CachedBalancesController)||void 0===i||delete i.cachedBalances;const g=null===(s=e.TransactionController)||void 0===s?void 0:s.transactions;Array.isArray(g)&&g.forEach((e=>{const t=null==e?void 0:e.metamaskNetworkId;"string"==typeof t&&u.test(t)&&(e.metamaskNetworkId=parseInt(t,16).toString(10))}));const y=(null===(o=e.AddressBookController)||void 0===o?void 0:o.addressBook)||{};Object.keys(y).forEach((e=>{if(/^\d+$/iu.test(e)){const t=`0x${parseInt(e,10).toString(16)}`;!function(e,t){Object.values(e).forEach((e=>{e&&"object"==typeof e&&(e.chainId=t)}))}(y[e],t),y[t]?function(e,t,r){const n=e[t]||{},i=a({},e[r]);Object.keys(n).forEach((e=>{if(i[e]&&"object"==typeof i[e]){const t={};new Set([...Object.keys(i[e]),...Object.keys(n[e]||{})]).forEach((r=>{var s;t[r]=i[e][r]||(null===(s=n[e])||void 0===s?void 0:s[r])||""})),i[e]=t}else n[e]&&"object"==typeof n[e]&&(i[e]=n[e])})),e[r]=i}(y,e,t):y[t]=y[e],delete y[e]}})),null===(c=e.IncomingTransactionsController)||void 0===c||null===(d=c.incomingTxLastFetchedBlocksByNetwork)||void 0===d||delete d.localhost;const b=null===(f=e.PreferencesController)||void 0===f?void 0:f.accountTokens;b&&Object.keys(b).forEach((e=>{var t,r;const n=(null===(t=b[e])||void 0===t?void 0:t.localhost)||[];if(n.length>0){const t=b[e].rpc||[];t.length>0?b[e].rpc=function(e,t){const r=s(e),n=s(t),i=[];return new Set([...Object.keys(r),...Object.keys(n)]).forEach((e=>{i.push(a(a({},r[e]),n[e]))})),i;function s(e){return e.reduce(((e,t)=>(null!=t&&t.address&&"string"==typeof(null==t?void 0:t.address)&&(e[t.address]=t),e)),{})}}(n,t):b[e].rpc=n}null===(r=b[e])||void 0===r||delete r.localhost}));return e}(r),t}};r.default=c;const u=/^0x[0-9a-f]+$/iu,l=/^0x[1-9a-f]+[0-9a-f]*$/iu}}},{package:"$root$"}],[132,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:49,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=49;const r=t.data;return t.data=function(e={}){if(e.PreferencesController){var t;const{metaMetricsId:r,participateInMetaMetrics:n,metaMetricsSendCount:i}=e.PreferencesController;e.MetaMetricsController=null!==(t=e.MetaMetricsController)&&void 0!==t?t:{},r!==undefined&&(e.MetaMetricsController.metaMetricsId=r,delete e.PreferencesController.metaMetricsId),n!==undefined&&(e.MetaMetricsController.participateInMetaMetrics=n,delete e.PreferencesController.participateInMetaMetrics),i!==undefined&&(e.MetaMetricsController.metaMetricsSendCount=i,delete e.PreferencesController.metaMetricsSendCount)}return e}(r),t}};r.default=i}}},{package:"$root$"}],[1320,{crypto:1935},function(){with(this)return function(){"use strict";return function(e,t,r){
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.curve25519=r.getSharedSecret=r.verify=r.sign=r.getPublicKey=r.Signature=r.Point=r.RistrettoPoint=r.ExtendedPoint=r.CURVE=void 0;const i=n(e("crypto")),s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(255),u=a**BigInt(252)+BigInt("27742317777372353535851937790883648493"),l={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:a**c-BigInt(19),l:u,n:u,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};r.CURVE=l;const d=a**BigInt(256),f=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),h=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),p=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),m=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),g=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class y{constructor(e,t,r,n){this.x=e,this.y=t,this.z=r,this.t=n}static fromAffine(e){if(!(e instanceof E))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(E.ZERO)?y.ZERO:new y(e.x,e.y,o,R(e.x*e.y))}static toAffineBatch(e){const t=function(e,t=l.P){const r=new Array(e.length),n=C(e.reduce(((e,n,i)=>n===s?e:(r[i]=e,R(e*n,t))),o),t);return e.reduceRight(((e,n,i)=>n===s?e:(r[i]=R(e*r[i],t),R(e*n,t))),n),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){b(e);const{x:t,y:r,z:n}=this,{x:i,y:s,z:o}=e,a=R(t*o),c=R(i*n),u=R(r*o),l=R(s*n);return a===c&&u===l}negate(){return new y(R(-this.x),this.y,this.z,R(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:n}=l,i=R(e**a),s=R(t**a),o=R(a*R(r**a)),c=R(n*i),u=R(R((e+t)**a)-i-s),d=c+s,f=d-o,h=c-s,p=R(u*f),m=R(d*h),g=R(u*h),b=R(f*d);return new y(p,m,b,g)}add(e){b(e);const{x:t,y:r,z:n,t:i}=this,{x:o,y:c,z:u,t:l}=e,d=R((r-t)*(c+o)),f=R((r+t)*(c-o)),h=R(f-d);if(h===s)return this.double();const p=R(n*a*l),m=R(i*a*u),g=m+p,w=f+d,v=m-p,_=R(g*h),S=R(w*v),E=R(g*v),k=R(h*w);return new y(_,S,k,E)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(y.BASE)&&(t=E.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&S.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=y.normalizeZ(n),S.set(t,n)));let i=y.ZERO,s=y.ZERO;const a=1+256/r,c=2**(r-1),u=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let t=0;t<a;t++){const r=t*c;let a=Number(e&u);if(e>>=d,a>c&&(a-=l,e+=o),0===a){let e=n[r];t%2&&(e=e.negate()),s=s.add(e)}else{let e=n[r+Math.abs(a)-1];a<0&&(e=e.negate()),i=i.add(e)}}return y.normalizeZ([i,s])[0]}multiply(e,t){return this.wNAF(K(e,l.l),t)}multiplyUnsafe(e){let t=K(e,l.l,!1);const r=y.BASE,n=y.ZERO;if(t===s)return n;if(this.equals(n)||t===o)return this;if(this.equals(r))return this.wNAF(t);let i=n,a=this;for(;t>s;)t&o&&(i=i.add(a)),a=a.double(),t>>=o;return i}isSmallOrder(){return this.multiplyUnsafe(l.h).equals(y.ZERO)}isTorsionFree(){return this.multiplyUnsafe(l.l).equals(y.ZERO)}toAffine(e=C(this.z)){const{x:t,y:r,z:n}=this,i=R(t*e),s=R(r*e);if(R(n*e)!==o)throw new Error("invZ was invalid");return new E(i,s)}fromRistrettoBytes(){v()}toRistrettoBytes(){v()}fromRistrettoHash(){v()}}function b(e){if(!(e instanceof y))throw new TypeError("ExtendedPoint expected")}function w(e){if(!(e instanceof _))throw new TypeError("RistrettoPoint expected")}function v(){throw new Error("Legacy method: switch to RistrettoPoint")}r.ExtendedPoint=y,y.BASE=new y(l.Gx,l.Gy,o,R(l.Gx*l.Gy)),y.ZERO=new y(s,o,o,s);class _{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=l,r=R(f*e*e),n=R((r+o)*m);let i=BigInt(-1);const s=R((i-t*r)*R(r+t));let{isValid:a,value:c}=D(n,s),u=R(c*e);I(u)||(u=R(-u)),a||(c=u),a||(i=r);const d=R(i*(r-o)*g-s),p=c*c,b=R((c+c)*s),w=R(d*h),v=R(o-p),_=R(o+p);return new y(R(b*_),R(v*w),R(w*_),R(b*v))}static hashToCurve(e){const t=N((e=H(e,64)).slice(0,32)),r=this.calcElligatorRistrettoMap(t),n=N(e.slice(32,64)),i=this.calcElligatorRistrettoMap(n);return new _(r.add(i))}static fromHex(e){e=H(e,32);const{a:t,d:r}=l,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=N(e);if(!function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(x(i),e)||I(i))throw new Error(n);const a=R(i*i),c=R(o+t*a),u=R(o-t*a),d=R(c*c),f=R(u*u),h=R(t*r*d-f),{isValid:p,value:m}=L(R(h*f)),g=R(m*u),b=R(m*g*h);let w=R((i+i)*g);I(w)&&(w=R(-w));const v=R(c*b),S=R(w*v);if(!p||I(S)||v===s)throw new Error(n);return new _(new y(w,v,o,S))}toRawBytes(){let{x:e,y:t,z:r,t:n}=this.ep;const i=R(R(r+t)*R(r-t)),s=R(e*t),{value:o}=L(R(i*s**a)),c=R(o*i),u=R(o*s),l=R(c*u*n);let d;if(I(n*l)){let r=R(t*f),n=R(e*f);e=r,t=n,d=R(c*p)}else d=u;I(e*l)&&(t=R(-t));let h=R((r-t)*d);return I(h)&&(h=R(-h)),x(h)}toHex(){return T(this.toRawBytes())}toString(){return this.toHex()}equals(e){w(e);const t=this.ep,r=e.ep,n=R(t.x*r.y)===R(t.y*r.x),i=R(t.y*r.y)===R(t.x*r.x);return n||i}add(e){return w(e),new _(this.ep.add(e.ep))}subtract(e){return w(e),new _(this.ep.subtract(e.ep))}multiply(e){return new _(this.ep.multiply(e))}multiplyUnsafe(e){return new _(this.ep.multiplyUnsafe(e))}}r.RistrettoPoint=_,_.BASE=new _(y.BASE),_.ZERO=new _(y.ZERO);const S=new WeakMap;class E{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,S.delete(this)}static fromHex(e,t=!0){const{d:r,P:n}=l,i=(e=H(e,32)).slice();i[31]=-129&e[31];const s=j(i);if(t&&s>=n)throw new Error("Expected 0 < hex < P");if(!t&&s>=d)throw new Error("Expected 0 < hex < 2**256");const a=R(s*s),c=R(a-o),u=R(r*a+o);let{isValid:f,value:h}=D(c,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");const p=(h&o)===o;return 0!=(128&e[31])!==p&&(h=R(-h)),new E(h,s)}static async fromPrivateKey(e){return(await F(e)).point}toRawBytes(){const e=x(this.y);return e[31]|=this.x&o?128:0,e}toHex(){return T(this.toRawBytes())}toX25519(){const{y:e}=this;return x(R((o+e)*C(o-e)))}isTorsionFree(){return y.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new E(R(-this.x),this.y)}add(e){return y.fromAffine(this).add(y.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return y.fromAffine(this).multiply(e,this).toAffine()}}r.Point=E,E.BASE=new E(l.Gx,l.Gy),E.ZERO=new E(s,o);class k{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=H(e,64),r=E.fromHex(t.slice(0,32),!1),n=j(t.slice(32,64));return new k(r,n)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof E))throw new Error("Expected Point instance");return K(t,l.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(x(this.s),32),e}toHex(){return T(this.toRawBytes())}}r.Signature=k;const P=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function T(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=P[e[r]];return t}function A(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function O(e){return A(e.toString(16).padStart(64,"0"))}function x(e){return O(e).reverse()}function I(e){return(R(e)&o)===o}function j(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+T(Uint8Array.from(e).reverse()))}function N(e){return R(j(e)&a**c-o)}function R(e,t=l.P){const r=e%t;return r>=s?r:t+r}function C(e,t=l.P){if(e===s||t<=s)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=R(e,t),n=t,i=s,a=o,c=o,u=s;for(;r!==s;){const e=n/r,t=n%r,s=i-c*e,o=a-u*e;n=r,r=t,i=c,a=u,c=s,u=o}if(n!==o)throw new Error("invert: does not exist");return R(i,t)}function M(e,t){const{P:r}=l;let n=e;for(;t-- >s;)n*=n,n%=r;return n}function B(e){const{P:t}=l,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),c=BigInt(80),u=e*e%t*e%t,d=M(u,a)*u%t,f=M(d,o)*e%t,h=M(f,r)*f%t,p=M(h,n)*h%t,m=M(p,i)*p%t,g=M(m,s)*m%t,y=M(g,c)*g%t,b=M(y,c)*g%t,w=M(b,n)*h%t;return{pow_p_5_8:M(w,a)*e%t,b2:u}}function D(e,t){const r=R(t*t*t),n=R(r*r*t);let i=R(e*r*B(e*n).pow_p_5_8);const s=R(t*i*i),o=i,a=R(i*f),c=s===e,u=s===R(-e),l=s===R(-e*f);return c&&(i=o),(u||l)&&(i=a),I(i)&&(i=R(-i)),{isValid:c||u,value:i}}function L(e){return D(o,e)}async function U(...e){return R(j(await r.utils.sha512(function(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(...e))),l.l)}function H(e,t){const r=e instanceof Uint8Array?Uint8Array.from(e):A(e);if("number"==typeof t&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function K(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t)if(r){if(s<e)return e}else if(s<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function $(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}async function F(e){if(32!==(e="bigint"==typeof e||"number"==typeof e?O(K(e,d)):H(e)).length)throw new Error("Expected 32 bytes");const t=await r.utils.sha512(e),n=$(t.slice(0,32)),i=t.slice(32,64),s=R(j(n),l.l),o=E.BASE.multiply(s),a=o.toRawBytes();return{head:n,prefix:i,scalar:s,point:o,pointBytes:a}}function q(e,t,r){const n=R(e*(t-r));return[t=R(t-n),r=R(r+n)]}r.getPublicKey=async function(e){return(await F(e)).pointBytes},r.sign=async function(e,t){e=H(e);const{prefix:r,scalar:n,pointBytes:i}=await F(t),s=await U(r,e),o=E.BASE.multiply(s),a=R(s+await U(o.toRawBytes(),i,e)*n,l.l);return new k(o,a).toRawBytes()},r.verify=async function(e,t,r){t=H(t),r instanceof E||(r=E.fromHex(r,!1));const{r:n,s:i}=e instanceof k?e.assertValidity():k.fromHex(e),s=y.BASE.multiplyUnsafe(i),o=await U(n.toRawBytes(),r.toRawBytes(),t),a=y.fromAffine(r).multiplyUnsafe(o);return y.fromAffine(n).add(a).subtract(s).multiplyUnsafe(l.h).equals(y.ZERO)},r.getSharedSecret=async function(e,t){const{head:n}=await F(e),i=E.fromHex(t).toX25519();return r.curve25519.scalarMult(n,i)},E.BASE._setWindowSize(8),r.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(e,t){const r=function(e,t){const{P:r}=l,n=K(e,r),i=K(t,r),c=BigInt(121665),u=n;let d,f=o,h=s,p=n,m=o,g=s;for(let e=BigInt(254);e>=s;e--){const t=i>>e&o;g^=t,d=q(g,f,p),f=d[0],p=d[1],d=q(g,h,m),h=d[0],m=d[1],g=t;const r=f+h,n=R(r*r),s=f-h,l=R(s*s),y=n-l,b=p+m,w=R((p-m)*r),v=R(b*s);p=R((w+v)**a),m=R(u*(w-v)**a),f=R(n*l),h=R(y*(n+R(c*y)))}d=q(g,f,p),f=d[0],p=d[1],d=q(g,h,m),h=d[0],m=d[1];const{pow_p_5_8:y,b2:b}=B(h),w=R(M(y,BigInt(3))*b);return R(f*w)}(function(e){const t=H(e,32);return t[31]&=127,j(t)}(t),j($(H(e,32))));if(r===s)throw new Error("Invalid private or public key received");return function(e){return x(R(e,l.P))}(r)},scalarMultBase:e=>r.curve25519.scalarMult(e,r.curve25519.BASE_POINT_U)};const V={node:i.default,web:"object"==typeof self&&"crypto"in self?self.crypto:undefined};r.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:T,getExtendedPublicKey:F,mod:R,invert:C,hashToPrivateScalar:e=>{if((e=H(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");const t=R(j(e),l.l);if(t===s||t===o)throw new Error("Invalid private key");return t},randomBytes:(e=32)=>{if(V.web)return V.web.getRandomValues(new Uint8Array(e));if(V.node){const{randomBytes:t}=V.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>r.utils.randomBytes(32),sha512:async e=>{if(V.web){const t=await V.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}if(V.node)return Uint8Array.from(V.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=E.BASE){const r=t.equals(E.BASE)?t:new E(t.x,t.y);return r._setWindowSize(e),r.multiply(a),r}}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/ed25519"}],[1321,{"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SHA2=void 0;const n=e("./utils.js");class i extends n.Hash{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,n.createView)(this.buffer)}update(e){if(this.destroyed)throw new Error("instance is destroyed");const{view:t,buffer:r,blockLen:i,finished:s}=this;if(s)throw new Error("digest() was already called");const o=(e=(0,n.toBytes)(e)).length;for(let s=0;s<o;){const a=Math.min(i-this.pos,o-s);if(a!==i)r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=(0,n.createView)(e);for(;i<=o-s;s+=i)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){if(this.destroyed)throw new Error("instance is destroyed");if(!(e instanceof Uint8Array)||e.length<this.outputLen)throw new Error("_Sha2: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let e=o;e<i;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}(r,i-8,BigInt(8*this.length),s),this.process(r,0);const a=(0,n.createView)(e);this.get().forEach(((e,t)=>a.setUint32(4*t,e,s)))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.length=n,e.pos=o,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}r.SHA2=i}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1322,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.add5H=r.add5L=r.add4H=r.add4L=r.add3H=r.add3L=r.add=r.rotlBL=r.rotlBH=r.rotlSL=r.rotlSH=r.rotr32L=r.rotr32H=r.rotrBL=r.rotrBH=r.rotrSL=r.rotrSH=r.shrSL=r.shrSH=r.toBig=r.split=r.fromBig=void 0;const n=BigInt(2**32-1),i=BigInt(32);function s(e,t=!1){return t?{h:Number(e&n),l:Number(e>>i&n)}:{h:0|Number(e>>i&n),l:0|Number(e&n)}}r.fromBig=s,r.split=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:a}=s(e[i],t);[r[i],n[i]]=[o,a]}return[r,n]};r.toBig=(e,t)=>BigInt(e>>>0)<<i|BigInt(t>>>0);r.shrSH=(e,t,r)=>e>>>r;r.shrSL=(e,t,r)=>e<<32-r|t>>>r;r.rotrSH=(e,t,r)=>e>>>r|t<<32-r;r.rotrSL=(e,t,r)=>e<<32-r|t>>>r;r.rotrBH=(e,t,r)=>e<<64-r|t>>>r-32;r.rotrBL=(e,t,r)=>e>>>r-32|t<<64-r;r.rotr32H=(e,t)=>t;r.rotr32L=(e,t)=>e;r.rotlSH=(e,t,r)=>e<<r|t>>>32-r;r.rotlSL=(e,t,r)=>t<<r|e>>>32-r;r.rotlBH=(e,t,r)=>t<<r-32|e>>>64-r;r.rotlBL=(e,t,r)=>e<<r-32|t>>>64-r,r.add=function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}};r.add3L=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);r.add3H=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;r.add4L=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);r.add4H=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;r.add5L=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);r.add5H=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1323,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.crypto=void 0,r.crypto={node:undefined,web:"object"==typeof self&&"crypto"in self?self.crypto:undefined}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1324,{"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hmac=void 0;const n=e("./utils.js");class i extends n.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,n.assertHash)(e);const r=(0,n.toBytes)(t);if(this.iHash=e.create(),!(this.iHash instanceof n.Hash))throw new TypeError("Expected instance of class which extends utils.Hash");const i=this.blockLen=this.iHash.blockLen;this.outputLen=this.iHash.outputLen;const s=new Uint8Array(i);s.set(r.length>this.iHash.blockLen?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){if(this.destroyed)throw new Error("instance is destroyed");return this.iHash.update(e),this}digestInto(e){if(this.destroyed)throw new Error("instance is destroyed");if(!(e instanceof Uint8Array)||e.length!==this.outputLen)throw new Error("HMAC: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return(e=e).finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}r.hmac=(e,t,r)=>new i(e,t).update(r).digest(),r.hmac.create=(e,t)=>new i(e,t)}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1325,{"./hmac.js":1324,"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.pbkdf2Async=r.pbkdf2=void 0;const n=e("./hmac.js"),i=e("./utils.js");function s(e,t,r,s){(0,i.assertHash)(e);const o=(0,i.checkOpts)({dkLen:32,asyncTick:10},s),{c:a,dkLen:c,asyncTick:u}=o;if((0,i.assertNumber)(a),(0,i.assertNumber)(c),(0,i.assertNumber)(u),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=(0,i.toBytes)(t),d=(0,i.toBytes)(r),f=new Uint8Array(c),h=n.hmac.create(e,l),p=h._cloneInto().update(d);return{c:a,dkLen:c,asyncTick:u,DK:f,PRF:h,PRFSalt:p}}function o(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}r.pbkdf2=function(e,t,r,n){const{c:a,dkLen:c,DK:u,PRF:l,PRFSalt:d}=s(e,t,r,n);let f;const h=new Uint8Array(4),p=(0,i.createView)(h),m=new Uint8Array(l.outputLen);for(let e=1,t=0;t<c;e++,t+=l.outputLen){const r=u.subarray(t,t+l.outputLen);p.setInt32(0,e,!1),(f=d._cloneInto(f)).update(h).digestInto(m),r.set(m.subarray(0,r.length));for(let e=1;e<a;e++){l._cloneInto(f).update(m).digestInto(m);for(let e=0;e<r.length;e++)r[e]^=m[e]}}return o(l,d,u,f,m)},r.pbkdf2Async=async function(e,t,r,n){const{c:a,dkLen:c,asyncTick:u,DK:l,PRF:d,PRFSalt:f}=s(e,t,r,n);let h;const p=new Uint8Array(4),m=(0,i.createView)(p),g=new Uint8Array(d.outputLen);for(let e=1,t=0;t<c;e++,t+=d.outputLen){const r=l.subarray(t,t+d.outputLen);m.setInt32(0,e,!1),(h=f._cloneInto(h)).update(p).digestInto(g),r.set(g.subarray(0,r.length)),await(0,i.asyncLoop)(a-1,u,(e=>{d._cloneInto(h).update(g).digestInto(g);for(let e=0;e<r.length;e++)r[e]^=g[e]}))}return o(d,f,l,h,g)}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1326,{"./_sha2.js":1321,"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ripemd160=r.RIPEMD160=void 0;const n=e("./_sha2.js"),i=e("./utils.js"),s=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),o=Uint8Array.from({length:16},((e,t)=>t)),a=o.map((e=>(9*e+5)%16));let c=[o],u=[a];for(let e=0;e<4;e++)for(let t of[c,u])t.push(t[e].map((e=>s[e])));const l=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((e=>new Uint8Array(e))),d=c.map(((e,t)=>e.map((e=>l[t][e])))),f=u.map(((e,t)=>e.map((e=>l[t][e])))),h=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),p=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),m=(e,t)=>e<<t|e>>>32-t;function g(e,t,r,n){return 0===e?t^r^n:1===e?t&r|~t&n:2===e?(t|~r)^n:3===e?t&n|r&~n:t^(r|~n)}const y=new Uint32Array(16);class b extends n.SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:n,h4:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.h0=0|e,this.h1=0|t,this.h2=0|r,this.h3=0|n,this.h4=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)y[r]=e.getUint32(t,!0);let r=0|this.h0,n=r,i=0|this.h1,s=i,o=0|this.h2,a=o,l=0|this.h3,b=l,w=0|this.h4,v=w;for(let e=0;e<5;e++){const t=4-e,_=h[e],S=p[e],E=c[e],k=u[e],P=d[e],T=f[e];for(let t=0;t<16;t++){const n=m(r+g(e,i,o,l)+y[E[t]]+_,P[t])+w|0;r=w,w=l,l=0|m(o,10),o=i,i=n}for(let e=0;e<16;e++){const r=m(n+g(t,s,a,b)+y[k[e]]+S,T[e])+v|0;n=v,v=b,b=0|m(a,10),a=s,s=r}}this.set(this.h1+o+b|0,this.h2+l+v|0,this.h3+w+n|0,this.h4+r+s|0,this.h0+i+a|0)}roundClean(){y.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}r.RIPEMD160=b,r.ripemd160=(0,i.wrapConstructor)((()=>new b))}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1327,{"./_sha2.js":1321,"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.sha256=void 0;const n=e("./_sha2.js"),i=e("./utils.js"),s=(e,t,r)=>e&t^e&r^t&r,o=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class u extends n.SHA2{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)c[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=c[e-15],r=c[e-2],n=(0,i.rotr)(t,7)^(0,i.rotr)(t,18)^t>>>3,s=(0,i.rotr)(r,17)^(0,i.rotr)(r,19)^r>>>10;c[e]=s+c[e-7]+n+c[e-16]|0}let{A:r,B:n,C:a,D:u,E:l,F:d,G:f,H:h}=this;for(let e=0;e<64;e++){const t=h+((0,i.rotr)(l,6)^(0,i.rotr)(l,11)^(0,i.rotr)(l,25))+((p=l)&d^~p&f)+o[e]+c[e]|0,m=((0,i.rotr)(r,2)^(0,i.rotr)(r,13)^(0,i.rotr)(r,22))+s(r,n,a)|0;h=f,f=d,d=l,l=u+t|0,u=a,a=n,n=r,r=t+m|0}var p;r=r+this.A|0,n=n+this.B|0,a=a+this.C|0,u=u+this.D|0,l=l+this.E|0,d=d+this.F|0,f=f+this.G|0,h=h+this.H|0,this.set(r,n,a,u,l,d,f,h)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}r.sha256=(0,i.wrapConstructor)((()=>new u))}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1328,{"./_u64.js":1322,"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.shake256=r.shake128=r.keccak_512=r.keccak_384=r.keccak_256=r.keccak_224=r.sha3_512=r.sha3_384=r.sha3_256=r.sha3_224=r.Keccak=r.keccakP=void 0;const o=s(e("./_u64.js")),a=e("./utils.js"),[c,u,l]=[[],[],[]],d=BigInt(0),f=BigInt(1),h=BigInt(2),p=BigInt(7),m=BigInt(256),g=BigInt(113);for(let e=0,t=f,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],c.push(2*(5*n+r)),u.push((e+1)*(e+2)/2%64);let i=d;for(let e=0;e<7;e++)t=(t<<f^(t>>p)*g)%m,t&h&&(i^=f<<(f<<BigInt(e))-f);l.push(i)}const[y,b]=o.split(l,!0),w=(e,t,r)=>r>32?o.rotlBH(e,t,r):o.rotlSH(e,t,r),v=(e,t,r)=>r>32?o.rotlBL(e,t,r):o.rotlSL(e,t,r);function _(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=w(s,o,1)^r[n],c=v(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=u[r],s=w(t,i,n),o=v(t,i,n),a=c[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=y[n],e[1]^=b[n]}r.fill(0)}r.keccakP=_;class S extends a.Hash{constructor(e,t,r,n=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,a.assertNumber)(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,a.u32)(this.state)}keccak(){_(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){if(this.destroyed)throw new Error("instance is destroyed");if(this.finished)throw new Error("digest() was already called");const{blockLen:t,state:r}=this,n=(e=(0,a.toBytes)(e)).length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,0!=(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){if(this.destroyed)throw new Error("instance is destroyed");if(!(e instanceof Uint8Array))throw new Error("Keccak: invalid output buffer");this.finish();for(let t=0,r=e.length;t<r;){this.posOut>=this.blockLen&&this.keccak();const n=Math.min(this.blockLen-this.posOut,r-t);e.set(this.state.subarray(this.posOut,this.posOut+n),t),this.posOut+=n,t+=n}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,a.assertNumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(e.length<this.outputLen)throw new Error("Keccak: invalid output buffer");if(this.finished)throw new Error("digest() was already called");return this.finish(),this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new S(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}r.Keccak=S;const E=(e,t,r)=>(0,a.wrapConstructor)((()=>new S(t,e,r)));r.sha3_224=E(6,144,28),r.sha3_256=E(6,136,32),r.sha3_384=E(6,104,48),r.sha3_512=E(6,72,64),r.keccak_224=E(1,144,28),r.keccak_256=E(1,136,32),r.keccak_384=E(1,104,48),r.keccak_512=E(1,72,64);const k=(e,t,r)=>(0,a.wrapConstructorWithOpts)(((n={})=>new S(t,e,n.dkLen!==undefined?n.dkLen:r,!0)));r.shake128=k(31,168,16),r.shake256=k(31,136,32)}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1329,{"./_sha2.js":1321,"./_u64.js":1322,"./utils.js":1330},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.sha384=r.sha512_256=r.sha512=r.SHA512=void 0;const o=e("./_sha2.js"),a=s(e("./_u64.js")),c=e("./utils.js"),[u,l]=a.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))),d=new Uint32Array(80),f=new Uint32Array(80);class h extends o.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:u,Fh:l,Fl:d,Gh:f,Gl:h,Hh:p,Hl:m}=this;return[e,t,r,n,i,s,o,a,c,u,l,d,f,h,p,m]}set(e,t,r,n,i,s,o,a,c,u,l,d,f,h,p,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|d,this.Gh=0|f,this.Gl=0|h,this.Hh=0|p,this.Hl=0|m}process(e,t){for(let r=0;r<16;r++,t+=4)d[r]=e.getUint32(t),f[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|d[e-15],r=0|f[e-15],n=a.rotrSH(t,r,1)^a.rotrSH(t,r,8)^a.shrSH(t,r,7),i=a.rotrSL(t,r,1)^a.rotrSL(t,r,8)^a.shrSL(t,r,7),s=0|d[e-2],o=0|f[e-2],c=a.rotrSH(s,o,19)^a.rotrBH(s,o,61)^a.shrSH(s,o,6),u=a.rotrSL(s,o,19)^a.rotrBL(s,o,61)^a.shrSL(s,o,6),l=a.add4L(i,u,f[e-7],f[e-16]),h=a.add4H(l,n,c,d[e-7],d[e-16]);d[e]=0|h,f[e]=0|l}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:c,Dh:h,Dl:p,Eh:m,El:g,Fh:y,Fl:b,Gh:w,Gl:v,Hh:_,Hl:S}=this;for(let e=0;e<80;e++){const t=a.rotrSH(m,g,14)^a.rotrSH(m,g,18)^a.rotrBH(m,g,41),E=a.rotrSL(m,g,14)^a.rotrSL(m,g,18)^a.rotrBL(m,g,41),k=m&y^~m&w,P=g&b^~g&v,T=a.add5L(S,E,P,l[e],f[e]),A=a.add5H(T,_,t,k,u[e],d[e]),O=0|T,x=a.rotrSH(r,n,28)^a.rotrBH(r,n,34)^a.rotrBH(r,n,39),I=a.rotrSL(r,n,28)^a.rotrBL(r,n,34)^a.rotrBL(r,n,39),j=r&i^r&o^i&o,N=n&s^n&c^s&c;_=0|w,S=0|v,w=0|y,v=0|b,y=0|m,b=0|g,({h:m,l:g}=a.add(0|h,0|p,0|A,0|O)),h=0|o,p=0|c,o=0|i,c=0|s,i=0|r,s=0|n;const R=a.add3L(O,I,N);r=a.add3H(R,A,x,j),n=0|R}({h:r,l:n}=a.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=a.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:c}=a.add(0|this.Ch,0|this.Cl,0|o,0|c)),({h:h,l:p}=a.add(0|this.Dh,0|this.Dl,0|h,0|p)),({h:m,l:g}=a.add(0|this.Eh,0|this.El,0|m,0|g)),({h:y,l:b}=a.add(0|this.Fh,0|this.Fl,0|y,0|b)),({h:w,l:v}=a.add(0|this.Gh,0|this.Gl,0|w,0|v)),({h:_,l:S}=a.add(0|this.Hh,0|this.Hl,0|_,0|S)),this.set(r,n,i,s,o,c,h,p,m,g,y,b,w,v,_,S)}roundClean(){d.fill(0),f.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}r.SHA512=h;class p extends h{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class m extends h{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}r.sha512=(0,c.wrapConstructor)((()=>new h)),r.sha512_256=(0,c.wrapConstructor)((()=>new p)),r.sha384=(0,c.wrapConstructor)((()=>new m))}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[133,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");const i=["METASWAP_GAS_PRICE_ESTIMATES_LAST_RETRIEVED","METASWAP_GAS_PRICE_ESTIMATES","cachedFetch","BASIC_PRICE_ESTIMATES_LAST_RETRIEVED","BASIC_PRICE_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES"];var s={version:50,async migrate(e){const t=(0,n.cloneDeep)(e);return t.meta.version=50,i.forEach((e=>{var t;return null===(t=window.localStorage)||void 0===t?void 0:t.removeItem(e)})),t}};r.default=s}}},{package:"$root$"}],[1330,{"@noble/hashes/crypto":1323},function(){with(this)return function(){"use strict";return function(e,t,r){
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(r,"__esModule",{value:!0}),r.randomBytes=r.wrapConstructorWithOpts=r.wrapConstructor=r.checkOpts=r.Hash=r.assertHash=r.assertBytes=r.assertBool=r.assertNumber=r.concatBytes=r.toBytes=r.utf8ToBytes=r.asyncLoop=r.nextTick=r.hexToBytes=r.bytesToHex=r.isLE=r.rotr=r.createView=r.u32=r.u8=void 0;const n=e("@noble/hashes/crypto");r.u8=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);r.u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));r.createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(r.rotr=(e,t)=>e<<32-t|e>>>t,r.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!r.isLE)throw new Error("Non little-endian hardware is not supported");const i=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function s(e){if("string"!=typeof e)throw new TypeError("utf8ToBytes expected string, got "+typeof e);return(new TextEncoder).encode(e)}function o(e){if("string"==typeof e&&(e=s(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}function a(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}r.bytesToHex=function(e){let t="";for(let r=0;r<e.length;r++)t+=i[e[r]];return t},r.hexToBytes=function(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s))throw new Error("Invalid byte sequence");t[r]=s}return t},r.nextTick=(()=>{const e=void 0!==t&&"function"==typeof t.require&&t.require.bind(t);try{if(e){const{setImmediate:t}=e("timers");return()=>new Promise((e=>t(e)))}}catch(e){}return()=>new Promise((e=>setTimeout(e,0)))})(),r.asyncLoop=async function(e,t,n){let i=Date.now();for(let s=0;s<e;s++){n(s);const e=Date.now()-i;e>=0&&e<t||(await(0,r.nextTick)(),i+=e)}},r.utf8ToBytes=s,r.toBytes=o,r.concatBytes=function(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r},r.assertNumber=a,r.assertBool=function(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)},r.assertBytes=function(e,...t){if(!(e instanceof Uint8Array)||t.length&&!t.includes(e.length))throw new TypeError(`Expected ${t} bytes, not ${typeof e} with length=${e.length}`)},r.assertHash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");a(e.outputLen),a(e.blockLen)};r.Hash=class{clone(){return this._cloneInto()}};r.checkOpts=function(e,t){if(t!==undefined&&("object"!=typeof t||(r=t,"[object Object]"!==Object.prototype.toString.call(r)||r.constructor!==Object)))throw new TypeError("Options should be object or undefined");var r;return Object.assign(e,t)},r.wrapConstructor=function(e){const t=t=>e().update(o(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t},r.wrapConstructorWithOpts=function(e){const t=(t,r)=>e(r).update(o(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t},r.randomBytes=function(e=32){if(n.crypto.web)return n.crypto.web.getRandomValues(new Uint8Array(e));if(n.crypto.node)return new Uint8Array(n.crypto.node.randomBytes(e).buffer);throw new Error("The environment doesn't have randomBytes function")}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/hashes"}],[1331,{crypto:1935},function(){with(this)return function(){"use strict";return function(e,t,r){
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.schnorr=r.verify=r.signSync=r.sign=r.getSharedSecret=r.recoverPublicKey=r.getPublicKey=r.Signature=r.Point=r.CURVE=void 0;const i=n(e("crypto")),s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(3),u=BigInt(8),l=a**BigInt(256),d={a:s,b:BigInt(7),P:l-a**BigInt(32)-BigInt(977),n:l-BigInt("432420386565659656852420866394968145599"),h:o,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function f(e){const{a:t,b:r}=d,n=N(e*e),i=N(n*e);return N(i+t*e+r)}r.CURVE=d;const h=d.a===s;class p{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof g))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new p(e.x,e.y,o)}static toAffineBatch(e){const t=function(e,t=d.P){const r=new Array(e.length),n=C(e.reduce(((e,n,i)=>n===s?e:(r[i]=e,N(e*n,t))),o),t);return e.reduceRight(((e,n,i)=>n===s?e:(r[i]=N(e*r[i],t),N(e*n,t))),n),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return p.toAffineBatch(e).map(p.fromAffine)}equals(e){if(!(e instanceof p))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:i,y:s,z:o}=e,c=N(n**a),u=N(o**a),l=N(t*u),d=N(i*c),f=N(N(r*o)*u),h=N(N(s*n)*c);return l===d&&f===h}negate(){return new p(this.x,N(-this.y),this.z)}double(){const{x:e,y:t,z:r}=this,n=N(e**a),i=N(t**a),s=N(i**a),o=N(a*(N((e+i)**a)-n-s)),l=N(c*n),d=N(l**a),f=N(d-a*o),h=N(l*(o-f)-u*s),m=N(a*t*r);return new p(f,h,m)}add(e){if(!(e instanceof p))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:i,y:o,z:c}=e;if(i===s||o===s)return this;if(t===s||r===s)return e;const u=N(n**a),l=N(c**a),d=N(t*l),f=N(i*u),h=N(N(r*c)*l),m=N(N(o*n)*u),g=N(f-d),y=N(m-h);if(g===s)return y===s?this.double():p.ZERO;const b=N(g**a),w=N(g*b),v=N(d*b),_=N(y**a-w-a*v),S=N(y*(v-_)-h*w),E=N(n*c*g);return new p(_,S,E)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=j(e);p.BASE;const r=p.ZERO;if(t===s)return r;if(t===o)return this;if(!h){let e=r,n=this;for(;t>s;)t&o&&(e=e.add(n)),n=n.double(),t>>=o;return e}let{k1neg:n,k1:i,k2neg:a,k2:c}=D(t),u=r,l=r,f=this;for(;i>s||c>s;)i&o&&(u=u.add(f)),c&o&&(l=l.add(f)),f=f.double(),i>>=o,c>>=o;return n&&(u=u.negate()),a&&(l=l.negate()),l=new p(N(l.x*d.beta),l.y,l.z),u.add(l)}precomputeWindow(e){const t=h?128/e+1:256/e+1,r=[];let n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(p.BASE)&&(t=g.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&m.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=p.normalizeZ(n),m.set(t,n)));let i=p.ZERO,s=p.ZERO;const a=1+(h?128/r:256/r),c=2**(r-1),u=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let t=0;t<a;t++){const r=t*c;let a=Number(e&u);if(e>>=d,a>c&&(a-=l,e+=o),0===a){let e=n[r];t%2&&(e=e.negate()),s=s.add(e)}else{let e=n[r+Math.abs(a)-1];a<0&&(e=e.negate()),i=i.add(e)}}return{p:i,f:s}}multiply(e,t){let r,n,i=j(e);if(h){const{k1neg:e,k1:s,k2neg:o,k2:a}=D(i);let{p:c,f:u}=this.wNAF(s,t),{p:l,f:f}=this.wNAF(a,t);e&&(c=c.negate()),o&&(l=l.negate()),l=new p(N(l.x*d.beta),l.y,l.z),r=c.add(l),n=u.add(f)}else{const{p:e,f:s}=this.wNAF(i,t);r=e,n=s}return p.normalizeZ([r,n])[0]}toAffine(e=C(this.z)){const{x:t,y:r,z:n}=this,i=e,s=N(i*i),a=N(s*i),c=N(t*s),u=N(r*a);if(N(n*i)!==o)throw new Error("invZ was invalid");return new g(c,u)}}p.BASE=new p(d.Gx,d.Gy,o),p.ZERO=new p(s,o,s);const m=new WeakMap;class g{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,m.delete(this)}static fromCompressedHex(e){const t=32===e.length,r=x(t?e:e.subarray(1));if(!K(r))throw new Error("Point is not on curve");let n=function(e){const{P:t}=d,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),u=BigInt(88),l=e*e*e%t,f=l*l*e%t,h=R(f,c)*f%t,p=R(h,c)*f%t,m=R(p,a)*l%t,g=R(m,n)*m%t,y=R(g,i)*g%t,b=R(y,o)*y%t,w=R(b,u)*b%t,v=R(w,o)*y%t,_=R(v,c)*f%t,S=R(_,s)*g%t,E=R(S,r)*l%t;return R(E,a)}(f(r));const i=(n&o)===o;if(t)i&&(n=N(-n));else{1==(1&e[0])!==i&&(n=N(-n))}const s=new g(r,n);return s.assertValidity(),s}static fromUncompressedHex(e){const t=x(e.subarray(1,33)),r=x(e.subarray(33,65)),n=new g(t,r);return n.assertValidity(),n}static fromHex(e){const t=I(e),r=t.length,n=t[0];if(32===r||33===r&&(2===n||3===n))return this.fromCompressedHex(t);if(65===r&&4===n)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return g.BASE.multiply(F(e))}static fromSignature(e,t,r){const n=L(e=I(e)),{r:i,s:o}=V(t);if(0!==r&&1!==r)throw new Error("Cannot recover signature: invalid recovery bit");if(n===s)throw new Error("Cannot recover signature: msgHash cannot be 0");const a=1&r?"03":"02",c=g.fromHex(a+k(i)),{n:u}=d,l=C(i,u),f=N(-n*l,u),h=N(o*l,u),p=g.BASE.multiplyAndAddUnsafe(c,f,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return O(this.toHex(e))}toHex(e=!1){const t=k(this.x);if(e){return`${this.y&o?"03":"02"}${t}`}return`04${t}${k(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:r}=this;if(!K(t)||!K(r))throw new Error(e);const n=N(r*r);if(N(n-f(t))!==s)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new g(this.x,N(-this.y))}double(){return p.fromAffine(this).double().toAffine()}add(e){return p.fromAffine(this).add(p.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return p.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){const n=p.fromAffine(this).multiply(t),i=p.fromAffine(e).multiplyUnsafe(r),s=n.add(i);return s.equals(p.ZERO)?undefined:s.toAffine()}}function y(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function b(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${E(e)}`);const t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:x(r),left:e.subarray(t+2)}}r.Point=g,g.BASE=new g(d.Gx,d.Gy),g.ZERO=new g(s,s);class w{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=_(e),r="Signature.fromCompact";if("string"!=typeof e&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);const n=t?E(e):e;if(128!==n.length)throw new Error(`${r}: Expected 64-byte hex`);return new w(A(n.slice(0,64)),A(n.slice(64,128)))}static fromDER(e){const t=_(e);if("string"!=typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:r,s:n}=function(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${E(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:r}=b(e.subarray(2)),{data:n,left:i}=b(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${E(i)}`);return{r:t,s:n}}(t?e:O(e));return new w(r,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!H(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!H(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=d.n>>o;return this.s>e}normalizeS(){return this.hasHighS()?new w(this.r,d.n-this.s):this}toDERRawBytes(e=!1){return O(this.toDERHex(e))}toDERHex(e=!1){const t=y(T(this.s));if(e)return t;const r=y(T(this.r)),n=T(r.length/2),i=T(t.length/2);return`30${T(r.length/2+t.length/2+4)}02${n}${r}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return O(this.toCompactHex())}toCompactHex(){return k(this.r)+k(this.s)}}function v(...e){if(!e.every(_))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}function _(e){return e instanceof Uint8Array}r.Signature=w;const S=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function E(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=S[e[r]];return t}function k(e){if(e>l)throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function P(e){return O(k(e))}function T(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function A(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function O(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function x(e){return A(E(e))}function I(e){return e instanceof Uint8Array?Uint8Array.from(e):O(e)}function j(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==typeof e&&H(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function N(e,t=d.P){const r=e%t;return r>=s?r:t+r}function R(e,t){const{P:r}=d;let n=e;for(;t-- >s;)n*=n,n%=r;return n}function C(e,t=d.P){if(e===s||t<=s)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=N(e,t),n=t,i=s,a=o,c=o,u=s;for(;r!==s;){const e=n/r,t=n%r,s=i-c*e,o=a-u*e;n=r,r=t,i=c,a=u,c=s,u=o}if(n!==o)throw new Error("invert: does not exist");return N(i,t)}const M=(e,t)=>(e+t/a)/t,B=a**BigInt(128);function D(e){const{n:t}=d,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-o*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=M(s*e,t),c=M(-n*e,t);let u=N(e-a*r-c*i,t),l=N(-a*n-c*s,t);const f=u>B,h=l>B;if(f&&(u=t-u),h&&(l=t-l),u>B||l>B)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:h,k2:l}}function L(e){const{n:t}=d,r=8*e.length-256;let n=x(e);return r>0&&(n>>=BigInt(r)),n>=t&&(n-=t),n}class U{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return r.utils.hmacSha256(this.k,...e)}hmacSync(...e){if("function"!=typeof r.utils.hmacSha256Sync)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");const t=r.utils.hmacSha256Sync(this.k,...e);if(t instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return t}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}}function H(e){return s<e&&e<d.n}function K(e){return s<e&&e<d.P}function $(e,t,r){const n=x(e);if(!H(n))return;const{n:i}=d,a=g.BASE.multiply(n),c=N(a.x,i);if(c===s)return;const u=N(C(n,i)*N(t+r*c,i),i);if(u===s)return;const l=new w(c,u);return{sig:l,recovery:(a.x===l.r?0:2)|Number(a.y&o)}}function F(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private key");t=A(e)}else{if(!_(e))throw new TypeError("Expected valid private key");if(32!==e.length)throw new Error("Expected 32 bytes of private key");t=x(e)}if(!H(t))throw new Error("Expected private key: 0 < key < n");return t}function q(e){return e instanceof g?(e.assertValidity(),e):g.fromHex(e)}function V(e){if(e instanceof w)return e.assertValidity(),e;try{return w.fromDER(e)}catch(t){return w.fromCompact(e)}}function z(e){const t=_(e),r="string"==typeof e,n=(t||r)&&e.length;return t?33===n||65===n:r?66===n||130===n:e instanceof g}function W(e){return x(e.length>32?e.slice(0,32):e)}function G(e){const t=W(e),r=N(t,d.n);return J(r<s?t:r)}function J(e){if("bigint"!=typeof e)throw new Error("Expected bigint");return O(k(e))}function Z(e,t,n){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const i=I(e),s=F(t),o=[J(s),G(i)];if(null!=n){!0===n&&(n=r.utils.randomBytes(32));const e=I(n);if(32!==e.length)throw new Error("sign: Expected 32 bytes of extra data");o.push(e)}return{seed:v(...o),m:W(i),d:s}}function Y(e,t){let{sig:r,recovery:n}=e;const{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},t);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);const a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}r.getPublicKey=function(e,t=!1){return g.fromPrivateKey(e).toRawBytes(t)},r.recoverPublicKey=function(e,t,r,n=!1){return g.fromSignature(e,t,r).toRawBytes(n)},r.getSharedSecret=function(e,t,r=!1){if(z(e))throw new TypeError("getSharedSecret: first arg must be private key");if(!z(t))throw new TypeError("getSharedSecret: second arg must be public key");const n=q(t);return n.assertValidity(),n.multiply(F(e)).toRawBytes(r)},r.sign=async function(e,t,r={}){const{seed:n,m:i,d:s}=Z(e,t,r.extraEntropy);let o;const a=new U;for(await a.reseed(n);!(o=$(await a.generate(),i,s));)await a.reseed();return Y(o,r)},r.signSync=function(e,t,r={}){const{seed:n,m:i,d:s}=Z(e,t,r.extraEntropy);let o;const a=new U;for(a.reseedSync(n);!(o=$(a.generateSync(),i,s));)a.reseedSync();return Y(o,r)};const X={strict:!0};async function Q(e,...t){const n=new Uint8Array(e.split("").map((e=>e.charCodeAt(0)))),i=await r.utils.sha256(n);return x(await r.utils.sha256(v(i,i,...t)))}async function ee(e,t,r){const n=P(e);return N(await Q("BIP0340/challenge",n,t.toRawX(),r),d.n)}function te(e){return(e.y&o)===s}r.verify=function(e,t,r,n=X){let i;try{i=V(e),t=I(t)}catch(e){return!1}const{r:o,s:a}=i;if(n.strict&&i.hasHighS())return!1;const c=L(t);if(c===s)return!1;let u;try{u=q(r)}catch(e){return!1}const{n:l}=d,f=C(a,l),h=N(c*f,l),p=N(o*f,l),m=g.BASE.multiplyAndAddUnsafe(u,h,p);return!!m&&N(m.x,l)===o};class re{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=I(e);if(64!==t.length)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${t.length}`);const r=x(t.subarray(0,32)),n=x(t.subarray(32,64));return new re(r,n)}assertValidity(){const{r:e,s:t}=this;if(!K(e)||!H(t))throw new Error("Invalid signature")}toHex(){return k(this.r)+k(this.s)}toRawBytes(){return O(this.toHex())}}async function ne(e,t,r){const n=e instanceof re;let i;try{i=n?e:re.fromHex(e),n&&i.assertValidity()}catch(e){return!1}const{r:s,s:o}=i,a=I(t);let c;try{c=q(r)}catch(e){return!1}const u=await ee(s,c,a),l=g.BASE.multiplyAndAddUnsafe(c,F(o),N(-u,d.n));return!(!l||!te(l)||l.x!==s)}r.schnorr={Signature:re,getPublicKey:function(e){return g.fromPrivateKey(e).toRawX()},sign:async function(e,t,n=r.utils.randomBytes()){if(null==e)throw new TypeError(`sign: Expected valid message, not "${e}"`);const{n:i}=d,o=I(e),a=F(t),c=I(n);if(32!==c.length)throw new TypeError("sign: Expected 32 bytes of aux randomness");const u=g.fromPrivateKey(a),l=te(u)?a:i-a,f=l^await Q("BIP0340/aux",c),h=N(await Q("BIP0340/nonce",P(f),u.toRawX(),o),i);if(h===s)throw new Error("sign: Creation of signature failed. k is zero");const p=g.fromPrivateKey(h),m=te(p)?h:i-h,y=await ee(p.x,u,o),b=new re(p.x,N(m+y*l,i)).toRawBytes();if(!await ne(b,o,u.toRawX()))throw new Error("sign: Invalid signature produced");return b},verify:ne},g.BASE._setWindowSize(8);const ie={node:i.default,web:"object"==typeof self&&"crypto"in self?self.crypto:undefined};r.utils={isValidPrivateKey(e){try{return F(e),!0}catch(e){return!1}},hashToPrivateKey:e=>{if((e=I(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");const t=N(x(e),d.n);if(t===s||t===o)throw new Error("Invalid private key");return P(t)},randomBytes:(e=32)=>{if(ie.web)return ie.web.getRandomValues(new Uint8Array(e));if(ie.node){const{randomBytes:t}=ie.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>r.utils.hashToPrivateKey(r.utils.randomBytes(40)),bytesToHex:E,mod:N,sha256:async e=>{if(ie.web){const t=await ie.web.subtle.digest("SHA-256",e.buffer);return new Uint8Array(t)}if(ie.node){const{createHash:t}=ie.node;return Uint8Array.from(t("sha256").update(e).digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ie.web){const r=await ie.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=v(...t),i=await ie.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}if(ie.node){const{createHmac:r}=ie.node,n=r("sha256",e);return t.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:undefined,hmacSha256Sync:undefined,precompute(e=8,t=g.BASE){const r=t===g.BASE?t:new g(t.x,t.y);return r._setWindowSize(e),r.multiply(c),r}}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@noble/secp256k1"}],[1336,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function i(...e){const t=(e,t)=>r=>e(t(r));return{encode:Array.from(e).reverse().reduce(((e,r)=>e?t(e,r.encode):r.encode),undefined),decode:e.reduce(((e,r)=>e?t(e,r.decode):r.decode),undefined)}}function s(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(n(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const r=e.indexOf(t);if(-1===r)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}}function o(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function a(e,t="="){if(n(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&"string"!=typeof r[0])throw new Error("padding.encode input should be array of strings");for(let e of r)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&"string"!=typeof r[0])throw new Error("padding.encode input should be array of strings");for(let e of r)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function c(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function u(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let i=0;const s=[],o=Array.from(e);for(o.forEach((e=>{if(n(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,n=!0;for(let s=i;s<o.length;s++){const a=o[s],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");if(e=c%r,o[s]=Math.floor(c/r),!Number.isSafeInteger(o[s])||o[s]*r+e!==c)throw new Error("convertRadix: carry overflow");n&&(o[s]?n=!1:i=s)}if(s.push(e),n)break}for(let t=0;t<e.length-1&&0===e[t];t++)s.push(0);return s.reverse()}
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(r,"__esModule",{value:!0}),r.bytes=r.stringToBytes=r.str=r.bytesToString=r.hex=r.utf8=r.bech32m=r.bech32=r.base58check=r.base58xmr=r.base58xrp=r.base58flickr=r.base58=r.base64url=r.base64=r.base32crockford=r.base32hex=r.base32=r.base16=r.utils=r.assertNumber=void 0,r.assertNumber=n;const l=(e,t)=>t?l(t,e%t):e,d=(e,t)=>e+(t-l(e,t));function f(e,t,r,i){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(d(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${d(t,r)}`);let s=0,o=0;const a=2**r-1,c=[];for(const i of e){if(n(i),i>=2**t)throw new Error(`convertRadix2: invalid data word=${i} from=${t}`);if(s=s<<t|i,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=r;o-=r)c.push((s>>o-r&a)>>>0);s&=2**o-1}if(s=s<<r-o&a,!i&&o>=t)throw new Error("Excess padding");if(!i&&s)throw new Error(`Non-zero padding: ${s}`);return i&&o>0&&c.push(s>>>0),c}function h(e){return n(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return u(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(u(t,e,256))}}}function p(e,t=!1){if(n(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(d(8,e)>32||d(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return f(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&"number"!=typeof r[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(f(r,e,8,t))}}}function m(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}function g(e,t){if(n(e),"function"!=typeof t)throw new Error("checksum fn should be function");return{encode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const n=t(r).slice(0,e),i=new Uint8Array(r.length+e);return i.set(r),i.set(n,r.length),i},decode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const n=r.slice(0,-e),i=t(n).slice(0,e),s=r.slice(-e);for(let t=0;t<e;t++)if(i[t]!==s[t])throw new Error("Invalid checksum");return n}}}r.utils={alphabet:s,chain:i,checksum:g,radix:h,radix2:p,join:o,padding:a},r.base16=i(p(4),s("0123456789ABCDEF"),o("")),r.base32=i(p(5),s("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),a(5),o("")),r.base32hex=i(p(5),s("0123456789ABCDEFGHIJKLMNOPQRSTUV"),a(5),o("")),r.base32crockford=i(p(5),s("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),c((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),r.base64=i(p(6),s("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),a(6),o("")),r.base64url=i(p(6),s("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),a(6),o(""));const y=e=>i(h(58),s(e),o(""));r.base58=y("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),r.base58flickr=y("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),r.base58xrp=y("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const b=[0,2,3,5,6,7,9,10,11];r.base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const i=e.subarray(n,n+8);t+=r.base58.encode(i).padStart(b[i.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const i=e.slice(n,n+11),s=b.indexOf(i.length),o=r.base58.decode(i);for(let e=0;e<o.length-s;e++)if(0!==o[e])throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-s)))}return Uint8Array.from(t)}};r.base58check=e=>i(g(4,(t=>e(e(t)))),r.base58);const w=i(s("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),v=[996825010,642813549,513874426,1027748829,705979059];function _(e){const t=e>>25;let r=(33554431&e)<<5;for(let e=0;e<v.length;e++)1==(t>>e&1)&&(r^=v[e]);return r}function S(e,t,r=1){const n=e.length;let i=1;for(let t=0;t<n;t++){const r=e.charCodeAt(t);if(r<33||r>126)throw new Error(`Invalid prefix (${e})`);i=_(i)^r>>5}i=_(i);for(let t=0;t<n;t++)i=_(i)^31&e.charCodeAt(t);for(let e of t)i=_(i)^e;for(let e=0;e<6;e++)i=_(i);return i^=r,w.encode(f([i%2**30],30,5,!1))}function E(e){const t="bech32"===e?1:734539939,r=p(5),n=r.decode,i=r.encode,s=m(n);function o(e,r=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==r&&e.length>r)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${r})`);const n=e.toLowerCase();if(e!==n&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const i=(e=n).lastIndexOf("1");if(0===i||-1===i)throw new Error('Letter "1" must be present between prefix and data only');const[s,o]=[e.slice(0,i),e.slice(i+1)];if(o.length<6)throw new Error("Data must be at least 6 characters long");const a=w.decode(o).slice(0,-6),c=S(s,a,t);if(!o.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:s,words:a}}return{encode:function(e,r,n=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(r)||r.length&&"number"!=typeof r[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof r);const i=e.length+7+r.length;if(!1!==n&&i>n)throw new TypeError(`Length ${i} exceeds limit ${n}`);return`${e=e.toLowerCase()}1${w.encode(r)}${S(e,r,t)}`},decode:o,decodeToBytes:function(e){const{prefix:t,words:r}=o(e,!1);return{prefix:t,words:r,bytes:n(r)}},decodeUnsafe:m(o),fromWords:n,fromWordsUnsafe:s,toWords:i}}r.bech32=E("bech32"),r.bech32m=E("bech32m"),r.utf8={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},r.hex=i(p(4),s("0123456789abcdef"),o(""),c((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})));const k={utf8:r.utf8,hex:r.hex,base16:r.base16,base32:r.base32,base64:r.base64,base64url:r.base64url,base58:r.base58,base58xmr:r.base58xmr},P=`Invalid encoding type. Available types: ${Object.keys(k).join(", ")}`;r.bytesToString=(e,t)=>{if("string"!=typeof e||!k.hasOwnProperty(e))throw new TypeError(P);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return k[e].encode(t)},r.str=r.bytesToString;r.stringToBytes=(e,t)=>{if(!k.hasOwnProperty(e))throw new TypeError(P);if("string"!=typeof t)throw new TypeError("stringToBytes() expects string");return k[e].decode(t)},r.bytes=r.stringToBytes}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@scure/base"}],[1337,{"@noble/hashes/pbkdf2":1325,"@noble/hashes/sha256":1327,"@noble/hashes/sha512":1329,"@noble/hashes/utils":1330,"@scure/base":1336},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mnemonicToSeedSync=r.mnemonicToSeed=r.validateMnemonic=r.entropyToMnemonic=r.mnemonicToEntropy=r.generateMnemonic=void 0;
/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */
const n=e("@noble/hashes/pbkdf2"),i=e("@noble/hashes/sha256"),s=e("@noble/hashes/sha512"),o=e("@noble/hashes/utils"),a=e("@scure/base");function c(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function u(e){const t=c(e),r=t.split(" ");if(![12,15,18,21,24].includes(r.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:r}}function l(e){(0,o.assertBytes)(e,16,20,24,28,32)}r.generateMnemonic=function(e,t=128){if((0,o.assertNumber)(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return p((0,o.randomBytes)(t/8),e)};const d=e=>{const t=8-e.length/4;return new Uint8Array([(0,i.sha256)(e)[0]>>t<<t])};function f(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Worlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),a.utils.chain(a.utils.checksum(1,d),a.utils.radix2(11,!0),a.utils.alphabet(e))}function h(e,t){const{words:r}=u(e),n=f(t).decode(r);return l(n),n}function p(e,t){l(e);return f(t).encode(e).join((e=>"あいこくしん"===e[0])(t)?"　":" ")}r.mnemonicToEntropy=h,r.entropyToMnemonic=p,r.validateMnemonic=function(e,t){try{h(e,t)}catch(e){return!1}return!0};const m=e=>c(`mnemonic${e}`);r.mnemonicToSeed=function(e,t=""){return(0,n.pbkdf2Async)(s.sha512,u(e).nfkd,m(t),{c:2048,dkLen:64})},r.mnemonicToSeedSync=function(e,t=""){return(0,n.pbkdf2)(s.sha512,u(e).nfkd,m(t),{c:2048,dkLen:64})}}}},{package:"@metamask/rpc-methods>@metamask/key-tree>@scure/bip39"}],[1338,{assert:1564,buffer:1936,"component-type":2004,"join-component":4587},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("component-type"),i=e("join-component"),s=e("assert");t.exports=function(e,t){switch(a(e),t=t||e.type,s(t,"You must pass an event type."),t){case"track":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.event,'You must pass an "event".')}(e);case"group":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.groupId,'You must pass a "groupId".')}(e);case"identify":case"page":case"screen":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".')}(e);case"alias":return function(e){s(e.userId,'You must pass a "userId".'),s(e.previousId,'You must pass a "previousId".')}(e);default:s(0,'Invalid event type: "'+t+'"')}};var o={anonymousId:["string","number"],category:"string",context:"object",event:"string",groupId:["string","number"],integrations:"object",name:"string",previousId:["string","number"],timestamp:"date",userId:["string","number"],type:"string"};function a(e){s("object"===n(e),"You must pass a message object.");var t=JSON.stringify(e);for(var a in s(r.byteLength(t,"utf8")<32768,"Your message must be < 32kb."),o){var c=e[a];if(c){var u=o[a];"array"!==n(u)&&(u=[u]);var l="object"===u[0]?"an":"a";s(u.some((function(e){return n(c)===e})),'"'+a+'" must be '+l+" "+i(u,"or")+".")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"analytics-node>@segment/loosely-validate-event"}],[134,{"../../../shared/constants/network":6028,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/network");var s={version:51,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=51;const r=t.data;return t.data=function(e){var t,r;const{chainId:n,type:s}=(null==e||null===(t=e.NetworkController)||void 0===t?void 0:t.provider)||{},o=null===(r=i.NETWORK_TYPE_TO_ID_MAP[s])||void 0===r?void 0:r.chainId;o&&n!==o&&(e.NetworkController.provider.chainId=o);return e}(r),t}};r.default=s}}},{package:"$root$"}],[135,{"../../../shared/constants/network":6028,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/network");var s={version:52,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=52;const r=t.data;return t.data=function(e={}){if(e.PreferencesController){const{accountTokens:t,accountHiddenTokens:r,frequentRpcListDetail:n}=e.PreferencesController,s={},o={};if(t&&Object.keys(t).length>0){for(const e of Object.keys(t)){s[e]={},t[e][i.NETWORK_TYPE_RPC]&&n.forEach((r=>{s[e][r.chainId]=t[e][i.NETWORK_TYPE_RPC]}));for(const r of Object.keys(t[e]))switch(r){case i.MAINNET:s[e][i.MAINNET_CHAIN_ID]=t[e][i.MAINNET];break;case i.ROPSTEN:s[e][i.ROPSTEN_CHAIN_ID]=t[e][i.ROPSTEN];break;case i.RINKEBY:s[e][i.RINKEBY_CHAIN_ID]=t[e][i.RINKEBY];break;case i.GOERLI:s[e][i.GOERLI_CHAIN_ID]=t[e][i.GOERLI];break;case i.KOVAN:s[e][i.KOVAN_CHAIN_ID]=t[e][i.KOVAN]}}e.PreferencesController.accountTokens=s}if(r&&Object.keys(r).length>0){for(const e of Object.keys(r)){o[e]={},r[e][i.NETWORK_TYPE_RPC]&&n.forEach((t=>{o[e][t.chainId]=r[e][i.NETWORK_TYPE_RPC]}));for(const t of Object.keys(r[e]))switch(t){case i.MAINNET:o[e][i.MAINNET_CHAIN_ID]=r[e][i.MAINNET];break;case i.ROPSTEN:o[e][i.ROPSTEN_CHAIN_ID]=r[e][i.ROPSTEN];break;case i.RINKEBY:o[e][i.RINKEBY_CHAIN_ID]=r[e][i.RINKEBY];break;case i.GOERLI:o[e][i.GOERLI_CHAIN_ID]=r[e][i.GOERLI];break;case i.KOVAN:o[e][i.KOVAN_CHAIN_ID]=r[e][i.KOVAN]}}e.PreferencesController.accountHiddenTokens=o}}return e}(r),t}};r.default=s}}},{package:"$root$"}],[136,{"../../../shared/constants/transaction":6033,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash"),o=e("../../../shared/constants/transaction");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={version:53,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=53;const r=t.data;return t.data=function(e){var t,r;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions,i=null==e||null===(r=e.IncomingTransactionsController)||void 0===r?void 0:r.incomingTransactions;Array.isArray(n)&&n.forEach((e=>{e&&(e.type!==o.TRANSACTION_TYPES.RETRY&&e.type!==o.TRANSACTION_TYPES.CANCEL&&(e.type=e.transactionCategory),delete e.transactionCategory)}));if(i){Object.entries(i).forEach((([t,r])=>{r&&(delete r.transactionCategory,e.IncomingTransactionsController.incomingTransactions[t]=c(c({},r),{},{type:o.TRANSACTION_TYPES.INCOMING}))}))}return e}(r),t}};r.default=u}}},{package:"$root$"}],[137,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");function i(e){return"number"==typeof e||"string"==typeof e&&e.match(/^(0x)?\d+$/u)}var s={version:54,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=54;const r=function(e){const t=e;if(!t.PreferencesController)return t;const r=(t.PreferencesController.tokens||[]).filter((({decimals:e})=>i(e)));for(const e of r)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t.PreferencesController.tokens=r;const{accountTokens:n}=t.PreferencesController;if(n&&"object"==typeof n)for(const e of Object.keys(n)){const t=n[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const r=(t[e]||[]).filter((({decimals:e})=>i(e)));for(const e of r)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t[e]=r}}return t.PreferencesController.accountTokens=n,t}(t.data);return t.data=r,t}};r.default=s}}},{package:"$root$"}],[138,{"../../../shared/constants/network":6028,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/network");var s={version:55,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=55;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.IncomingTransactionsController)&&void 0!==t&&t.incomingTxLastFetchedBlocksByNetwork&&(e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId=(0,n.mapKeys)(e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork,((e,t)=>{var r,n;return null!==(r=null===(n=i.NETWORK_TYPE_TO_ID_MAP[t])||void 0===n?void 0:n.chainId)&&void 0!==r?r:o})),delete e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId.UNKNOWN,delete e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork);return e}(r),t}};r.default=s;const o="UNKNOWN"}}},{package:"$root$"}],[139,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:56,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=56;const{PreferencesController:r}=t.data;return Array.isArray(null==r?void 0:r.tokens)&&(r.tokens=r.tokens.filter((({address:e})=>e))),null!=r&&r.accountTokens&&"object"==typeof r.accountTokens&&Object.keys(r.accountTokens).forEach((e=>{Object.keys(r.accountTokens[e]).forEach((t=>{r.accountTokens[e][t]=r.accountTokens[e][t].filter((({address:e})=>e))}))})),null!=r&&r.assetImages&&"undefined"in r.assetImages&&delete r.assetImages.undefined,t}};r.default=i}}},{package:"$root$"}],[14,{"../../../../shared/constants/network":6028,"@babel/runtime/helpers/interopRequireDefault":200,"eth-block-tracker":2216,"eth-json-rpc-infura":2248,"eth-json-rpc-middleware":2254,"json-rpc-engine":4598},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({network:e,projectId:t}){const r=(0,o.default)({network:e,projectId:t,maxAttempts:5,source:"metamask"}),n=(0,s.providerFromMiddleware)(r),c=new a.PollingBlockTracker({provider:n});return{networkMiddleware:(0,i.mergeMiddleware)([u({network:e}),(0,s.createBlockCacheMiddleware)({blockTracker:c}),(0,s.createInflightCacheMiddleware)(),(0,s.createBlockRefMiddleware)({blockTracker:c,provider:n}),(0,s.createRetryOnEmptyMiddleware)({blockTracker:c,provider:n}),(0,s.createBlockTrackerInspectorMiddleware)({blockTracker:c}),r]),blockTracker:c}};var i=e("json-rpc-engine"),s=e("eth-json-rpc-middleware"),o=n(e("eth-json-rpc-infura")),a=e("eth-block-tracker"),c=e("../../../../shared/constants/network");function u({network:e}){if(!c.NETWORK_TYPE_TO_ID_MAP[e])throw new Error(`createInfuraClient - unknown network "${e}"`);const{chainId:t,networkId:r}=c.NETWORK_TYPE_TO_ID_MAP[e];return(0,i.createScaffoldMiddleware)({eth_chainId:t,net_version:r})}}}},{package:"$root$"}],[140,{"../../../shared/modules/random-id":6042,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash"),s=n(e("../../../shared/modules/random-id"));var o={version:57,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=57;const r=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.TransactionController)&&void 0!==t&&t.transactions&&Array.isArray(e.TransactionController.transactions)&&!e.TransactionController.transactions.some((e=>"object"!=typeof e||void 0===e.txParams))&&(e.TransactionController.transactions=(0,i.keyBy)(e.TransactionController.transactions,(e=>(void 0!==e.id&&null!==e.id||(e.id=(0,s.default)()),e.id))));return e}(r),t}};r.default=o}}},{package:"$root$"}],[141,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:58,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=58;const r=t.data;return t.data=function(e){var t;return null===(t=e.AppStateController)||void 0===t||delete t.swapsWelcomeMessageHasBeenShown,e}(r),t}};r.default=i}}},{package:"$root$"}],[1419,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n="utf8: invalid string",i="utf8: invalid source encoding";function s(e){for(var t=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i<128)t+=1;else if(i<2048)t+=2;else if(i<55296)t+=3;else{if(!(i<=57343))throw new Error(n);if(r>=e.length-1)throw new Error(n);r++,t+=4}}return t}r.encode=function(e){for(var t=new Uint8Array(s(e)),r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=192|i>>6,t[r++]=128|63&i):i<55296?(t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|63&i):(n++,i=(1023&i)<<10,i|=1023&e.charCodeAt(n),i+=65536,t[r++]=240|i>>18,t[r++]=128|i>>12&63,t[r++]=128|i>>6&63,t[r++]=128|63&i)}return t},r.encodedLength=s,r.decode=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(128&n){var s=void 0;if(n<224){if(r>=e.length)throw new Error(i);if(128!=(192&(o=e[++r])))throw new Error(i);n=(31&n)<<6|63&o,s=128}else if(n<240){if(r>=e.length-1)throw new Error(i);var o=e[++r],a=e[++r];if(128!=(192&o)||128!=(192&a))throw new Error(i);n=(15&n)<<12|(63&o)<<6|63&a,s=2048}else{if(!(n<248))throw new Error(i);if(r>=e.length-2)throw new Error(i);o=e[++r],a=e[++r];var c=e[++r];if(128!=(192&o)||128!=(192&a)||128!=(192&c))throw new Error(i);n=(15&n)<<18|(63&o)<<12|(63&a)<<6|63&c,s=65536}if(n<s||n>=55296&&n<=57343)throw new Error(i);if(n>=65536){if(n>1114111)throw new Error(i);n-=65536,t.push(String.fromCharCode(55296|n>>10)),n=56320|1023&n}}t.push(String.fromCharCode(n))}return t.join("")}}}},{package:"3box>did-jwt>@stablelib/utf8"}],[142,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var s={version:59,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=59;const r=t.data;return t.data=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,n.isPlainObject)(r)){const t=(0,n.groupBy)(Object.values(r),(e=>{var t,r;return`${null===(t=e.txParams)||void 0===t?void 0:t.nonce}-${null!==(r=e.chainId)&&void 0!==r?r:e.metamaskNetworkId}`})),s=(0,n.pickBy)(t,(e=>e.some((e=>e.type!==i.TRANSACTION_TYPES.CANCEL&&e.type!==i.TRANSACTION_TYPES.RETRY))));e.TransactionController.transactions=(0,n.keyBy)((0,n.concat)(...Object.values(s)),(e=>e.id))}return e}(r),t}};r.default=s}}},{package:"$root$"}],[143,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");const i="2020-08-31";var s={version:60,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=60;const r=function(e){var t;const r=null==e||null===(t=e.NotificationController)||void 0===t?void 0:t.notifications;var s;(0,n.isPlainObject)(r)&&(null===(s=r[2])||void 0===s?void 0:s.date)===i&&delete e.NotificationController.notifications[2];return e}(t.data);return t.data=r,t}};r.default=s}}},{package:"$root$"}],[144,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:61,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=61;const r=function(e){const t=(new Date).getTime();e.AppStateController?(e.AppStateController.recoveryPhraseReminderHasBeenShown=!1,e.AppStateController.recoveryPhraseReminderLastShown=t):e.AppStateController={recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:t};return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[145,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:62,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=62;const r=function(e){if(e.MetaMetricsController){const{metaMetricsSendCount:t}=e.MetaMetricsController;t!==undefined&&delete e.MetaMetricsController.metaMetricsSendCount}return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[146,{"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:63,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=63;const r=function(e){var t,r,n,i,s,o,c,u;const l=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,d=null==e||null===(r=e.PreferencesController)||void 0===r?void 0:r.accountHiddenTokens,f={};l&&Object.keys(l).forEach((e=>{Object.keys(l[e]).forEach((t=>{const r=l[e][t];f[t]===undefined?f[t]={[e]:r}:f[t]=a(a({},f[t]),{},{[e]:r})}))}));const h={};d&&Object.keys(d).forEach((e=>{Object.keys(d[e]).forEach((t=>{const r=d[e][t];h[t]===undefined?h[t]={[e]:r}:h[t]=a(a({},h[t]),{},{[e]:r})}))}));e.TokensController?(e.TokensController.allTokens=f,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:f,allIgnoredTokens:h};return null==e||(null===(n=e.PreferencesController)||void 0===n||delete n.accountHiddenTokens),null==e||null===(i=e.PreferencesController)||void 0===i||delete i.accountTokens,null==e||null===(s=e.PreferencesController)||void 0===s||delete s.assetImages,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.hiddenTokens,null==e||null===(c=e.PreferencesController)||void 0===c||delete c.tokens,null==e||null===(u=e.PreferencesController)||void 0===u||delete u.suggestedTokens,e}(t.data);return t.data=r,t}};r.default=c}}},{package:"$root$"}],[147,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");const s="sentEther";var o={version:64,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=64;const r=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,n.isPlainObject)(r))for(const e of Object.values(r))e.type===s&&(e.type=i.TRANSACTION_TYPES.SIMPLE_SEND),e.history&&e.history.map((e=>(e.type&&e.type===s&&(e.type=i.TRANSACTION_TYPES.SIMPLE_SEND),e)));return e}(t.data);return t.data=r,t}};r.default=o}}},{package:"$root$"}],[148,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:65,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=65;const r=function(e){if(e.PreferencesController){var t;const{completedOnboarding:r,firstTimeFlowType:n}=e.PreferencesController;e.OnboardingController=null!==(t=e.OnboardingController)&&void 0!==t?t:{},r!==undefined&&(e.OnboardingController.completedOnboarding=r,delete e.PreferencesController.completedOnboarding),n!==undefined&&(e.OnboardingController.firstTimeFlowType=n,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[149,{"../../../shared/constants/hardware-wallets":6025,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash"),o=e("../../../shared/constants/hardware-wallets");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={version:66,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=66;const r=function(e){var t;const r=window.navigator.hid?o.LEDGER_TRANSPORT_TYPES.WEBHID:o.LEDGER_TRANSPORT_TYPES.U2F,n=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),i=c(c({},e),{},{PreferencesController:c(c({},null==e?void 0:e.PreferencesController),{},{ledgerTransportType:n?o.LEDGER_TRANSPORT_TYPES.LIVE:r})});return delete i.PreferencesController.useLedgerLive,i}(t.data);return t.data=r,t}};r.default=u}}},{package:"$root$"}],[15,{"../../../../shared/constants/time":6032,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,_process:5261,"eth-block-tracker":2216,"eth-json-rpc-middleware":2254,"json-rpc-engine":4598},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({rpcUrl:e,chainId:t}){const r=(0,o.createFetchMiddleware)({rpcUrl:e}),n=(0,o.providerFromMiddleware)(r),i=new a.PollingBlockTracker(l(l({},f),{},{provider:n}));return{networkMiddleware:(0,s.mergeMiddleware)([...d?[(0,s.createAsyncMiddleware)((async(e,t,r)=>("eth_estimateGas"===e.method&&await new Promise((e=>setTimeout(e,2*c.SECOND))),r())))]:[],h(t),(0,o.createBlockRefRewriteMiddleware)({blockTracker:i}),(0,o.createBlockCacheMiddleware)({blockTracker:i}),(0,o.createInflightCacheMiddleware)(),(0,o.createBlockTrackerInspectorMiddleware)({blockTracker:i}),r]),blockTracker:i}};var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("json-rpc-engine"),o=e("eth-json-rpc-middleware"),a=e("eth-block-tracker"),c=e("../../../../shared/constants/time");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const d=t.env.IN_TEST,f=d?{pollingInterval:c.SECOND}:{};function h(e){return(t,r,n,i)=>"eth_chainId"===t.method?(r.result=e,i()):n()}}).call(this)}).call(this,e("_process"))}}},{package:"$root$"}],[150,{"../../../shared/constants/network":6028,"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,"bignumber.js":1824,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash"),o=n(e("bignumber.js")),a=e("../../../shared/constants/network");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const l=e=>new o.default(e||"0x0",16).gt(0);var d={version:67,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=67;const r=function(e){var t,r,n;const i=(null==e?void 0:e.PreferencesController)||{},s=i.preferences||{};if(s.showTestNetworks)return e;const o=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},c=(null===(r=e.NetworkController)||void 0===r?void 0:r.provider)||{},d=(null===(n=e.CachedBalancesController)||void 0===n?void 0:n.cachedBalances)||{},f=a.TEST_CHAINS.includes(null==c?void 0:c.chainId),h=Object.values(o).some((({chainId:e})=>a.TEST_CHAINS.includes(e))),p=a.TEST_CHAINS.some((e=>Object.values(d[e]||{}).some(l))),m=f||h||p;return u(u({},e),{},{PreferencesController:u(u({},i),{},{preferences:u(u({},s),{},{showTestNetworks:m})})})}(t.data);return t.data=r,t}};r.default=d}}},{package:"$root$"}],[151,{"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,"@babel/runtime/helpers/objectWithoutProperties":209,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("@babel/runtime/helpers/objectWithoutProperties")),o=e("lodash");const a=["PermissionsController","PermissionsMetadata"],c=["name","icon","extensionId"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={version:68,async migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=68;const r=function(e){const{PermissionsController:t={},PermissionsMetadata:r={}}=e,n=(0,s.default)(e,a),{domainMetadata:i={},permissionsHistory:o={},permissionsLog:c=[]}=r;return l(l({},n),{},{PermissionController:f(t),PermissionLogController:{permissionActivityLog:c,permissionHistory:o},SubjectMetadataController:h(i)})}(t.data);return t.data=r,t}};function f(e){const{domains:t={}}=e;return{subjects:Object.entries(t).reduce(((e,[t,r])=>{const{permissions:[n]}=r,i=n.caveats.find((e=>"exposedAccounts"===e.name)),s=l(l({},n),{},{caveats:[{type:"restrictReturnedAccounts",value:i.value}]});return delete s["@context"],e[t]={origin:t,permissions:{eth_accounts:s}},e}),{})}}function h(e){return{subjectMetadata:Object.entries(e).reduce(((e,[t,r])=>{const{name:n=null,icon:i=null,extensionId:o=null}=r,a=(0,s.default)(r,c);return delete a.lastUpdated,delete a.host,t&&(e[t]=l(l({name:n,iconUrl:i,extensionId:o},a),{},{origin:t})),e}),{})}}r.default=d}}},{package:"$root$"}],[152,{"../../../shared/constants/app":6023,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/app");var s={version:69,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=69;const r=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?i.SUBJECT_TYPES.EXTENSION:i.SUBJECT_TYPES.WEBSITE)}))}return e}(t.data);return t.data=r,t}};r.default=s}}},{package:"$root$"}],[153,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:70,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=70;const r=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)}))}return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[1534,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if("object"!=typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._operations=[],this._written=!1}n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(e,t){this._checkWritten();var r=this.db._checkKey(e)||this.db._checkValue(t);if(r)throw r;return e=this.db._serializeKey(e),t=this.db._serializeValue(t),this._put(e,t),this},n.prototype._put=function(e,t){this._operations.push({type:"put",key:e,value:t})},n.prototype.del=function(e){this._checkWritten();var t=this.db._checkKey(e);if(t)throw t;return e=this.db._serializeKey(e),this._del(e),this},n.prototype._del=function(e){this._operations.push({type:"del",key:e})},n.prototype.clear=function(){return this._checkWritten(),this._clear(),this},n.prototype._clear=function(){this._operations=[]},n.prototype.write=function(e,t){if(this._checkWritten(),"function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("write() requires a callback argument");"object"==typeof e&&null!==e||(e={}),this._written=!0,this._write(e,t)},n.prototype._write=function(e,t){this.db._batch(this._operations,e,t)},t.exports=n}}},{package:"3box>orbit-db>orbit-db-cache>level-js>abstract-leveldown"}],[1535,{_process:5261},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(e){if("object"!=typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._ended=!1,this._nexting=!1}r.prototype.next=function(t){var r=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return r._ended?(e.nextTick(t,new Error("cannot call next() after end()")),r):r._nexting?(e.nextTick(t,new Error("cannot call next() before previous next() has completed")),r):(r._nexting=!0,r._next((function(){r._nexting=!1,t.apply(null,arguments)})),r)},r.prototype._next=function(t){e.nextTick(t)},r.prototype.seek=function(e){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");e=this.db._serializeKey(e),this._seek(e)},r.prototype._seek=function(e){},r.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");if(this._ended)return e.nextTick(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)},r.prototype._end=function(t){e.nextTick(t)},t.exports=r}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-cache>level-js>abstract-leveldown"}],[1536,{"../is-buffer/index.js":4558,"./abstract-chained-batch":1534,"./abstract-iterator":1535,_process:5261,xtend:6010},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r,n){(function(){var i=e("xtend"),s=e("./abstract-iterator"),o=e("./abstract-chained-batch"),a=Object.prototype.hasOwnProperty,c="start end gt gte lt lte".split(" ");function u(){this.status="new"}function l(e){return-1!==c.indexOf(e)}u.prototype.open=function(e,t){var r=this,n=this.status;if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("open() requires a callback argument");"object"==typeof e&&null!==e||(e={}),e.createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists,this.status="opening",this._open(e,(function(e){if(e)return r.status=n,t(e);r.status="open",t()}))},u.prototype._open=function(e,t){n.nextTick(t)},u.prototype.close=function(e){var t=this,r=this.status;if("function"!=typeof e)throw new Error("close() requires a callback argument");this.status="closing",this._close((function(n){if(n)return t.status=r,e(n);t.status="closed",e()}))},u.prototype._close=function(e){n.nextTick(e)},u.prototype.get=function(e,t,r){if("function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("get() requires a callback argument");var i=this._checkKey(e);if(i)return n.nextTick(r,i);e=this._serializeKey(e),"object"==typeof t&&null!==t||(t={}),t.asBuffer=!1!==t.asBuffer,this._get(e,t,r)},u.prototype._get=function(e,t,r){n.nextTick((function(){r(new Error("NotFound"))}))},u.prototype.put=function(e,t,r,i){if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");var s=this._checkKey(e)||this._checkValue(t);if(s)return n.nextTick(i,s);e=this._serializeKey(e),t=this._serializeValue(t),"object"==typeof r&&null!==r||(r={}),this._put(e,t,r,i)},u.prototype._put=function(e,t,r,i){n.nextTick(i)},u.prototype.del=function(e,t,r){if("function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("del() requires a callback argument");var i=this._checkKey(e);if(i)return n.nextTick(r,i);e=this._serializeKey(e),"object"==typeof t&&null!==t||(t={}),this._del(e,t,r)},u.prototype._del=function(e,t,r){n.nextTick(r)},u.prototype.batch=function(e,t,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof t&&(r=t),"function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return n.nextTick(r,new Error("batch(array) requires an array argument"));if(0===e.length)return n.nextTick(r);"object"==typeof t&&null!==t||(t={});for(var s=new Array(e.length),o=0;o<e.length;o++){if("object"!=typeof e[o]||null===e[o])return n.nextTick(r,new Error("batch(array) element must be an object and not `null`"));var a=i(e[o]);if("put"!==a.type&&"del"!==a.type)return n.nextTick(r,new Error("`type` must be 'put' or 'del'"));var c=this._checkKey(a.key);if(c)return n.nextTick(r,c);if(a.key=this._serializeKey(a.key),"put"===a.type){var u=this._checkValue(a.value);if(u)return n.nextTick(r,u);a.value=this._serializeValue(a.value)}s[o]=a}this._batch(s,t,r)},u.prototype._batch=function(e,t,r){n.nextTick(r)},u.prototype._setupIteratorOptions=function(e){return(e=function(e,t){var r={};for(var n in t)if(a.call(t,n)){var i=t[n];l(n)&&(i=e._serializeKey(i)),r[n]=i}return r}(this,e)).reverse=!!e.reverse,e.keys=!1!==e.keys,e.values=!1!==e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=!1!==e.keyAsBuffer,e.valueAsBuffer=!1!==e.valueAsBuffer,e},u.prototype.iterator=function(e){return"object"==typeof e&&null!==e||(e={}),e=this._setupIteratorOptions(e),this._iterator(e)},u.prototype._iterator=function(e){return new s(this)},u.prototype._chainedBatch=function(){return new o(this)},u.prototype._serializeKey=function(e){return e},u.prototype._serializeValue=function(e){return e},u.prototype._checkKey=function(e){return null===e||e===undefined?new Error("key cannot be `null` or `undefined`"):r.isBuffer(e)&&0===e.length?new Error("key cannot be an empty Buffer"):""===e?new Error("key cannot be an empty String"):Array.isArray(e)&&0===e.length?new Error("key cannot be an empty Array"):void 0},u.prototype._checkValue=function(e){if(null===e||e===undefined)return new Error("value cannot be `null` or `undefined`")},t.exports=u}).call(this)}).call(this,{isBuffer:e("../is-buffer/index.js")},e("_process"))}}},{package:"3box>orbit-db>orbit-db-cache>level-js>abstract-leveldown"}],[1537,{"./abstract-chained-batch":1534,"./abstract-iterator":1535,"./abstract-leveldown":1536},function(){with(this)return function(){"use strict";return function(e,t,r){r.AbstractLevelDOWN=e("./abstract-leveldown"),r.AbstractIterator=e("./abstract-iterator"),r.AbstractChainedBatch=e("./abstract-chained-batch")}}},{package:"3box>orbit-db>orbit-db-cache>level-js>abstract-leveldown"}],[154,{lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:71,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=71;const r=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=r,t}};r.default=i}}},{package:"$root$"}],[1540,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(){}t.exports=function(e,t,r){var i=!1;return r=r||n,s.count=e,0===e?t():s;function s(e,n){if(s.count<=0)throw new Error("after called too many times");--s.count,e?(i=!0,t(e),t=r):0!==s.count||i||t(null,n)}}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>engine.io-parser>after"}],[1541,{"./package.json":1545,"@segment/loosely-validate-event":1338,_process:5261,assert:1564,axios:1648,"axios-retry":1646,"lodash.isstring":4838,md5:5039,ms:5051,"remove-trailing-slash":5569,"uuid/v4":1544},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("assert"),i=e("remove-trailing-slash"),s=e("@segment/loosely-validate-event"),o=e("axios"),a=e("axios-retry"),c=e("ms"),u=e("uuid/v4"),l=e("md5"),d=e("./package.json").version,f=e("lodash.isstring"),h=global.setImmediate||r.nextTick.bind(r),p=()=>{};t.exports=class{constructor(e,t){t=t||{},n(e,"You must pass your Segment project's write key."),this.queue=[],this.writeKey=e,this.host=i(t.host||"https://api.segment.io"),this.timeout=t.timeout||!1,this.flushAt=Math.max(t.flushAt,1)||20,this.flushInterval=t.flushInterval||1e4,this.flushed=!1,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:"boolean"!=typeof t.enable||t.enable}),this.axiosClient=o.create(),a(this.axiosClient,{retries:t.retryCount||3,retryCondition:this._isErrorRetryable,retryDelay:a.exponentialDelay})}_validate(e,t){try{s(e,t)}catch(t){if("Your message must be < 32kb."===t.message)return void console.log("Your message must be < 32kb. This is currently surfaced as a warning to allow clients to update. Versions released after August 1, 2018 will throw an error instead. Please update your code before then.",e);throw t}}identify(e,t){return this._validate(e,"identify"),this.enqueue("identify",e,t),this}group(e,t){return this._validate(e,"group"),this.enqueue("group",e,t),this}track(e,t){return this._validate(e,"track"),this.enqueue("track",e,t),this}page(e,t){return this._validate(e,"page"),this.enqueue("page",e,t),this}screen(e,t){return this._validate(e,"screen"),this.enqueue("screen",e,t),this}alias(e,t){return this._validate(e,"alias"),this.enqueue("alias",e,t),this}enqueue(e,t,n){return n=n||p,this.enable?((t=Object.assign({},t)).type=e,t.context=Object.assign({library:{name:"analytics-node",version:d}},t.context),t._metadata=Object.assign({nodeVersion:r.versions.node},t._metadata),t.timestamp||(t.timestamp=new Date),t.messageId||(t.messageId=`node-${l(JSON.stringify(t))}-${u()}`),t.anonymousId&&!f(t.anonymousId)&&(t.anonymousId=JSON.stringify(t.anonymousId)),t.userId&&!f(t.userId)&&(t.userId=JSON.stringify(t.userId)),this.queue.push({message:t,callback:n}),this.flushed?(this.queue.length>=this.flushAt&&this.flush(),void(this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval)))):(this.flushed=!0,void this.flush())):h(n)}flush(e){if(e=e||p,!this.enable)return h(e);if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return h(e);const t=this.queue.splice(0,this.flushAt),r=t.map((e=>e.callback)),n={batch:t.map((e=>e.message)),timestamp:new Date,sentAt:new Date},i=t=>{r.forEach((e=>e(t))),e(t,n)},s={};"undefined"==typeof window&&(s["user-agent"]=`analytics-node/${d}`);const o={method:"POST",url:`${this.host}/v1/batch`,auth:{username:this.writeKey},data:n,headers:s};this.timeout&&(o.timeout="string"==typeof this.timeout?c(this.timeout):this.timeout),this.axiosClient(o).then((()=>i())).catch((e=>{if(e.response){const t=new Error(e.response.statusText);return i(t)}i(e)}))}_isErrorRetryable(e){return!!a.isNetworkError(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("_process"))}}},{package:"analytics-node"}],[1542,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"analytics-node>uuid"}],[1543,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var s=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}}}},{package:"analytics-node>uuid"}],[1544,{"./lib/bytesToUuid":1542,"./lib/rng":1543},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}}}},{package:"analytics-node>uuid"}],[1545,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"analytics-node",version:"3.4.0-beta.3",description:"The hassle-free way to integrate analytics into any Node.js application",license:"MIT",repository:"segmentio/analytics-node",author:{name:"Segment",email:"tools+npm@segment.com",url:"https://segment.com"},engines:{node:">=4"},"size-limit":[{limit:"25 KB",path:"index.js"}],scripts:{"circle-lint":".buildscript/circle.sh",dependencies:"yarn",size:"size-limit",test:"standard && nyc ava --timeout=20s&& .buildscript/e2e.sh","report-coverage":"nyc report --reporter=lcov > coverage.lcov && codecov",np:"np --no-publish",release:"yarn run np"},files:["index.js"],keywords:["analytics","stats","segment.io","segmentio","segment","client","driver"],dependencies:{"@segment/loosely-validate-event":"^2.0.0",axios:"^0.19.2","axios-retry":"^3.0.2","lodash.isstring":"^4.0.1",md5:"^2.2.1",ms:"^2.0.0","remove-trailing-slash":"^0.1.0",uuid:"^3.2.1"},devDependencies:{ava:"^0.25.0","basic-auth":"^2.0.1","body-parser":"^1.17.1",codecov:"^3.0.0",commander:"^2.9.0",delay:"^4.2.0",express:"^4.15.2",husky:"^3.0.4",nyc:"^14.1.1",pify:"^4.0.1",sinon:"^7.3.2","size-limit":"^1.3.5",snyk:"^1.171.1",standard:"^12.0.1"}}}}},{package:"analytics-node"}],[1546,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var i=new Uint8Array(e),s=new Uint8Array(r-t),o=t,a=0;o<r;o++,a++)s[a]=i[o];return s.buffer}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>engine.io-parser>arraybuffer.slice"}],[1549,{"./asn1/api":1550,"./asn1/base":1552,"./asn1/constants":1556,"./asn1/decoders":1558,"./asn1/encoders":1561,"bn.js":1892},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r;n.bignum=e("bn.js"),n.define=e("./asn1/api").define,n.base=e("./asn1/base"),n.constants=e("./asn1/constants"),n.decoders=e("./asn1/decoders"),n.encoders=e("./asn1/encoders")}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[155,{"@babel/runtime/helpers/defineProperty":194,"@babel/runtime/helpers/interopRequireDefault":200,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("lodash");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:72,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=72;const r=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return a(a({},e),{},{PreferencesController:a(a({},t),{},{knownMethodData:{}})})}(t.data);return t.data=r,t}};r.default=c}}},{package:"$root$"}],[1550,{"./decoders":1558,"./encoders":1561,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./encoders"),i=e("./decoders"),s=e("inherits");function o(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}r.define=function(e,t){return new o(e,t)},o.prototype._createNamed=function(e){const t=this.name;function r(e){this._initNamed(e,t)}return s(r,e),r.prototype._initNamed=function(t,r){e.call(this,t,r)},new r(this)},o.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i[e])),this.decoders[e]},o.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},o.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},o.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1551,{"../base/reporter":1554,buffer:1936,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits"),i=e("../base/reporter").Reporter,s=e("buffer").Buffer;function o(e,t){i.call(this,t),s.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function a(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return a.isEncoderBuffer(e)||(e=new a(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=s.byteLength(e);else{if(!s.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}n(o,i),r.DecoderBuffer=o,o.isDecoderBuffer=function(e){if(e instanceof o)return!0;return"object"==typeof e&&s.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},o.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},o.prototype.restore=function(e){const t=new o(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,i.prototype.restore.call(this,e.reporter),t},o.prototype.isEmpty=function(){return this.offset===this.length},o.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},o.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const r=new o(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},o.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},r.EncoderBuffer=a,a.isEncoderBuffer=function(e){if(e instanceof a)return!0;return"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},a.prototype.join=function(e,t){return e||(e=new s(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(r){r.join(e,t),t+=r.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):s.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1552,{"./buffer":1551,"./node":1553,"./reporter":1554},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r;n.Reporter=e("./reporter").Reporter,n.DecoderBuffer=e("./buffer").DecoderBuffer,n.EncoderBuffer=e("./buffer").EncoderBuffer,n.Node=e("./node")}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1553,{"../base/buffer":1551,"../base/reporter":1554,"minimalistic-assert":5044},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../base/reporter").Reporter,i=e("../base/buffer").EncoderBuffer,s=e("../base/buffer").DecoderBuffer,o=e("minimalistic-assert"),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function u(e,t,r){const n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}t.exports=u;const l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];u.prototype.clone=function(){const e=this._baseState,t={};l.forEach((function(r){t[r]=e[r]}));const r=new this.constructor(t.parent);return r._baseState=t,r},u.prototype._wrap=function(){const e=this._baseState;c.forEach((function(t){this[t]=function(){const r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}}),this)},u.prototype._init=function(e){const t=this._baseState;o(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),o.equal(t.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function(e){const t=this._baseState,r=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==r.length&&(o(null===t.children),t.children=r,r.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(o(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(r){r==(0|r)&&(r|=0);const n=e[r];t[n]=r})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){u.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),a.forEach((function(e){u.prototype[e]=function(){const t=this._baseState,r=Array.prototype.slice.call(arguments);return o(null===t.tag),t.tag=e,this._useArgs(r),this}})),u.prototype.use=function(e){o(e);const t=this._baseState;return o(null===t.use),t.use=e,this},u.prototype.optional=function(){return this._baseState.optional=!0,this},u.prototype.def=function(e){const t=this._baseState;return o(null===t.default),t.default=e,t.optional=!0,this},u.prototype.explicit=function(e){const t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.explicit=e,this},u.prototype.implicit=function(e){const t=this._baseState;return o(null===t.explicit&&null===t.implicit),t.implicit=e,this},u.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},u.prototype.key=function(e){const t=this._baseState;return o(null===t.key),t.key=e,this},u.prototype.any=function(){return this._baseState.any=!0,this},u.prototype.choice=function(e){const t=this._baseState;return o(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},u.prototype.contains=function(e){const t=this._baseState;return o(null===t.use),t.contains=e,this},u.prototype._decode=function(e,t){const r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));let n,i=r.default,o=!0,a=null;if(null!==r.key&&(a=e.enterKey(r.key)),r.optional){let n=null;if(null!==r.explicit?n=r.explicit:null!==r.implicit?n=r.implicit:null!==r.tag&&(n=r.tag),null!==n||r.any){if(o=this._peekTag(e,n,r.any),e.isError(o))return o}else{const n=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),o=!0}catch(e){o=!1}e.restore(n)}}if(r.obj&&o&&(n=e.enterObject()),o){if(null!==r.explicit){const t=this._decodeTag(e,r.explicit);if(e.isError(t))return t;e=t}const n=e.offset;if(null===r.use&&null===r.choice){let t;r.any&&(t=e.save());const n=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(n))return n;r.any?i=e.raw(t):e=n}if(t&&t.track&&null!==r.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),r.any||(i=null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t)),e.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach((function(r){r._decode(e,t)})),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){const n=new s(i);i=this._getUse(r.contains,e._reporterState.obj)._decode(n,t)}}return r.obj&&o&&(i=e.leaveObject(n)),null===r.key||null===i&&!0!==o?null!==a&&e.exitKey(a):e.leaveKey(a,r.key,i),i},u.prototype._decodeGeneric=function(e,t,r){const n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],r):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},u.prototype._getUse=function(e,t){const r=this._baseState;return r.useDecoder=this._use(e,t),o(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},u.prototype._decodeChoice=function(e,t){const r=this._baseState;let n=null,i=!1;return Object.keys(r.choice).some((function(s){const o=e.save(),a=r.choice[s];try{const r=a._decode(e,t);if(e.isError(r))return!1;n={type:s,value:r},i=!0}catch(t){return e.restore(o),!1}return!0}),this),i?n:e.error("Choice not matched")},u.prototype._createEncoderBuffer=function(e){return new i(e,this.reporter)},u.prototype._encode=function(e,t,r){const n=this._baseState;if(null!==n.default&&n.default===e)return;const i=this._encodeValue(e,t,r);return i===undefined||this._skipDefault(i,t,r)?void 0:i},u.prototype._encodeValue=function(e,t,r){const i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new n);let s=null;if(this.reporter=t,i.optional&&e===undefined){if(null===i.default)return;e=i.default}let o=null,a=!1;if(i.any)s=this._createEncoderBuffer(e);else if(i.choice)s=this._encodeChoice(e,t);else if(i.contains)o=this._getUse(i.contains,r)._encode(e,t),a=!0;else if(i.children)o=i.children.map((function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");const n=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");const i=r._encode(e[r._baseState.key],t,e);return t.leaveKey(n),i}),this).filter((function(e){return e})),o=this._createEncoderBuffer(o);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const r=this.clone();r._baseState.implicit=null,o=this._createEncoderBuffer(e.map((function(r){const n=this._baseState;return this._getUse(n.args[0],e)._encode(r,t)}),r))}else null!==i.use?s=this._getUse(i.use,r)._encode(e,t):(o=this._encodePrimitive(i.tag,e),a=!0);if(!i.any&&null===i.choice){const e=null!==i.implicit?i.implicit:i.tag,r=null===i.implicit?"universal":"context";null===e?null===i.use&&t.error("Tag could be omitted only for .use()"):null===i.use&&(s=this._encodeComposite(e,a,r,o))}return null!==i.explicit&&(s=this._encodeComposite(i.explicit,!1,"context",s)),s},u.prototype._encodeChoice=function(e,t){const r=this._baseState,n=r.choice[e.type];return n||o(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),n._encode(e.value,t)},u.prototype._encodePrimitive=function(e,t){const r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},u.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},u.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1554,{inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits");function i(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}r.Reporter=i,i.prototype.isError=function(e){return e instanceof s},i.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},i.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},i.prototype.enterKey=function(e){return this._reporterState.path.push(e)},i.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},i.prototype.leaveKey=function(e,t,r){const n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=r)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},i.prototype.leaveObject=function(e){const t=this._reporterState,r=t.obj;return t.obj=e,r},i.prototype.error=function(e){let t;const r=this._reporterState,n=e instanceof s;if(t=n?e:new s(r.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!r.options.partial)throw t;return n||r.errors.push(t),t},i.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},n(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1555,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t}r.tagClass={0:"universal",1:"application",2:"context",3:"private"},r.tagClassByName=n(r.tagClass),r.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},r.tagByName=n(r.tag)}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1556,{"./der":1555},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t},n.der=e("./der")}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1557,{"../base/buffer":1551,"../base/node":1553,"../constants/der":1555,"bn.js":1892,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits"),i=e("bn.js"),s=e("../base/buffer").DecoderBuffer,o=e("../base/node"),a=e("../constants/der");function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new u,this.tree._init(e.body)}function u(e){o.call(this,"der",e)}function l(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;const n=a.tagClass[r>>6],i=0==(32&r);if(31==(31&r)){let n=r;for(r=0;128==(128&n);){if(n=e.readUInt8(t),e.isError(n))return n;r<<=7,r|=127&n}}else r&=31;return{cls:n,primitive:i,tag:r,tagStr:a.tag[r]}}function d(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&128===n)return null;if(0==(128&n))return n;const i=127&n;if(i>4)return e.error("length octect is too long");n=0;for(let t=0;t<i;t++){n<<=8;const t=e.readUInt8(r);if(e.isError(t))return t;n|=t}return n}t.exports=c,c.prototype.decode=function(e,t){return s.isDecoderBuffer(e)||(e=new s(e,t)),this.tree._decode(e,t)},n(u,o),u.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;const n=e.save(),i=l(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(n),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||r)},u.prototype._decodeTag=function(e,t,r){const n=l(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;let i=d(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!r&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');const s=e.save(),o=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(o)?o:(i=e.offset-s.offset,e.restore(s),e.skip(i,'Failed to match body of: "'+t+'"'))},u.prototype._skipUntilEnd=function(e,t){for(;;){const r=l(e,t);if(e.isError(r))return r;const n=d(e,r.primitive,t);if(e.isError(n))return n;let i;if(i=r.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===r.tagStr)break}},u.prototype._decodeList=function(e,t,r,n){const i=[];for(;!e.isEmpty();){const t=this._peekTag(e,"end");if(e.isError(t))return t;const s=r.decode(e,"der",n);if(e.isError(s)&&t)break;i.push(s)}return i},u.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");let r="";for(let e=0;e<t.length/2;e++)r+=String.fromCharCode(t.readUInt16BE(2*e));return r}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: "+"numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: "+"printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},u.prototype._decodeObjid=function(e,t,r){let n;const i=[];let s=0,o=0;for(;!e.isEmpty();)o=e.readUInt8(),s<<=7,s|=127&o,0==(128&o)&&(i.push(s),s=0);128&o&&i.push(s);const a=i[0]/40|0,c=i[0]%40;if(n=r?i:[a,c].concat(i.slice(1)),t){let e=t[n.join(" ")];e===undefined&&(e=t[n.join(".")]),e!==undefined&&(n=e)}return n},u.prototype._decodeTime=function(e,t){const r=e.raw().toString();let n,i,s,o,a,c;if("gentime"===t)n=0|r.slice(0,4),i=0|r.slice(4,6),s=0|r.slice(6,8),o=0|r.slice(8,10),a=0|r.slice(10,12),c=0|r.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|r.slice(0,2),i=0|r.slice(2,4),s=0|r.slice(4,6),o=0|r.slice(6,8),a=0|r.slice(8,10),c=0|r.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,i-1,s,o,a,c,0)},u.prototype._decodeNull=function(){return null},u.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},u.prototype._decodeInt=function(e,t){const r=e.raw();let n=new i(r);return t&&(n=t[n.toString(10)]||n),n},u.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1558,{"./der":1557,"./pem":1559},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r;n.der=e("./der"),n.pem=e("./pem")}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1559,{"./der":1557,buffer:1936,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits"),i=e("buffer").Buffer,s=e("./der");function o(e){s.call(this,e),this.enc="pem"}n(o,s),t.exports=o,o.prototype.decode=function(e,t){const r=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/;let a=-1,c=-1;for(let e=0;e<r.length;e++){const t=r[e].match(o);if(null!==t&&t[2]===n){if(-1!==a){if("END"!==t[1])break;c=e;break}if("BEGIN"!==t[1])break;a=e}}if(-1===a||-1===c)throw new Error("PEM section not found for: "+n);const u=r.slice(a+1,c).join("");u.replace(/[^a-z0-9+/=]+/gi,"");const l=new i(u,"base64");return s.prototype.decode.call(this,l,t)}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[156,{"../../../shared/constants/transaction":6033,lodash:5016},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){return function(s){const o=(0,n.cloneDeep)(s);o.meta.version=e;try{const e=function(e,t,r){const n=e,{TransactionController:s}=n;if(s&&s.transactions){const{transactions:e}=s;n.TransactionController.transactions=e.map((e=>t(e)?(e.status=i.TRANSACTION_STATUSES.FAILED,e.err={message:r,note:`Tx automatically failed by migration because ${r}`},e):e))}return n}(o.data,r,t);o.data=e}catch(t){console.warn(`MetaMask Migration #${e}${t.stack}`)}return Promise.resolve(o)}};var n=e("lodash"),i=e("../../../shared/constants/transaction")}}},{package:"$root$"}],[1560,{"../base/node":1553,"../constants/der":1555,buffer:1936,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits"),i=e("buffer").Buffer,s=e("../base/node"),o=e("../constants/der");function a(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){s.call(this,"der",e)}function u(e){return e<10?"0"+e:e}t.exports=a,a.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(c,s),c.prototype._encodeComposite=function(e,t,r,n){const s=function(e,t,r,n){let i;"seqof"===e?e="seq":"setof"===e&&(e="set");if(o.tagByName.hasOwnProperty(e))i=o.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);i=e}if(i>=31)return n.error("Multi-octet tag encoding unsupported");t||(i|=32);return i|=o.tagClassByName[r||"universal"]<<6,i}(e,t,r,this.reporter);if(n.length<128){const e=new i(2);return e[0]=s,e[1]=n.length,this._createEncoderBuffer([e,n])}let a=1;for(let e=n.length;e>=256;e>>=8)a++;const c=new i(2+a);c[0]=s,c[1]=128|a;for(let e=1+a,t=n.length;t>0;e--,t>>=8)c[e]=255&t;return this._createEncoderBuffer([c,n])},c.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=new i(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports "+"only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports "+"only latin upper and lower case letters, "+"digits, space, apostrophe, left and rigth "+"parenthesis, plus sign, comma, hyphen, "+"dot, slash, colon, equal sign, "+"question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},c.prototype._encodeObjid=function(e,t,r){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, "+"got: "+JSON.stringify(e));if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let t=0;t<e.length;t++){let r=e[t];for(n++;r>=128;r>>=7)n++}const s=new i(n);let o=s.length-1;for(let t=e.length-1;t>=0;t--){let r=e[t];for(s[o--]=127&r;(r>>=7)>0;)s[o--]=128|127&r}return this._createEncoderBuffer(s)},c.prototype._encodeTime=function(e,t){let r;const n=new Date(e);return"gentime"===t?r=[u(n.getUTCFullYear()),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[u(n.getUTCFullYear()%100),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!i.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=new i(t)}if(i.isBuffer(e)){let t=e.length;0===e.length&&t++;const r=new i(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let t=e;t>=256;t>>=8)r++;const n=new Array(r);for(let t=n.length-1;t>=0;t--)n[t]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(new i(n))},c.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},c.prototype._skipDefault=function(e,t,r){const n=this._baseState;let i;if(null===n.default)return!1;const s=e.join();if(n.defaultBuffer===undefined&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),s.length!==n.defaultBuffer.length)return!1;for(i=0;i<s.length;i++)if(s[i]!==n.defaultBuffer[i])return!1;return!0}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1561,{"./der":1560,"./pem":1562},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r;n.der=e("./der"),n.pem=e("./pem")}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1562,{"./der":1560,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("inherits"),i=e("./der");function s(e){i.call(this,e),this.enc="pem"}n(s,i),t.exports=s,s.prototype.encode=function(e,t){const r=i.prototype.encode.call(this,e).toString("base64"),n=["-----BEGIN "+t.label+"-----"];for(let e=0;e<r.length;e+=64)n.push(r.slice(e,e+64));return n.push("-----END "+t.label+"-----"),n.join("\n")}}}},{package:"3box>ipfs>libp2p-crypto>asn1.js"}],[1563,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n="undefined"!=typeof BigUint64Array,i=Symbol();function s(e,t,r){var n=r+4>>>1,i=e[r>>>2],s=[];const o=1024;for(;i>o;){let e=t[n+o-1],r=e>=55296&&e<56320?1023:o,a=t.subarray(n,n+=r);s.push(String.fromCharCode.apply(String,a)),i-=r}return s.join("")+String.fromCharCode.apply(String,t.subarray(n,n+i))}function o(e){var t={};function r(e,t){if(!e)return"<yet unknown>";var r=e.buffer;return s(new Uint32Array(r),new Uint16Array(r),t)}var n=e.env=e.env||{};return n.abort=n.abort||function(e,i,s,o){var a=t.memory||n.memory;throw Error("abort: "+r(a,e)+" at "+r(a,i)+":"+s+":"+o)},n.trace=n.trace||function(e,i){var s=t.memory||n.memory;console.log("trace: "+r(s,e)+(i?" ":"")+Array.prototype.slice.call(arguments,2,2+i).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function a(e,t){var r,i,o,a,u,d,f,h,p,m,g,y=t.exports,b=y.memory,w=y["memory.allocate"],v=y["memory.fill"],_=y["memory.free"],S=y.table,E=y._setargc||function(){};function k(){r!==b.buffer&&(r=b.buffer,i=new Int8Array(r),o=new Uint8Array(r),a=new Int16Array(r),u=new Uint16Array(r),d=new Int32Array(r),f=new Uint32Array(r),n&&(m=new BigInt64Array(r),g=new BigUint64Array(r)),h=new Float32Array(r),p=new Float64Array(r))}return k(),e.newString=function(e){var t=e.length,r=w(4+(t<<1)),n=4+r>>>1;k(),f[r>>>2]=t;for(let r=0;r<t;++r)u[n+r]=e.charCodeAt(r);return r},e.getString=function(e){return k(),s(f,u,e)},e.newArray=function(e,t,n){var i=e.constructor;i===Function?(i=e,e=null):t===undefined&&(t=e.length);var s=i.BYTES_PER_ELEMENT;if(!s)throw Error("not a typed array");var o=s*t,a=w(12),c=w(function(e){return 1<<32-Math.clz32(e+8-1)}(o));if(k(),f[a>>>2]=c,f[a+4>>>2]=0,f[a+8>>>2]=o,f[c>>>2]=o,f[c+4>>>2]=0,e){if(new i(r,c+8,t).set(e),e.length<t&&!n){let t=s*e.length;v(c+8+t,0,o-t)}}else n||v(c+8,0,o);return a},e.getArray=function(e,t){var n=e.BYTES_PER_ELEMENT;if(!n)throw Error("not a typed array");k();var i=f[t>>>2],s=f[t+4>>>2],o=f[t+8>>>2];return new e(r,i+8+s,(o-s)/n)},e.freeArray=function(e){k();var t=f[e>>>2];_(t),_(e)},e.newFunction=function(e){"function"==typeof e.original&&(e=e.original);var t=S.length;return S.grow(1),S.set(t,e),t},e.getFunction=function(e){return c(S.get(e),E)},e.memory=e.memory||b,e.table=e.table||S,l(y,Object.defineProperties(e,{I8:{get:function(){return k(),i}},U8:{get:function(){return k(),o}},I16:{get:function(){return k(),a}},U16:{get:function(){return k(),u}},I32:{get:function(){return k(),d}},U32:{get:function(){return k(),f}},I64:{get:function(){return k(),m}},U64:{get:function(){return k(),g}},F32:{get:function(){return k(),h}},F64:{get:function(){return k(),p}}}))}function c(e,t){var r=(...r)=>(t(r.length),e(...r));return r.original=e,r}function u(e,t){return a(o(t||(t={})),new WebAssembly.Instance(e,t))}function l(e,t){var r=t?Object.create(t):{},n=e._setargc||function(){};function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}for(let t in e){if(!s(e,t))continue;let o=e[t],a=t.split("."),u=r;for(;a.length>1;){let e=a.shift();s(u,e)||(u[e]={}),u=u[e]}let l=a[0],d=l.indexOf("#");if(d>=0){let r=l.substring(0,d),a=u[r];if(void 0===a||!a.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={},e.wrap=function(t){return Object.create(e.prototype,{[i]:{value:t,writable:!1}})},a&&Object.getOwnPropertyNames(a).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t)))),u[r]=e}if(l=l.substring(d+1),u=u[r].prototype,/^(get|set):/.test(l)){if(!s(u,l=l.substring(4))){let r=e[t.replace("set:","get:")],n=e[t.replace("get:","set:")];Object.defineProperty(u,l,{get:function(){return r(this[i])},set:function(e){n(this[i],e)},enumerable:!0})}}else"constructor"===l?u[l]=c(o,n):Object.defineProperty(u,l,{value:function(...e){return n(e.length),o(this[i],...e)}})}else/^(get|set):/.test(l)?s(u,l=l.substring(4))||Object.defineProperty(u,l,{get:e[t.replace("set:","get:")],set:e[t.replace("get:","set:")],enumerable:!0}):u[l]="function"==typeof o?c(o,n):o}return r}r.instantiate=u,r.instantiateBuffer=function(e,t){return u(new WebAssembly.Module(e),t)},r.instantiateStreaming=async function(e,t){return a(o(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance)},r.demangle=l}}},{package:"3box>ipfs>ipfs-unixfs-importer>rabin-wasm>assemblyscript"}],[1568,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=async e=>{const t=[];for await(const r of e)t.push(r);return t}}}},{package:"3box>ipfs>async-iterator-all"}],[1569,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=async function*(e,t){let r=[];for await(const n of e)for(r=r.concat(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length;)yield r.slice(0,t),r=r.slice(t)}}}},{package:"3box>ipfs>ipfs-unixfs-importer>async-iterator-batch"}],[157,{"./002":85,"./003":86,"./004":87,"./005":88,"./006":89,"./007":90,"./008":91,"./009":92,"./010":93,"./011":94,"./012":95,"./013":96,"./014":97,"./015":98,"./016":99,"./017":100,"./018":101,"./019":102,"./020":103,"./021":104,"./022":105,"./023":106,"./024":107,"./025":108,"./026":109,"./027":110,"./028":111,"./029":112,"./030":113,"./031":114,"./032":115,"./033":116,"./034":117,"./035":118,"./036":119,"./037":120,"./038":121,"./039":122,"./040":123,"./041":124,"./042":125,"./043":126,"./044":127,"./045":128,"./046":129,"./047":130,"./048":131,"./049":132,"./050":133,"./051":134,"./052":135,"./053":136,"./054":137,"./055":138,"./056":139,"./057":140,"./058":141,"./059":142,"./060":143,"./061":144,"./062":145,"./063":146,"./064":147,"./065":148,"./066":149,"./067":150,"./068":151,"./069":152,"./070":153,"./071":154,"./072":155,"@babel/runtime/helpers/interopRequireDefault":200},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("./002")),s=n(e("./003")),o=n(e("./004")),a=n(e("./005")),c=n(e("./006")),u=n(e("./007")),l=n(e("./008")),d=n(e("./009")),f=n(e("./010")),h=n(e("./011")),p=n(e("./012")),m=n(e("./013")),g=n(e("./014")),y=n(e("./015")),b=n(e("./016")),w=n(e("./017")),v=n(e("./018")),_=n(e("./019")),S=n(e("./020")),E=n(e("./021")),k=n(e("./022")),P=n(e("./023")),T=n(e("./024")),A=n(e("./025")),O=n(e("./026")),x=n(e("./027")),I=n(e("./028")),j=n(e("./029")),N=n(e("./030")),R=n(e("./031")),C=n(e("./032")),M=n(e("./033")),B=n(e("./034")),D=n(e("./035")),L=n(e("./036")),U=n(e("./037")),H=n(e("./038")),K=n(e("./039")),$=n(e("./040")),F=n(e("./041")),q=n(e("./042")),V=n(e("./043")),z=n(e("./044")),W=n(e("./045")),G=n(e("./046")),J=n(e("./047")),Z=n(e("./048")),Y=n(e("./049")),X=n(e("./050")),Q=n(e("./051")),ee=n(e("./052")),te=n(e("./053")),re=n(e("./054")),ne=n(e("./055")),ie=n(e("./056")),se=n(e("./057")),oe=n(e("./058")),ae=n(e("./059")),ce=n(e("./060")),ue=n(e("./061")),le=n(e("./062")),de=n(e("./063")),fe=n(e("./064")),he=n(e("./065")),pe=n(e("./066")),me=n(e("./067")),ge=n(e("./068")),ye=n(e("./069")),be=n(e("./070")),we=n(e("./071")),ve=n(e("./072"));var _e=[i.default,s.default,o.default,a.default,c.default,u.default,l.default,d.default,f.default,h.default,p.default,m.default,g.default,y.default,b.default,w.default,v.default,_.default,S.default,E.default,k.default,P.default,T.default,A.default,O.default,x.default,I.default,j.default,N.default,R.default,C.default,M.default,B.default,D.default,L.default,U.default,H.default,K.default,$.default,F.default,q.default,V.default,z.default,W.default,G.default,J.default,Z.default,Y.default,X.default,Q.default,ee.default,te.default,re.default,ne.default,ie.default,se.default,oe.default,ae.default,ce.default,ue.default,le.default,de.default,fe.default,he.default,pe.default,me.default,ge.default,ye.default,be.default,we.default,ve.default];r.default=_e}}},{package:"$root$"}],[1570,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=async e=>{for await(const t of e)return t}}}},{package:"3box>ipfs>ipfs-unixfs-importer>async-iterator-first"}],[1571,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=async e=>{let t;for await(const r of e)t=r;return t}}}},{package:"3box>ipfs>ipfs-mfs>async-iterator-last"}],[1572,{"get-iterator":4162,"pull-stream-to-async-iterator":5316},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("get-iterator"),i=e("pull-stream-to-async-iterator");function s(e){return e=n(e),async(t,r)=>{if(t){if(e.return)try{await e.return()}catch(e){return r(e)}return r(t)}let n;try{n=await e.next()}catch(e){return r(e)}if(n.done)return r(!0);r(null,n.value)}}s.source=s,s.transform=s.through=e=>t=>s(e(i(t))),s.duplex=e=>({sink:s.sink(e.sink),source:s(e.source)}),s.sink=e=>t=>{e({[Symbol.asyncIterator](){return this},next:()=>new Promise(((e,r)=>{t(null,((t,n)=>!0===t?e({done:!0,value:n}):t?r(t):void e({done:!1,value:n})))})),return:()=>new Promise(((e,r)=>{t(!0,((t,n)=>{if(t&&!0!==t)return r(t);e({done:!0,value:n})}))})),throw:e=>new Promise(((r,n)=>{t(e,((e,t)=>{if(e&&!0!==e)return n(e);r({done:!0,value:t})}))}))})},t.exports=s}}},{package:"3box>ipfs>async-iterator-to-pull-stream"}],[1573,{_process:5261,"readable-stream":1588},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.apply(this,arguments)}function i(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){i(o,n,s,a,c,"next",e)}function c(e){i(o,n,s,a,c,"throw",e)}a(undefined)}))}}const o=e("readable-stream").Readable,a="function"==typeof Symbol?e=>{const t=Symbol[e];return t!==undefined?t:`@@${e}`}:e=>`@@${e}`,c=l.$$asyncIterator=a("asyncIterator"),u=l.$$iterator=a("iterator");function l(e,t){if("function"==typeof e)return function(){return l(e.apply(this,arguments),t)};const n=e.then;if("function"==typeof n)return n.call(e,(e=>l(e,t)));const i=(e=>{let t;return"function"==typeof(t=e[c])||"function"==typeof(t=e[u])?t.call(e):e})(e),a="return"in i,d=t instanceof o?t:new o(t);var f;a&&(d._destroy=(f=s((function*(e,t){try{yield null!=e?i.throw(e):i.return()}catch(e){return t(e)}t(e)})),function(e,t){return f.apply(this,arguments)}));let h=!1;var p;return d._read=(p=s((function*(e){if(!h){h=!0;try{let t;do{let r=i.next(e);if("function"==typeof r.then)r=yield r;else for(;!r.done&&null!=(t=r.value)&&"function"==typeof t.then;){try{t=yield t}catch(e){r=i.throw(e);continue}r=i.next(t)}if(r.done)return d.push(null);t=r.value}while(t===undefined||d.push(t))}catch(e){r.nextTick(d.emit.bind(d,"error",e))}finally{h=!1}}})),function(e){return p.apply(this,arguments)}),d}t.exports=l,l.obj=(e,t)=>l(e,n({objectMode:!0},t))}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>async-iterator-to-stream"}],[1574,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(r===undefined||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(s(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}}},{package:"3box>ipfs>async-iterator-to-stream>readable-stream"}],[1575,{"./_stream_readable":1577,"./_stream_writable":1579,_process:5261,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=u;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(u,i);for(var o=n(s.prototype),a=0;a<o.length;a++){var c=o[a];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>async-iterator-to-stream>readable-stream"}],[1576,{"./_stream_transform":1578,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"3box>ipfs>async-iterator-to-stream>readable-stream"}],[1577,{"../errors":1574,"./_stream_duplex":1575,"./internal/streams/async_iterator":1580,"./internal/streams/buffer_list":1581,"./internal/streams/destroy":1582,"./internal/streams/from":1584,"./internal/streams/state":1586,"./internal/streams/stream":1587,_process:5261,buffer:1936,events:1937,inherits:4276,"string_decoder/":5747,util:1935},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;t.exports=k,k.ReadableState=E;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=global.Uint8Array||function(){};var c,u=e("util");c=u&&u.debuglog?u.debuglog("stream"):function(){};var l,d,f,h=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,y=g.ERR_INVALID_ARG_TYPE,b=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,v=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(k,s);var _=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function E(t,r,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(l||(l=e("string_decoder/").StringDecoder),this.decoder=new l(t.encoding),this.encoding=t.encoding)}function k(t){if(n=n||e("./_stream_duplex"),!(this instanceof k))return new k(t);var r=this instanceof n;this._readableState=new E(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function P(e,t,r,n,i){c("readableAddChunk",t);var s,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?x(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,u);else if(i||(s=function(e,t){var r;n=t,o.isBuffer(n)||n instanceof a||"string"==typeof t||t===undefined||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(u,t)),s)_(e,s);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),n)u.endEmitted?_(e,new v):T(e,u,t,!0);else if(u.ended)_(e,new b);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?T(e,u,t,!1):j(e,u)):T(e,u,t,!1)}else n||(u.reading=!1,j(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function T(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&x(e)),j(e,t)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),k.prototype.destroy=p.destroy,k.prototype._undestroy=p.undestroy,k.prototype._destroy=function(e,t){t(e)},k.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=o.from(e,t),t=""),r=!0),P(this,e,t,!1,r)},k.prototype.unshift=function(e){return P(this,e,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(t){l||(l=e("string_decoder/").StringDecoder);var r=new l(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(I,e))}function I(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,B(e)}function j(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(N,e,t))}function N(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(c("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function R(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){c("readable nexttick read 0"),e.read(0)}function M(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function L(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(U,t,e))}function U(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function H(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}k.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):x(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&L(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(r,t))),null===(n=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&L(this)),null!==n&&this.emit("data",n),n},k.prototype._read=function(e){_(this,new w("_read()"))},k.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,c("pipe count=%d opts=%j",s.pipesCount,t);var o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?u:g;function a(t,r){c("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",h),e.removeListener("unpipe",a),n.removeListener("end",u),n.removeListener("end",g),n.removeListener("data",f),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}s.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,B(e))}}(n);e.on("drain",l);var d=!1;function f(t){c("ondata");var r=e.write(t);c("dest.write",r),!1===r&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==H(s.pipes,e))&&!d&&(c("false write response, pause",s.awaitDrain),s.awaitDrain++),n.pause())}function h(t){c("onerror",t),g(),e.removeListener("error",h),0===i(e,"error")&&_(e,t)}function p(){e.removeListener("finish",m),g()}function m(){c("onfinish"),e.removeListener("close",p),g()}function g(){c("unpipe"),n.unpipe(e)}return n.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",p),e.once("finish",m),e.emit("pipe",n),s.flowing||(c("pipe resume"),n.resume()),e},k.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=H(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},k.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?x(this):i.reading||r.nextTick(C,this))),n},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(R,this),n},k.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||r.nextTick(R,this),t},k.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(M,e,t))}(this,e)),e.paused=!1,this},k.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&i!==undefined)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(k.prototype[Symbol.asyncIterator]=function(){return d===undefined&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),k._fromList=D,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(k.from=function(t,r){return f===undefined&&(f=e("./internal/streams/from")),f(k,t,r)})}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>async-iterator-to-stream>readable-stream"}],[1578,{"../errors":1574,"./_stream_duplex":1575,inherits:4276},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=l;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new i("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"3box>ipfs>async-iterator-to-stream>readable-stream"}]],[],{});